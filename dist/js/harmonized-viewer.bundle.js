!function o(s,a,l){function u(t,e){if(!a[t]){if(!s[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(h)return h(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=a[t]={exports:{}};s[t][0].call(r.exports,function(e){return u(s[t][1][e]||e)},r,r.exports,o,s,a,l)}return a[t].exports}for(var h="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,i){e("handlebars"),e("openseadragon");var a=e("manifesto.js"),l=e("get-user-locale");!function(u,o,n,h){"use strict";var s,i="harmonizedViewer",r={locale:"en-GB",manifest:null,navigation:{enableCustomScrollbar:!0}};function t(e,t){this.element=e,this.settings=u.extend({},r,t),this._defaults=r,this._name=i,this.displayMode=1,this.manifest=null,this.currentPage=0,this.pages=[],this.carousel=null,this.init()}u.extend(t.prototype,{init:function(){this.events={},this.configureLocales(),alert(this.localeString("display_mode_single_page")),this.initToolbar(),this.loadManifest();var i=this;this.bindEventControls("page"),this.bindEventControls("previous"),this.bindEventControls("next"),this.bindEventControls("navigation"),this.bindEventControls("metadata"),this.bindEventControls("gallery"),this.bindEventControls("display"),this.addHandler("navigation",function(){i.toggleSidebar(".hv-sidebar__navigation")}),this.addHandler("gallery",function(){i.toggleSidebar(".hv-overlay__gallery")}),this.addHandler("metadata",function(){i.toggleSidebar(".hv-sidebar__metadata")}),this.addHandler("display",function(e){var t=parseInt(e.displayMode);i.displayMode=1===t||2===t?t:1,i.initOpenSeadragon()}),this.addHandler("previous",function(){i.goTo(i.currentPage-i.displayMode)}),this.addHandler("next",function(){i.goTo(i.currentPage+i.displayMode)}),this.addHandler("page",function(){i.enableNavigationPrevious(i.isFirstPage()),i.enableNavigationNext(i.isLastPage());var e=u(i.element).find(".hv-navigation__item--active");i.scrollTo(e)}),this.addHandler("loaded",function(){i.getViewport().removeClass("loading"),u(s.element).show(),i.showToolbars(),i.enableToolbar(".hv-toolbar__secondary")})},configureLocales:function(){},populateAnnotations:function(){var e=this.getSidebar(".hv-sidebar__metadata"),t=u("<div/>").addClass("hv-sidebar-content").appendTo(e),i=u("<dl/>").addClass("hv-annotations").appendTo(t);u.each(this.manifest.getMetadata(),function(e,t){u("<dt/>").text(t.getLabel()).appendTo(i),u("<dd/>").html(t.getValue()).appendTo(i),i.append(i)})},populateNavigation:function(){var r=this,t=this.getSidebar(".hv-sidebar__navigation"),e=this.getSidebar(".hv-overlay__gallery"),i=t.find(".hv-navigation__items"),n=e.find(".hv-navigation__items"),o=[];this.manifest.getSequenceByIndex(0).getCanvases().forEach(function(e){var t=e.getImages()[0],i=e.getLabel()[0],n=r.getThumbnail(t,h,120);o.push({title:i.value,imageUrl:n})});var s=u("<ol/>");o.forEach(function(e,t){var i=u("<li/>").attr("data-index",t).appendTo(s),n=u("<a/>").attr("href","javascript:;").addClass("hv-navigation__item").attr("title",e.title).attr("data-toggle","page").attr("data-page",t).appendTo(i);r.createThumbnail(e.imageUrl).appendTo(n)}),i.html(s[0].outerHTML),n.html(s[0].outerHTML),t.mCustomScrollbar({skin:"dark-think",scrollInertia:0,keyboard:{enable:!1},advanced:{autoScrollOnFocus:".hv-navigation__item"}}),e.mCustomScrollbar({skin:"dark-think",scrollInertia:0,keyboard:{enable:!1},advanced:{autoScrollOnFocus:".hv-navigation__item"}});var a=u(this.element).find(".hv-navigation__carousel .swiper-wrapper");o.forEach(function(e){var t=u("<li/>").addClass("swiper-slide").css({width:"90px",height:"90px"}).appendTo(a);r.createThumbnail(e.imageUrl).appendTo(t)}),this.carousel=new Swiper(".hv-navigation__carousel",{slidesPerView:"auto",centeredSlides:!0,slidesPerColumnFill:"row",spaceBetween:3}),this.initLazyLoading();var l={trigger:"hover focus",placement:"bottom",template:'<div class="tooltip hv-tooltip" role="tooltip"><div class="tooltip-inner"></div></div>'};t.find(".hv-navigation__item").tooltip(l),e.find(".hv-navigation__item").tooltip(l),t.keydown(function(e){switch(e.which){case 37:case 38:t.find(".hv-navigation__item:focus").parent().prev().children(".hv-navigation__item").eq(0).focus();break;case 39:case 40:t.find(".hv-navigation__item:focus").parent().next().children(".hv-navigation__item").eq(0).focus();break;default:return}e.preventDefault()})},goTo:function(e){e<0?console.error("Page index must be equal to or greater than zero."):e>this.pages.length-1?console.error("Page index must be less than the total number of pages."):(this.currentPage=e,this.initOpenSeadragon(),this.raiseEvent("page",{page:e}))},isFirstPage:function(){return this.currentPage<this.displayMode},isLastPage:function(){return this.currentPage>=this.pages.length-1-(this.displayMode-1)},getThumbnail:function(e,t,i){var n=e.getResource().getServices()[0];return this.format("{0}/full/{1},{2}/0/default.{3}",n.id,t!==h?t:"",i!==h?i:"","jpg")},bindProperty:function(e,t){u(this.element).find("[data-bind]").filter(function(){return-1<u(this).attr("data-bind").toLowerCase().indexOf(e.toLowerCase())}).text(t).removeClass("hv-skeleton")},getContent:function(){return u(this.element).find(".hv-content")},getViewport:function(){return u(this.element).find(".hv-viewport")},getSidebar:function(e){return u(this.element).find(e)},openSidebar:function(e){var t=this.getSidebar(e).removeClass("hv-sidebar--closing hv-sidebar--closed hv-sidebar--opened").addClass("hv-sidebar--opening");t.hasClass("hv-sidebar__right")||t.hasClass("hv-sidebar__top")||t.hasClass("hv-sidebar__bottom"),t.addClass("hv-sidebar--opened"),this.resizeViewport()},closeSidebar:function(e){var t=this.getSidebar(e).removeClass("hv-sidebar--opening hv-sidebar--opened hv-sidebar--closed").addClass("hv-sidebar--closing");t.hasClass("hv-sidebar__right")||t.hasClass("hv-sidebar__top")||t.hasClass("hv-sidebar__bottom"),t.addClass("hv-sidebar--closed"),this.resizeViewport()},isSidebarOpened:function(e){var t=this.getSidebar(e);return t.hasClass("hv-sidebar--opened")||t.hasClass("hv-sidebar--opening")},resizeViewport:function(){var e=this.caculateSidebarWidth(".hv-sidebar.hv-sidebar__push.hv-sidebar__left"),t=this.caculateSidebarWidth(".hv-sidebar.hv-sidebar__push.hv-sidebar__right");this.getContent().find(".hv-content__container").css("padding-left",this.format("{0}px",e)).css("padding-right",this.format("{0}px",t))},caculateSidebarWidth:function(e){var t=this,i=0;return u(this.element).find(e).each(function(){t.isSidebarOpened(this)&&(i+=u(this).outerWidth())}),i},toggleSidebar:function(e){this.isSidebarOpened(e)?this.closeSidebar(e):this.openSidebar(e)},enableButton:function(e,t){void 0===t&&(t=!0),u(this.element).find(e).prop("disabled",!t)},disableButton:function(e,t){return this.enableButton(e,!1)},showToolbars:function(){u(this.element).find(".hv-toolbar__secondary.invisible").removeClass("invisible")},initToolbar:function(){u(this.element).on("click",".hv-button-toggle",function(){u(this).toggleClass("hv-button-toggle--active")}),u(this.element).append(Handlebars.partials["modal-settings"]()).find(".modal").modal({autofocus:!1,detachable:!0,blurring:!0}),u(this.element).find(".hv-modal_settings .ui.dropdown").dropdown(),u(this.element).on("click",".hv-menu_settings",function(){u(".hv-modal_settings").modal("show")})},enableToolbar:function(e,t){void 0===t&&(t=!0),u(this.element).find(e).find(".hv-button").prop("disabled",!t)},disableToolbar:function(e){this.enableToolbar(e,!1)},scrollTo:function(e){var t=this.getSidebar(".hv-sidebar__navigation");this.settings.navigation.enableCustomScrollbar?t.mCustomScrollbar("scrollTo",u(e)):u(e)[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})},enableNavigation:function(e){this.enableNavigationPrevious(e),this.enableNavigationNext(e)},disableNavigation:function(){return this.enableNavigation(!1)},enableNavigationPrevious:function(e){var t=this.getViewport().find(".hv-viewport__prev");return this.enableButton(t,e)},disableNavigationPrevious:function(){return enableNavigationPrevious(!1)},enableNavigationNext:function(e){var t=this.getViewport().find(".hv-viewport__next");return this.enableButton(t,e)},disableNavigationNext:function(){return enableNavigationNext(!1)},updateNavigationControls:function(){var e=s.currentPage();this.getEventControls("previous").prop("disabled",this.isFirstPage()),this.getEventControls("next").prop("disabled",this.isLastPage()),u(this.element).find(".hv-sidebar__navigation ol > li .hv-navigation__item").removeClass("hv-navigation__item--active"),u(this.element).find(".hv-sidebar__navigation ol > li[data-index="+e+"] .hv-navigation__item").addClass("hv-navigation__item--active")},getManifestCanvas:function(e){return this.manifest.getSequenceByIndex(0).getCanvasByIndex(e)},bindEventControls:function(e,t){var i=this;u(n).find(this.element).on("click","[data-toggle="+e+"]",function(){i.raiseEvent(e,u(this).data())})},getEventControls:function(e){return u(this.element).find("[data-toggle="+e+"]")},raiseEvent:function(e,t){var i=this.getHandler(e);i&&i(this,t=t||{})},addHandler:function(e,t,i){var n=this.events[e];n||(this.events[e]=n=[]),t&&"function"==typeof t&&(n[n.length]={handler:t,userData:i||null})},getHandler:function(e){var r=this.events[e];return r&&r.length?(r=1===r.length?[r[0]]:Array.apply(null,r),function(e,t){var i,n=r.length;for(i=0;i<n;i++)r[i]&&(t.eventSource=e,t.userData=r[i].userData,r[i].handler(t))}):null},createThumbnail:function(e){return u("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==").addClass("hv-thumbnail hv-lazy").attr("data-src",e).attr("data-srcset",this.format("{0} 1x",e))},initOpenSeadragon:function(){var r=this;s!==h&&(s.destroy(),s=null);var e=this.getViewport();e.find(".hv-openseadragon").remove();var t=u("<div/>").addClass("hv-openseadragon").hide().width("100%").height("100%").appendTo(e),i=this.getUniqueId(t[0]),n=r.pages.slice(r.currentPage,r.currentPage+r.displayMode);(s=new OpenSeadragon({id:i,prefixUrl:"../node_modules/openseadragon/build/openseadragon/images/",tileSources:n,sequenceMode:!1,collectionMode:!0,collectionRows:1,collectionColumns:1,collectionLayout:"horizontal",collectionTileMargin:30,showNavigator:!0,navigatorPosition:"BOTTOM_RIGHT",showNavigationControl:!1,showSequenceControl:!1,minZoomImageRatio:1,preserveViewport:!0,animationTime:.25,springStiffness:10})).addHandler("open",function(e){r.raiseEvent("loaded",e)}),s.addHandler("page",function(e){}),s.addHandler("tile-loaded",function(e){r.raiseEvent("tile-loaded",e)}),s.addHandler("open-failed",function(e){u(s.element).hide(),r.showError(e)}),s.addHandler("animation",function(){var e=s.viewport.getMinZoom(),t=s.viewport.getMaxZoom(),i=s.viewport.getZoom(!1),n=Math.round(100*(i-e)/(t-e),0);u(r.element).find(".hv-zoom").text(r.format("{0}%",n))})},loadManifest:function(){var t=this;a.loadManifest(this.settings.manifest).then(function(e){t.manifest=a.create(e),t.manifest.getSequences()[0].getCanvases().map(function(e){return e.getImages()[0].getResource().getServices()[0].id+"/info.json"}).forEach(function(e){t.pages.push(e)}),t.bindProperty("manifest-label",t.manifest.getDefaultLabel()),t.bindProperty("total-pages",t.pages.length),t.initOpenSeadragon()},function(e){console.error(e),t.showError(e)}).catch(function(e){console.error(e),t.showError(e.message)})},initPageSlider:function(){var e=this.manifest.getSequenceByIndex(0).getCanvases().length,t=u(this.element).find(".hv-pageslider")[0];noUiSlider.create(t,{start:[1],step:1,range:{min:[1],max:[e]},behaviour:"hover-snap"});var n=this;u(t).hover(function(){},function(){u(".hv-tooltip").remove()}),u(t).mousemove(function(e){n.setSliderTooltipPosition(t,{x:e.pageX,y:e.pageY})}),t.noUiSlider.on("hover",function(e){var t=parseInt(e)-1;n.updateSliderPreview(t)}),t.noUiSlider.on("slide",function(e,t){var i=parseInt(e[t])-1;n.updateSliderPreview(i)}),t.noUiSlider.on("end",function(e,t){})},setSliderTooltipPosition:function(e,t){var i=u(".hv-tooltip"),n=u(e).offset().top,r=u(o).height()-n;i.css({bottom:r,left:t.x-i.outerWidth()/2})},updateSliderPreview:function(e){var t=this.getManifestCanvas(e).getImages(0)[0],i=this.getThumbnail(t,h,120);if(0===u(".hv-tooltip").length){var n=u("<div/>").addClass("hv-tooltip animated bounceIn2 faster").attr("role","tooltip").appendTo("body"),r=(u("<div/>").addClass("arrow").appendTo(n),u("<div/>").addClass("tooltip-inner").appendTo(n));u("<img/>").addClass("hv-thumbnail").appendTo(r)}u(".hv-tooltip").find("img").one("load",function(){u(".hv-tooltip").find(".arrow").css({left:u(this).width()/2})}).attr("src",i)},getLocale:function(){return alert(l.getUserLocales()),o.localStorage.getItem("locale")||o.navigator.language||o.navigator.userLanguage},resolveLocale:function(t){if("undefined"==typeof harmonizedviewer_locales)return null;void 0===t&&(t=this.getLocale());var e=harmonizedviewer_locales.filter(function(e){return e.code===t&&null!==e.code});if(0<e.length)return e[0];if(t.indexOf("-")){var i=t.substring(0,t.indexOf("-"));return this.resolveLocale(i)}},localeString:function(e){return this.resolveLocale().strings[e]},getUniqueId:function(e){var t=u(e).attr("id");if(t)return t;var i=6,n="0123456789abcdef".split("");i=i||Math.floor(Math.random()*n.length);for(var r="",o=0;o<i;o++)r+=n[Math.floor(Math.random()*n.length)];var s=this.format("#{0}",r);return 0==u(s).length?(u(e).attr("id",r),r):this.getUniqueId(e)},format:function(e){for(var t=0;t<arguments.length-1;t++){var i=new RegExp("\\{"+t+"\\}","gi");e=e.replace(i,arguments[t+1])}return e},showError:function(e){var t=u("<div />").addClass("hv-error ui negative message");u("<div/>").addClass("header").html("Oops...").appendTo(t),u("<p/>").html("Something went wrong. Please try again later.").appendTo(t);var i=this.getViewport();i.removeClass("loading"),t.appendTo(i)},animate:function(e,t,i){var n=u(this.element).find(e);n.addClass("animated").addClass(t),n[0].addEventListener("animationend",function e(){n.removeClass("animated").removeClass(t),n[0].removeEventListener("animationend",e),"function"==typeof i&&i()})},initLazyLoading:function(){var e=[].slice.call(n.querySelectorAll(".hv-lazy"));if(u(e).addClass("hv-lazy--pending"),"IntersectionObserver"in o){var i=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){var t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("hv-lazy--pending"),t.classList.add("hv-lazy--loaded"),i.unobserve(t)}})});e.forEach(function(e){i.observe(e)})}}}),u.fn.harmonizedViewer=function(e){return this.each(function(){u.data(this,"plugin_"+i)||u.data(this,"plugin_"+i,new t(this,e))})}}(jQuery,window,document),harmonizedviewer_locales=[{code:"en",strings:{name:"English",display_mode_single_page:"Single page",display_mode_dual_page:"Dual page"}},{code:"fr",strings:{name:"Français",display_mode_single_page:"Single page",display_mode_dual_page:"Dual page"}}],Handlebars.registerPartial("modal-settings",Handlebars.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,n,r){return'<div class="hv-modal_settings ui small modal">\r\n    <div class="header">\r\n        Settings\r\n    </div>\r\n    <div class="content">\r\n        <div class="ui grid">\r\n            <div class="two column row">\r\n                <div class="eight wide column">\r\n                    <h5 class="ui small header">Language</h5>\r\n                    <p>\r\n                        Choose your preferred language for the Harmonized Viewer\'s interface.\r\n                    </p>\r\n                </div>\r\n                <div class="eight wide column">\r\n                    <div class="ui fluid selection dropdown">\r\n                        <i class="dropdown icon"></i>\r\n                        <div class="default text">\r\n                            Select a language\r\n                        </div>\r\n                        <div class="menu">\r\n                            <div class="item" data-value="en">\r\n                                <i class="gb uk flag"></i>\r\n                                English\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    <div class="actions">\r\n        <div class="ui black deny button">\r\n            Cancel\r\n        </div>\r\n        <div class="ui positive right button">\r\n            Apply\r\n        </div>\r\n    </div>\r\n</div>'},useData:!0}))},{"get-user-locale":10,handlebars:40,"manifesto.js":57,openseadragon:58}],2:[function(e,t,i){"use strict";i.byteLength=function(e){var t=c(e),i=t[0],n=t[1];return 3*(i+n)/4-n},i.toByteArray=function(e){var t,i,n=c(e),r=n[0],o=n[1],s=new h(function(e,t,i){return 3*(t+i)/4-i}(0,r,o)),a=0,l=0<o?r-4:r;for(i=0;i<l;i+=4)t=u[e.charCodeAt(i)]<<18|u[e.charCodeAt(i+1)]<<12|u[e.charCodeAt(i+2)]<<6|u[e.charCodeAt(i+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===o&&(t=u[e.charCodeAt(i)]<<2|u[e.charCodeAt(i+1)]>>4,s[a++]=255&t);1===o&&(t=u[e.charCodeAt(i)]<<10|u[e.charCodeAt(i+1)]<<4|u[e.charCodeAt(i+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},i.fromByteArray=function(e){for(var t,i=e.length,n=i%3,r=[],o=0,s=i-n;o<s;o+=16383)r.push(l(e,o,s<o+16383?s:o+16383));1==n?(t=e[i-1],r.push(a[t>>2]+a[t<<4&63]+"==")):2==n&&(t=(e[i-2]<<8)+e[i-1],r.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"="));return r.join("")};for(var a=[],u=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,o=n.length;r<o;++r)a[r]=n[r],u[n.charCodeAt(r)]=r;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function l(e,t,i){for(var n,r,o=[],s=t;s<i;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(a[(r=n)>>18&63]+a[r>>12&63]+a[r>>6&63]+a[63&r]);return o.join("")}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},{}],3:[function(e,t,i){},{}],4:[function(e,t,i){arguments[4][3][0].apply(i,arguments)},{dup:3}],5:[function(e,L,k){(function(A){!function(e){var t="object"==typeof k&&k&&!k.nodeType&&k,i="object"==typeof L&&L&&!L.nodeType&&L,n="object"==typeof A&&A;n.global!==n&&n.window!==n&&n.self!==n||(e=n);var r,o,v=2147483647,y=36,w=1,S=26,s=38,a=700,_=72,T=128,b="-",l=/^xn--/,u=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=y-w,E=Math.floor,x=String.fromCharCode;function P(e){throw new RangeError(c[e])}function d(e,t){for(var i=e.length,n=[];i--;)n[i]=t(e[i]);return n}function f(e,t){var i=e.split("@"),n="";return 1<i.length&&(n=i[0]+"@",e=i[1]),n+d((e=e.replace(h,".")).split("."),t).join(".")}function I(e){for(var t,i,n=[],r=0,o=e.length;r<o;)55296<=(t=e.charCodeAt(r++))&&t<=56319&&r<o?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function C(e){return d(e,function(e){var t="";return 65535<e&&(t+=x((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=x(e)}).join("")}function O(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,i){var n=0;for(e=i?E(e/a):e>>1,e+=E(e/t);p*S>>1<e;n+=y)e=E(e/p);return E(n+(p+1)*e/(e+s))}function g(e){var t,i,n,r,o,s,a,l,u,h,c,p=[],d=e.length,f=0,g=T,m=_;for((i=e.lastIndexOf(b))<0&&(i=0),n=0;n<i;++n)128<=e.charCodeAt(n)&&P("not-basic"),p.push(e.charCodeAt(n));for(r=0<i?i+1:0;r<d;){for(o=f,s=1,a=y;d<=r&&P("invalid-input"),c=e.charCodeAt(r++),(y<=(l=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:y)||l>E((v-f)/s))&&P("overflow"),f+=l*s,!(l<(u=a<=m?w:m+S<=a?S:a-m));a+=y)s>E(v/(h=y-u))&&P("overflow"),s*=h;m=R(f-o,t=p.length+1,0==o),E(f/t)>v-g&&P("overflow"),g+=E(f/t),f%=t,p.splice(f++,0,g)}return C(p)}function m(e){var t,i,n,r,o,s,a,l,u,h,c,p,d,f,g,m=[];for(p=(e=I(e)).length,t=T,o=_,s=i=0;s<p;++s)(c=e[s])<128&&m.push(x(c));for(n=r=m.length,r&&m.push(b);n<p;){for(a=v,s=0;s<p;++s)t<=(c=e[s])&&c<a&&(a=c);for(a-t>E((v-i)/(d=n+1))&&P("overflow"),i+=(a-t)*d,t=a,s=0;s<p;++s)if((c=e[s])<t&&++i>v&&P("overflow"),c==t){for(l=i,u=y;!(l<(h=u<=o?w:o+S<=u?S:u-o));u+=y)g=l-h,f=y-h,m.push(x(O(h+g%f,0))),l=E(g/f);m.push(x(O(l,0))),o=R(i,d,n==r),i=0,++n}++i,++t}return m.join("")}if(r={version:"1.4.1",ucs2:{decode:I,encode:C},decode:g,encode:m,toASCII:function(e){return f(e,function(e){return u.test(e)?"xn--"+m(e):e})},toUnicode:function(e){return f(e,function(e){return l.test(e)?g(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return r});else if(t&&i)if(L.exports==t)i.exports=r;else for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);else e.punycode=r}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(D,e,F){(function(c){"use strict";var n=D("base64-js"),o=D("ieee754"),e="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;F.Buffer=c,F.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},F.INSPECT_MAX_BYTES=50;var i=2147483647;function s(e){if(i<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,i){if("number"!=typeof e)return r(e,t,i);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return l(e)}function r(e,t,i){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var i=0|p(e,t),n=s(i),r=n.write(e,t);r!==i&&(n=n.slice(0,r));return n}(e,t);if(ArrayBuffer.isView(e))return u(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(M(e,ArrayBuffer)||e&&M(e.buffer,ArrayBuffer))return function(e,t,i){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;n=void 0===t&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,t):new Uint8Array(e,t,i);return Object.setPrototypeOf(n,c.prototype),n}(e,t,i);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,i);var r=function(e){if(c.isBuffer(e)){var t=0|h(e.length),i=s(t);return 0===i.length||e.copy(i,0,0,t),i}if(void 0!==e.length)return"number"!=typeof e.length||N(e.length)?s(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function l(e){return a(e),s(e<0?0:0|h(e))}function u(e){for(var t=e.length<0?0:0|h(e.length),i=s(t),n=0;n<t;n+=1)i[n]=255&e[n];return i}function h(e){if(i<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||M(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var i=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===i)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return A(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return L(e).length;default:if(r)return n?-1:A(e).length;t=(""+t).toLowerCase(),r=!0}}function d(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function f(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),N(i=+i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:g(e,t,i,n,r);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):g(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function g(e,t,i,n,r){var o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a/=s=2,l/=2,i/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var h=-1;for(o=i;o<a;o++)if(u(e,o)===u(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===l)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(a<i+l&&(i=a-l),o=i;0<=o;o--){for(var c=!0,p=0;p<l;p++)if(u(e,o+p)!==u(t,p)){c=!1;break}if(c)return o}return-1}function m(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?r<(n=Number(n))&&(n=r):n=r;var o=t.length;o/2<n&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(N(a))return s;e[i+s]=a}return s}function v(e,t,i,n){return k(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function y(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function w(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var o,s,a,l,u=e[r],h=null,c=239<u?4:223<u?3:191<u?2:1;if(r+c<=i)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(o=e[r+1]))&&127<(l=(31&u)<<6|63&o)&&(h=l);break;case 3:o=e[r+1],s=e[r+2],128==(192&o)&&128==(192&s)&&2047<(l=(15&u)<<12|(63&o)<<6|63&s)&&(l<55296||57343<l)&&(h=l);break;case 4:o=e[r+1],s=e[r+2],a=e[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)&&l<1114112&&(h=l)}null===h?(h=65533,c=1):65535<h&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),r+=c}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=S));return i}(n)}F.kMaxLength=i,(c.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(e,t,i){return r(e,t,i)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,i){return function(e,t,i){return a(e),e<=0?s(e):void 0!==t?"string"==typeof i?s(e).fill(t,i):s(e).fill(t):s(e)}(e,t,i)},c.allocUnsafe=function(e){return l(e)},c.allocUnsafeSlow=function(e){return l(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(M(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),M(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var i=e.length,n=t.length,r=0,o=Math.min(i,n);r<o;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var i;if(void 0===t)for(i=t=0;i<e.length;++i)t+=e[i].length;var n=c.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var o=e[i];if(M(o,Uint8Array)&&(o=c.from(o)),!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)d(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)d(this,t,t+3),d(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)d(this,t,t+7),d(this,t+1,t+6),d(this,t+2,t+5),d(this,t+3,t+4);return this},c.prototype.toLocaleString=c.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?w(this,0,e):function(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return b(this,t,i);case"utf8":case"utf-8":return w(this,t,i);case"ascii":return _(this,t,i);case"latin1":case"binary":return T(this,t,i);case"base64":return y(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",t=F.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},e&&(c.prototype[e]=c.prototype.inspect),c.prototype.compare=function(e,t,i,n,r){if(M(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(r<=n&&i<=t)return 0;if(r<=n)return-1;if(i<=t)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(n,r),u=e.slice(t,i),h=0;h<a;++h)if(l[h]!==u[h]){o=l[h],s=u[h];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},c.prototype.indexOf=function(e,t,i){return f(this,e,t,i,!0)},c.prototype.lastIndexOf=function(e,t,i){return f(this,e,t,i,!1)},c.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||r<i)&&(i=r),0<e.length&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var o,s,a,l,u,h,c,p,d,f=!1;;)switch(n){case"hex":return m(this,e,t,i);case"utf8":case"utf-8":return p=t,d=i,k(A(e,(c=this).length-p),c,p,d);case"ascii":return v(this,e,t,i);case"latin1":case"binary":return v(this,e,t,i);case"base64":return l=this,u=t,h=i,k(L(e),l,u,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s=t,a=i,k(function(e,t){for(var i,n,r,o=[],s=0;s<e.length&&!((t-=2)<0);++s)i=e.charCodeAt(s),n=i>>8,r=i%256,o.push(r),o.push(n);return o}(e,(o=this).length-s),o,s,a);default:if(f)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function _(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function T(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function b(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||n<i)&&(i=n);for(var r="",o=t;o<i;++o)r+=R(e[o]);return r}function E(e,t,i){for(var n=e.slice(t,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function x(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(i<e+t)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,i,n,r,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<t||t<o)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function I(e,t,i,n){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function C(e,t,i,n,r){return t=+t,i>>>=0,r||I(e,0,i,4),o.write(e,t,i,n,23,4),i+4}function O(e,t,i,n,r){return t=+t,i>>>=0,r||I(e,0,i,8),o.write(e,t,i,n,52,8),i+8}c.prototype.slice=function(e,t){var i=this.length;(e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUIntLE=function(e,t,i){e>>>=0,t>>>=0,i||x(e,t,this.length);for(var n=this[e],r=1,o=0;++o<t&&(r*=256);)n+=this[e+o]*r;return n},c.prototype.readUIntBE=function(e,t,i){e>>>=0,t>>>=0,i||x(e,t,this.length);for(var n=this[e+--t],r=1;0<t&&(r*=256);)n+=this[e+--t]*r;return n},c.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,i){e>>>=0,t>>>=0,i||x(e,t,this.length);for(var n=this[e],r=1,o=0;++o<t&&(r*=256);)n+=this[e+o]*r;return(r*=128)<=n&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,i){e>>>=0,t>>>=0,i||x(e,t,this.length);for(var n=t,r=1,o=this[e+--n];0<n&&(r*=256);)o+=this[e+--n]*r;return(r*=128)<=o&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),o.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),o.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),o.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),o.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,i,n){e=+e,t>>>=0,i>>>=0,n||P(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[t]=255&e;++o<i&&(r*=256);)this[t+o]=e/r&255;return t+i},c.prototype.writeUIntBE=function(e,t,i,n){e=+e,t>>>=0,i>>>=0,n||P(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[t+r]=255&e;0<=--r&&(o*=256);)this[t+r]=e/o&255;return t+i},c.prototype.writeUInt8=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);P(this,e,t,i,r-1,-r)}var o=0,s=1,a=0;for(this[t]=255&e;++o<i&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t>>>=0,!n){var r=Math.pow(2,8*i-1);P(this,e,t,i,r-1,-r)}var o=i-1,s=1,a=0;for(this[t+o]=255&e;0<=--o&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},c.prototype.writeInt8=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,i){return e=+e,t>>>=0,i||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeFloatLE=function(e,t,i){return C(this,e,t,!0,i)},c.prototype.writeFloatBE=function(e,t,i){return C(this,e,t,!1,i)},c.prototype.writeDoubleLE=function(e,t,i){return O(this,e,t,!0,i)},c.prototype.writeDoubleBE=function(e,t,i){return O(this,e,t,!1,i)},c.prototype.copy=function(e,t,i,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i=i||0,n||0===n||(n=this.length),t>=e.length&&(t=e.length),t=t||0,0<n&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,i,n);else if(this===e&&i<t&&t<n)for(var o=r-1;0<=o;--o)e[o+t]=this[o+i];else Uint8Array.prototype.set.call(e,this.subarray(i,n),t);return r},c.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var r=e.charCodeAt(0);("utf8"===n&&r<128||"latin1"===n)&&(e=r)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var o;if(t>>>=0,i=void 0===i?this.length:i>>>0,"number"==typeof(e=e||0))for(o=t;o<i;++o)this[o]=e;else{var s=c.isBuffer(e)?e:c.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=s[o%a]}return this};var t=/[^+/0-9A-Za-z-_]/g;function R(e){return e<16?"0"+e.toString(16):e.toString(16)}function A(e,t){var i;t=t||1/0;for(var n=e.length,r=null,o=[],s=0;s<n;++s){if(55295<(i=e.charCodeAt(s))&&i<57344){if(!r){if(56319<i){-1<(t-=3)&&o.push(239,191,189);continue}if(s+1===n){-1<(t-=3)&&o.push(239,191,189);continue}r=i;continue}if(i<56320){-1<(t-=3)&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&-1<(t-=3)&&o.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function L(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function k(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}function M(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function N(e){return e!=e}}).call(this,D("buffer").Buffer)},{"base64-js":2,buffer:6,ieee754:53}],7:[function(e,t,i){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],8:[function(e,t,i){(function(e){function t(e){return Object.prototype.toString.call(e)}i.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},i.isBoolean=function(e){return"boolean"==typeof e},i.isNull=function(e){return null===e},i.isNullOrUndefined=function(e){return null==e},i.isNumber=function(e){return"number"==typeof e},i.isString=function(e){return"string"==typeof e},i.isSymbol=function(e){return"symbol"==typeof e},i.isUndefined=function(e){return void 0===e},i.isRegExp=function(e){return"[object RegExp]"===t(e)},i.isObject=function(e){return"object"==typeof e&&null!==e},i.isDate=function(e){return"[object Date]"===t(e)},i.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},i.isFunction=function(e){return"function"==typeof e},i.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},i.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":55}],9:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function u(e){return"object"==typeof e&&null!==e}function h(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,o,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||u(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var a=new Error('Uncaught, unspecified "error" event. ('+t+")");throw a.context=t,a}if(h(i=this._events[e]))return!1;if(l(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:r=Array.prototype.slice.call(arguments,1),i.apply(this,r)}else if(u(i))for(r=Array.prototype.slice.call(arguments,1),n=(s=i.slice()).length,o=0;o<n;o++)s[o].apply(this,r);return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?u(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u(this._events[e])&&!this._events[e].warned&&(i=h(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var i,n,r,o;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,n=-1,i===t||l(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u(i)){for(o=r;0<o--;)if(i[o]===t||i[o].listener&&i[o].listener===t){n=o;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(i=this._events[e]))this.removeListener(e,i);else if(i)for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],10:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=i.getUserLocale=i.getUserLocales=void 0;var n,r=(n=e("lodash.once"))&&n.__esModule?n:{default:n};var o=(0,r.default)(function(){var e=[];return"undefined"!=typeof window&&(window.navigator.languages&&(e=e.concat(window.navigator.languages)),window.navigator.language&&e.push(window.navigator.language),window.navigator.userLanguage&&e.push(window.navigator.userLanguage),window.navigator.browserLanguage&&e.push(window.navigator.browserLanguage),window.navigator.systemLanguage&&e.push(window.navigator.systemLanguage)),e.push("en-US"),function(e){return e.map(function(e){if(!e||-1===e.indexOf("-")||e.toLowerCase()!==e)return e;var t=e.split("-");return"".concat(t[0],"-").concat(t[1].toUpperCase())})}(function(e){return e.filter(function(e,t,i){return i.indexOf(e)===t})}(e))});i.getUserLocales=o;var s=(0,r.default)(function(){return o()[0]}),a=i.getUserLocale=s;i.default=a},{"lodash.once":56}],11:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0;var r=n(e("./handlebars.runtime")),o=n(e("./handlebars/compiler/ast")),s=e("./handlebars/compiler/base"),a=e("./handlebars/compiler/compiler"),l=n(e("./handlebars/compiler/javascript-compiler")),u=n(e("./handlebars/compiler/visitor")),h=n(e("./handlebars/no-conflict")),c=r.default.create;function p(){var i=c();return i.compile=function(e,t){return a.compile(e,t,i)},i.precompile=function(e,t){return a.precompile(e,t,i)},i.AST=o.default,i.Compiler=a.Compiler,i.JavaScriptCompiler=l.default,i.Parser=s.parser,i.parse=s.parse,i}var d=p();d.create=p,h.default(d),d.Visitor=u.default,d.default=d,i.default=d,t.exports=i.default},{"./handlebars.runtime":12,"./handlebars/compiler/ast":14,"./handlebars/compiler/base":15,"./handlebars/compiler/compiler":17,"./handlebars/compiler/javascript-compiler":19,"./handlebars/compiler/visitor":22,"./handlebars/no-conflict":36}],12:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}i.__esModule=!0;var o=r(e("./handlebars/base")),s=n(e("./handlebars/safe-string")),a=n(e("./handlebars/exception")),l=r(e("./handlebars/utils")),u=r(e("./handlebars/runtime")),h=n(e("./handlebars/no-conflict"));function c(){var t=new o.HandlebarsEnvironment;return l.extend(t,o),t.SafeString=s.default,t.Exception=a.default,t.Utils=l,t.escapeExpression=l.escapeExpression,t.VM=u,t.template=function(e){return u.template(e,t)},t}var p=c();p.create=c,h.default(p),p.default=p,i.default=p,t.exports=i.default},{"./handlebars/base":13,"./handlebars/exception":26,"./handlebars/no-conflict":36,"./handlebars/runtime":37,"./handlebars/safe-string":38,"./handlebars/utils":39}],13:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0,i.HandlebarsEnvironment=h;var r=e("./utils"),o=n(e("./exception")),s=e("./helpers"),a=e("./decorators"),l=n(e("./logger"));i.VERSION="4.1.2";i.COMPILER_REVISION=7;i.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};var u="[object Object]";function h(e,t,i){this.helpers=e||{},this.partials=t||{},this.decorators=i||{},s.registerDefaultHelpers(this),a.registerDefaultDecorators(this)}h.prototype={constructor:h,logger:l.default,log:l.default.log,registerHelper:function(e,t){if(r.toString.call(e)===u){if(t)throw new o.default("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(r.toString.call(e)===u)r.extend(this.partials,e);else{if(void 0===t)throw new o.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(r.toString.call(e)===u){if(t)throw new o.default("Arg not supported with multiple decorators");r.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]}};var c=l.default.log;i.log=c,i.createFrame=r.createFrame,i.logger=l.default},{"./decorators":24,"./exception":26,"./helpers":27,"./logger":35,"./utils":39}],14:[function(e,t,i){"use strict";i.__esModule=!0;var n={helpers:{helperExpression:function(e){return"SubExpression"===e.type||("MustacheStatement"===e.type||"BlockStatement"===e.type)&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!n.helpers.scopedId(e)&&!e.depth}}};i.default=n,t.exports=i.default},{}],15:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0,i.parse=function(e,t){return"Program"!==e.type?((r.default.yy=l).locInfo=function(e){return new l.SourceLocation(t&&t.srcName,e)},new o.default(t).accept(r.default.parse(e))):e};var r=n(e("./parser")),o=n(e("./whitespace-control")),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./helpers")),a=e("../utils");i.parser=r.default;var l={};a.extend(l,s)},{"../utils":39,"./helpers":18,"./parser":20,"./whitespace-control":23}],16:[function(e,t,i){"use strict";i.__esModule=!0;var s=e("../utils"),n=void 0;try{if("function"!=typeof define||!define.amd){var r=e("source-map");n=r.SourceNode}}catch(e){}function o(e,t,i){if(s.isArray(e)){for(var n=[],r=0,o=e.length;r<o;r++)n.push(t.wrap(e[r],i));return n}return"boolean"==typeof e||"number"==typeof e?e+"":e}function a(e){this.srcFile=e,this.source=[]}n||((n=function(e,t,i,n){this.src="",n&&this.add(n)}).prototype={add:function(e){s.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){s.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),a.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var t=this.empty();return this.each(function(e){t.add(["  ",e,"\n"])}),t},each:function(e){for(var t=0,i=this.source.length;t<i;t++)e(this.source[t])},empty:function(){var e=this.currentLocation||{start:{}};return new n(e.start.line,e.start.column,this.srcFile)},wrap:function(e,t){var i=arguments.length<=1||void 0===t?this.currentLocation||{start:{}}:t;return e instanceof n?e:(e=o(e,this,i),new n(i.start.line,i.start.column,this.srcFile,e))},functionCall:function(e,t,i){return i=this.generateList(i),this.wrap([e,t?"."+t+"(":"(",i,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i)){var n=o(e[i],this);"undefined"!==n&&t.push([this.quotedString(i),":",n])}var r=this.generateList(t);return r.prepend("{"),r.add("}"),r},generateList:function(e){for(var t=this.empty(),i=0,n=e.length;i<n;i++)i&&t.add(","),t.add(o(e[i],this));return t},generateArray:function(e){var t=this.generateList(e);return t.prepend("["),t.add("]"),t}},i.default=a,t.exports=i.default},{"../utils":39,"source-map":51}],17:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0,i.Compiler=o,i.precompile=function(e,t,i){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new l.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);"data"in(t=t||{})||(t.data=!0);t.compat&&(t.useDepths=!0);var n=i.parse(e,t),r=(new i.Compiler).compile(n,t);return(new i.JavaScriptCompiler).compile(r,t)},i.compile=function(n,r,o){void 0===r&&(r={});if(null==n||"string"!=typeof n&&"Program"!==n.type)throw new l.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+n);"data"in(r=u.extend({},r))||(r.data=!0);r.compat&&(r.useDepths=!0);var s=void 0;function a(){var e=o.parse(n,r),t=(new o.Compiler).compile(e,r),i=(new o.JavaScriptCompiler).compile(t,r,void 0,!0);return o.template(i)}function e(e,t){return(s=s||a()).call(this,e,t)}return e._setup=function(e){return(s=s||a())._setup(e)},e._child=function(e,t,i,n){return(s=s||a())._child(e,t,i,n)},e};var l=n(e("../exception")),u=e("../utils"),a=n(e("./ast")),r=[].slice;function o(){}function s(e,t){if(e===t)return!0;if(u.isArray(e)&&u.isArray(t)&&e.length===t.length){for(var i=0;i<e.length;i++)if(!s(e[i],t[i]))return!1;return!0}}function h(e){if(!e.path.parts){var t=e.path;e.path={type:"PathExpression",data:!1,depth:0,parts:[t.original+""],original:t.original+"",loc:t.loc}}}o.prototype={compiler:o,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;i<t;i++){var n=this.opcodes[i],r=e.opcodes[i];if(n.opcode!==r.opcode||!s(n.args,r.args))return!1}t=this.children.length;for(i=0;i<t;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[];var i=t.knownHelpers;if(t.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.accept(e)},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),i=this.guid++;return this.usePartial=this.usePartial||t.usePartial,this.children[i]=t,this.useDepths=this.useDepths||t.useDepths,i},accept:function(e){if(!this[e.type])throw new l.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,i=t.length,n=0;n<i;n++)this.accept(t[n]);return this.options.blockParams.shift(),this.isSimple=1===i,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){h(e);var t=e.program,i=e.inverse;t=t&&this.compileProgram(t),i=i&&this.compileProgram(i);var n=this.classifySexpr(e);"helper"===n?this.helperSexpr(e,t,i):"simple"===n?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,i),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var t=e.program&&this.compileProgram(e.program),i=this.setupFullMustacheParams(e,t,void 0),n=e.path;this.useDecorators=!0,this.opcode("registerDecorator",i.length,n.original)},PartialStatement:function(e){this.usePartial=!0;var t=e.program;t=t&&this.compileProgram(e.program);var i=e.params;if(1<i.length)throw new l.default("Unsupported number of partial arguments: "+i.length,e);i.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):i.push({type:"PathExpression",parts:[],depth:0}));var n=e.name.original,r="SubExpression"===e.name.type;r&&this.accept(e.name),this.setupFullMustacheParams(e,t,void 0,!0);var o=e.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",r,n,o),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){h(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,i){var n=e.path,r=n.parts[0],o=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),n.strict=!0,this.accept(n),this.opcode("invokeAmbiguous",r,o)},simpleSexpr:function(e){var t=e.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),r=e.path,o=r.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new l.default("You specified knownHelpersOnly, but used the unknown helper "+o,e);r.strict=!0,r.falsy=!0,this.accept(r),this.opcode("invokeHelper",n.length,r.original,a.default.helpers.simpleId(r))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],i=a.default.helpers.scopedId(e),n=!e.depth&&!i&&this.blockParamIndex(t);n?this.opcode("lookupBlockParam",n,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,i):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,i=0,n=t.length;for(this.opcode("pushHash");i<n;i++)this.pushParam(t[i].value);for(;i--;)this.opcode("assignToHash",t[i].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:r.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=a.default.helpers.simpleId(e.path),i=t&&!!this.blockParamIndex(e.path.parts[0]),n=!i&&a.default.helpers.helperExpression(e),r=!i&&(n||t);if(r&&!n){var o=e.path.parts[0],s=this.options;s.knownHelpers[o]?n=!0:s.knownHelpersOnly&&(r=!1)}return n?"helper":r?"ambiguous":"simple"},pushParams:function(e){for(var t=0,i=e.length;t<i;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var i=void 0;if(!e.parts||a.default.helpers.scopedId(e)||e.depth||(i=this.blockParamIndex(e.parts[0])),i){var n=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",i,n)}else(t=e.original||t).replace&&(t=t.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,i,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.accept(e.hash):this.opcode("emptyHash",n),r},blockParamIndex:function(e){for(var t=0,i=this.options.blockParams.length;t<i;t++){var n=this.options.blockParams[t],r=n&&u.indexOf(n,e);if(n&&0<=r)return[t,r]}}}},{"../exception":26,"../utils":39,"./ast":14}],18:[function(e,t,i){"use strict";i.__esModule=!0,i.SourceLocation=function(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}},i.id=function(e){return/^\[.*\]$/.test(e)?e.substring(1,e.length-1):e},i.stripFlags=function(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}},i.stripComment=function(e){return e.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")},i.preparePath=function(e,t,i){i=this.locInfo(i);for(var n=e?"@":"",r=[],o=0,s=0,a=t.length;s<a;s++){var l=t[s].part,u=t[s].original!==l;if(n+=(t[s].separator||"")+l,u||".."!==l&&"."!==l&&"this"!==l)r.push(l);else{if(0<r.length)throw new h.default("Invalid path: "+n,{loc:i});".."===l&&o++}}return{type:"PathExpression",data:e,depth:o,parts:r,original:n,loc:i}},i.prepareMustache=function(e,t,i,n,r,o){var s=n.charAt(3)||n.charAt(2),a="{"!==s&&"&"!==s;return{type:/\*/.test(n)?"Decorator":"MustacheStatement",path:e,params:t,hash:i,escaped:a,strip:r,loc:this.locInfo(o)}},i.prepareRawBlock=function(e,t,i,n){u(e,i),n=this.locInfo(n);var r={type:"Program",body:t,strip:{},loc:n};return{type:"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:r,openStrip:{},inverseStrip:{},closeStrip:{},loc:n}},i.prepareBlock=function(e,t,i,n,r,o){n&&n.path&&u(e,n);var s=/\*/.test(e.open);t.blockParams=e.blockParams;var a=void 0,l=void 0;if(i){if(s)throw new h.default("Unexpected inverse block on decorator",i);i.chain&&(i.program.body[0].closeStrip=n.strip),l=i.strip,a=i.program}r&&(r=a,a=t,t=r);return{type:s?"DecoratorBlock":"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:t,inverse:a,openStrip:e.strip,inverseStrip:l,closeStrip:n&&n.strip,loc:this.locInfo(o)}},i.prepareProgram=function(e,t){if(!t&&e.length){var i=e[0].loc,n=e[e.length-1].loc;i&&n&&(t={source:i.source,start:{line:i.start.line,column:i.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:e,strip:{},loc:t}},i.preparePartialBlock=function(e,t,i,n){return u(e,i),{type:"PartialBlockStatement",name:e.path,params:e.params,hash:e.hash,program:t,openStrip:e.strip,closeStrip:i&&i.strip,loc:this.locInfo(n)}};var n,r=e("../exception"),h=(n=r)&&n.__esModule?n:{default:n};function u(e,t){if(t=t.path?t.path.original:t,e.path.original!==t){var i={loc:e.path.loc};throw new h.default(e.path.original+" doesn't match "+t,i)}}},{"../exception":26}],19:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0;var r=e("../base"),f=n(e("../exception")),o=e("../utils"),s=n(e("./code-gen"));function l(e){this.value=e}function a(){}a.prototype={nameLookup:function(e,t){return"constructor"===t?["(",e,".propertyIsEnumerable('constructor') ? ",e,".constructor : undefined",")"]:a.isValidJavaScriptVariableName(t)?[e,".",t]:[e,"[",JSON.stringify(t),"]"]},depthedLookup:function(e){return[this.aliasable("container.lookup"),'(depths, "',e,'")']},compilerInfo:function(){var e=r.COMPILER_REVISION;return[e,r.REVISION_CHANGES[e]]},appendToBuffer:function(e,t,i){return o.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:i?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},compile:function(e,t,i,n){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!i,this.context=i||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var r=e.opcodes,o=void 0,s=void 0,a=void 0,l=void 0;for(a=0,l=r.length;a<l;a++)o=r[a],this.source.currentLocation=o.loc,s=s||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new f.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend("var decorators = container.decorators;\n"),this.decorators.push("return fn;"),n?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var u=this.createFunctionContext(n);if(this.isChild)return u;var h={compiler:this.compilerInfo(),main:u};this.decorators&&(h.main_d=this.decorators,h.useDecorators=!0);var c=this.context,p=c.programs,d=c.decorators;for(a=0,l=p.length;a<l;a++)p[a]&&(h[a]=p[a],d[a]&&(h[a+"_d"]=d[a],h.useDecorators=!0));return this.environment.usePartial&&(h.usePartial=!0),this.options.data&&(h.useData=!0),this.useDepths&&(h.useDepths=!0),this.useBlockParams&&(h.useBlockParams=!0),this.options.compat&&(h.compat=!0),n?h.compilerOptions=this.options:(h.compiler=JSON.stringify(h.compiler),this.source.currentLocation={start:{line:1,column:0}},h=this.objectLiteral(h),t.srcName?(h=h.toStringWithSourceMap({file:t.destName})).map=h.map&&h.map.toString():h=h.toString()),h},preamble:function(){this.lastContext=0,this.source=new s.default(this.options.srcName),this.decorators=new s.default(this.options.srcName)},createFunctionContext:function(e){var t="",i=this.stackVars.concat(this.registers.list);0<i.length&&(t+=", "+i.join(", "));var n=0;for(var r in this.aliases){var o=this.aliases[r];this.aliases.hasOwnProperty(r)&&o.children&&1<o.referenceCount&&(t+=", alias"+ ++n+"="+r,o.children[0]="alias"+n)}var s=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var a=this.mergeSource(t);return e?(s.push(a),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",a,"}"])},mergeSource:function(e){var t=this.environment.isSimple,i=!this.forceBuffer,n=void 0,r=void 0,o=void 0,s=void 0;return this.source.each(function(e){e.appendToBuffer?(o?e.prepend("  + "):o=e,s=e):(o&&(r?o.prepend("buffer += "):n=!0,s.add(";"),o=s=void 0),r=!0,t||(i=!1))}),i?o?(o.prepend("return "),s.add(";")):r||this.source.push('return "";'):(e+=", buffer = "+(n?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(e){var t=this.aliasable("helpers.blockHelperMissing"),i=[this.contextName(0)];this.setupHelperArgs(e,0,i);var n=this.popStack();i.splice(1,0,n),this.push(this.source.functionCall(t,"call",i))},ambiguousBlockValue:function(){var e=this.aliasable("helpers.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var i=this.topStack();t.splice(1,0,i),this.pushSource(["if (!",this.lastHelper,") { ",i," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(e){return[" != null ? ",e,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,i,n){var r=0;n||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[r++])),this.resolvePath("context",e,r,t,i)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t,i){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0,i)},resolvePath:function(i,n,r,o,e){var s=this;if(this.options.strict||this.options.assumeObjects)this.push(function(e,t,i,n){var r=t.popStack(),o=0,s=i.length;e&&s--;for(;o<s;o++)r=t.nameLookup(r,i[o],n);return e?[t.aliasable("container.strict"),"(",r,", ",t.quotedString(i[o]),")"]:r}(this.options.strict&&e,this,n,i));else for(var t=n.length;r<t;r++)this.replaceStack(function(e){var t=s.nameLookup(e,n[r],i);return o?[" && ",t]:[" != null ? ",t," : ",e]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,t){var i=this.nameLookup("decorators",t,"decorator"),n=this.setupHelperArgs(t,e);this.decorators.push(["fn = ",this.decorators.functionCall(i,"",["fn","props","container",n])," || fn;"])},invokeHelper:function(e,t,i){var n=this.popStack(),r=this.setupHelper(e,t),o=i?[r.name," || "]:"",s=["("].concat(o,n);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",r.callParams))},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(this.source.functionCall(i.name,"call",i.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var i=this.popStack();this.emptyHash();var n=this.setupHelper(0,e,t),r=["(","(helper = ",this.lastHelper=this.nameLookup("helpers",e,"helper")," || ",i,")"];this.options.strict||(r[0]="(helper = ",r.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",r,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(e,t,i){var n=[],r=this.setupParams(t,1,n);e&&(t=this.popStack(),delete r.name),i&&(r.indent=JSON.stringify(i)),r.helpers="helpers",r.partials="partials",r.decorators="container.decorators",e?n.unshift(t):n.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(r.depths="depths"),r=this.objectLiteral(r),n.push(r),this.push(this.source.functionCall("container.invokePartial","",n))},assignToHash:function(e){var t=this.popStack(),i=void 0,n=void 0,r=void 0;this.trackIds&&(r=this.popStack()),this.stringParams&&(n=this.popStack(),i=this.popStack());var o=this.hash;i&&(o.contexts[e]=i),n&&(o.types[e]=n),r&&(o.ids[e]=r),o.values[e]=t},pushId:function(e,t,i){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(i?" + "+JSON.stringify("."+i):"")):"PathExpression"===e?this.pushString(t):"SubExpression"===e?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:a,compileChildren:function(e,t){for(var i=e.children,n=void 0,r=void 0,o=0,s=i.length;o<s;o++){n=i[o],r=new this.compiler;var a=this.matchExistingProgram(n);if(null==a){this.context.programs.push("");var l=this.context.programs.length;n.index=l,n.name="program"+l,this.context.programs[l]=r.compile(n,t,this.context,!this.precompile),this.context.decorators[l]=r.decorators,this.context.environments[l]=n,this.useDepths=this.useDepths||r.useDepths,this.useBlockParams=this.useBlockParams||r.useBlockParams,n.useDepths=this.useDepths,n.useBlockParams=this.useBlockParams}else n.index=a.index,n.name="program"+a.index,this.useDepths=this.useDepths||a.useDepths,this.useBlockParams=this.useBlockParams||a.useBlockParams}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;t<i;t++){var n=this.context.environments[t];if(n&&n.equals(e))return n}},programExpression:function(e){var t=this.environment.children[e],i=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&i.push("blockParams"),this.useDepths&&i.push("depths"),"container.program("+i.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof l||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new l(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],i=void 0,n=void 0,r=void 0;if(!this.isInline())throw new f.default("replaceStack on non-inline");var o=this.popStack(!0);if(o instanceof l)t=["(",i=[o.value]],r=!0;else{n=!0;var s=this.incrStack();t=["((",this.push(s)," = ",o,")"],i=this.topStack()}var a=e.call(this,i);r||this.popStack(),n&&this.stackSlot--,this.push(t.concat(a,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,i=e.length;t<i;t++){var n=e[t];if(n instanceof l)this.compileStack.push(n);else{var r=this.incrStack();this.pushSource([r," = ",n,";"]),this.compileStack.push(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();if(!e&&i instanceof l)return i.value;if(!t){if(!this.stackSlot)throw new f.default("Invalid stack pop");this.stackSlot--}return i},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof l?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?t.referenceCount++:((t=this.aliases[e]=this.source.wrap(e)).aliasable=!0,t.referenceCount=1),t},setupHelper:function(e,t,i){var n=[];return{params:n,paramsInit:this.setupHelperArgs(t,e,n,i),name:this.nameLookup("helpers",t,"helper"),callParams:[this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})")].concat(n)}},setupParams:function(e,t,i){var n={},r=[],o=[],s=[],a=!i,l=void 0;a&&(i=[]),n.name=this.quotedString(e),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var u=this.popStack(),h=this.popStack();(h||u)&&(n.fn=h||"container.noop",n.inverse=u||"container.noop");for(var c=t;c--;)l=this.popStack(),i[c]=l,this.trackIds&&(s[c]=this.popStack()),this.stringParams&&(o[c]=this.popStack(),r[c]=this.popStack());return a&&(n.args=this.source.generateArray(i)),this.trackIds&&(n.ids=this.source.generateArray(s)),this.stringParams&&(n.types=this.source.generateArray(o),n.contexts=this.source.generateArray(r)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(e,t,i,n){var r=this.setupParams(e,t,i);return r=this.objectLiteral(r),n?(this.useRegister("options"),i.push("options"),["options=",r]):i?(i.push(r),""):r}},function(){for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),t=a.RESERVED_WORDS={},i=0,n=e.length;i<n;i++)t[e[i]]=!0}(),a.isValidJavaScriptVariableName=function(e){return!a.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},i.default=a,t.exports=i.default},{"../base":13,"../exception":26,"../utils":39,"./code-gen":16}],20:[function(e,t,i){"use strict";i.__esModule=!0;var n,r,o=(r={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(20<e.length?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(20<e.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;var e,t,i,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),s=0;s<o.length&&(!(i=this._input.match(this.rules[o[s]]))||t&&!(i[0].length>t[0].length)||(t=i,n=s,this.options.flex));s++);return t?((r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e||void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return void 0!==e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)},options:{},performAction:function(e,i,t,n){function r(e,t){return i.yytext=i.yytext.substring(e,i.yyleng-t+e)}switch(t){case 0:if("\\\\"===i.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===i.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),i.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(r(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(i.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return i.yytext=r(1,2).replace(/\\"/g,'"'),80;case 32:return i.yytext=r(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return i.yytext=i.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},rules:[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!(n={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition_plus0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,1],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(e,t,i,n,r,o,s){var a=o.length-1;switch(r){case 1:return o[a-1];case 2:this.$=n.prepareProgram(o[a]);break;case 3:case 4:case 5:case 6:case 7:case 8:this.$=o[a];break;case 9:this.$={type:"CommentStatement",value:n.stripComment(o[a]),strip:n.stripFlags(o[a],o[a]),loc:n.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:o[a],value:o[a],loc:n.locInfo(this._$)};break;case 11:this.$=n.prepareRawBlock(o[a-2],o[a-1],o[a],this._$);break;case 12:this.$={path:o[a-3],params:o[a-2],hash:o[a-1]};break;case 13:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!1,this._$);break;case 14:this.$=n.prepareBlock(o[a-3],o[a-2],o[a-1],o[a],!0,this._$);break;case 15:this.$={open:o[a-5],path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 16:case 17:this.$={path:o[a-4],params:o[a-3],hash:o[a-2],blockParams:o[a-1],strip:n.stripFlags(o[a-5],o[a])};break;case 18:this.$={strip:n.stripFlags(o[a-1],o[a-1]),program:o[a]};break;case 19:var l=n.prepareBlock(o[a-2],o[a-1],o[a],o[a],!1,this._$),u=n.prepareProgram([l],o[a-1].loc);u.chained=!0,this.$={strip:o[a-2].strip,program:u,chain:!0};break;case 20:this.$=o[a];break;case 21:this.$={path:o[a-1],strip:n.stripFlags(o[a-2],o[a])};break;case 22:case 23:this.$=n.prepareMustache(o[a-3],o[a-2],o[a-1],o[a-4],n.stripFlags(o[a-4],o[a]),this._$);break;case 24:this.$={type:"PartialStatement",name:o[a-3],params:o[a-2],hash:o[a-1],indent:"",strip:n.stripFlags(o[a-4],o[a]),loc:n.locInfo(this._$)};break;case 25:this.$=n.preparePartialBlock(o[a-2],o[a-1],o[a],this._$);break;case 26:this.$={path:o[a-3],params:o[a-2],hash:o[a-1],strip:n.stripFlags(o[a-4],o[a])};break;case 27:case 28:this.$=o[a];break;case 29:this.$={type:"SubExpression",path:o[a-3],params:o[a-2],hash:o[a-1],loc:n.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:o[a],loc:n.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:n.id(o[a-2]),value:o[a],loc:n.locInfo(this._$)};break;case 32:this.$=n.id(o[a-1]);break;case 33:case 34:this.$=o[a];break;case 35:this.$={type:"StringLiteral",value:o[a],original:o[a],loc:n.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(o[a]),original:Number(o[a]),loc:n.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===o[a],original:"true"===o[a],loc:n.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:n.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:n.locInfo(this._$)};break;case 40:case 41:this.$=o[a];break;case 42:this.$=n.preparePath(!0,o[a],this._$);break;case 43:this.$=n.preparePath(!1,o[a],this._$);break;case 44:o[a-2].push({part:n.id(o[a]),original:o[a],separator:o[a-1]}),this.$=o[a-2];break;case 45:this.$=[{part:n.id(o[a]),original:o[a]}];break;case 46:this.$=[];break;case 47:o[a-1].push(o[a]);break;case 48:this.$=[o[a]];break;case 49:o[a-1].push(o[a]);break;case 50:this.$=[];break;case 51:o[a-1].push(o[a]);break;case 58:this.$=[];break;case 59:o[a-1].push(o[a]);break;case 64:this.$=[];break;case 65:o[a-1].push(o[a]);break;case 70:this.$=[];break;case 71:o[a-1].push(o[a]);break;case 78:this.$=[];break;case 79:o[a-1].push(o[a]);break;case 82:this.$=[];break;case 83:o[a-1].push(o[a]);break;case 86:this.$=[];break;case 87:o[a-1].push(o[a]);break;case 90:this.$=[];break;case 91:o[a-1].push(o[a]);break;case 94:this.$=[];break;case 95:o[a-1].push(o[a]);break;case 98:this.$=[o[a]];break;case 99:o[a-1].push(o[a]);break;case 100:this.$=[o[a]];break;case 101:o[a-1].push(o[a])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{13:40,15:[1,20],17:39},{20:42,56:41,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:45,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:48,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:42,56:49,64:43,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:50,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,51]},{72:[1,35],86:52},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:53,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:54,38:56,39:[1,58],43:57,44:[1,59],45:55,47:[2,54]},{28:60,43:61,44:[1,59],47:[2,56]},{13:63,15:[1,20],18:[1,62]},{15:[2,48],18:[2,48]},{33:[2,86],57:64,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:65,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:66,47:[1,67]},{30:68,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:69,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:70,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:71,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:75,33:[2,80],50:72,63:73,64:76,65:[1,44],69:74,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,80]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,51]},{20:75,53:81,54:[2,84],63:82,64:76,65:[1,44],69:83,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:84,47:[1,67]},{47:[2,55]},{4:85,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:86,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:87,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:88,47:[1,67]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:75,33:[2,88],58:89,63:90,64:76,65:[1,44],69:91,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:92,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:93,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,31:94,33:[2,60],63:95,64:76,65:[1,44],69:96,70:77,71:78,72:[1,79],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,66],36:97,63:98,64:76,65:[1,44],69:99,70:77,71:78,72:[1,79],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,22:100,23:[2,52],63:101,64:76,65:[1,44],69:102,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:75,33:[2,92],62:103,63:104,64:76,65:[1,44],69:105,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,106]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:107,72:[1,108],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,109],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,110]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:56,39:[1,58],43:57,44:[1,59],45:112,46:111,47:[2,76]},{33:[2,70],40:113,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,114]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:75,63:116,64:76,65:[1,44],67:115,68:[2,96],69:117,70:77,71:78,72:[1,79],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,118]},{32:119,33:[2,62],74:120,75:[1,121]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:122,74:123,75:[1,121]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,124]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,125]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,109]},{20:75,63:126,64:76,65:[1,44],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:75,33:[2,72],41:127,63:128,64:76,65:[1,44],69:129,70:77,71:78,72:[1,79],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,130]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,131]},{33:[2,63]},{72:[1,133],76:132},{33:[1,134]},{33:[2,69]},{15:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:135,74:136,75:[1,121]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,138],77:[1,137]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,139]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],55:[2,55],57:[2,20],61:[2,57],74:[2,81],83:[2,85],87:[2,18],91:[2,89],102:[2,53],105:[2,93],111:[2,19],112:[2,77],117:[2,97],120:[2,63],123:[2,69],124:[2,12],136:[2,75],137:[2,32]},parseError:function(e,t){throw new Error(e)},parse:function(e){var t=this,i=[0],n=[null],r=[],o=this.table,s="",a=0,l=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,void 0===(this.yy.parser=this).lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;r.push(h);var c=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,d,f,g,m,v,y,w,S,_,T={};;){if(f=i[i.length-1],void 0===(g=this.defaultActions[f]?this.defaultActions[f]:(null==p&&(_=void 0,"number"!=typeof(_=t.lexer.lex()||1)&&(_=t.symbols_[_]||_),p=_),o[f]&&o[f][p]))||!g.length||!g[0]){var b="";if(!u){for(v in S=[],o[f])this.terminals_[v]&&2<v&&S.push("'"+this.terminals_[v]+"'");b=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+S.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(a+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(b,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:S})}}if(g[0]instanceof Array&&1<g.length)throw new Error("Parse Error: multiple actions possible at state: "+f+", token: "+p);switch(g[0]){case 1:i.push(p),n.push(this.lexer.yytext),r.push(this.lexer.yylloc),i.push(g[1]),p=null,d?(p=d,d=null):(l=this.lexer.yyleng,s=this.lexer.yytext,a=this.lexer.yylineno,h=this.lexer.yylloc,0<u&&u--);break;case 2:if(y=this.productions_[g[1]][1],T.$=n[n.length-y],T._$={first_line:r[r.length-(y||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(y||1)].first_column,last_column:r[r.length-1].last_column},c&&(T._$.range=[r[r.length-(y||1)].range[0],r[r.length-1].range[1]]),void 0!==(m=this.performAction.call(T,s,l,a,this.yy,g[1],n,r)))return m;y&&(i=i.slice(0,-1*y*2),n=n.slice(0,-1*y),r=r.slice(0,-1*y)),i.push(this.productions_[g[1]][0]),n.push(T.$),r.push(T._$),w=o[i[i.length-2]][i[i.length-1]],i.push(w);break;case 3:return!0}}return!0}})},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}}},n.lexer=r,new((s.prototype=n).Parser=s));function s(){this.yy={}}i.default=o,t.exports=i.default},{}],21:[function(e,t,i){"use strict";i.__esModule=!0,i.print=function(e){return(new s).accept(e)},i.PrintVisitor=s;var n,r=e("./visitor"),o=(n=r)&&n.__esModule?n:{default:n};function s(){this.padding=0}(s.prototype=new o.default).pad=function(e){for(var t="",i=0,n=this.padding;i<n;i++)t+="  ";return t+=e+"\n"},s.prototype.Program=function(e){var t="",i=e.body,n=void 0,r=void 0;if(e.blockParams){var o="BLOCK PARAMS: [";for(n=0,r=e.blockParams.length;n<r;n++)o+=" "+e.blockParams[n];o+=" ]",t+=this.pad(o)}for(n=0,r=i.length;n<r;n++)t+=this.accept(i[n]);return this.padding--,t},s.prototype.MustacheStatement=function(e){return this.pad("{{ "+this.SubExpression(e)+" }}")},s.prototype.Decorator=function(e){return this.pad("{{ DIRECTIVE "+this.SubExpression(e)+" }}")},s.prototype.BlockStatement=s.prototype.DecoratorBlock=function(e){var t="";return t+=this.pad(("DecoratorBlock"===e.type?"DIRECTIVE ":"")+"BLOCK:"),this.padding++,t+=this.pad(this.SubExpression(e)),e.program&&(t+=this.pad("PROGRAM:"),this.padding++,t+=this.accept(e.program),this.padding--),e.inverse&&(e.program&&this.padding++,t+=this.pad("{{^}}"),this.padding++,t+=this.accept(e.inverse),this.padding--,e.program&&this.padding--),this.padding--,t},s.prototype.PartialStatement=function(e){var t="PARTIAL:"+e.name.original;return e.params[0]&&(t+=" "+this.accept(e.params[0])),e.hash&&(t+=" "+this.accept(e.hash)),this.pad("{{> "+t+" }}")},s.prototype.PartialBlockStatement=function(e){var t="PARTIAL BLOCK:"+e.name.original;return e.params[0]&&(t+=" "+this.accept(e.params[0])),e.hash&&(t+=" "+this.accept(e.hash)),t+=" "+this.pad("PROGRAM:"),this.padding++,t+=this.accept(e.program),this.padding--,this.pad("{{> "+t+" }}")},s.prototype.ContentStatement=function(e){return this.pad("CONTENT[ '"+e.value+"' ]")},s.prototype.CommentStatement=function(e){return this.pad("{{! '"+e.value+"' }}")},s.prototype.SubExpression=function(e){for(var t,i=e.params,n=[],r=0,o=i.length;r<o;r++)n.push(this.accept(i[r]));return i="["+n.join(", ")+"]",t=e.hash?" "+this.accept(e.hash):"",this.accept(e.path)+" "+i+t},s.prototype.PathExpression=function(e){var t=e.parts.join("/");return(e.data?"@":"")+"PATH:"+t},s.prototype.StringLiteral=function(e){return'"'+e.value+'"'},s.prototype.NumberLiteral=function(e){return"NUMBER{"+e.value+"}"},s.prototype.BooleanLiteral=function(e){return"BOOLEAN{"+e.value+"}"},s.prototype.UndefinedLiteral=function(){return"UNDEFINED"},s.prototype.NullLiteral=function(){return"NULL"},s.prototype.Hash=function(e){for(var t=e.pairs,i=[],n=0,r=t.length;n<r;n++)i.push(this.accept(t[n]));return"HASH{"+i.join(", ")+"}"},s.prototype.HashPair=function(e){return e.key+"="+this.accept(e.value)}},{"./visitor":22}],22:[function(e,t,i){"use strict";i.__esModule=!0;var n,r=e("../exception"),o=(n=r)&&n.__esModule?n:{default:n};function s(){this.parents=[]}function a(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")}function l(e){a.call(this,e),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")}function u(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")}s.prototype={constructor:s,mutating:!1,acceptKey:function(e,t){var i=this.accept(e[t]);if(this.mutating){if(i&&!s.prototype[i.type])throw new o.default('Unexpected node type "'+i.type+'" found when accepting '+t+" on "+e.type);e[t]=i}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new o.default(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,i=e.length;t<i;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,i--)},accept:function(e){if(e){if(!this[e.type])throw new o.default("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:!1!==t?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:a,Decorator:a,BlockStatement:l,DecoratorBlock:l,PartialStatement:u,PartialBlockStatement:function(e){u.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:a,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},i.default=s,t.exports=i.default},{"../exception":26}],23:[function(e,t,i){"use strict";i.__esModule=!0;var n,r=e("./visitor"),o=(n=r)&&n.__esModule?n:{default:n};function s(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=e}function d(e,t,i){void 0===t&&(t=e.length);var n=e[t-1],r=e[t-2];return n?"ContentStatement"===n.type?(r||!i?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:i}function f(e,t,i){void 0===t&&(t=-1);var n=e[t+1],r=e[t+2];return n?"ContentStatement"===n.type?(r||!i?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:i}function g(e,t,i){var n=e[null==t?0:t+1];if(n&&"ContentStatement"===n.type&&(i||!n.rightStripped)){var r=n.value;n.value=n.value.replace(i?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==r}}function m(e,t,i){var n=e[null==t?e.length-1:t-1];if(n&&"ContentStatement"===n.type&&(i||!n.leftStripped)){var r=n.value;return n.value=n.value.replace(i?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==r,n.leftStripped}}(s.prototype=new o.default).Program=function(e){var t=!this.options.ignoreStandalone,i=!this.isRootSeen;this.isRootSeen=!0;for(var n=e.body,r=0,o=n.length;r<o;r++){var s=n[r],a=this.accept(s);if(a){var l=d(n,r,i),u=f(n,r,i),h=a.openStandalone&&l,c=a.closeStandalone&&u,p=a.inlineStandalone&&l&&u;a.close&&g(n,r,!0),a.open&&m(n,r,!0),t&&p&&(g(n,r),m(n,r)&&"PartialStatement"===s.type&&(s.indent=/([ \t]+$)/.exec(n[r-1].original)[1])),t&&h&&(g((s.program||s.inverse).body),m(n,r)),t&&c&&(g(n,r),m((s.inverse||s.program).body))}}return e},s.prototype.BlockStatement=s.prototype.DecoratorBlock=s.prototype.PartialBlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,i=e.program&&e.inverse,n=i,r=i;if(i&&i.chained)for(n=i.body[0].program;r.chained;)r=r.body[r.body.length-1].program;var o={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:f(t.body),closeStandalone:d((n||t).body)};if(e.openStrip.close&&g(t.body,null,!0),i){var s=e.inverseStrip;s.open&&m(t.body,null,!0),s.close&&g(n.body,null,!0),e.closeStrip.open&&m(r.body,null,!0),!this.options.ignoreStandalone&&d(t.body)&&f(n.body)&&(m(t.body),g(n.body))}else e.closeStrip.open&&m(t.body,null,!0);return o},s.prototype.Decorator=s.prototype.MustacheStatement=function(e){return e.strip},s.prototype.PartialStatement=s.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},i.default=s,t.exports=i.default},{"./visitor":22}],24:[function(e,t,i){"use strict";i.__esModule=!0,i.registerDefaultDecorators=function(e){o.default(e)};var n,r=e("./decorators/inline"),o=(n=r)&&n.__esModule?n:{default:n}},{"./decorators/inline":25}],25:[function(e,t,i){"use strict";i.__esModule=!0;var a=e("../utils");i.default=function(e){e.registerDecorator("inline",function(r,o,s,e){var t=r;return o.partials||(o.partials={},t=function(e,t){var i=s.partials;s.partials=a.extend({},i,o.partials);var n=r(e,t);return s.partials=i,n}),o.partials[e.args[0]]=e.fn,t})},t.exports=i.default},{"../utils":39}],26:[function(e,t,i){"use strict";i.__esModule=!0;var a=["description","fileName","lineNumber","message","name","number","stack"];function l(e,t){var i=t&&t.loc,n=void 0,r=void 0;i&&(e+=" - "+(n=i.start.line)+":"+(r=i.start.column));for(var o=Error.prototype.constructor.call(this,e),s=0;s<a.length;s++)this[a[s]]=o[a[s]];Error.captureStackTrace&&Error.captureStackTrace(this,l);try{i&&(this.lineNumber=n,Object.defineProperty?Object.defineProperty(this,"column",{value:r,enumerable:!0}):this.column=r)}catch(e){}}l.prototype=new Error,i.default=l,t.exports=i.default},{}],27:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}i.__esModule=!0,i.registerDefaultHelpers=function(e){r.default(e),o.default(e),s.default(e),a.default(e),l.default(e),u.default(e),h.default(e)};var r=n(e("./helpers/block-helper-missing")),o=n(e("./helpers/each")),s=n(e("./helpers/helper-missing")),a=n(e("./helpers/if")),l=n(e("./helpers/log")),u=n(e("./helpers/lookup")),h=n(e("./helpers/with"))},{"./helpers/block-helper-missing":28,"./helpers/each":29,"./helpers/helper-missing":30,"./helpers/if":31,"./helpers/log":32,"./helpers/lookup":33,"./helpers/with":34}],28:[function(e,t,i){"use strict";i.__esModule=!0;var s=e("../utils");i.default=function(o){o.registerHelper("blockHelperMissing",function(e,t){var i=t.inverse,n=t.fn;if(!0===e)return n(this);if(!1===e||null==e)return i(this);if(s.isArray(e))return 0<e.length?(t.ids&&(t.ids=[t.name]),o.helpers.each(e,t)):i(this);if(t.data&&t.ids){var r=s.createFrame(t.data);r.contextPath=s.appendContextPath(t.data.contextPath,t.name),t={data:r}}return n(e,t)})},t.exports=i.default},{"../utils":39}],29:[function(e,t,i){"use strict";i.__esModule=!0;var n,p=e("../utils"),r=e("../exception"),d=(n=r)&&n.__esModule?n:{default:n};i.default=function(e){e.registerHelper("each",function(n,e){if(!e)throw new d.default("Must pass iterator to #each");var r=e.fn,t=e.inverse,i=0,o="",s=void 0,a=void 0;function l(e,t,i){s&&(s.key=e,s.index=t,s.first=0===t,s.last=!!i,a&&(s.contextPath=a+e)),o+=r(n[e],{data:s,blockParams:p.blockParams([n[e],e],[a+e,null])})}if(e.data&&e.ids&&(a=p.appendContextPath(e.data.contextPath,e.ids[0])+"."),p.isFunction(n)&&(n=n.call(this)),e.data&&(s=p.createFrame(e.data)),n&&"object"==typeof n)if(p.isArray(n))for(var u=n.length;i<u;i++)i in n&&l(i,i,i===n.length-1);else{var h=void 0;for(var c in n)n.hasOwnProperty(c)&&(void 0!==h&&l(h,i-1),h=c,i++);void 0!==h&&l(h,i-1,!0)}return 0===i&&(o=t(this)),o})},t.exports=i.default},{"../exception":26,"../utils":39}],30:[function(e,t,i){"use strict";i.__esModule=!0;var n,r=e("../exception"),o=(n=r)&&n.__esModule?n:{default:n};i.default=function(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=i.default},{"../exception":26}],31:[function(e,t,i){"use strict";i.__esModule=!0;var n=e("../utils");i.default=function(i){i.registerHelper("if",function(e,t){return n.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||n.isEmpty(e)?t.inverse(this):t.fn(this)}),i.registerHelper("unless",function(e,t){return i.helpers.if.call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})})},t.exports=i.default},{"../utils":39}],32:[function(e,t,i){"use strict";i.__esModule=!0,i.default=function(r){r.registerHelper("log",function(){for(var e=[void 0],t=arguments[arguments.length-1],i=0;i<arguments.length-1;i++)e.push(arguments[i]);var n=1;null!=t.hash.level?n=t.hash.level:t.data&&null!=t.data.level&&(n=t.data.level),e[0]=n,r.log.apply(r,e)})},t.exports=i.default},{}],33:[function(e,t,i){"use strict";i.__esModule=!0,i.default=function(e){e.registerHelper("lookup",function(e,t){return e?"constructor"!==t||e.propertyIsEnumerable(t)?e[t]:void 0:e})},t.exports=i.default},{}],34:[function(e,t,i){"use strict";i.__esModule=!0;var r=e("../utils");i.default=function(e){e.registerHelper("with",function(e,t){r.isFunction(e)&&(e=e.call(this));var i=t.fn;if(r.isEmpty(e))return t.inverse(this);var n=t.data;return t.data&&t.ids&&((n=r.createFrame(t.data)).contextPath=r.appendContextPath(t.data.contextPath,t.ids[0])),i(e,{data:n,blockParams:r.blockParams([e],[n&&n.contextPath])})})},t.exports=i.default},{"../utils":39}],35:[function(e,t,i){"use strict";i.__esModule=!0;var n=e("./utils"),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if("string"==typeof e){var t=n.indexOf(o.methodMap,e.toLowerCase());e=0<=t?t:parseInt(e,10)}return e},log:function(e){if(e=o.lookupLevel(e),"undefined"!=typeof console&&o.lookupLevel(o.level)<=e){var t=o.methodMap[e];console[t]||(t="log");for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];console[t].apply(console,n)}}};i.default=o,t.exports=i.default},{"./utils":39}],36:[function(e,t,i){(function(n){"use strict";i.__esModule=!0,i.default=function(e){var t=void 0!==n?n:window,i=t.Handlebars;e.noConflict=function(){return t.Handlebars===e&&(t.Handlebars=i),e}},t.exports=i.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){"use strict";i.__esModule=!0,i.checkRevision=function(e){var t=e&&e[0]||1,i=p.COMPILER_REVISION;if(t!==i){if(t<i){var n=p.REVISION_CHANGES[i],r=p.REVISION_CHANGES[t];throw new c.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+r+").")}throw new c.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}},i.template=function(a,l){if(!l)throw new c.default("No environment passed to template");if(!a||!a.main)throw new c.default("Unknown template object: "+typeof a);a.main.decorator=a.main_d,l.VM.checkRevision(a.compiler);var s={strict:function(e,t){if(!(t in e))throw new c.default('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var i=e.length,n=0;n<i;n++)if(e[n]&&null!=e[n][t])return e[n][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:function(e,t,i){i.hash&&(t=h.extend({},t,i.hash),i.ids&&(i.ids[0]=!0)),e=l.VM.resolvePartial.call(this,e,t,i);var n=l.VM.invokePartial.call(this,e,t,i);if(null==n&&l.compile&&(i.partials[i.name]=l.compile(e,a.compilerOptions,l),n=i.partials[i.name](t,i)),null==n)throw new c.default("The partial "+i.name+" could not be compiled when running in runtime-only mode");if(i.indent){for(var r=n.split("\n"),o=0,s=r.length;o<s&&(r[o]||o+1!==s);o++)r[o]=i.indent+r[o];n=r.join("\n")}return n},fn:function(e){var t=a[e];return t.decorator=a[e+"_d"],t},programs:[],program:function(e,t,i,n,r){var o=this.programs[e],s=this.fn(e);return o=t||r||n||i?d(this,e,s,t,i,n,r):o||(this.programs[e]=d(this,e,s))},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i=h.extend({},t,e)),i},nullContext:Object.seal({}),noop:l.VM.noop,compilerInfo:a.compiler};function u(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=t.data;u._setup(t),!t.partial&&a.useData&&(i=function(e,t){t&&"root"in t||((t=t?p.createFrame(t):{}).root=e);return t}(e,i));var n=void 0,r=a.useBlockParams?[]:void 0;function o(e){return""+a.main(s,e,s.helpers,s.partials,i,r,n)}return a.useDepths&&(n=t.depths?e!=t.depths[0]?[e].concat(t.depths):t.depths:[e]),(o=f(a.main,o,s,t.depths||[],i,r))(e,t)}return u.isTop=!0,u._setup=function(e){e.partial?(s.helpers=e.helpers,s.partials=e.partials,s.decorators=e.decorators):(s.helpers=s.merge(e.helpers,l.helpers),a.usePartial&&(s.partials=s.merge(e.partials,l.partials)),(a.usePartial||a.useDecorators)&&(s.decorators=s.merge(e.decorators,l.decorators)))},u._child=function(e,t,i,n){if(a.useBlockParams&&!i)throw new c.default("must pass block params");if(a.useDepths&&!n)throw new c.default("must pass parent depths");return d(s,e,a[e],t,0,i,n)},u},i.wrapProgram=d,i.resolvePartial=function(e,t,i){e?e.call||i.name||(i.name=e,e=i.partials[e]):e="@partial-block"===i.name?i.data["partial-block"]:i.partials[i.name];return e},i.invokePartial=function(e,t,i){var r=i.data&&i.data["partial-block"];i.partial=!0,i.ids&&(i.data.contextPath=i.ids[0]||i.data.contextPath);var o=void 0;i.fn&&i.fn!==s&&function(){i.data=p.createFrame(i.data);var n=i.fn;o=i.data["partial-block"]=function(e,t){var i=arguments.length<=1||void 0===t?{}:t;return i.data=p.createFrame(i.data),i.data["partial-block"]=r,n(e,i)},n.partials&&(i.partials=h.extend({},i.partials,n.partials))}();void 0===e&&o&&(e=o);{if(void 0===e)throw new c.default("The partial "+i.name+" could not be found");if(e instanceof Function)return e(t,i)}},i.noop=s;var n,h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(e("./utils")),r=e("./exception"),c=(n=r)&&n.__esModule?n:{default:n},p=e("./base");function d(n,e,r,o,t,s,a){function i(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=a;return!a||e==a[0]||e===n.nullContext&&null===a[0]||(i=[e].concat(a)),r(n,e,n.helpers,n.partials,t.data||o,s&&[t.blockParams].concat(s),i)}return(i=f(r,i,n,a,o,s)).program=e,i.depth=a?a.length:0,i.blockParams=t||0,i}function s(){return""}function f(e,t,i,n,r,o){if(e.decorator){var s={};t=e.decorator(t,s,i,n&&n[0],r,o,n),h.extend(t,s)}return t}},{"./base":13,"./exception":26,"./utils":39}],38:[function(e,t,i){"use strict";function n(e){this.string=e}i.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},i.default=n,t.exports=i.default},{}],39:[function(e,t,i){"use strict";i.__esModule=!0,i.extend=a,i.indexOf=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},i.escapeExpression=function(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return o.test(e)?e.replace(r,s):e},i.isEmpty=function(e){return!e&&0!==e||!(!h(e)||0!==e.length)},i.createFrame=function(e){var t=a({},e);return t._parent=e,t},i.blockParams=function(e,t){return e.path=t,e},i.appendContextPath=function(e,t){return(e?e+".":"")+t};var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},r=/[&<>"'`=]/g,o=/[&<>"'`=]/;function s(e){return n[e]}function a(e){for(var t=1;t<arguments.length;t++)for(var i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&(e[i]=arguments[t][i]);return e}var l=Object.prototype.toString;i.toString=l;var u=function(e){return"function"==typeof e};u(/x/)&&(i.isFunction=u=function(e){return"function"==typeof e&&"[object Function]"===l.call(e)}),i.isFunction=u;var h=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===l.call(e)};i.isArray=h},{}],40:[function(n,e,t){var r=n("../dist/cjs/handlebars").default,i=n("../dist/cjs/handlebars/compiler/printer");function o(e,t){var i=n("fs").readFileSync(t,"utf8");e.exports=r.compile(i)}r.PrintVisitor=i.PrintVisitor,r.print=i.print,e.exports=r,void 0!==n&&n.extensions&&(n.extensions[".handlebars"]=o,n.extensions[".hbs"]=o)},{"../dist/cjs/handlebars":11,"../dist/cjs/handlebars/compiler/printer":21,fs:4}],41:[function(e,t,i){var o=e("./util"),s=Object.prototype.hasOwnProperty,a="undefined"!=typeof Map;function l(){this._array=[],this._set=a?new Map:Object.create(null)}l.fromArray=function(e,t){for(var i=new l,n=0,r=e.length;n<r;n++)i.add(e[n],t);return i},l.prototype.size=function(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length},l.prototype.add=function(e,t){var i=a?e:o.toSetString(e),n=a?this.has(e):s.call(this._set,i),r=this._array.length;n&&!t||this._array.push(e),n||(a?this._set.set(e,r):this._set[i]=r)},l.prototype.has=function(e){if(a)return this._set.has(e);var t=o.toSetString(e);return s.call(this._set,t)},l.prototype.indexOf=function(e){if(a){var t=this._set.get(e);if(0<=t)return t}else{var i=o.toSetString(e);if(s.call(this._set,i))return this._set[i]}throw new Error('"'+e+'" is not in the set.')},l.prototype.at=function(e){if(0<=e&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},l.prototype.toArray=function(){return this._array.slice()},i.ArraySet=l},{"./util":50}],42:[function(e,t,i){var l=e("./base64");i.encode=function(e){for(var t,i="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);t=31&n,0<(n>>>=5)&&(t|=32),i+=l.encode(t),0<n;);return i},i.decode=function(e,t,i){var n,r,o=e.length,s=0,a=0;do{if(o<=t)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(r=l.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));n=!!(32&r),s+=(r&=31)<<a,a+=5}while(n);i.value=function(e){var t=e>>1;return 1==(1&e)?-t:t}(s),i.rest=t}},{"./base64":43}],43:[function(e,t,i){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");i.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},i.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},{}],44:[function(e,t,u){u.GREATEST_LOWER_BOUND=1,u.LEAST_UPPER_BOUND=2,u.search=function(e,t,i,n){if(0===t.length)return-1;var r=function e(t,i,n,r,o,s){var a=Math.floor((i-t)/2)+t,l=o(n,r[a],!0);return 0===l?a:0<l?1<i-a?e(a,i,n,r,o,s):s==u.LEAST_UPPER_BOUND?i<r.length?i:-1:a:1<a-t?e(t,a,n,r,o,s):s==u.LEAST_UPPER_BOUND?a:t<0?-1:t}(-1,t.length,e,t,i,n||u.GREATEST_LOWER_BOUND);if(r<0)return-1;for(;0<=r-1&&0===i(t[r],t[r-1],!0);)--r;return r}},{}],45:[function(e,t,i){var s=e("./util");function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}n.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},n.prototype.add=function(e){!function(e,t){var i=e.generatedLine,n=t.generatedLine,r=e.generatedColumn,o=t.generatedColumn;return i<n||n==i&&r<=o||s.compareByGeneratedPositionsInflated(e,t)<=0}(this._last,e)?this._sorted=!1:this._last=e,this._array.push(e)},n.prototype.toArray=function(){return this._sorted||(this._array.sort(s.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},i.MappingList=n},{"./util":50}],46:[function(e,t,i){function l(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function u(e,t,i,n){if(i<n){var r=i-1;l(e,function(e,t){return Math.round(e+Math.random()*(t-e))}(i,n),n);for(var o=e[n],s=i;s<n;s++)t(e[s],o)<=0&&l(e,r+=1,s);l(e,r+1,s);var a=r+1;u(e,t,i,a-1),u(e,t,a+1,n)}}i.quickSort=function(e,t){u(e,t,0,e.length-1)}},{}],47:[function(e,t,i){var w=e("./util"),l=e("./binary-search"),p=e("./array-set").ArraySet,S=e("./base64-vlq"),_=e("./quick-sort").quickSort;function s(e,t){var i=e;return"string"==typeof e&&(i=w.parseSourceMapInput(e)),null!=i.sections?new n(i,t):new d(i,t)}function d(e,t){var i=e;"string"==typeof e&&(i=w.parseSourceMapInput(e));var n=w.getArg(i,"version"),r=w.getArg(i,"sources"),o=w.getArg(i,"names",[]),s=w.getArg(i,"sourceRoot",null),a=w.getArg(i,"sourcesContent",null),l=w.getArg(i,"mappings"),u=w.getArg(i,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);s=s&&w.normalize(s),r=r.map(String).map(w.normalize).map(function(e){return s&&w.isAbsolute(s)&&w.isAbsolute(e)?w.relative(s,e):e}),this._names=p.fromArray(o.map(String),!0),this._sources=p.fromArray(r,!0),this._absoluteSources=this._sources.toArray().map(function(e){return w.computeSourceURL(s,e,t)}),this.sourceRoot=s,this.sourcesContent=a,this._mappings=l,this._sourceMapURL=t,this.file=u}function T(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function n(e,r){var t=e;"string"==typeof e&&(t=w.parseSourceMapInput(e));var i=w.getArg(t,"version"),n=w.getArg(t,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new p,this._names=new p;var o={line:-1,column:0};this._sections=n.map(function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var t=w.getArg(e,"offset"),i=w.getArg(t,"line"),n=w.getArg(t,"column");if(i<o.line||i===o.line&&n<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=t,{generatedOffset:{generatedLine:i+1,generatedColumn:n+1},consumer:new s(w.getArg(e,"map"),r)}})}s.fromSourceMap=function(e,t){return d.fromSourceMap(e,t)},s.prototype._version=3,s.prototype.__generatedMappings=null,Object.defineProperty(s.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),s.prototype.__originalMappings=null,Object.defineProperty(s.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),s.prototype._charIsMappingSeparator=function(e,t){var i=e.charAt(t);return";"===i||","===i},s.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},s.GENERATED_ORDER=1,s.ORIGINAL_ORDER=2,s.GREATEST_LOWER_BOUND=1,s.LEAST_UPPER_BOUND=2,s.prototype.eachMapping=function(e,t,i){var n,r=t||null;switch(i||s.GENERATED_ORDER){case s.GENERATED_ORDER:n=this._generatedMappings;break;case s.ORIGINAL_ORDER:n=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var o=this.sourceRoot;n.map(function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=w.computeSourceURL(o,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}},this).forEach(e,r)},s.prototype.allGeneratedPositionsFor=function(e){var t=w.getArg(e,"line"),i={source:w.getArg(e,"source"),originalLine:t,originalColumn:w.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];var n=[],r=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",w.compareByOriginalPositions,l.LEAST_UPPER_BOUND);if(0<=r){var o=this._originalMappings[r];if(void 0===e.column)for(var s=o.originalLine;o&&o.originalLine===s;)n.push({line:w.getArg(o,"generatedLine",null),column:w.getArg(o,"generatedColumn",null),lastColumn:w.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++r];else for(var a=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==a;)n.push({line:w.getArg(o,"generatedLine",null),column:w.getArg(o,"generatedColumn",null),lastColumn:w.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++r]}return n},i.SourceMapConsumer=s,(d.prototype=Object.create(s.prototype)).consumer=s,d.prototype._findSourceIndex=function(e){var t,i=e;if(null!=this.sourceRoot&&(i=w.relative(this.sourceRoot,i)),this._sources.has(i))return this._sources.indexOf(i);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},d.fromSourceMap=function(e,t){var i=Object.create(d.prototype),n=i._names=p.fromArray(e._names.toArray(),!0),r=i._sources=p.fromArray(e._sources.toArray(),!0);i.sourceRoot=e._sourceRoot,i.sourcesContent=e._generateSourcesContent(i._sources.toArray(),i.sourceRoot),i.file=e._file,i._sourceMapURL=t,i._absoluteSources=i._sources.toArray().map(function(e){return w.computeSourceURL(i.sourceRoot,e,t)});for(var o=e._mappings.toArray().slice(),s=i.__generatedMappings=[],a=i.__originalMappings=[],l=0,u=o.length;l<u;l++){var h=o[l],c=new T;c.generatedLine=h.generatedLine,c.generatedColumn=h.generatedColumn,h.source&&(c.source=r.indexOf(h.source),c.originalLine=h.originalLine,c.originalColumn=h.originalColumn,h.name&&(c.name=n.indexOf(h.name)),a.push(c)),s.push(c)}return _(i.__originalMappings,w.compareByOriginalPositions),i},d.prototype._version=3,Object.defineProperty(d.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),d.prototype._parseMappings=function(e,t){for(var i,n,r,o,s,a=1,l=0,u=0,h=0,c=0,p=0,d=e.length,f=0,g={},m={},v=[],y=[];f<d;)if(";"===e.charAt(f))a++,f++,l=0;else if(","===e.charAt(f))f++;else{for((i=new T).generatedLine=a,o=f;o<d&&!this._charIsMappingSeparator(e,o);o++);if(r=g[n=e.slice(f,o)])f+=n.length;else{for(r=[];f<o;)S.decode(e,f,m),s=m.value,f=m.rest,r.push(s);if(2===r.length)throw new Error("Found a source, but no line and column");if(3===r.length)throw new Error("Found a source and line, but no column");g[n]=r}i.generatedColumn=l+r[0],l=i.generatedColumn,1<r.length&&(i.source=c+r[1],c+=r[1],i.originalLine=u+r[2],u=i.originalLine,i.originalLine+=1,i.originalColumn=h+r[3],h=i.originalColumn,4<r.length&&(i.name=p+r[4],p+=r[4])),y.push(i),"number"==typeof i.originalLine&&v.push(i)}_(y,w.compareByGeneratedPositionsDeflated),this.__generatedMappings=y,_(v,w.compareByOriginalPositions),this.__originalMappings=v},d.prototype._findMapping=function(e,t,i,n,r,o){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return l.search(e,t,r,o)},d.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var i=this._generatedMappings[e+1];if(t.generatedLine===i.generatedLine){t.lastGeneratedColumn=i.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},d.prototype.originalPositionFor=function(e){var t={generatedLine:w.getArg(e,"line"),generatedColumn:w.getArg(e,"column")},i=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",w.compareByGeneratedPositionsDeflated,w.getArg(e,"bias",s.GREATEST_LOWER_BOUND));if(0<=i){var n=this._generatedMappings[i];if(n.generatedLine===t.generatedLine){var r=w.getArg(n,"source",null);null!==r&&(r=this._sources.at(r),r=w.computeSourceURL(this.sourceRoot,r,this._sourceMapURL));var o=w.getArg(n,"name",null);return null!==o&&(o=this._names.at(o)),{source:r,line:w.getArg(n,"originalLine",null),column:w.getArg(n,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}},d.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return null==e}))},d.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var i=this._findSourceIndex(e);if(0<=i)return this.sourcesContent[i];var n,r=e;if(null!=this.sourceRoot&&(r=w.relative(this.sourceRoot,r)),null!=this.sourceRoot&&(n=w.urlParse(this.sourceRoot))){var o=r.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!n.path||"/"==n.path)&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(t)return null;throw new Error('"'+r+'" is not in the SourceMap.')},d.prototype.generatedPositionFor=function(e){var t=w.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var i={source:t,originalLine:w.getArg(e,"line"),originalColumn:w.getArg(e,"column")},n=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",w.compareByOriginalPositions,w.getArg(e,"bias",s.GREATEST_LOWER_BOUND));if(0<=n){var r=this._originalMappings[n];if(r.source===i.source)return{line:w.getArg(r,"generatedLine",null),column:w.getArg(r,"generatedColumn",null),lastColumn:w.getArg(r,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},i.BasicSourceMapConsumer=d,(n.prototype=Object.create(s.prototype)).constructor=s,n.prototype._version=3,Object.defineProperty(n.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var i=0;i<this._sections[t].consumer.sources.length;i++)e.push(this._sections[t].consumer.sources[i]);return e}}),n.prototype.originalPositionFor=function(e){var t={generatedLine:w.getArg(e,"line"),generatedColumn:w.getArg(e,"column")},i=l.search(t,this._sections,function(e,t){var i=e.generatedLine-t.generatedOffset.generatedLine;return i||e.generatedColumn-t.generatedOffset.generatedColumn}),n=this._sections[i];return n?n.consumer.originalPositionFor({line:t.generatedLine-(n.generatedOffset.generatedLine-1),column:t.generatedColumn-(n.generatedOffset.generatedLine===t.generatedLine?n.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},n.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})},n.prototype.sourceContentFor=function(e,t){for(var i=0;i<this._sections.length;i++){var n=this._sections[i].consumer.sourceContentFor(e,!0);if(n)return n}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},n.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var i=this._sections[t];if(-1!==i.consumer._findSourceIndex(w.getArg(e,"source"))){var n=i.consumer.generatedPositionFor(e);if(n)return{line:n.line+(i.generatedOffset.generatedLine-1),column:n.column+(i.generatedOffset.generatedLine===n.line?i.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},n.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var i=0;i<this._sections.length;i++)for(var n=this._sections[i],r=n.consumer._generatedMappings,o=0;o<r.length;o++){var s=r[o],a=n.consumer._sources.at(s.source);a=w.computeSourceURL(n.consumer.sourceRoot,a,this._sourceMapURL),this._sources.add(a),a=this._sources.indexOf(a);var l=null;s.name&&(l=n.consumer._names.at(s.name),this._names.add(l),l=this._names.indexOf(l));var u={source:a,generatedLine:s.generatedLine+(n.generatedOffset.generatedLine-1),generatedColumn:s.generatedColumn+(n.generatedOffset.generatedLine===s.generatedLine?n.generatedOffset.generatedColumn-1:0),originalLine:s.originalLine,originalColumn:s.originalColumn,name:l};this.__generatedMappings.push(u),"number"==typeof u.originalLine&&this.__originalMappings.push(u)}_(this.__generatedMappings,w.compareByGeneratedPositionsDeflated),_(this.__originalMappings,w.compareByOriginalPositions)},i.IndexedSourceMapConsumer=n},{"./array-set":41,"./base64-vlq":42,"./binary-search":44,"./quick-sort":46,"./util":50}],48:[function(e,t,i){var f=e("./base64-vlq"),g=e("./util"),n=e("./array-set").ArraySet,r=e("./mapping-list").MappingList;function s(e){e=e||{},this._file=g.getArg(e,"file",null),this._sourceRoot=g.getArg(e,"sourceRoot",null),this._skipValidation=g.getArg(e,"skipValidation",!1),this._sources=new n,this._names=new n,this._mappings=new r,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(n){var r=n.sourceRoot,o=new s({file:n.file,sourceRoot:r});return n.eachMapping(function(e){var t={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(t.source=e.source,null!=r&&(t.source=g.relative(r,t.source)),t.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(t.name=e.name)),o.addMapping(t)}),n.sources.forEach(function(e){var t=e;null!==r&&(t=g.relative(r,e)),o._sources.has(t)||o._sources.add(t);var i=n.sourceContentFor(e);null!=i&&o.setSourceContent(e,i)}),o},s.prototype.addMapping=function(e){var t=g.getArg(e,"generated"),i=g.getArg(e,"original",null),n=g.getArg(e,"source",null),r=g.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,i,n,r),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=r&&(r=String(r),this._names.has(r)||this._names.add(r)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=i&&i.line,originalColumn:null!=i&&i.column,source:n,name:r})},s.prototype.setSourceContent=function(e,t){var i=e;null!=this._sourceRoot&&(i=g.relative(this._sourceRoot,i)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[g.toSetString(i)]=t):this._sourcesContents&&(delete this._sourcesContents[g.toSetString(i)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(r,e,o){var s=e;if(null==e){if(null==r.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');s=r.file}var a=this._sourceRoot;null!=a&&(s=g.relative(a,s));var l=new n,u=new n;this._mappings.unsortedForEach(function(e){if(e.source===s&&null!=e.originalLine){var t=r.originalPositionFor({line:e.originalLine,column:e.originalColumn});null!=t.source&&(e.source=t.source,null!=o&&(e.source=g.join(o,e.source)),null!=a&&(e.source=g.relative(a,e.source)),e.originalLine=t.line,e.originalColumn=t.column,null!=t.name&&(e.name=t.name))}var i=e.source;null==i||l.has(i)||l.add(i);var n=e.name;null==n||u.has(n)||u.add(n)},this),this._sources=l,this._names=u,r.sources.forEach(function(e){var t=r.sourceContentFor(e);null!=t&&(null!=o&&(e=g.join(o,e)),null!=a&&(e=g.relative(a,e)),this.setSourceContent(e,t))},this)},s.prototype._validateMapping=function(e,t,i,n){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&0<e.line&&0<=e.column)||t||i||n)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&0<e.line&&0<=e.column&&0<t.line&&0<=t.column&&i))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:i,original:t,name:n}))},s.prototype._serializeMappings=function(){for(var e,t,i,n,r=0,o=1,s=0,a=0,l=0,u=0,h="",c=this._mappings.toArray(),p=0,d=c.length;p<d;p++){if(e="",(t=c[p]).generatedLine!==o)for(r=0;t.generatedLine!==o;)e+=";",o++;else if(0<p){if(!g.compareByGeneratedPositionsInflated(t,c[p-1]))continue;e+=","}e+=f.encode(t.generatedColumn-r),r=t.generatedColumn,null!=t.source&&(n=this._sources.indexOf(t.source),e+=f.encode(n-u),u=n,e+=f.encode(t.originalLine-1-a),a=t.originalLine-1,e+=f.encode(t.originalColumn-s),s=t.originalColumn,null!=t.name&&(i=this._names.indexOf(t.name),e+=f.encode(i-l),l=i)),h+=e}return h},s.prototype._generateSourcesContent=function(e,i){return e.map(function(e){if(!this._sourcesContents)return null;null!=i&&(e=g.relative(i,e));var t=g.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,t)?this._sourcesContents[t]:null},this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},i.SourceMapGenerator=s},{"./array-set":41,"./base64-vlq":42,"./mapping-list":45,"./util":50}],49:[function(e,t,i){var n=e("./source-map-generator").SourceMapGenerator,p=e("./util"),d=/(\r?\n)/,o="$$$isSourceNode$$$";function f(e,t,i,n,r){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==i?null:i,this.name=null==r?null:r,this[o]=!0,null!=n&&this.add(n)}f.fromStringWithSourceMap=function(e,i,n){function r(){return e()+(e()||"");function e(){return a<s.length?s[a++]:void 0}}var o=new f,s=e.split(d),a=0,l=1,u=0,h=null;return i.eachMapping(function(e){if(null!==h){if(!(l<e.generatedLine)){var t=(i=s[a]||"").substr(0,e.generatedColumn-u);return s[a]=i.substr(e.generatedColumn-u),u=e.generatedColumn,c(h,t),void(h=e)}c(h,r()),l++,u=0}for(;l<e.generatedLine;)o.add(r()),l++;if(u<e.generatedColumn){var i=s[a]||"";o.add(i.substr(0,e.generatedColumn)),s[a]=i.substr(e.generatedColumn),u=e.generatedColumn}h=e},this),a<s.length&&(h&&c(h,r()),o.add(s.splice(a).join(""))),i.sources.forEach(function(e){var t=i.sourceContentFor(e);null!=t&&(null!=n&&(e=p.join(n,e)),o.setSourceContent(e,t))}),o;function c(e,t){if(null===e||void 0===e.source)o.add(t);else{var i=n?p.join(n,e.source):e.source;o.add(new f(e.originalLine,e.originalColumn,i,t,e.name))}}},f.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},f.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;0<=t;t--)this.prepend(e[t]);else{if(!e[o]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},f.prototype.walk=function(e){for(var t,i=0,n=this.children.length;i<n;i++)(t=this.children[i])[o]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},f.prototype.join=function(e){var t,i,n=this.children.length;if(0<n){for(t=[],i=0;i<n-1;i++)t.push(this.children[i]),t.push(e);t.push(this.children[i]),this.children=t}return this},f.prototype.replaceRight=function(e,t){var i=this.children[this.children.length-1];return i[o]?i.replaceRight(e,t):"string"==typeof i?this.children[this.children.length-1]=i.replace(e,t):this.children.push("".replace(e,t)),this},f.prototype.setSourceContent=function(e,t){this.sourceContents[p.toSetString(e)]=t},f.prototype.walkSourceContents=function(e){for(var t=0,i=this.children.length;t<i;t++)this.children[t][o]&&this.children[t].walkSourceContents(e);var n=Object.keys(this.sourceContents);for(t=0,i=n.length;t<i;t++)e(p.fromSetString(n[t]),this.sourceContents[n[t]])},f.prototype.toString=function(){var t="";return this.walk(function(e){t+=e}),t},f.prototype.toStringWithSourceMap=function(e){var r={code:"",line:1,column:0},o=new n(e),s=!1,a=null,l=null,u=null,h=null;return this.walk(function(e,t){r.code+=e,null!==t.source&&null!==t.line&&null!==t.column?(a===t.source&&l===t.line&&u===t.column&&h===t.name||o.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name}),a=t.source,l=t.line,u=t.column,h=t.name,s=!0):s&&(o.addMapping({generated:{line:r.line,column:r.column}}),a=null,s=!1);for(var i=0,n=e.length;i<n;i++)10===e.charCodeAt(i)?(r.line++,r.column=0,i+1===n?(a=null,s=!1):s&&o.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name})):r.column++}),this.walkSourceContents(function(e,t){o.setSourceContent(e,t)}),{code:r.code,map:o}},i.SourceNode=f},{"./source-map-generator":48,"./util":50}],50:[function(e,t,l){l.getArg=function(e,t,i){if(t in e)return e[t];if(3===arguments.length)return i;throw new Error('"'+t+'" is a required argument.')};var i=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,o=/^data:.+\,.+$/;function u(e){var t=e.match(i);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function h(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function s(e){var t=e,i=u(e);if(i){if(!i.path)return e;t=i.path}for(var n,r=l.isAbsolute(t),o=t.split(/\/+/),s=0,a=o.length-1;0<=a;a--)"."===(n=o[a])?o.splice(a,1):".."===n?s++:0<s&&(""===n?(o.splice(a+1,s),s=0):(o.splice(a,2),s--));return""===(t=o.join("/"))&&(t=r?"/":"."),i?(i.path=t,h(i)):t}function a(e,t){""===e&&(e="."),""===t&&(t=".");var i=u(t),n=u(e);if(n&&(e=n.path||"/"),i&&!i.scheme)return n&&(i.scheme=n.scheme),h(i);if(i||t.match(o))return t;if(n&&!n.host&&!n.path)return n.host=t,h(n);var r="/"===t.charAt(0)?t:s(e.replace(/\/+$/,"")+"/"+t);return n?(n.path=r,h(n)):r}l.urlParse=u,l.urlGenerate=h,l.normalize=s,l.join=a,l.isAbsolute=function(e){return"/"===e.charAt(0)||i.test(e)},l.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var i=0;0!==t.indexOf(e+"/");){var n=e.lastIndexOf("/");if(n<0)return t;if((e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++i}return Array(i+1).join("../")+t.substr(e.length+1)};var n=!("__proto__"in Object.create(null));function r(e){return e}function c(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var i=t-10;0<=i;i--)if(36!==e.charCodeAt(i))return!1;return!0}function p(e,t){return e===t?0:null===e?1:null===t?-1:t<e?1:-1}l.toSetString=n?r:function(e){return c(e)?"$"+e:e},l.fromSetString=n?r:function(e){return c(e)?e.slice(1):e},l.compareByOriginalPositions=function(e,t,i){var n=p(e.source,t.source);return 0!==n?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)||i?n:0!==(n=e.generatedColumn-t.generatedColumn)?n:0!==(n=e.generatedLine-t.generatedLine)?n:p(e.name,t.name)},l.compareByGeneratedPositionsDeflated=function(e,t,i){var n=e.generatedLine-t.generatedLine;return 0!==n?n:0!==(n=e.generatedColumn-t.generatedColumn)||i?n:0!==(n=p(e.source,t.source))?n:0!==(n=e.originalLine-t.originalLine)?n:0!==(n=e.originalColumn-t.originalColumn)?n:p(e.name,t.name)},l.compareByGeneratedPositionsInflated=function(e,t){var i=e.generatedLine-t.generatedLine;return 0!==i?i:0!==(i=e.generatedColumn-t.generatedColumn)?i:0!==(i=p(e.source,t.source))?i:0!==(i=e.originalLine-t.originalLine)?i:0!==(i=e.originalColumn-t.originalColumn)?i:p(e.name,t.name)},l.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},l.computeSourceURL=function(e,t,i){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),i){var n=u(i);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var r=n.path.lastIndexOf("/");0<=r&&(n.path=n.path.substring(0,r+1))}t=a(h(n),t)}return s(t)}},{}],51:[function(e,t,i){i.SourceMapGenerator=e("./lib/source-map-generator").SourceMapGenerator,i.SourceMapConsumer=e("./lib/source-map-consumer").SourceMapConsumer,i.SourceNode=e("./lib/source-node").SourceNode},{"./lib/source-map-consumer":47,"./lib/source-map-generator":48,"./lib/source-node":49}],52:[function(e,t,i){var n=e("http"),r=e("url"),o=t.exports;for(var s in n)n.hasOwnProperty(s)&&(o[s]=n[s]);function a(e){if("string"==typeof e&&(e=r.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}o.request=function(e,t){return e=a(e),n.request.call(this,e,t)},o.get=function(e,t){return e=a(e),n.get.call(this,e,t)}},{http:65,url:82}],53:[function(e,t,i){i.read=function(e,t,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,u=l>>1,h=-7,c=i?r-1:0,p=i?-1:1,d=e[t+c];for(c+=p,o=d&(1<<-h)-1,d>>=-h,h+=a;0<h;o=256*o+e[t+c],c+=p,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;0<h;s=256*s+e[t+c],c+=p,h-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),o-=u}return(d?-1:1)*s*Math.pow(2,o-n)},i.write=function(e,t,i,n,r,o){var s,a,l,u=8*o-r-1,h=(1<<u)-1,c=h>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),2<=(t+=1<=s+c?p/l:p*Math.pow(2,1-c))*l&&(s++,l/=2),h<=s+c?(a=0,s=h):1<=s+c?(a=(t*l-1)*Math.pow(2,r),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,r),s=0));8<=r;e[i+d]=255&a,d+=f,a/=256,r-=8);for(s=s<<r|a,u+=r;0<u;e[i+d]=255&s,d+=f,s/=256,u-=8);e[i+d-f]|=128*g}},{}],54:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;function i(){}i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},{}],55:[function(e,t,i){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],56:[function(e,t,i){var n="Expected a function",r=1/0,o=17976931348623157e292,s=NaN,a="[object Symbol]",l=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,c=/^0o[0-7]+$/i,p=parseInt,d=Object.prototype.toString;function f(e,t){var i;if("function"!=typeof t)throw new TypeError(n);return e=function(e){var t=function(e){return e?(e=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==a}(e))return s;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(l,"");var i=h.test(e);return i||c.test(e)?p(e.slice(2),i?2:8):u.test(e)?s:+e}(e))!==r&&e!==-r?e==e?e:0:(e<0?-1:1)*o:0===e?e:0}(e),i=t%1;return t==t?i?t-i:t:0}(e),function(){return 0<--e&&(i=t.apply(this,arguments)),e<=1&&(t=void 0),i}}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=function(e){return f(2,e)}},{}],57:[function(ni,ri,oi){(function(n){var e,t,i,r;function o(e){this.value="",e&&(this.value=e.toLowerCase())}function s(e,t){this.start=e,this.end=t}!function(e){if("object"==typeof oi&&void 0!==ri)ri.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).httpStatusCodes=e()}}(function(){return function o(s,a,l){function u(i,e){if(!a[i]){if(!s[i]){var t="function"==typeof ni&&ni;if(!e&&t)return t(i,!0);if(h)return h(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var r=a[i]={exports:{}};s[i][0].call(r.exports,function(e){var t=s[i][1][e];return u(t||e)},r,r.exports,o,s,a,l)}return a[i].exports}for(var h="function"==typeof ni&&ni,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,i){(function(e){var t,i,n;(i=t=t||{}).CONTINUE=100,i.SWITCHING_PROTOCOLS=101,i.PROCESSING=102,i.OK=200,i.CREATED=201,i.ACCEPTED=202,i.NON_AUTHORITATIVE_INFORMATION=203,i.NO_CONTENT=204,i.RESET_CONTENT=205,i.PARTIAL_CONTENT=206,i.MULTI_STATUS=207,i.MULTIPLE_CHOICES=300,i.MOVED_PERMANENTLY=301,i.MOVED_TEMPORARILY=302,i.SEE_OTHER=303,i.NOT_MODIFIED=304,i.USE_PROXY=305,i.TEMPORARY_REDIRECT=307,i.BAD_REQUEST=400,i.UNAUTHORIZED=401,i.PAYMENT_REQUIRED=402,i.FORBIDDEN=403,i.NOT_FOUND=404,i.METHOD_NOT_ALLOWED=405,i.NOT_ACCEPTABLE=406,i.PROXY_AUTHENTICATION_REQUIRED=407,i.REQUEST_TIME_OUT=408,i.CONFLICT=409,i.GONE=410,i.LENGTH_REQUIRED=411,i.PRECONDITION_FAILED=412,i.REQUEST_ENTITY_TOO_LARGE=413,i.REQUEST_URI_TOO_LARGE=414,i.UNSUPPORTED_MEDIA_TYPE=415,i.REQUESTED_RANGE_NOT_SATISFIABLE=416,i.EXPECTATION_FAILED=417,i.IM_A_TEAPOT=418,i.UNPROCESSABLE_ENTITY=422,i.LOCKED=423,i.FAILED_DEPENDENCY=424,i.UNORDERED_COLLECTION=425,i.UPGRADE_REQUIRED=426,i.PRECONDITION_REQUIRED=428,i.TOO_MANY_REQUESTS=429,i.REQUEST_HEADER_FIELDS_TOO_LARGE=431,i.INTERNAL_SERVER_ERROR=500,i.NOT_IMPLEMENTED=501,i.BAD_GATEWAY=502,i.SERVICE_UNAVAILABLE=503,i.GATEWAY_TIME_OUT=504,i.HTTP_VERSION_NOT_SUPPORTED=505,i.VARIANT_ALSO_NEGOTIATES=506,i.INSUFFICIENT_STORAGE=507,i.BANDWIDTH_LIMIT_EXCEEDED=509,i.NOT_EXTENDED=510,i.NETWORK_AUTHENTICATION_REQUIRED=511,(n=e).HTTPStatusCode||(n.HTTPStatusCode=t)}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}),e=Yt=Yt||{},o.prototype.toString=function(){return this.value},t=o,e.StringValue=t,i=Yt=Yt||{},s.prototype.getLength=function(){return this.end-this.start},r=s,i.Duration=r;var a,l,u,h,c=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function p(){return null!==u&&u.apply(this,arguments)||this}l=Yt=Yt||{},u=l.StringValue,c(p,u),p.prototype.bookmarking=function(){return new p(p.BOOKMARKING.toString())},p.prototype.classifying=function(){return new p(p.CLASSIFYING.toString())},p.prototype.commenting=function(){return new p(p.COMMENTING.toString())},p.prototype.describing=function(){return new p(p.DESCRIBING.toString())},p.prototype.editing=function(){return new p(p.EDITING.toString())},p.prototype.highlighting=function(){return new p(p.HIGHLIGHTING.toString())},p.prototype.identifying=function(){return new p(p.IDENTIFYING.toString())},p.prototype.linking=function(){return new p(p.LINKING.toString())},p.prototype.moderating=function(){return new p(p.MODERATING.toString())},p.prototype.painting=function(){return new p(p.PAINTING.toString())},p.prototype.questioning=function(){return new p(p.QUESTIONING.toString())},p.prototype.replying=function(){return new p(p.REPLYING.toString())},p.prototype.tagging=function(){return new p(p.TAGGING.toString())},p.prototype.transcribing=function(){return new p(p.TRANSCRIBING.toString())},p.BOOKMARKING=new p("oa:bookmarking"),p.CLASSIFYING=new p("oa:classifying"),p.COMMENTING=new p("oa:commenting"),p.DESCRIBING=new p("oa:describing"),p.EDITING=new p("oa:editing"),p.HIGHLIGHTING=new p("oa:highlighting"),p.IDENTIFYING=new p("oa:identifying"),p.LINKING=new p("oa:linking"),p.MODERATING=new p("oa:moderating"),p.PAINTING=new p("sc:painting"),p.QUESTIONING=new p("oa:questioning"),p.REPLYING=new p("oa:replying"),p.TAGGING=new p("oa:tagging"),p.TRANSCRIBING=new p("oad:transcribing"),h=p,l.AnnotationMotivation=h;var d,f,g,m;c=this&&this.__extends||(d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function v(){return null!==g&&g.apply(this,arguments)||this}f=Yt=Yt||{},g=f.StringValue,c(v,g),v.prototype.autoadvance=function(){return new v(v.AUTOADVANCE.toString())},v.prototype.nonav=function(){return new v(v.NONAV.toString())},v.prototype.paged=function(){return new v(v.PAGED.toString())},v.AUTOADVANCE=new v("auto-advance"),v.NONAV=new v("no-nav"),v.PAGED=new v("paged"),m=v,f.Behavior=m;var y,w,S,_;c=this&&this.__extends||(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function T(){return null!==S&&S.apply(this,arguments)||this}w=Yt=Yt||{},S=w.StringValue,c(T,S),T.prototype.annotation=function(){return new T(T.ANNOTATION.toString())},T.prototype.canvas=function(){return new T(T.CANVAS.toString())},T.prototype.collection=function(){return new T(T.COLLECTION.toString())},T.prototype.manifest=function(){return new T(T.MANIFEST.toString())},T.prototype.range=function(){return new T(T.RANGE.toString())},T.prototype.sequence=function(){return new T(T.SEQUENCE.toString())},T.ANNOTATION=new T("annotation"),T.CANVAS=new T("canvas"),T.COLLECTION=new T("collection"),T.MANIFEST=new T("manifest"),T.RANGE=new T("range"),T.SEQUENCE=new T("sequence"),_=T,w.IIIFResourceType=_;var b,E,x,P;c=this&&this.__extends||(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function I(){return null!==x&&x.apply(this,arguments)||this}E=Yt=Yt||{},x=E.StringValue,c(I,x),I.prototype.empty=function(){return new I(I.EMPTY.toString())},I.prototype.manuscript=function(){return new I(I.MANUSCRIPT.toString())},I.prototype.monograph=function(){return new I(I.MONOGRAPH.toString())},I.EMPTY=new I(""),I.MANUSCRIPT=new I("manuscript"),I.MONOGRAPH=new I("monograph"),P=I,E.ManifestType=P;var C,O,R,A;c=this&&this.__extends||(C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function L(){return null!==R&&R.apply(this,arguments)||this}O=Yt=Yt||{},R=O.StringValue,c(L,R),L.prototype.pdf=function(){return new L(L.PDF.toString())},L.prototype.doc=function(){return new L(L.DOC.toString())},L.prototype.docx=function(){return new L(L.DOCX.toString())},L.PDF=new L("application/pdf"),L.DOC=new L("application/msword"),L.DOCX=new L("application/vnd.openxmlformats-officedocument.wordprocessingml.document"),A=L,O.RenderingFormat=A;var k,M,N,D;c=this&&this.__extends||(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function F(){return null!==N&&N.apply(this,arguments)||this}M=Yt=Yt||{},N=M.StringValue,c(F,N),F.prototype.jpg=function(){return new F(F.JPG.toString())},F.prototype.mp4=function(){return new F(F.MP4.toString())},F.prototype.pdf=function(){return new F(F.PDF.toString())},F.prototype.threejs=function(){return new F(F.THREEJS.toString())},F.prototype.webm=function(){return new F(F.WEBM.toString())},F.JPG=new F("image/jpeg"),F.MP4=new F("video/mp4"),F.PDF=new F("application/pdf"),F.THREEJS=new F("application/vnd.threejs+json"),F.WEBM=new F("video/webm"),D=F,M.MediaType=D;var H,B,G,U;c=this&&this.__extends||(H=function(e,t){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}H(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function z(){return null!==G&&G.apply(this,arguments)||this}B=Yt=Yt||{},G=B.StringValue,c(z,G),z.prototype.canvas=function(){return new z(z.CANVAS.toString())},z.prototype.choice=function(){return new z(z.CHOICE.toString())},z.prototype.document=function(){return new z(z.DOCUMENT.toString())},z.prototype.image=function(){return new z(z.IMAGE.toString())},z.prototype.movingimage=function(){return new z(z.MOVINGIMAGE.toString())},z.prototype.physicalobject=function(){return new z(z.PHYSICALOBJECT.toString())},z.prototype.sound=function(){return new z(z.SOUND.toString())},z.prototype.text=function(){return new z(z.TEXT.toString())},z.CANVAS=new z("canvas"),z.CHOICE=new z("choice"),z.DOCUMENT=new z("document"),z.IMAGE=new z("image"),z.MOVINGIMAGE=new z("movingimage"),z.PHYSICALOBJECT=new z("physicalobject"),z.SOUND=new z("sound"),z.TEXT=new z("textualbody"),U=z,B.ResourceType=U;var j,V,q,W;c=this&&this.__extends||(j=function(e,t){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}j(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function $(){return null!==q&&q.apply(this,arguments)||this}V=Yt=Yt||{},q=V.StringValue,c($,q),$.prototype.auth1Clickthrough=function(){return new $($.AUTH1CLICKTHROUGH.toString())},$.prototype.auth1External=function(){return new $($.AUTH1EXTERNAL.toString())},$.prototype.auth1Kiosk=function(){return new $($.AUTH1KIOSK.toString())},$.prototype.auth1Login=function(){return new $($.AUTH1LOGIN.toString())},$.prototype.auth1Logout=function(){return new $($.AUTH1LOGOUT.toString())},$.prototype.auth1Probe=function(){return new $($.AUTH1PROBE.toString())},$.prototype.auth1Token=function(){return new $($.AUTH1TOKEN.toString())},$.prototype.autoComplete=function(){return new $($.AUTOCOMPLETE.toString())},$.prototype.iiif1ImageLevel1=function(){return new $($.IIIF1IMAGELEVEL1.toString())},$.prototype.iiif1ImageLevel2=function(){return new $($.IIIF1IMAGELEVEL2.toString())},$.prototype.iiif2ImageLevel1=function(){return new $($.IIIF2IMAGELEVEL1.toString())},$.prototype.iiif2ImageLevel2=function(){return new $($.IIIF2IMAGELEVEL2.toString())},$.prototype.ixif=function(){return new $($.IXIF.toString())},$.prototype.login=function(){return new $($.AUTHLOGIN.toString())},$.prototype.clickThrough=function(){return new $($.AUTHCLICKTHROUGH.toString())},$.prototype.restricted=function(){return new $($.AUTHRESTRICTED.toString())},$.prototype.logout=function(){return new $($.AUTHLOGOUT.toString())},$.prototype.otherManifestations=function(){return new $($.OTHERMANIFESTATIONS.toString())},$.prototype.search=function(){return new $($.SEARCH.toString())},$.prototype.stanfordIIIFImageCompliance1=function(){return new $($.STANFORDIIIFIMAGECOMPLIANCE1.toString())},$.prototype.stanfordIIIFImageCompliance2=function(){return new $($.STANFORDIIIFIMAGECOMPLIANCE2.toString())},$.prototype.stanfordIIIFImageConformance1=function(){return new $($.STANFORDIIIFIMAGECONFORMANCE1.toString())},$.prototype.stanfordIIIFImageConformance2=function(){return new $($.STANFORDIIIFIMAGECONFORMANCE2.toString())},$.prototype.stanfordIIIF1ImageCompliance1=function(){return new $($.STANFORDIIIF1IMAGECOMPLIANCE1.toString())},$.prototype.stanfordIIIF1ImageCompliance2=function(){return new $($.STANFORDIIIF1IMAGECOMPLIANCE2.toString())},$.prototype.stanfordIIIF1ImageConformance1=function(){return new $($.STANFORDIIIF1IMAGECONFORMANCE1.toString())},$.prototype.stanfordIIIF1ImageConformance2=function(){return new $($.STANFORDIIIF1IMAGECONFORMANCE2.toString())},$.prototype.token=function(){return new $($.AUTHTOKEN.toString())},$.prototype.trackingExtensions=function(){return new $($.TRACKINGEXTENSIONS.toString())},$.prototype.uiExtensions=function(){return new $($.UIEXTENSIONS.toString())},$.prototype.printExtensions=function(){return new $($.PRINTEXTENSIONS.toString())},$.prototype.shareExtensions=function(){return new $($.SHAREEXTENSIONS.toString())},$.STANFORDIIIFIMAGECOMPLIANCE0=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level0"),$.STANFORDIIIFIMAGECOMPLIANCE1=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level1"),$.STANFORDIIIFIMAGECOMPLIANCE2=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level2"),$.STANFORDIIIFIMAGECONFORMANCE0=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level0"),$.STANFORDIIIFIMAGECONFORMANCE1=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level1"),$.STANFORDIIIFIMAGECONFORMANCE2=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level2"),$.STANFORDIIIF1IMAGECOMPLIANCE0=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"),$.STANFORDIIIF1IMAGECOMPLIANCE1=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"),$.STANFORDIIIF1IMAGECOMPLIANCE2=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"),$.STANFORDIIIF1IMAGECONFORMANCE0=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0"),$.STANFORDIIIF1IMAGECONFORMANCE1=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1"),$.STANFORDIIIF1IMAGECONFORMANCE2=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2"),$.IIIF1IMAGELEVEL0=new $("http://iiif.io/api/image/1/level0.json"),$.IIIF1IMAGELEVEL0PROFILE=new $("http://iiif.io/api/image/1/profiles/level0.json"),$.IIIF1IMAGELEVEL1=new $("http://iiif.io/api/image/1/level1.json"),$.IIIF1IMAGELEVEL1PROFILE=new $("http://iiif.io/api/image/1/profiles/level1.json"),$.IIIF1IMAGELEVEL2=new $("http://iiif.io/api/image/1/level2.json"),$.IIIF1IMAGELEVEL2PROFILE=new $("http://iiif.io/api/image/1/profiles/level2.json"),$.IIIF2IMAGELEVEL0=new $("http://iiif.io/api/image/2/level0.json"),$.IIIF2IMAGELEVEL0PROFILE=new $("http://iiif.io/api/image/2/profiles/level0.json"),$.IIIF2IMAGELEVEL1=new $("http://iiif.io/api/image/2/level1.json"),$.IIIF2IMAGELEVEL1PROFILE=new $("http://iiif.io/api/image/2/profiles/level1.json"),$.IIIF2IMAGELEVEL2=new $("http://iiif.io/api/image/2/level2.json"),$.IIIF2IMAGELEVEL2PROFILE=new $("http://iiif.io/api/image/2/profiles/level2.json"),$.AUTHCLICKTHROUGH=new $("http://iiif.io/api/auth/0/login/clickthrough"),$.AUTHLOGIN=new $("http://iiif.io/api/auth/0/login"),$.AUTHLOGOUT=new $("http://iiif.io/api/auth/0/logout"),$.AUTHRESTRICTED=new $("http://iiif.io/api/auth/0/login/restricted"),$.AUTHTOKEN=new $("http://iiif.io/api/auth/0/token"),$.AUTH1CLICKTHROUGH=new $("http://iiif.io/api/auth/1/clickthrough"),$.AUTH1EXTERNAL=new $("http://iiif.io/api/auth/1/external"),$.AUTH1KIOSK=new $("http://iiif.io/api/auth/1/kiosk"),$.AUTH1LOGIN=new $("http://iiif.io/api/auth/1/login"),$.AUTH1LOGOUT=new $("http://iiif.io/api/auth/1/logout"),$.AUTH1PROBE=new $("http://iiif.io/api/auth/1/probe"),$.AUTH1TOKEN=new $("http://iiif.io/api/auth/1/token"),$.AUTOCOMPLETE=new $("http://iiif.io/api/search/0/autocomplete"),$.SEARCH=new $("http://iiif.io/api/search/0/search"),$.TRACKINGEXTENSIONS=new $("http://universalviewer.io/tracking-extensions-profile"),$.UIEXTENSIONS=new $("http://universalviewer.io/ui-extensions-profile"),$.PRINTEXTENSIONS=new $("http://universalviewer.io/print-extensions-profile"),$.SHAREEXTENSIONS=new $("http://universalviewer.io/share-extensions-profile"),$.OTHERMANIFESTATIONS=new $("http://iiif.io/api/otherManifestations.json"),$.IXIF=new $("http://wellcomelibrary.org/ld/ixif/0/alpha.json"),W=$,V.ServiceProfile=W;var K,X,Z,Q;c=this&&this.__extends||(K=function(e,t){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}K(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Y(){return null!==Z&&Z.apply(this,arguments)||this}X=Yt=Yt||{},Z=X.StringValue,c(Y,Z),Y.prototype.leftToRight=function(){return new Y(Y.LEFTTORIGHT.toString())},Y.prototype.rightToLeft=function(){return new Y(Y.RIGHTTOLEFT.toString())},Y.prototype.topToBottom=function(){return new Y(Y.TOPTOBOTTOM.toString())},Y.prototype.bottomToTop=function(){return new Y(Y.BOTTOMTOTOP.toString())},Y.LEFTTORIGHT=new Y("left-to-right"),Y.RIGHTTOLEFT=new Y("right-to-left"),Y.TOPTOBOTTOM=new Y("top-to-bottom"),Y.BOTTOMTOTOP=new Y("bottom-to-top"),Q=Y,X.ViewingDirection=Q;var J,ee,te,ie,ne,re;c=this&&this.__extends||(J=function(e,t){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}J(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function oe(){return null!==te&&te.apply(this,arguments)||this}function se(e){this.__jsonld=e,this.context=this.getProperty("context"),this.id=this.getProperty("id")}ee=Yt=Yt||{},te=ee.StringValue,c(oe,te),oe.prototype.continuous=function(){return new oe(oe.CONTINUOUS.toString())},oe.prototype.empty=function(){return new oe(oe.EMPTY.toString())},oe.prototype.individuals=function(){return new oe(oe.INDIVIDUALS.toString())},oe.prototype.nonPaged=function(){return new oe(oe.NONPAGED.toString())},oe.prototype.paged=function(){return new oe(oe.PAGED.toString())},oe.prototype.top=function(){return new oe(oe.TOP.toString())},oe.CONTINUOUS=new oe("continuous"),oe.EMPTY=new oe(""),oe.INDIVIDUALS=new oe("individuals"),oe.NONPAGED=new oe("non-paged"),oe.PAGED=new oe("paged"),oe.TOP=new oe("top"),ie=oe,ee.ViewingHint=ie,ne=Yt=Yt||{},se.prototype.getProperty=function(e){var t=null;return this.__jsonld&&(t=(t=this.__jsonld[e])||this.__jsonld["@"+e]),t},re=se,ne.JSONLDResource=re;var ae,le,ue,he;c=this&&this.__extends||(ae=function(e,t){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ae(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function ce(e,t){var i=ue.call(this,e)||this;return i.options=t,i}le=Yt=Yt||{},ue=le.JSONLDResource,c(ce,ue),ce.prototype.getIIIFResourceType=function(){return new le.IIIFResourceType(le.Utils.normaliseType(this.getProperty("type")))},ce.prototype.getLabel=function(){var e=this.getProperty("label");return e?le.LanguageMap.parse(e,this.options.locale):[]},ce.prototype.getDefaultLabel=function(){return le.LanguageMap.getValue(this.getLabel())},ce.prototype.getMetadata=function(){var e=this.getProperty("metadata"),t=[];if(!e)return t;for(var i=0;i<e.length;i++){var n=e[i],r=new le.LabelValuePair(this.options.locale);r.parse(n),t.push(r)}return t},ce.prototype.getRendering=function(e){var t=this.getRenderings();"string"!=typeof e&&(e=e.toString());for(var i=0;i<t.length;i++){var n=t[i];if(n.getFormat().toString()===e)return n}return null},ce.prototype.getRenderings=function(){var e,t=[];if(!(e=this.__jsonld?this.__jsonld.rendering:this.rendering))return t;Array.isArray(e)||(e=[e]);for(var i=0;i<e.length;i++){var n=e[i];t.push(new le.Rendering(n,this.options))}return t},ce.prototype.getService=function(e){return le.Utils.getService(this,e)},ce.prototype.getServices=function(){return le.Utils.getServices(this)},ce.prototype.getThumbnail=function(){var e=this.getProperty("thumbnail");return Array.isArray(e)&&(e=e[0]),e?new le.Thumbnail(e,this.options):null},ce.prototype.isAnnotation=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.ANNOTATION.toString()},ce.prototype.isCanvas=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.CANVAS.toString()},ce.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.COLLECTION.toString()},ce.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.MANIFEST.toString()},ce.prototype.isRange=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.RANGE.toString()},ce.prototype.isSequence=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.SEQUENCE.toString()},he=ce,le.ManifestResource=he;var pe,de,fe,ge;c=this&&this.__extends||(pe=function(e,t){return(pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}pe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function me(e,t){return fe.call(this,e,t)||this}de=Yt=Yt||{},fe=de.ManifestResource,c(me,fe),me.prototype.getFormat=function(){var e=this.getProperty("format");return e?new de.MediaType(e.toLowerCase()):null},me.prototype.getResources=function(){var e=[];if(!this.__jsonld.resources)return e;for(var t=0;t<this.__jsonld.resources.length;t++){var i=this.__jsonld.resources[t],n=new de.Annotation(i,this.options);e.push(n)}return e},me.prototype.getType=function(){var e=this.getProperty("type");return e?new de.ResourceType(de.Utils.normaliseType(e)):null},me.prototype.getWidth=function(){return this.getProperty("width")},me.prototype.getHeight=function(){return this.getProperty("height")},me.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},me.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},ge=me,de.Resource=ge;var ve,ye,we,Se;c=this&&this.__extends||(ve=function(e,t){return(ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ve(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function _e(e,t){return we.call(this,e,t)||this}ye=Yt=Yt||{},we=ye.Resource,c(_e,we),_e.prototype.getCanonicalImageUri=function(e){var t,i=null,n="default",r=e;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])i=this.externalResource.data["@id"],r=r||this.externalResource.data.width,this.externalResource.data["@context"]&&(-1<this.externalResource.data["@context"].indexOf("/1.0/context.json")||-1<this.externalResource.data["@context"].indexOf("/1.1/context.json")||-1<this.externalResource.data["@context"].indexOf("/1/context.json"))&&(n="native");else{var o=this.getImages();if(o&&o.length){var s=o[0].getResource(),a=s.getServices();if(r=r||s.getWidth(),a.length){var l=a[0];i=l.id,n=ye.Utils.getImageQuality(l.getProfile())}else if(r===s.getWidth())return s.id}if(!i){var u=this.getProperty("thumbnail");if(u){if("string"==typeof u)return u;if(u["@id"])return u["@id"];if(u.length)return u[0].id}}}return t=r+",",i&&i.endsWith("/")&&(i=i.substr(0,i.length-1)),[i,"full",t,0,n+".jpg"].join("/")},_e.prototype.getMaxDimensions=function(){var e,t=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(e=this.externalResource.data.profile,Array.isArray(e)&&(e=e.filter(function(e){return e.maxWidth})[0])&&(t=new ye.Size(e.maxWidth,e.maxHeight?e.maxHeight:e.maxWidth))),t},_e.prototype.getContent=function(){var e=[],t=this.__jsonld.items||this.__jsonld.content;if(!t)return e;var i=null;if(t.length&&(i=new ye.AnnotationPage(t[0],this.options)),!i)return e;for(var n=i.getItems(),r=0;r<n.length;r++){var o=n[r],s=new ye.Annotation(o,this.options);e.push(s)}return e},_e.prototype.getDuration=function(){return this.getProperty("duration")},_e.prototype.getImages=function(){var e=[];if(!this.__jsonld.images)return e;for(var t=0;t<this.__jsonld.images.length;t++){var i=this.__jsonld.images[t],n=new ye.Annotation(i,this.options);e.push(n)}return e},_e.prototype.getIndex=function(){return this.getProperty("index")},_e.prototype.getOtherContent=function(){var i=this,e=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],t=e.filter(function(e){return e&&function(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase()==e.toLowerCase()}(e["@type"],"sc:AnnotationList")}).map(function(e,t){return new ye.AnnotationList(e.label||"Annotation list "+t,e,i.options)}).map(function(e){return e.load()});return Promise.all(t)},_e.prototype.getWidth=function(){return this.getProperty("width")},_e.prototype.getHeight=function(){return this.getProperty("height")},Se=_e,ye.Canvas=Se;var Te,be,Ee,xe;c=this&&this.__extends||(Te=function(e,t){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Pe(e,t){var i=Ee.call(this,e,t)||this;i.index=-1,i.isLoaded=!1;var n={defaultLabel:"-",locale:"en-GB",resource:i,pessimisticAccessControl:!1};return i.options=Object.assign(n,t),i}be=Yt=Yt||{},Ee=be.ManifestResource,c(Pe,Ee),Pe.prototype.getAttribution=function(){console.warn("getAttribution will be deprecated, use getRequiredStatement instead.");var e=this.getProperty("attribution");return e?be.LanguageMap.parse(e,this.options.locale):[]},Pe.prototype.getDescription=function(){var e=this.getProperty("description");return e?be.LanguageMap.parse(e,this.options.locale):[]},Pe.prototype.getIIIFResourceType=function(){return new be.IIIFResourceType(be.Utils.normaliseType(this.getProperty("type")))},Pe.prototype.getLogo=function(){var e=this.getProperty("logo");return e?"string"==typeof e?e:(Array.isArray(e)&&e.length&&(e=e[0]),e["@id"]||e.id):null},Pe.prototype.getLicense=function(){return be.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},Pe.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},Pe.prototype.getRelated=function(){return this.getProperty("related")},Pe.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},Pe.prototype.getTrackingLabel=function(){var e=this.getService(be.ServiceProfile.TRACKINGEXTENSIONS);return e?e.getProperty("trackingLabel"):""},Pe.prototype.getDefaultTree=function(){return this.defaultTree=new be.TreeNode("root"),(this.defaultTree.data=this).defaultTree},Pe.prototype.getRequiredStatement=function(){var e=null,t=this.getProperty("requiredStatement");if(t)(e=new be.LabelValuePair(this.options.locale)).parse(t);else{var i=this.getAttribution();i&&((e=new be.LabelValuePair(this.options.locale)).value=i)}return e},Pe.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===be.IIIFResourceType.COLLECTION.toString()},Pe.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===be.IIIFResourceType.MANIFEST.toString()},Pe.prototype.load=function(){var r=this;return new Promise(function(i,e){if(r.isLoaded)i(r);else{var n=r.options;n.navDate=r.getNavDate();var t=r.__jsonld.id;t=t||r.__jsonld["@id"],be.Utils.loadResource(t).then(function(e){r.parentLabel=be.LanguageMap.getValue(r.getLabel(),n.locale);var t=be.Deserialiser.parse(e,n);(r=Object.assign(r,t)).index=n.index,i(r)})}})},xe=Pe,be.IIIFResource=xe;var Ie,Ce,Oe,Re;c=this&&this.__extends||(Ie=function(e,t){return(Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ie(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Ae(e,t){var i=Oe.call(this,e,t)||this;if(i.index=0,i._allRanges=null,i.items=[],i._topRanges=[],i.__jsonld.structures&&i.__jsonld.structures.length)for(var n=i._getTopRanges(),r=0;r<n.length;r++){var o=n[r];i._parseRanges(o,String(r))}return i}Ce=Yt=Yt||{},Oe=Ce.IIIFResource,c(Ae,Oe),Ae.prototype.getPosterCanvas=function(){var e=this.getProperty("posterCanvas");return e=e&&new Ce.Canvas(e,this.options)},Ae.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e?new Ce.Behavior(e):null},Ae.prototype.getDefaultTree=function(){if(Oe.prototype.getDefaultTree.call(this),this.defaultTree.data.type=Ce.Utils.normaliseType(Ce.TreeNodeType.MANIFEST.toString()),!this.isLoaded)return this.defaultTree;var e=this.getTopRanges();return e.length&&e[0].getTree(this.defaultTree),Ce.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},Ae.prototype._getTopRanges=function(){var e=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var t=0;t<this.__jsonld.structures.length;t++){var i=this.__jsonld.structures[t];i.viewingHint===Ce.ViewingHint.TOP.toString()&&e.push(i)}if(!e.length){var n={};n.ranges=this.__jsonld.structures,e.push(n)}}return e},Ae.prototype.getTopRanges=function(){return this._topRanges},Ae.prototype._getRangeById=function(e){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var t=0;t<this.__jsonld.structures.length;t++){var i=this.__jsonld.structures[t];if(i["@id"]===e||i.id===e)return i}return null},Ae.prototype._parseRanges=function(e,t,i){var n,r=null;if("string"==typeof e&&(r=e,e=this._getRangeById(r)),e){(n=new Ce.Range(e,this.options)).parentRange=i,n.path=t,i?i.items.push(n):this._topRanges.push(n);var o=e.items||e.members;if(o)for(var s=0;s<o.length;s++){var a=o[s];if(a["@type"]&&"sc:range"===a["@type"].toLowerCase()||a.type&&"range"===a.type.toLowerCase())this._parseRanges(a,t+"/"+s,n);else if(a["@type"]&&"sc:canvas"===a["@type"].toLowerCase()||a.type&&"canvas"===a.type.toLowerCase()){n.canvases||(n.canvases=[]);var l=a.id||a["@id"];n.canvases.push(l)}}else if(e.ranges)for(s=0;s<e.ranges.length;s++)this._parseRanges(e.ranges[s],t+"/"+s,n)}else console.warn("Range:",r,"does not exist")},Ae.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;function e(e){var t=r[e];t.id&&o._allRanges.push(t);var n=function(e,t){e.add(t);var i=t.getRanges();return i.length?i.reduce(n,e):e},i=Array.from(t.getRanges().reduce(n,new Set));o._allRanges=o._allRanges.concat(i)}this._allRanges=[];for(var r=this.getTopRanges(),o=this,t=0;t<r.length;t++)e(t);return this._allRanges},Ae.prototype.getRangeById=function(e){for(var t=this.getAllRanges(),i=0;i<t.length;i++){var n=t[i];if(n.id===e)return n}return null},Ae.prototype.getRangeByPath=function(e){for(var t=this.getAllRanges(),i=0;i<t.length;i++){var n=t[i];if(n.path===e)return n}return null},Ae.prototype.getSequences=function(){if(this.items.length)return this.items;var e=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(e)for(var t=0;t<e.length;t++){var i=e[t],n=new Ce.Sequence(i,this.options);this.items.push(n)}else this.__jsonld.items&&(n=new Ce.Sequence(this.__jsonld.items,this.options),this.items.push(n));return this.items},Ae.prototype.getSequenceByIndex=function(e){return this.getSequences()[e]},Ae.prototype.getTotalSequences=function(){return this.getSequences().length},Ae.prototype.getManifestType=function(){var e=this.getService(Ce.ServiceProfile.UIEXTENSIONS);return e?new Ce.ManifestType(e.getProperty("manifestType")):new Ce.ManifestType("")},Ae.prototype.isMultiSequence=function(){return 1<this.getTotalSequences()},Ae.prototype.isPagingEnabled=function(){var e=this.getViewingHint();if(e)return e.toString()===Ce.ViewingHint.PAGED.toString();var t=this.getBehavior();return!!t&&t.toString()===Ce.Behavior.PAGED.toString()},Ae.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new Ce.ViewingDirection(this.getProperty("viewingDirection")):null},Ae.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new Ce.ViewingHint(this.getProperty("viewingHint")):null},Re=Ae,Ce.Manifest=Re;var Le,ke,Me,Ne;c=this&&this.__extends||(Le=function(e,t){return(Le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Le(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function De(e,t){var i=Me.call(this,e,t)||this;return i.items=[],i._collections=null,i._manifests=null,e.__collection=i}ke=Yt=Yt||{},Me=ke.IIIFResource,c(De,Me),De.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(e){return e.isCollection()})},De.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(e){return e.isManifest()})},De.prototype.getCollectionByIndex=function(e){for(var t,i=this.getCollections(),n=0;n<i.length;n++){var r=i[n];r.index===e&&(t=r)}if(t)return t.options.index=e,t.load();throw new Error("Collection index not found")},De.prototype.getManifestByIndex=function(e){for(var t,i=this.getManifests(),n=0;n<i.length;n++){var r=i[n];r.index===e&&(t=r)}if(t)return t.options.index=e,t.load();throw new Error("Manifest index not found")},De.prototype.getTotalCollections=function(){return this.getCollections().length},De.prototype.getTotalManifests=function(){return this.getManifests().length},De.prototype.getTotalItems=function(){return this.items.length},De.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new ke.ViewingDirection(this.getProperty("viewingDirection")):ke.ViewingDirection.LEFTTORIGHT},De.prototype.getDefaultTree=function(){return Me.prototype.getDefaultTree.call(this),this.defaultTree.data.type=ke.Utils.normaliseType(ke.TreeNodeType.COLLECTION.toString()),this._parseManifests(this),this._parseCollections(this),ke.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},De.prototype._parseManifests=function(e){if(e.getManifests()&&e.getManifests().length)for(var t=0;t<e.getManifests().length;t++){var i=e.getManifests()[t],n=i.getDefaultTree();n.label=i.parentLabel||ke.LanguageMap.getValue(i.getLabel(),this.options.locale)||"manifest "+(t+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=ke.Utils.normaliseType(ke.TreeNodeType.MANIFEST.toString()),e.defaultTree.addNode(n)}},De.prototype._parseCollections=function(e){if(e.getCollections()&&e.getCollections().length)for(var t=0;t<e.getCollections().length;t++){var i=e.getCollections()[t],n=i.getDefaultTree();n.label=i.parentLabel||ke.LanguageMap.getValue(i.getLabel(),this.options.locale)||"collection "+(t+1),n.navDate=i.getNavDate(),n.data.id=i.id,n.data.type=ke.Utils.normaliseType(ke.TreeNodeType.COLLECTION.toString()),e.defaultTree.addNode(n)}},Ne=De,ke.Collection=Ne;var Fe,He,Be,Ge;c=this&&this.__extends||(Fe=function(e,t){return(Fe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Fe(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Ue(e,t){var i=Be.call(this,e,t)||this;return i._ranges=null,i.canvases=null,i.items=[],i}He=Yt=Yt||{},Be=He.ManifestResource,c(Ue,Be),Ue.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},Ue.prototype.getDuration=function(){var e,t;if(this.canvases&&this.canvases.length)for(var i=0;i<this.canvases.length;i++){var n=this.canvases[i],r=He.Utils.getTemporalComponent(n);r&&1<r.length&&(0===i&&(e=Number(r[0])),i===this.canvases.length-1&&(t=Number(r[1])))}else{var o=this.getRanges();for(i=0;i<o.length;i++){var s=o[i].getDuration();s&&(0===i&&(e=s.start),i===o.length-1&&(t=s.end))}}if(void 0!==e&&void 0!==t)return new He.Duration(e,t)},Ue.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(e){return e.isRange()})},Ue.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e?new He.Behavior(e):null},Ue.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new He.ViewingDirection(this.getProperty("viewingDirection")):null},Ue.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new He.ViewingHint(this.getProperty("viewingHint")):null},Ue.prototype.getTree=function(e){(e.data=this).treeNode=e;var t=this.getRanges();if(t&&t.length)for(var i=0;i<t.length;i++){var n=t[i],r=new He.TreeNode;e.addNode(r),this._parseTreeNode(r,n)}return He.Utils.generateTreeNodeIds(e),e},Ue.prototype.spansTime=function(e){var t=this.getDuration();return!!(t&&e>=t.start&&e<=t.end)},Ue.prototype._parseTreeNode=function(e,t){e.label=He.LanguageMap.getValue(t.getLabel(),this.options.locale),e.data=t,e.data.type=He.Utils.normaliseType(He.TreeNodeType.RANGE.toString()),t.treeNode=e;var i=t.getRanges();if(i&&i.length)for(var n=0;n<i.length;n++){var r=i[n],o=r.getBehavior();if(!o||o.toString()!==He.Behavior.NONAV.toString()){var s=new He.TreeNode;e.addNode(s),this._parseTreeNode(s,r)}}},Ge=Ue,He.Range=Ge;var ze,je,Ve,qe;c=this&&this.__extends||(ze=function(e,t){return(ze=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}ze(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function We(e,t){return Ve.call(this,e,t)||this}je=Yt=Yt||{},Ve=je.ManifestResource,c(We,Ve),We.prototype.getFormat=function(){return new je.RenderingFormat(this.getProperty("format"))},qe=We,je.Rendering=qe;var $e,Ke,Xe,Ze;c=this&&this.__extends||($e=function(e,t){return($e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}$e(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Qe(e,t){var i=Xe.call(this,e,t)||this;return i.items=[],i._thumbnails=null,i}Ke=Yt=Yt||{},Xe=Ke.ManifestResource,c(Qe,Xe),Qe.prototype.getCanvases=function(){if(this.items.length)return this.items;var e=this.__jsonld.canvases||this.__jsonld.elements;if(e)for(var t=0;t<e.length;t++){var i=e[t];(n=new Ke.Canvas(i,this.options)).index=t,this.items.push(n)}else if(this.__jsonld)for(t=0;t<this.__jsonld.length;t++){var n;i=this.__jsonld[t],(n=new Ke.Canvas(i,this.options)).index=t,this.items.push(n)}return this.items},Qe.prototype.getCanvasById=function(e){for(var t=0;t<this.getTotalCanvases();t++){var i=this.getCanvasByIndex(t),n=Ke.Utils.normaliseUrl(i.id);if(Ke.Utils.normaliseUrl(e)===n)return i}return null},Qe.prototype.getCanvasByIndex=function(e){return this.getCanvases()[e]},Qe.prototype.getCanvasIndexById=function(e){for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return null},Qe.prototype.getCanvasIndexByLabel=function(e,t){e=e.trim(),isNaN(e)||(e=parseInt(e,10).toString(),t&&(e+="r"));for(var i,n,r,o=/(\d*)\D+(\d*)/,s=0;s<this.getTotalCanvases();s++){var a=this.getCanvasByIndex(s);if(Ke.LanguageMap.getValue(a.getLabel(),this.options.locale)===e)return s;if((i=o.exec(e))&&(n=i[1],(r=i[2])&&new RegExp("^"+n+"\\D+"+r+"$").test(a.getLabel().toString())))return s}return-1},Qe.prototype.getLastCanvasLabel=function(e){for(var t=this.getTotalCanvases()-1;0<=t;t--){var i=this.getCanvasByIndex(t),n=Ke.LanguageMap.getValue(i.getLabel(),this.options.locale);if(e){if(/^[a-zA-Z0-9]*$/.test(n))return n}else if(n)return n}return this.options.defaultLabel},Qe.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},Qe.prototype.getNextPageIndex=function(e,t){var i;if(t){var n=this.getPagedIndices(e),r=this.getViewingDirection();i=r&&r.toString()===Ke.ViewingDirection.RIGHTTOLEFT.toString()?n[0]+1:n[n.length-1]+1}else i=e+1;return i>this.getLastPageIndex()?-1:i},Qe.prototype.getPagedIndices=function(e,t){var i=[];if(t){i=this.isFirstCanvas(e)||this.isLastCanvas(e)?[e]:e%2?[e,e+1]:[e-1,e];var n=this.getViewingDirection();n&&n.toString()===Ke.ViewingDirection.RIGHTTOLEFT.toString()&&(i=i.reverse())}else i.push(e);return i},Qe.prototype.getPrevPageIndex=function(e,t){var i;if(t){var n=this.getPagedIndices(e),r=this.getViewingDirection();i=r&&r.toString()===Ke.ViewingDirection.RIGHTTOLEFT.toString()?n[n.length-1]-1:n[0]-1}else i=e-1;return i},Qe.prototype.getStartCanvasIndex=function(){var e=this.getStartCanvas();if(e)for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return 0},Qe.prototype.getThumbs=function(e,t){console.warn("getThumbs will be deprecated, use getThumbnails instead");for(var i=[],n=this.getTotalCanvases(),r=0;r<n;r++){var o=this.getCanvasByIndex(r),s=new Ke.Thumb(e,o);i.push(s)}return i},Qe.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var e=this.getCanvases(),t=0;t<e.length;t++){var i=e[t].getThumbnail();i&&this._thumbnails.push(i)}return this._thumbnails},Qe.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},Qe.prototype.getTotalCanvases=function(){return this.getCanvases().length},Qe.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new Ke.ViewingDirection(this.getProperty("viewingDirection")):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},Qe.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new Ke.ViewingHint(this.getProperty("viewingHint")):null},Qe.prototype.isCanvasIndexOutOfRange=function(e){return e>this.getTotalCanvases()-1},Qe.prototype.isFirstCanvas=function(e){return 0===e},Qe.prototype.isLastCanvas=function(e){return e===this.getTotalCanvases()-1},Qe.prototype.isMultiCanvas=function(){return 1<this.getTotalCanvases()},Qe.prototype.isPagingEnabled=function(){var e=this.getViewingHint();return!!e&&e.toString()===Ke.ViewingHint.PAGED.toString()},Qe.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},Ze=Qe,Ke.Sequence=Ze,function(n){var e=(t.parse=function(e,t){return"string"==typeof e&&(e=JSON.parse(e)),this.parseJson(e,t)},t.parseJson=function(e,t){var i;if(t&&t.navDate&&!isNaN(t.navDate.getTime())&&(e.navDate=t.navDate.toString()),e["@type"])switch(e["@type"]){case"sc:Collection":i=this.parseCollection(e,t);break;case"sc:Manifest":i=this.parseManifest(e,t);break;default:return null}else switch(e.type){case"Collection":i=this.parseCollection(e,t);break;case"Manifest":i=this.parseManifest(e,t);break;default:return null}return i.isLoaded=!0,i},t.parseCollection=function(e,t){var i=new n.Collection(e,t);return t?(i.index=t.index||0,t.resource&&(i.parentCollection=t.resource.parentCollection)):i.index=0,this.parseCollections(i,t),this.parseManifests(i,t),this.parseItems(i,t),i},t.parseCollections=function(e,t){var i;if(e.__jsonld.collections?i=e.__jsonld.collections:e.__jsonld.items&&(i=e.__jsonld.items.filter(function(e){return"collection"===e.type.toLowerCase()})),i)for(var n=0;n<i.length;n++){t&&(t.index=n);var r=this.parseCollection(i[n],t);r.index=n,(r.parentCollection=e).items.push(r)}},t.parseManifest=function(e,t){return new n.Manifest(e,t)},t.parseManifests=function(e,t){var i;if(e.__jsonld.manifests?i=e.__jsonld.manifests:e.__jsonld.items&&(i=e.__jsonld.items.filter(function(e){return"manifest"===e.type.toLowerCase()})),i)for(var n=0;n<i.length;n++){var r=this.parseManifest(i[n],t);r.index=n,(r.parentCollection=e).items.push(r)}},t.parseItem=function(e,t){if(e["@type"]){if("sc:manifest"===e["@type"].toLowerCase())return this.parseManifest(e,t);if("sc:collection"===e["@type"].toLowerCase())return this.parseCollection(e,t)}else if(e.type){if("manifest"===e.type.toLowerCase())return this.parseManifest(e,t);if("collection"===e.type.toLowerCase())return this.parseCollection(e,t)}return null},t.parseItems=function(i,n){var r=i.__jsonld.members||i.__jsonld.items;if(r){function e(e){n&&(n.index=e);var t=o.parseItem(r[e],n);return t?i.items.filter(function(e){return e.id===t.id})[0]?"continue":(t.index=e,void(t.parentCollection=i).items.push(t)):{value:void 0}}for(var o=this,t=0;t<r.length;t++){var s=e(t);if("object"==typeof s)return s.value}}},t);function t(){}n.Deserialiser=e;var i=(r.serialise=function(e){return""},r);function r(){}n.Serialiser=i}(Yt=Yt||{});var Ye,Je,et,tt,it,nt,rt;c=this&&this.__extends||(Ye=function(e,t){return(Ye=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ye(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function ot(e,t){return et.call(this,e,t)||this}function st(e,t){this.data=t,this.index=t.index,this.width=e;var i=t.getHeight()/t.getWidth();this.height=i?Math.floor(this.width*i):e,this.uri=t.getCanonicalImageUri(e),this.label=it.LanguageMap.getValue(t.getLabel())}function at(e,t){this.label=e,this.data=t||{},this.nodes=[]}Je=Yt=Yt||{},et=Je.ManifestResource,c(ot,et),ot.prototype.getProfile=function(){var e=this.getProperty("profile");return e=e||this.getProperty("dcterms:conformsTo"),Array.isArray(e)?new Je.ServiceProfile(e[0]):new Je.ServiceProfile(e)},ot.prototype.getConfirmLabel=function(){return Je.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},ot.prototype.getDescription=function(){return Je.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},ot.prototype.getFailureDescription=function(){return Je.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},ot.prototype.getFailureHeader=function(){return Je.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},ot.prototype.getHeader=function(){return Je.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},ot.prototype.getServiceLabel=function(){return Je.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},ot.prototype.getInfoUri=function(){var e=this.id;return e.endsWith("/")||(e+="/"),e+="info.json"},tt=ot,Je.Service=tt,(it=Yt=Yt||{}).Thumb=st,nt=Yt=Yt||{},at.prototype.addNode=function(e){this.nodes.push(e),e.parentNode=this},at.prototype.isCollection=function(){return this.data.type===nt.Utils.normaliseType(nt.TreeNodeType.COLLECTION.toString())},at.prototype.isManifest=function(){return this.data.type===nt.Utils.normaliseType(nt.TreeNodeType.MANIFEST.toString())},at.prototype.isRange=function(){return this.data.type===nt.Utils.normaliseType(nt.TreeNodeType.RANGE.toString())},rt=at,nt.TreeNode=rt;var lt,ut,ht,ct;c=this&&this.__extends||(lt=function(e,t){return(lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}lt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function pt(){return null!==ht&&ht.apply(this,arguments)||this}ut=Yt=Yt||{},ht=ut.StringValue,c(pt,ht),pt.prototype.collection=function(){return new pt(pt.COLLECTION.toString())},pt.prototype.manifest=function(){return new pt(pt.MANIFEST.toString())},pt.prototype.range=function(){return new pt(pt.RANGE.toString())},pt.COLLECTION=new pt("collection"),pt.MANIFEST=new pt("manifest"),pt.RANGE=new pt("range"),ct=pt,ut.TreeNodeType=ct;var dt,ft,gt=this&&this.__awaiter||function(o,s,a,l){return new(a=a||Promise)(function(e,t){function i(e){try{r(l.next(e))}catch(e){t(e)}}function n(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,n)}r((l=l.apply(o,s||[])).next())})},mt=this&&this.__generator||function(i,n){var r,o,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(i,a)}catch(e){t=[6,e],o=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},vt=ni("http"),yt=ni("https"),wt=ni("url");function St(){}function _t(e,t){Array.isArray(e)?1===e.length?this.value=e[0]:this.value=e.join("<br/>"):this.value=e,this.locale=t}dt=Yt=Yt||{},St.getMediaType=function(e){return(e=(e=e.toLowerCase()).split(";")[0]).trim()},St.getImageQuality=function(e){var t=e.toString();return t===dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||t===dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||t===dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||t===dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||t===dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||t===dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||t===dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||t===dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||t===dt.ServiceProfile.IIIF1IMAGELEVEL1.toString()||t===dt.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||t===dt.ServiceProfile.IIIF1IMAGELEVEL2.toString()||t===dt.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()?"native":"default"},St.getInexactLocale=function(e){return-1!==e.indexOf("-")?e.substr(0,e.indexOf("-")):e},St.getLocalisedValue=function(e,t){if(!Array.isArray(e))return e;for(var i=0;i<e.length;i++){var n=e[i];if(t===n["@language"])return n["@value"]}var r=t.substr(0,t.indexOf("-"));for(i=0;i<e.length;i++){var o=e[i];if(o["@language"]===r)return o["@value"]}return null},St.generateTreeNodeIds=function(e,t){var i;void 0===t&&(t=0),i=e.parentNode?e.parentNode.id+"-"+t:"0",e.id=i;for(var n=0;n<e.nodes.length;n++){var r=e.nodes[n];St.generateTreeNodeIds(r,n)}},St.normaliseType=function(e){return-1===(e=e.toLowerCase()).indexOf(":")?e:e.split(":")[1]},St.normaliseUrl=function(e){return-1!==(e=e.substr(e.indexOf("://"))).indexOf("#")&&(e=e.split("#")[0]),e},St.normalisedUrlsMatch=function(e,t){return St.normaliseUrl(e)===St.normaliseUrl(t)},St.isImageProfile=function(e){return"string"==typeof e&&(e=new dt.ServiceProfile(e)),!!(St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},St.isLevel0ImageProfile=function(e){return"string"==typeof e&&(e=new dt.ServiceProfile(e)),!!(St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL0.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString()))},St.isLevel1ImageProfile=function(e){return"string"==typeof e&&(e=new dt.ServiceProfile(e)),!!(St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL1.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString()))},St.isLevel2ImageProfile=function(e){return"string"==typeof e&&(e=new dt.ServiceProfile(e)),!!(St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL2.toString())||St.normalisedUrlsMatch(e.toString(),dt.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},St.loadResource=function(s){return new Promise(function(i,t){var e,n=wt.parse(s),r={host:n.hostname,port:n.port,path:n.path,method:"GET",withCredentials:!1};switch(n.protocol){case"https:":(e=yt.request(r,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){i(t)})})).on("error",function(e){t(e)}),e.end();break;case"dat:":var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&i(o.response)},o.open("GET",s,!0),o.send();break;default:(e=vt.request(r,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){i(t)})})).on("error",function(e){t(e)}),e.end()}})},St.loadExternalResourcesAuth1=function(n,r,o,s,a,l,u,h){return new Promise(function(e,t){var i=n.map(function(e){return St.loadExternalResourceAuth1(e,r,o,s,a,l,u,h)});Promise.all(i).then(function(){e(n)}).catch(function(e){t(e)})})},St.loadExternalResourceAuth1=function(i,n,r,o,s,a,l,u){return gt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,o(i)];case 1:return(t=e.sent())?[4,i.getData(t)]:[3,6];case 2:return e.sent(),i.status!==HTTPStatusCode.OK?[3,3]:[2,i];case 3:return[4,St.doAuthChain(i,n,r,s,a,l,u)];case 4:e.sent(),e.label=5;case 5:if(i.status===HTTPStatusCode.OK||i.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,i];throw St.createAuthorizationFailedError();case 6:return[4,i.getData()];case 7:return e.sent(),i.status!==HTTPStatusCode.MOVED_TEMPORARILY&&i.status!==HTTPStatusCode.UNAUTHORIZED?[3,9]:[4,St.doAuthChain(i,n,r,s,a,l,u)];case 8:e.sent(),e.label=9;case 9:if(i.status===HTTPStatusCode.OK||i.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,i];throw St.createAuthorizationFailedError()}})})},St.doAuthChain=function(u,h,c,p,d,f,g){return gt(this,void 0,void 0,function(){var t,i,n,r,o,s,a,l;return mt(this,function(e){switch(e.label){case 0:return u.isAccessControlled()?((t=u.externalService)&&(t.options=u.options),(i=u.kioskService)&&(i.options=u.options),(n=u.clickThroughService)&&(n.options=u.options),(r=u.loginService)&&(r.options=u.options),u.isResponseHandled||u.status!==HTTPStatusCode.MOVED_TEMPORARILY?[3,2]:[4,f(u)]):[2,u];case 1:return e.sent(),[2,u];case 2:return s=o=null,(o=t)?[4,St.attemptResourceWithToken(u,c,s=o)]:[3,4];case 3:return e.sent(),[2,u];case 4:return(o=i)&&(a=h(s=o))?[4,p(a)]:[3,7];case 5:return e.sent(),[4,St.attemptResourceWithToken(u,c,o)];case 6:return e.sent(),[2,u];case 7:return(o=n)?[4,d(u,s=o)]:[3,11];case 8:return(l=e.sent())?[4,p(l)]:[3,11];case 9:return e.sent(),[4,St.attemptResourceWithToken(u,c,o)];case 10:return e.sent(),[2,u];case 11:return(o=r)?[4,d(u,s=o)]:[3,15];case 12:return(l=e.sent())?[4,p(l)]:[3,15];case 13:return e.sent(),[4,St.attemptResourceWithToken(u,c,o)];case 14:return e.sent(),[2,u];case 15:return s&&g(u,s),[2]}})})},St.attemptResourceWithToken=function(n,r,o){return gt(this,void 0,void 0,function(){var t,i;return mt(this,function(e){switch(e.label){case 0:return(t=o.getService(dt.ServiceProfile.AUTH1TOKEN.toString()))?[4,r(n,t)]:[3,3];case 1:return(i=e.sent())&&i.accessToken?[4,n.getData(i)]:[3,3];case 2:return e.sent(),[2,n];case 3:return[2]}})})},St.loadExternalResourcesAuth09=function(n,r,o,s,a,l,u,h,c,p){return new Promise(function(e,t){var i=n.map(function(e){return St.loadExternalResourceAuth09(e,r,o,s,a,l,u,h,c,p)});Promise.all(i).then(function(){e(n)}).catch(function(e){t(e)})})},St.loadExternalResourceAuth09=function(n,r,o,s,a,l,u,h,c,e){return new Promise(function(t,i){e&&e.pessimisticAccessControl?n.getData().then(function(){n.isAccessControlled()?n.clickThroughService?(t(o(n)),t(s(n))):a(n).then(function(){l(n,!0).then(function(e){n.getData(e).then(function(){t(c(n))}).catch(function(e){i(St.createInternalServerError(e))})}).catch(function(e){i(St.createInternalServerError(e))})}).catch(function(e){i(St.createInternalServerError(e))}):t(n)}).catch(function(e){i(St.createInternalServerError(e))}):h(n,r).then(function(e){e?n.getData(e).then(function(){n.status===HTTPStatusCode.OK?t(c(n)):St.authorize(n,r,o,s,a,l,u,h).then(function(){t(c(n))}).catch(function(e){i(St.createAuthorizationFailedError())})}).catch(function(e){i(St.createAuthorizationFailedError())}):St.authorize(n,r,o,s,a,l,u,h).then(function(){t(c(n))}).catch(function(e){i(St.createAuthorizationFailedError())})}).catch(function(e){i(St.createAuthorizationFailedError())})})},St.createError=function(e,t){var i=new Error;return i.message=t,i.name=e,i},St.createAuthorizationFailedError=function(){return St.createError(manifesto.StatusCodes.AUTHORIZATION_FAILED.toString(),"Authorization failed")},St.createRestrictedError=function(){return St.createError(manifesto.StatusCodes.RESTRICTED.toString(),"Restricted")},St.createInternalServerError=function(e){return St.createError(manifesto.StatusCodes.INTERNAL_SERVER_ERROR.toString(),e)},St.authorize=function(n,r,o,s,a,l,u,e){return new Promise(function(t,i){n.getData().then(function(){n.isAccessControlled()?e(n,r).then(function(e){e?n.getData(e).then(function(){n.status===HTTPStatusCode.OK?t(n):St.showAuthInteraction(n,r,o,s,a,l,u,t,i)}).catch(function(e){i(St.createInternalServerError(e))}):l(n,!1).then(function(e){e?u(n,e,r).then(function(){n.getData(e).then(function(){n.status===HTTPStatusCode.OK?t(n):St.showAuthInteraction(n,r,o,s,a,l,u,t,i)}).catch(function(e){i(St.createInternalServerError(e))})}).catch(function(e){i(St.createInternalServerError(e))}):St.showAuthInteraction(n,r,o,s,a,l,u,t,i)})}).catch(function(e){i(St.createInternalServerError(e))}):t(n)})})},St.showAuthInteraction=function(t,i,e,n,r,o,s,a,l){t.status!==HTTPStatusCode.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?e(t).then(function(){o(t,!0).then(function(e){s(t,e,i).then(function(){t.getData(e).then(function(){a(t)}).catch(function(e){l(St.createInternalServerError(e))})}).catch(function(e){l(St.createInternalServerError(e))})}).catch(function(e){l(St.createInternalServerError(e))})}):r(t).then(function(){o(t,!0).then(function(e){s(t,e,i).then(function(){t.getData(e).then(function(){a(t)}).catch(function(e){l(St.createInternalServerError(e))})}).catch(function(e){l(St.createInternalServerError(e))})}).catch(function(e){l(St.createInternalServerError(e))})}):a(t)},St.getService=function(e,t){var i=this.getServices(e);"string"!=typeof t&&(t=t.toString());for(var n=0;n<i.length;n++){var r=i[n];if(r.getProfile().toString()===t)return r}return null},St.getResourceById=function(e,t){return St.traverseAndFind(e.__jsonld,"@id",t)},St.traverseAndFind=function(e,t,i){if(e.hasOwnProperty(t)&&e[t]===i)return e;for(var n=0;n<Object.keys(e).length;n++)if("object"==typeof e[Object.keys(e)[n]]){var r=St.traverseAndFind(e[Object.keys(e)[n]],t,i);if(null!=r)return r}},St.getServices=function(e){var t,i=[];if(!(t=e.__jsonld?e.__jsonld.service:e.service))return i;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var r=t[n];if("string"==typeof r){var o=this.getResourceById(e.options.resource,r);o&&i.push(new dt.Service(o.__jsonld||o,e.options))}else i.push(new dt.Service(r,e.options))}return i},St.getTemporalComponent=function(e){var t=/t=([^&]+)/g.exec(e),i=null;return t&&t[1]&&(i=t[1].split(",")),i},ft=St,dt.Utils=ft,(Yt=Yt||{}).Language=_t;var Tt,bt,Et,xt,Pt,It;c=this&&this.__extends||(Tt=function(e,t){return(Tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Tt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Ct(){return null!==Et&&Et.apply(this,arguments)||this}function Ot(e){this.defaultLocale=e}function Rt(e,t){this.width=e,this.height=t}bt=Yt=Yt||{},Et=Array,c(Ct,Et),Ct.parse=function(t,e){var i,n=[];if(!t)return n;if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];i="string"==typeof o?new bt.Language(o,e):new bt.Language(o["@value"],o["@language"]||e),n.push(i)}else{if("string"==typeof t)return i=new bt.Language(t,e),n.push(i),n;t["@value"]?(i=new bt.Language(t["@value"],t["@language"]||e),n.push(i)):Object.keys(t).forEach(function(e){if(!t[e].length)throw new Error("language must have a value");i=new bt.Language(t[e],e),n.push(i)})}return n},Ct.getValue=function(e,t){if(e.length){if(t){var i=e.filter(function(e){return e.locale===t||bt.Utils.getInexactLocale(e.locale)===bt.Utils.getInexactLocale(t)})[0];if(i)return i.value}return e[0].value}return null},xt=Ct,bt.LanguageMap=xt,Pt=Yt=Yt||{},Ot.prototype.parse=function(e){this.resource=e,this.label=Pt.LanguageMap.parse(this.resource.label,this.defaultLocale),this.value=Pt.LanguageMap.parse(this.resource.value,this.defaultLocale)},Ot.prototype.getLabel=function(){return this.label?Pt.LanguageMap.getValue(this.label,this.defaultLocale):null},Ot.prototype.setLabel=function(e){var t=this;if(this.label&&this.label.length){var i=this.label.filter(function(e){return e.locale===t.defaultLocale||e.locale===Pt.Utils.getInexactLocale(t.defaultLocale)})[0];i&&(i.value=e)}},Ot.prototype.getValue=function(){if(this.value){var e=this.defaultLocale;return this.label&&this.label.length&&this.label[0].locale&&(e=this.label[0].locale),Pt.LanguageMap.getValue(this.value,e)}return null},Ot.prototype.setValue=function(e){var t=this;if(this.value&&this.value.length){var i=this.value.filter(function(e){return e.locale===t.defaultLocale||e.locale===Pt.Utils.getInexactLocale(t.defaultLocale)})[0];i&&(i.value=e)}},It=Ot,Pt.LabelValuePair=It,(Yt=Yt||{}).Size=Rt,n.manifesto=n.Manifesto=ri.exports={AnnotationMotivation:new Yt.AnnotationMotivation,Behavior:new Yt.Behavior,IIIFResourceType:new Yt.IIIFResourceType,LabelValuePair:Yt.LabelValuePair,Language:Yt.Language,LanguageMap:Yt.LanguageMap,ManifestType:new Yt.ManifestType,MediaType:new Yt.MediaType,RenderingFormat:new Yt.RenderingFormat,ResourceType:new Yt.ResourceType,ServiceProfile:new Yt.ServiceProfile,Size:Yt.Size,TreeNode:Yt.TreeNode,TreeNodeType:new Yt.TreeNodeType,Utils:Yt.Utils,ViewingDirection:new Yt.ViewingDirection,ViewingHint:new Yt.ViewingHint,Annotation:Yt.Annotation,AnnotationBody:Yt.AnnotationBody,AnnotationList:Yt.AnnotationList,AnnotationPage:Yt.AnnotationPage,Canvas:Yt.Canvas,Collection:Yt.Collection,Duration:Yt.Duration,Manifest:Yt.Manifest,Range:Yt.Range,Sequence:Yt.Sequence,Service:Yt.Service,Thumbnail:Yt.Thumbnail,Thumb:Yt.Thumb,StatusCodes:{AUTHORIZATION_FAILED:1,FORBIDDEN:2,INTERNAL_SERVER_ERROR:3,RESTRICTED:4},create:function(e,t){return Yt.Deserialiser.parse(e,t)},loadManifest:function(e){return Yt.Utils.loadResource(e)}};var At,Lt,kt,Mt;c=this&&this.__extends||(At=function(e,t){return(At=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}At(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Nt(e,t){return kt.call(this,e,t)||this}Lt=Yt=Yt||{},kt=Lt.ManifestResource,c(Nt,kt),Nt.prototype.getBody=function(){var e=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var i=0;i<t.length;i++)if((o=t[i]).items)for(var n=0;n<o.items.length;n++){var r=o.items[n];e.push(new Lt.AnnotationBody(r,this.options))}else e.push(new Lt.AnnotationBody(o,this.options));else if(t.items)for(i=0;i<t.items.length;i++){var o=t.items[i];e.push(new Lt.AnnotationBody(o,this.options))}else e.push(new Lt.AnnotationBody(t,this.options));return e},Nt.prototype.getMotivation=function(){var e=this.getProperty("motivation");return e?new Lt.AnnotationMotivation(e.toLowerCase()):null},Nt.prototype.getOn=function(){return this.getProperty("on")},Nt.prototype.getTarget=function(){return this.getProperty("target")},Nt.prototype.getResource=function(){return new Lt.Resource(this.getProperty("resource"),this.options)},Mt=Nt,Lt.Annotation=Mt;var Dt,Ft,Ht,Bt;c=this&&this.__extends||(Dt=function(e,t){return(Dt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Dt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Gt(e,t){return Ht.call(this,e,t)||this}Ft=Yt=Yt||{},Ht=Ft.ManifestResource,c(Gt,Ht),Gt.prototype.getFormat=function(){var e=this.getProperty("format");return e?new Ft.MediaType(Ft.Utils.getMediaType(e)):null},Gt.prototype.getType=function(){return this.getProperty("type")?new Ft.ResourceType(Ft.Utils.normaliseType(this.getProperty("type"))):null},Gt.prototype.getWidth=function(){return this.getProperty("width")},Gt.prototype.getHeight=function(){return this.getProperty("height")},Bt=Gt,Ft.AnnotationBody=Bt;var Ut,zt,jt,Vt;c=this&&this.__extends||(Ut=function(e,t){return(Ut=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Ut(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function qt(e,t,i){var n=jt.call(this,t)||this;return n.label=e,n.options=i,n}zt=Yt=Yt||{},jt=zt.JSONLDResource,c(qt,jt),qt.prototype.getIIIFResourceType=function(){return new zt.IIIFResourceType(zt.Utils.normaliseType(this.getProperty("type")))},qt.prototype.getLabel=function(){return this.label},qt.prototype.getResources=function(){var t=this;return this.getProperty("resources").map(function(e){return new zt.Annotation(e,t.options)})},qt.prototype.load=function(){var n=this;return new Promise(function(t,e){if(n.isLoaded)t(n);else{var i=n.__jsonld.id;i=i||n.__jsonld["@id"],zt.Utils.loadResource(i).then(function(e){n.__jsonld=JSON.parse(e),n.context=n.getProperty("context"),n.id=n.getProperty("id"),n.isLoaded=!0,t(n)}).catch(e)}})},Vt=qt,zt.AnnotationList=Vt;var Wt,$t,Kt,Xt;c=this&&this.__extends||(Wt=function(e,t){return(Wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Wt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function Zt(e,t){return Kt.call(this,e,t)||this}$t=Yt=Yt||{},Kt=$t.ManifestResource,c(Zt,Kt),Zt.prototype.getItems=function(){return this.getProperty("items")},Xt=Zt,$t.AnnotationPage=Xt;var Qt,Yt,Jt,ei,ti;c=this&&this.__extends||(Qt=function(e,t){return(Qt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Qt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});function ii(e,t){return ei.call(this,e,t)||this}Jt=Yt=Yt||{},ei=Jt.Resource,c(ii,ei),ti=ii,Jt.Thumbnail=ti}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{http:65,https:52,url:82}],58:[function(require,module,exports){function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}var Pka,Qka,Rka,Ska,Yka,gta,nta,Fta,Gta,Hta,Ita,Sya,gAa,hAa,vAa,OAa,ACa,LDa,aFa,oFa,GFa,_Fa,LGa,lHa,qHa,SHa,_Ha,KJa,LJa,RKa,YKa,kLa,LLa,lMa,kNa,QOa,tSa,MXa,rYa;function ota(e,t){var i,n=e.controls;for(i=n.length-1;0<=i;i--)if(n[i].element==t)return i;return-1}function Jta(e){return e=Gta.getElement(e),new Gta.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function Lta(e,t){if(t instanceof Gta.Overlay)return t;var i=null;if(t.element)i=Gta.getElement(t.element);else{var n=t.id?t.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(i=Gta.getElement(t.id))||((i=document.createElement("a")).href="#/overlay/"+n),i.id=n,Gta.addClass(i,t.className?t.className:"openseadragon-overlay")}var r=t.location,o=t.width,s=t.height;if(!r){var a=t.x,l=t.y;if(void 0!==t.px){var u=e.viewport.imageToViewportRectangle(new Gta.Rect(t.px,t.py,o||0,s||0));a=u.x,l=u.y,o=void 0!==o?u.width:void 0,s=void 0!==s?u.height:void 0}r=new Gta.Point(a,l)}var h=t.placement;return h&&"string"===Gta.type(h)&&(h=Gta.Placement[t.placement.toUpperCase()]),new Gta.Overlay({element:i,location:r,placement:h,onDraw:t.onDraw,checkResize:t.checkResize,width:o,height:s,rotationMode:t.rotationMode})}function Mta(e,t){var i;for(i=e.length-1;0<=i;i--)if(e[i].element===t)return i;return-1}function Nta(e,t){return Gta.requestAnimationFrame(function(){t(e)})}function Ota(e){Gta.requestAnimationFrame(function(){!function(e){var t,i,n,r;if(e.controlsShouldFade){for(t=Gta.now(),i=t-e.controlsFadeBeginTime,n=1-i/e.controlsFadeLength,n=Math.min(1,n),n=Math.max(0,n),r=e.controls.length-1;0<=r;r--)e.controls[r].autoFade&&e.controls[r].setOpacity(n);0<n&&Ota(e)}}(e)})}function Pta(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=Gta.now()+e.controlsFadeDelay,window.setTimeout(function(){Ota(e)},e.controlsFadeDelay))}function Rta(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;0<=t;t--)e.controls[t].setOpacity(1)}function Sta(){Rta(this)}function Tta(){Pta(this)}function Uta(e){var t={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function Vta(e){var t={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new Gta.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(Gta.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(Gta.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(Gta.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(Gta.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function Wta(e){var t;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var i={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-click",i),!i.preventDefaultAction&&this.viewport&&e.quick&&(t=this.gestureSettingsByDeviceType(e.pointerType)).clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function Xta(e){var t,i={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-double-click",i),!i.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function Yta(e){var t,i={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.raiseEvent("canvas-drag",i),!i.preventDefaultAction&&this.viewport){if(t=this.gestureSettingsByDeviceType(e.pointerType),this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan){var n=this.viewport.deltaPointsFromPixels(e.delta.negate());this.viewport.centerSpringX.target.value+=n.x,this.viewport.centerSpringY.target.value+=n.y;var r=this.viewport.getBounds(),o=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=n.x,this.viewport.centerSpringY.target.value-=n.y,r.x!=o.x&&(e.delta.x=0),r.y!=o.y&&(e.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),t.flickEnabled&&!this.constrainDuringPan)}}function Zta(e){if(!e.preventDefaultAction&&this.viewport){var t=this.gestureSettingsByDeviceType(e.pointerType);if(t.flickEnabled&&e.speed>=t.flickMinSpeed){var i=0;this.panHorizontal&&(i=t.flickMomentum*e.speed*Math.cos(e.direction));var n=0;this.panVertical&&(n=t.flickMomentum*e.speed*Math.sin(e.direction));var r=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),o=this.viewport.pointFromPixel(new Gta.Point(r.x-i,r.y-n));this.viewport.panTo(o,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:e.eventSource,position:e.position,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent})}function $ta(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function _ta(e){window.location!=window.parent.location&&Gta.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function aua(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function bua(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function cua(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function dua(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function eua(e){var t,i,n;if(!e.preventDefaultAction&&this.viewport&&((t=this.gestureSettingsByDeviceType(e.pointerType)).pinchToZoom&&(i=this.viewport.pointFromPixel(e.center,!0),n=this.viewport.pointFromPixel(e.lastCenter,!0).minus(i),this.panHorizontal||(n.x=0),this.panVertical||(n.y=0),this.viewport.zoomBy(e.distance/e.lastDistance,i,!0),t.zoomToRefPoint&&this.viewport.panBy(n,!0),this.viewport.applyConstraints()),t.pinchRotate)){var r=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),o=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(r-o)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:e.eventSource,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent}),!1}function fua(e){var t,i,n;if((n=Gta.now())-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=n,this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),!e.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).scrollToZoom&&(i=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(i,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),t&&t.scrollToZoom)return!1}else if((t=this.gestureSettingsByDeviceType(e.pointerType))&&t.scrollToZoom)return!1}function gua(e){Hta[this.hash].mouseInside=!0,Rta(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function hua(e){e.pointers<1&&(Hta[this.hash].mouseInside=!1,Hta[this.hash].animating||Pta(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function iua(e){!function(e){if(e._opening)return;if(e.autoResize){var t=Jta(e.container),i=Hta[e.hash].prevContainerSize;if(!t.equals(i)){var n=e.viewport;if(e.preserveImageSizeOnResize){var r=i.x/t.x,o=n.getZoom()*r,s=n.getCenter();n.resize(t,!1),n.zoomTo(o,null,!0),n.panTo(s,!0)}else{var a=n.getBounds();n.resize(t,!0),n.fitBoundsWithConstraints(a,!0)}Hta[e.hash].prevContainerSize=t,Hta[e.hash].forceRedraw=!0}}var l=e.viewport.update(),u=e.world.update()||l;l&&e.raiseEvent("viewport-change");e.referenceStrip&&(u=e.referenceStrip.update(e.viewport)||u);!Hta[e.hash].animating&&u&&(e.raiseEvent("animation-start"),Rta(e));(u||Hta[e.hash].forceRedraw||e.world.needsDraw())&&(function(e){e.imageLoader.clear(),e.drawer.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),Hta[e.hash].forceRedraw=!1,u&&e.raiseEvent("animation"));Hta[e.hash].animating&&!u&&(e.raiseEvent("animation-finish"),Hta[e.hash].mouseInside||Pta(e));Hta[e.hash].animating=u}(e),e.isOpen()?e._updateRequestId=Nta(e,iua):e._updateRequestId=!1}function lua(e,t){return e?e+t:t}function mua(){Hta[this.hash].lastZoomTime=Gta.now(),Hta[this.hash].zoomFactor=this.zoomPerSecond,Hta[this.hash].zooming=!0,pua(this)}function nua(){Hta[this.hash].lastZoomTime=Gta.now(),Hta[this.hash].zoomFactor=1/this.zoomPerSecond,Hta[this.hash].zooming=!0,pua(this)}function oua(){Hta[this.hash].zooming=!1}function pua(e){Gta.requestAnimationFrame(Gta.delegate(e,qua))}function qua(){var e,t,i;Hta[this.hash].zooming&&this.viewport&&(t=(e=Gta.now())-Hta[this.hash].lastZoomTime,i=Math.pow(Hta[this.hash].zoomFactor,t/1e3),this.viewport.zoomBy(i),this.viewport.applyConstraints(),Hta[this.hash].lastZoomTime=e,pua(this))}function rua(){this.viewport&&(Hta[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function sua(){this.viewport&&(Hta[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function tua(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function uua(){this.viewport&&this.viewport.goHome()}function vua(){this.isFullPage()&&!Gta.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function wua(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?Gta.positiveModulo(e+this.rotationIncrement,360):Gta.positiveModulo(e-this.rotationIncrement,360),this.viewport.setRotation(e)}}function xua(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?Gta.positiveModulo(e-this.rotationIncrement,360):Gta.positiveModulo(e+this.rotationIncrement,360),this.viewport.setRotation(e)}}function yua(){this.viewport.toggleFlip()}function zua(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)}function Aua(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}function Tya(e){var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",t),!t.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var i=this.viewport.pointFromPixel(e.position);this.panVertical?this.panHorizontal||(i.x=this.viewer.viewport.getCenter(!0).x):i.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(i),this.viewer.viewport.applyConstraints()}}function Uya(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function Vya(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function Wya(e){return this.viewer.raiseEvent("navigator-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function Xya(e,t){Yya(e,"rotate("+t+"deg)")}function Yya(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}function CCa(e,t){var i,n,r=t.Image,o=r.Url,s=r.Format,a=r.Size,l=r.DisplayRect||[],u=parseInt(a.Width,10),h=parseInt(a.Height,10),c=parseInt(r.TileSize,10),p=parseInt(r.Overlap,10),d=[];for(n=0;n<l.length;n++)i=l[n].Rect,d.push(new ACa.DisplayRect(parseInt(i.X,10),parseInt(i.Y,10),parseInt(i.Width,10),parseInt(i.Height,10),parseInt(i.MinLevel,10),parseInt(i.MaxLevel,10)));return ACa.extend(!0,{width:u,height:h,tileSize:c,tileOverlap:p,minLevel:null,maxLevel:null,tilesUrl:o,fileFormat:s,displayRects:d},t)}function cGa(e,t){return t.levels}function rHa(e){qHa.requestAnimationFrame(function(){!function(e){var t,i,n;e.shouldFade&&(t=qHa.now(),i=t-e.fadeBeginTime,n=1-i/e.fadeLength,n=Math.min(1,n),n=Math.max(0,n),e.imgGroup&&qHa.setElementOpacity(e.imgGroup,n,!0),0<n&&rHa(e))}(e)})}function vHa(e,t){e.element.disabled||(t>=qHa.ButtonState.GROUP&&e.currentState==qHa.ButtonState.REST&&(function(e){e.shouldFade=!1,e.imgGroup&&qHa.setElementOpacity(e.imgGroup,1,!0)}(e),e.currentState=qHa.ButtonState.GROUP),t>=qHa.ButtonState.HOVER&&e.currentState==qHa.ButtonState.GROUP&&(e.imgHover&&(e.imgHover.style.visibility=""),e.currentState=qHa.ButtonState.HOVER),t>=qHa.ButtonState.DOWN&&e.currentState==qHa.ButtonState.HOVER&&(e.imgDown&&(e.imgDown.style.visibility=""),e.currentState=qHa.ButtonState.DOWN))}function wHa(e,t){e.element.disabled||(t<=qHa.ButtonState.HOVER&&e.currentState==qHa.ButtonState.DOWN&&(e.imgDown&&(e.imgDown.style.visibility="hidden"),e.currentState=qHa.ButtonState.HOVER),t<=qHa.ButtonState.GROUP&&e.currentState==qHa.ButtonState.HOVER&&(e.imgHover&&(e.imgHover.style.visibility="hidden"),e.currentState=qHa.ButtonState.GROUP),t<=qHa.ButtonState.REST&&e.currentState==qHa.ButtonState.GROUP&&(function(e){e.shouldFade=!0,e.fadeBeginTime=qHa.now()+e.fadeDelay,window.setTimeout(function(){rHa(e)},e.fadeDelay)}(e),e.currentState=qHa.ButtonState.REST))}function MJa(e){var t=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),n=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),o=KJa.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?0<-e.delta.x?t>-(n-o.x)&&(this.element.style.marginLeft=t+2*e.delta.x+"px",OJa(this,o.x,t+2*e.delta.x)):-e.delta.x<0&&t<0&&(this.element.style.marginLeft=t+2*e.delta.x+"px",OJa(this,o.x,t+2*e.delta.x)):0<-e.delta.y?i>-(r-o.y)&&(this.element.style.marginTop=i+2*e.delta.y+"px",OJa(this,o.y,i+2*e.delta.y)):-e.delta.y<0&&i<0&&(this.element.style.marginTop=i+2*e.delta.y+"px",OJa(this,o.y,i+2*e.delta.y))),!1}function NJa(e){var t=Number(this.element.style.marginLeft.replace("px","")),i=Number(this.element.style.marginTop.replace("px","")),n=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),o=KJa.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?0<e.scroll?t>-(n-o.x)&&(this.element.style.marginLeft=t-60*e.scroll+"px",OJa(this,o.x,t-60*e.scroll)):e.scroll<0&&t<0&&(this.element.style.marginLeft=t-60*e.scroll+"px",OJa(this,o.x,t-60*e.scroll)):e.scroll<0?i>o.y-r&&(this.element.style.marginTop=i+60*e.scroll+"px",OJa(this,o.y,i+60*e.scroll)):0<e.scroll&&i<0&&(this.element.style.marginTop=i+60*e.scroll+"px",OJa(this,o.y,i+60*e.scroll))),!1}function OJa(e,t,i){var n,r,o,s,a,l,u;for(n="horizontal"==e.scroll?e.panelWidth:e.panelHeight,r=Math.ceil(t/n)+5,l=r=(r=(o=Math.ceil((Math.abs(i)+t)/n)+1)-r)<0?0:r;l<o&&l<e.panels.length;l++)if(!(u=e.panels[l]).activePanel){var h,c=e.viewer.tileSources[l];h=c.referenceStripThumbnailUrl?{type:"image",url:c.referenceStripThumbnailUrl}:c,(s=new KJa.Viewer({id:u.id,tileSources:[h],element:u,navigatorSizeRatio:e.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0})).displayRegion=KJa.makeNeutralElement("div"),s.displayRegion.id=u.id+"-displayregion",s.displayRegion.className="displayregion",(a=s.displayRegion.style).position="relative",a.top="0px",a.left="0px",a.fontSize="0px",a.overflow="hidden",a.float="left",a.cssFloat="left",a.styleFloat="left",a.zIndex=999999999,a.cursor="default",a.width=e.panelWidth-4+"px",a.height=e.panelHeight-4+"px",s.displayRegion.innerTracker=new KJa.MouseTracker({element:s.displayRegion,startDisabled:!0}),u.getElementsByTagName("div")[0].appendChild(s.displayRegion),e.miniViewers[u.id]=s,u.activePanel=!0}}function PJa(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="0px":t.style.marginLeft="0px",!1}function QJa(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="-"+KJa.getElementSize(t).y/2+"px":t.style.marginLeft="-"+KJa.getElementSize(t).x/2+"px",!1}function RJa(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function SJa(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 61:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return NJa.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function lLa(e){kLa.extend(!0,this,{timeout:kLa.DEFAULT_SETTINGS.timeout,jobId:null},e),this.image=null}function uSa(e,t,i,n,r,o,s,a,l){var u=s.getBoundingBox().getTopLeft(),h=s.getBoundingBox().getBottomRight();e.viewer&&e.viewer.raiseEvent("update-level",{tiledImage:e,havedrawn:t,level:n,opacity:r,visibility:o,drawArea:s,topleft:u,bottomright:h,currenttime:a,best:l}),FSa(e.coverage,n),FSa(e.loadingCoverage,n);for(var c=e._getCornerTiles(n,u,h),p=c.topLeft,d=c.bottomRight,f=e.source.getNumTiles(n),g=e.viewport.pixelFromPoint(e.viewport.getCenter()),m=p.x;m<=d.x;m++)for(var v=p.y;v<=d.y;v++){if(!e.wrapHorizontal&&!e.wrapVertical){var y=e.source.getTileBounds(n,m,v);if(null===s.intersection(y))continue}l=vSa(e,i,t,m,v,n,r,o,g,f,a,l)}return l}function vSa(e,t,i,n,r,o,s,a,l,u,h,c){var p=function(e,t,i,n,r,o,s,a,l,u){var h,c,p,d,f,g,m,v,y;o[i]||(o[i]={});o[i][e]||(o[i][e]={});o[i][e][t]||(h=(a.x+e%a.x)%a.x,c=(a.y+t%a.y)%a.y,p=r.getTileBounds(i,h,c),d=r.getTileBounds(i,h,c,!0),f=r.tileExists(i,h,c),g=r.getTileUrl(i,h,c),n.loadTilesWithAjax?(m=r.getTileAjaxHeaders(i,h,c),tSa.isPlainObject(n.ajaxHeaders)&&(m=tSa.extend({},n.ajaxHeaders,m))):m=null,v=r.getContext2D?r.getContext2D(i,h,c):void 0,p.x+=(e-h)/a.x,p.y+=u/l*((t-c)/a.y),y=new tSa.Tile(i,e,t,p,f,g,v,n.loadTilesWithAjax,m,d),h==a.x-1&&(y.isRightMost=!0),c==a.y-1&&(y.isBottomMost=!0),o[i][e][t]=y);return(y=o[i][e][t]).lastTouchTime=s,y}(n,r,o,e,e.source,e.tilesMatrix,h,u,e._worldWidthCurrent,e._worldHeightCurrent),d=i;e.viewer&&e.viewer.raiseEvent("update-tile",{tiledImage:e,tile:p}),ESa(e.coverage,o,n,r,!1);var f=p.loaded||p.loading||DSa(e.loadingCoverage,o,n,r);if(ESa(e.loadingCoverage,o,n,r,f),!p.exists)return c;if(t&&!d&&(DSa(e.coverage,o,n,r)?ESa(e.coverage,o,n,r,!0):d=!0),!d)return c;if(function(e,t,i,n,r,o){var s=e.bounds.getTopLeft();s.x*=o._scaleSpring.current.value,s.y*=o._scaleSpring.current.value,s.x+=o._xSpring.current.value,s.y+=o._ySpring.current.value;var a=e.bounds.getSize();a.x*=o._scaleSpring.current.value,a.y*=o._scaleSpring.current.value;var l=i.pixelFromPointNoRotate(s,!0),u=i.pixelFromPointNoRotate(s,!1),h=i.deltaPixelsFromPointsNoRotate(a,!0),c=i.deltaPixelsFromPointsNoRotate(a,!1),p=u.plus(c.divide(2)),d=n.squaredDistanceTo(p);t||(h=h.plus(new tSa.Point(1,1)));e.isRightMost&&o.wrapHorizontal&&(h.x+=.75);e.isBottomMost&&o.wrapVertical&&(h.y+=.75);e.position=l,e.size=h,e.squaredDistance=d,e.visibility=r}(p,e.source.tileOverlap,e.viewport,l,a,e),!p.loaded)if(p.context2D)zSa(e,p);else{var g=e._tileCache.getImageRecord(p.cacheKey);if(g)zSa(e,p,g.getImage())}p.loaded?function(e,t,i,n,r,o,s){var a,l,u=1e3*e.blendTime;t.blendStart||(t.blendStart=s);a=s-t.blendStart,l=u?Math.min(1,a/u):1,e.alwaysBlend&&(l*=o);if(t.opacity=l,e.lastDrawn.push(t),1===l)ESa(e.coverage,r,i,n,!0),e._hasOpaqueTile=!0;else if(a<u)return!0;return!1}(e,p,n,r,o,s,h)&&(e._needsDraw=!0):p.loading?e._tilesLoading++:f||(c=function(e,t){if(!e)return t;{if(t.visibility>e.visibility)return t;if(t.visibility==e.visibility&&t.squaredDistance<e.squaredDistance)return t}return e}(c,p));return c}function zSa(e,t,i,n,r){var o=0;function s(){return o++,a}function a(){0===--o&&(t.loading=!1,t.loaded=!0,t.context2D||e._tileCache.cacheTile({image:i,tile:t,cutoff:n,tiledImage:e}),e._needsDraw=!0)}e.viewer.raiseEvent("tile-loaded",{tile:t,tiledImage:e,tileRequest:r,image:i,getCompletionCallback:s}),s()()}function CSa(e,t,i,n){var r,o,s,a;if(!e[t])return!1;if(void 0!==i&&void 0!==n)return void 0===e[t][i]||void 0===e[t][i][n]||!0===e[t][i][n];for(s in r=e[t])if(r.hasOwnProperty(s))for(a in o=r[s])if(o.hasOwnProperty(a)&&!o[a])return!1;return!0}function DSa(e,t,i,n){return void 0===i||void 0===n?CSa(e,t+1):CSa(e,t+1,2*i,2*n)&&CSa(e,t+1,2*i,2*n+1)&&CSa(e,t+1,2*i+1,2*n)&&CSa(e,t+1,2*i+1,2*n+1)}function ESa(e,t,i,n,r){e[t]?(e[t][i]||(e[t][i]={}),e[t][i][n]=r):tSa.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",t)}function FSa(e,t){e[t]={}}function NXa(e){MXa.console.assert(e,"[TileCache.cacheTile] options is required"),MXa.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),MXa.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=e.tile,this.tiledImage=e.tiledImage}function OXa(e){MXa.console.assert(e,"[ImageRecord] options is required"),MXa.console.assert(e.image,"[ImageRecord] options.image is required"),this._image=e.image,this._tiles=[]}!function(n){n.version={versionStr:"2.4.1",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("1",10)};var e,t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},i=Object.prototype.toString,r=Object.prototype.hasOwnProperty;n.isFunction=function(e){return"function"===n.type(e)},n.isArray=Array.isArray||function(e){return"array"===n.type(e)},n.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},n.type=function(e){return null==e?String(e):t[i.call(e)]||"object"},n.isPlainObject=function(e){if(!e||"object"!==OpenSeadragon.type(e)||e.nodeType||n.isWindow(e))return!1;if(e.constructor&&!r.call(e,"constructor")&&!r.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(var i in e)t=i;return void 0===t||r.call(e,t)},n.isEmptyObject=function(e){for(var t in e)return!1;return!0},n.freezeObject=function(e){return Object.freeze?n.freezeObject=Object.freeze:n.freezeObject=function(e){return e},n.freezeObject(e)},n.supportsCanvas=(e=document.createElement("canvas"),!(!n.isFunction(e.getContext)||!e.getContext("2d"))),n.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){t=!0}return t},n.pixelDensityRatio=function(){if(n.supportsCanvas){var e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return Math.max(t,1)/i}return 1}()}(OpenSeadragon),function($){$.extend=function(){var e,t,i,n,r,o,s=arguments[0]||{},a=arguments.length,l=!1,u=1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},u=2),"object"==typeof s||OpenSeadragon.isFunction(s)||(s={}),a===u&&(s=this,--u);u<a;u++)if(null!==(e=arguments[u])||void 0!==e)for(t in e)i=s[t],s!==(n=e[t])&&(l&&n&&(OpenSeadragon.isPlainObject(n)||(r=OpenSeadragon.isArray(n)))?(o=r?(r=!1,i&&OpenSeadragon.isArray(i)?i:[]):i&&OpenSeadragon.isPlainObject(i)?i:{},s[t]=OpenSeadragon.extend(l,o,n)):void 0!==n&&(s[t]=n));return s};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var e=navigator.userAgent;return"string"==typeof e&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(t,i){return function(){var e=arguments;return void 0===e&&(e=[]),i.apply(t,e)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(e){var t,i,n=new $.Point;for(i=getOffsetParent(e=$.getElement(e),t="fixed"==$.getElementStyle(e).position);i;)n.x+=e.offsetLeft,n.y+=e.offsetTop,t&&(n=n.plus($.getPageScroll())),i=getOffsetParent(e=i,t="fixed"==$.getElementStyle(e).position);return n},getElementOffset:function(e){var t,i,n=(e=$.getElement(e))&&e.ownerDocument,r={top:0,left:0};return n?(t=n.documentElement,void 0!==e.getBoundingClientRect&&(r=e.getBoundingClientRect()),i=n==n.window?n:9===n.nodeType&&(n.defaultView||n.parentWindow),new $.Point(r.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0),r.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return(e=$.getElement(e)).currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var a={};return $.getCssPropertyWithVendorPrefix=function(e){if(void 0!==a[e])return a[e];var t=document.createElement("div").style,i=null;if(void 0!==t[e])i=e;else for(var n=["Webkit","Moz","MS","O","webkit","moz","ms","o"],r=$.capitalizeFirstLetter(e),o=0;o<n.length;o++){var s=n[o]+r;if(void 0!==t[s]){i=s;break}}return a[e]=i},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var i=e%t;return i<0&&(i+=t),i},pointInElement:function(e,t){e=$.getElement(e);var i=$.getElementOffset(e),n=$.getElementSize(e);return t.x>=i.x&&t.x<i.x+n.x&&t.y<i.y+n.y&&t.y>=i.y},getEvent:function(e){return $.getEvent=e?function(e){return e}:function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if("number"==typeof e.pageX)$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.pageX,t.y=e.pageY,t};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,t}}return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(e){if(void 0!==window.scrollTo)$.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var t=$.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var i=$.getPageScroll();if(i.x!==t.x&&i.y!==t.y)return void($.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,(i=$.getPageScroll()).x!==t.x&&i.y!==t.y)return void($.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});$.setPageScroll=function(e){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!t.clientWidth&&!t.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var t=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(t[1].style,{display:"table-row"}),$.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e),i=t.style;return i.background="transparent none",i.border="none",i.margin="0px",i.padding="0px",i.position="static",t},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(e){var t=$.makeNeutralElement("img");return t.src=e,t},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(e){var t=$.makeNeutralElement("img"),i=null;return(i=$.makeNeutralElement("span")).style.display="inline-block",t.onload=function(){i.style.width=i.style.width||t.width+"px",i.style.height=i.style.height||t.height+"px",t.onload=null,t=null},t.src=e,i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')",i}),$.makeTransparentImage(e)},setElementOpacity:function(e,t,i){var n;e=$.getElement(e),i&&!$.Browser.alpha&&(t=Math.round(t)),$.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(n="alpha(opacity="+Math.round(100*t)+")",e.style.filter=n):e.style.filter=""},setElementTouchActionNone:function(e){void 0!==(e=$.getElement(e)).style.touchAction?e.style.touchAction="none":void 0!==e.style.msTouchAction&&(e.style.msTouchAction="none")},addClass:function(e,t){(e=$.getElement(e)).className?-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,i){return Array.prototype.indexOf?this.indexOf=function(e,t,i){return e.indexOf(t,i)}:this.indexOf=function(e,t,i){var n,r,o=i||0;if(!e)throw new TypeError;if(0===(r=e.length)||r<=o)return-1;for(o<0&&(o=r-Math.abs(o)),n=o;n<r;n++)if(e[n]===t)return n;return-1},this.indexOf(e,t,i)},removeClass:function(e,t){var i,n,r=[];for(i=(e=$.getElement(e)).className.split(/\s+/),n=0;n<i.length;n++)i[n]&&i[n]!==t&&r.push(i[n]);e.className=r.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,t,i,n){(e=$.getElement(e)).addEventListener(t,i,n)};if(window.attachEvent)return function(e,t,i,n){(e=$.getElement(e)).attachEvent("on"+t,i)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,t,i,n){(e=$.getElement(e)).removeEventListener(t,i,n)};if(window.detachEvent)return function(e,t,i,n){(e=$.getElement(e)).detachEvent("on"+t,i)};throw new Error("No known event model.")}(),cancelEvent:function(e){(e=$.getEvent(e)).preventDefault?$.cancelEvent=function(e){e.preventDefault()}:$.cancelEvent=function(e){(e=$.getEvent(e)).cancel=!0,e.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){(e=$.getEvent(e)).stopPropagation?$.stopEvent=function(e){e.stopPropagation()}:$.stopEvent=function(e){(e=$.getEvent(e)).cancelBubble=!0},$.stopEvent(e)},createCallback:function(i,n){var e,r=[];for(e=2;e<arguments.length;e++)r.push(arguments[e]);return function(){var e,t=r.concat([]);for(e=0;e<arguments.length;e++)t.push(arguments[e]);return n.apply(i,t)}},getUrlParameter:function(e){var t=URLPARAMS[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return null===t?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}if(t)window.XMLHttpRequest?$.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(e)},makeAjaxRequest:function(e,i,n){var t,r,o;$.isPlainObject(e)&&(i=e.success,n=e.error,t=e.withCredentials,r=e.headers,o=e.responseType||null,e=e.url);var s=$.getUrlProtocol(e),a=$.createAjaxRequest("file:"===s);if(!$.isFunction(i))throw new Error("makeAjaxRequest requires a success callback");a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=function(){},200<=a.status&&a.status<300||0===a.status&&"http:"!==s&&"https:"!==s?i(a):($.console.log("AJAX request returned %d: %s",a.status,e),$.isFunction(n)&&n(a)))};try{if(a.open("GET",e,!0),o&&(a.responseType=o),r)for(var l in r)r.hasOwnProperty(l)&&r[l]&&a.setRequestHeader(l,r[l]);t&&(a.withCredentials=!0),a.send(null)}catch(t){var u=t.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&void 0!==t.number&&-2147024891==t.number&&(u+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",t.name,u),a.onreadystatechange=function(){},window.XDomainRequest){var h=new XDomainRequest;if(h){h.onload=function(e){$.isFunction(i)&&i({responseText:h.responseText,status:200,statusText:"OK"})},h.onerror=function(e){$.isFunction(n)&&n({responseText:h.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{h.open("GET",e),h.send()}catch(e){$.isFunction(n)&&n(a,t)}}}else $.isFunction(n)&&n(a,t)}return a},jsonp:function(e){var i,t=e.url,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,r=e.callbackName||"openseadragon"+$.now(),o=window[r],s="$1"+r+"$2",a=e.param||"callback",l=e.callback;t=t.replace(/(\=)\?(&|$)|\?\?/i,s),t+=(/\?/.test(t)?"&":"?")+a+"="+r,window[r]=function(e){if(o)window[r]=o;else try{delete window[r]}catch(e){}l&&$.isFunction(l)&&l(e)},i=document.createElement("script"),void 0===e.async&&!1===e.async||(i.async="async"),e.scriptCharset&&(i.charset=e.scriptCharset),i.src=t,i.onload=i.onreadystatechange=function(e,t){!t&&i.readyState&&!/loaded|complete/.test(i.readyState)||(i.onload=i.onreadystatechange=null,n&&i.parentNode&&n.removeChild(i),i=void 0)},n.insertBefore(i,n.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(e){return(new DOMParser).parseFromString(e,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(e){var t=null;return(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t}}return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return!!FILEFORMATS[(e=e||"").toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var e=navigator.appVersion,t=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(0<=t.indexOf("Firefox")?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):0<=t.indexOf("Safari")?($.Browser.vendor=0<=t.indexOf("Chrome")?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(t)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(e)}var i,n,r,o=window.location.search.substring(1).split("&");for(r=0;r<o.length;r++)0<(n=(i=o[r]).indexOf("="))&&(URLPARAMS[i.substring(0,n)]=decodeURIComponent(i.substring(n+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(e){};function getOffsetParent(e,t){return t&&e!=document.body?document.body:e.offsetParent}$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(e){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,i=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(t&&i)$.requestAnimationFrame=function(){return t.apply(e,arguments)},$.cancelAnimationFrame=function(){return i.apply(e,arguments)};else{var n,r=[],o=[],s=0;$.requestAnimationFrame=function(e){return r.push([++s,e]),n=n||setInterval(function(){if(r.length){var e=$.now(),t=o;for(o=r,r=t;o.length;)o.shift()[1](e)}else clearInterval(n),n=void 0},20),s},$.cancelAnimationFrame=function(e){var t,i;for(t=0,i=r.length;t<i;t+=1)if(r[t][0]===e)return void r.splice(t,1);for(t=0,i=o.length;t<i;t+=1)if(o[t][0]===e)return void o.splice(t,1)}}}(window)}(OpenSeadragon),Pka=this,Qka=function(){return OpenSeadragon},"function"==typeof define&&define.amd?define([],Qka):"object"==typeof module&&module.exports?module.exports=Qka():Pka.OpenSeadragon=Qka(),Rka=OpenSeadragon,Ska={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""},document.exitFullscreen?(Ska.supportsFullScreen=!0,Ska.getFullScreenElement=function(){return document.fullscreenElement},Ska.requestFullScreen=function(e){return e.requestFullscreen()},Ska.exitFullScreen=function(){document.exitFullscreen()},Ska.fullScreenEventName="fullscreenchange",Ska.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(Ska.supportsFullScreen=!0,Ska.getFullScreenElement=function(){return document.msFullscreenElement},Ska.requestFullScreen=function(e){return e.msRequestFullscreen()},Ska.exitFullScreen=function(){document.msExitFullscreen()},Ska.fullScreenEventName="MSFullscreenChange",Ska.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(Ska.supportsFullScreen=!0,Ska.getFullScreenElement=function(){return document.webkitFullscreenElement},Ska.requestFullScreen=function(e){return e.webkitRequestFullscreen()},Ska.exitFullScreen=function(){document.webkitExitFullscreen()},Ska.fullScreenEventName="webkitfullscreenchange",Ska.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(Ska.supportsFullScreen=!0,Ska.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},Ska.requestFullScreen=function(e){return e.webkitRequestFullScreen()},Ska.exitFullScreen=function(){document.webkitCancelFullScreen()},Ska.fullScreenEventName="webkitfullscreenchange",Ska.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(Ska.supportsFullScreen=!0,Ska.getFullScreenElement=function(){return document.mozFullScreenElement},Ska.requestFullScreen=function(e){return e.mozRequestFullScreen()},Ska.exitFullScreen=function(){document.mozCancelFullScreen()},Ska.fullScreenEventName="mozfullscreenchange",Ska.fullScreenErrorEventName="mozfullscreenerror"),Ska.isFullScreen=function(){return null!==Ska.getFullScreenElement()},Ska.cancelFullScreen=function(){Rka.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),Ska.exitFullScreen()},Rka.extend(Rka,Ska),Yka=OpenSeadragon,Yka.EventSource=function(){this.events={}},Yka.EventSource.prototype={addOnceHandler:function(t,i,e,n){var r=this;n=n||1;var o=0,s=function(e){++o===n&&r.removeHandler(t,s),i(e)};this.addHandler(t,s,e)},addHandler:function(e,t,i){var n=this.events[e];n||(this.events[e]=n=[]),t&&Yka.isFunction(t)&&(n[n.length]={handler:t,userData:i||null})},removeHandler:function(e,t){var i,n=this.events[e],r=[];if(n&&Yka.isArray(n)){for(i=0;i<n.length;i++)n[i].handler!==t&&r.push(n[i]);this.events[e]=r}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var r=this.events[e];return r&&r.length?(r=1===r.length?[r[0]]:Array.apply(null,r),function(e,t){var i,n=r.length;for(i=0;i<n;i++)r[i]&&(t.eventSource=e,t.userData=r[i].userData,r[i].handler(t))}):null},raiseEvent:function(e,t){var i=this.getHandler(e);i&&i(this,t=t||{})}},function(m){var l,o,u,e,h=[],v={};function s(e,t){return e.hash.toString()+t.type+t.id.toString()}function n(){var e,t,i,n,r,o,s=l.length,a=m.now();for(n=a-u,u=a,e=0;e<s;e++)(i=(t=l[e]).gPoint).direction=Math.atan2(i.currentPos.y-t.lastPos.y,i.currentPos.x-t.lastPos.x),r=t.lastPos.distanceTo(i.currentPos),t.lastPos=i.currentPos,o=1e3*r/(1+n),i.speed=.75*o+.25*i.speed}function r(e){var t,i=v[e.hash],n=i.activePointersLists.length;for(t=0;t<n;t++)0<i.activePointersLists[t].captureCount&&(m.removeEvent(m.MouseTracker.captureElement,"mousemove",i.mousemovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"mouseup",i.mouseupcaptured,!0),m.removeEvent(m.MouseTracker.captureElement,m.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",i.pointermovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,m.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",i.pointerupcaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"touchmove",i.touchmovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"touchend",i.touchendcaptured,!0),i.activePointersLists[t].captureCount=0);for(t=0;t<n;t++)i.activePointersLists.pop()}function t(e){var t,i,n=v[e.hash];if(n.tracking){for(i=0;i<m.MouseTracker.subscribeEvents.length;i++)t=m.MouseTracker.subscribeEvents[i],m.removeEvent(e.element,t,n[t],!1);r(e),n.tracking=!1}}function a(e,t){var i=v[e.hash];if("pointerevent"===t)return{upName:m.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:i.pointerupcaptured,moveName:m.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:i.pointermovecaptured};if("mouse"===t)return{upName:"mouseup",upHandler:i.mouseupcaptured,moveName:"mousemove",moveHandler:i.mousemovecaptured};if("touch"===t)return{upName:"touchend",upHandler:i.touchendcaptured,moveName:"touchmove",moveHandler:i.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function c(e,t,i){var n,r=e.getActivePointersListByType(t);r.captureCount+=i||1,1===r.captureCount&&(m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?e.element.setCapture(!0):(n=a(e,m.MouseTracker.havePointerEvents?"pointerevent":t),W&&$(window.top)&&m.addEvent(window.top,n.upName,n.upHandler,!0),m.addEvent(m.MouseTracker.captureElement,n.upName,n.upHandler,!0),m.addEvent(m.MouseTracker.captureElement,n.moveName,n.moveHandler,!0)))}function p(e,t,i){var n,r=e.getActivePointersListByType(t);r.captureCount-=i||1,0===r.captureCount&&(m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?e.element.releaseCapture():(n=a(e,m.MouseTracker.havePointerEvents?"pointerevent":t),W&&$(window.top)&&m.removeEvent(window.top,n.upName,n.upHandler,!0),m.removeEvent(m.MouseTracker.captureElement,n.moveName,n.moveHandler,!0),m.removeEvent(m.MouseTracker.captureElement,n.upName,n.upHandler,!0)))}function d(e){var t;if(m.MouseTracker.unprefixedPointerEvents)t=e.pointerType;else switch(e.pointerType){case 2:t="touch";break;case 3:t="pen";break;case 4:t="mouse";break;default:t=""}return t}function f(e){return m.getMousePosition(e)}function g(e,t){return y(f(e),t)}function y(e,t){var i=m.getElementOffset(t);return e.minus(i)}function w(e,t){return new m.Point((e.x+t.x)/2,(e.y+t.y)/2)}function S(e,t){var i={target:(t=m.getEvent(t)).target||t.srcElement,type:"wheel",shiftKey:t.shiftKey||!1,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX?t.pageX:t.clientX,pageY:t.pageY?t.pageY:t.clientY,deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==m.MouseTracker.wheelEventName?i.deltaY=-t.wheelDelta/m.DEFAULT_SETTINGS.pixelsPerWheelLine:i.deltaY=t.detail,_(e,i,t)}function _(e,t,i){var n;n=t.deltaY<0?1:-1,e.scrollHandler&&!1===e.scrollHandler({eventSource:e,pointerType:"mouse",position:g(t,e.element),scroll:n,shift:t.shiftKey,isTouchEvent:!1,originalEvent:i,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(i)}function T(e,t){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e}function b(e,t){U(e,t,[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:f(t),currentTime:m.now()}])}function E(e,t){z(e,t,[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:f(t),currentTime:m.now()}])}function x(e){return m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?1===e?0:2===e?2:4===e?1:-1:e}function P(e,t){V(e,t=m.getEvent(t),[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:f(t),currentTime:m.now()}],x(t.button))&&p(e,"mouse")}function I(e,t){q(e,t=m.getEvent(t),[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:f(t),currentTime:m.now()}])}function C(e,t,i){var n,r=i.getLength(),o=[];if("touch"===i.type||0<i.contacts){for(n=0;n<r;n++)o.push(i.getByIndex(n));0<o.length&&(V(e,t,o,0),i.captureCount=1,p(e,i.type),z(e,t,o))}}function O(e,t){var i,n,r,o,s=t.changedTouches.length,a=[];for(i=m.now(),n=0;n<s;n++)a.push({id:t.changedTouches[n].identifier,type:"touch",currentPos:f(t.changedTouches[n]),currentTime:i});for(V(e,t,a,0)&&p(e,"touch",s),z(e,t,a),n=0;n<h.length;n++)if(h[n]!==e&&h[n].isTracking()&&T(h[n].element,e.element)){for(o=[],r=0;r<s;r++)o.push({id:t.changedTouches[r].identifier,type:"touch",currentPos:f(t.changedTouches[r]),currentTime:i});z(h[n],t,o)}m.cancelEvent(t)}function R(e,t){var i,n=t.changedTouches.length,r=[];for(i=0;i<n;i++)r.push({id:t.changedTouches[i].identifier,type:"touch",currentPos:f(t.changedTouches[i]),currentTime:m.now()});q(e,t,r),m.cancelEvent(t)}function A(e,t){t.currentTarget===t.relatedTarget||T(t.currentTarget,t.relatedTarget)||U(e,t,[{id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:f(t),currentTime:m.now()}])}function L(e,t){t.currentTarget===t.relatedTarget||T(t.currentTarget,t.relatedTarget)||z(e,t,[{id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:f(t),currentTime:m.now()}])}function k(e,t){var i;j(e,t,[i={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:f(t),currentTime:m.now()}],t.button)&&(m.stopEvent(t),c(e,i.type)),(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.cancelEvent(t)}function M(e,t){N(e,t)}function N(e,t){var i;V(e,t,[i={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:f(t),currentTime:m.now()}],t.button)&&p(e,i.type)}function D(e,t){F(e,t)}function F(e,t){q(e,t,[{id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:f(t),currentTime:m.now()}])}function H(e,t){!function(e,t,i){V(e,t,i,0),z(e,t,i)}(e,t,[{id:t.pointerId,type:d(t)}])}function B(e,t){return t.hasOwnProperty("isPrimary")||(0===e.getLength()?t.isPrimary=!0:t.isPrimary=!1),t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function G(e,t){var i,n;return e.getById(t.id)?(i=e.removeById(t.id),t.hasOwnProperty("isPrimary")||(n=e.getPrimary())||(n=e.getByIndex(0))&&(n.isPrimary=!0)):i=e.getLength(),i}function U(e,t,i){var n,r,o,s=e.getActivePointersListByType(i[0].type),a=i.length;for(n=0;n<a;n++)r=i[n],(o=s.getById(r.id))?(o.insideElement=!0,o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=r.currentPos,o.currentTime=r.currentTime,r=o):(r.captured=!1,r.insideElementPressed=!1,r.insideElement=!0,B(s,r)),e.enterHandler&&!1===e.enterHandler({eventSource:e,pointerType:r.type,position:y(r.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:r.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)}function z(e,t,i){var n,r,o,s=e.getActivePointersListByType(i[0].type),a=i.length;for(n=0;n<a;n++)r=i[n],(o=s.getById(r.id))&&(o.captured?(o.insideElement=!1,o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=r.currentPos,o.currentTime=r.currentTime):G(s,o),r=o),e.exitHandler&&!1===e.exitHandler({eventSource:e,pointerType:r.type,position:y(r.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:!!o&&o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)}function j(e,t,i,n){var r,o,s,a=v[e.hash],l=e.getActivePointersListByType(i[0].type),u=i.length;void 0!==t.buttons?l.buttons=t.buttons:m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?0===n?l.buttons+=1:1===n?l.buttons+=4:2===n?l.buttons+=2:3===n?l.buttons+=8:4===n?l.buttons+=16:5===n&&(l.buttons+=32):0===n?l.buttons|=1:1===n?l.buttons|=4:2===n?l.buttons|=2:3===n?l.buttons|=8:4===n?l.buttons|=16:5===n&&(l.buttons|=32);var h=e.getActivePointersListsExceptType(i[0].type);for(r=0;r<h.length;r++)C(e,t,h[r]);if(0!==n)return e.nonPrimaryPressHandler&&!1===e.nonPrimaryPressHandler({eventSource:e,pointerType:i[0].type,position:y(i[0].currentPos,e.element),button:n,buttons:l.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),!1;for(r=0;r<u;r++)o=i[r],(s=l.getById(o.id))?(s.captured=!0,s.insideElementPressed=!0,s.insideElement=!0,s.contactPos=o.currentPos,s.contactTime=o.currentTime,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=o.currentPos,s.currentTime=o.currentTime,o=s):(o.captured=!0,o.insideElementPressed=!0,o.insideElement=!0,B(l,o)),l.addContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.MouseTracker.gesturePointVelocityTracker.addPoint(e,o),1===l.contacts?e.pressHandler&&!1===e.pressHandler({eventSource:e,pointerType:o.type,position:y(o.contactPos,e.element),buttons:l.buttons,isTouchEvent:"touch"===o.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t):2===l.contacts&&e.pinchHandler&&"touch"===o.type&&(a.pinchGPoints=l.asArray(),a.lastPinchDist=a.currentPinchDist=a.pinchGPoints[0].currentPos.distanceTo(a.pinchGPoints[1].currentPos),a.lastPinchCenter=a.currentPinchCenter=w(a.pinchGPoints[0].currentPos,a.pinchGPoints[1].currentPos));return!0}function V(e,t,i,n){var r,o,s,a,l,u,h=v[e.hash],c=e.getActivePointersListByType(i[0].type),p=i.length,d=!1,f=!1;if(void 0!==t.buttons?c.buttons=t.buttons:m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?0===n?c.buttons-=1:1===n?c.buttons-=4:2===n?c.buttons-=2:3===n?c.buttons-=8:4===n?c.buttons-=16:5===n&&(c.buttons-=32):0===n?c.buttons^=-2:1===n?c.buttons^=-5:2===n?c.buttons^=-3:3===n?c.buttons^=-9:4===n?c.buttons^=-17:5===n&&(c.buttons^=-33),0!==n){e.nonPrimaryReleaseHandler&&!1===e.nonPrimaryReleaseHandler({eventSource:e,pointerType:i[0].type,position:y(i[0].currentPos,e.element),button:n,buttons:c.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t);var g=e.getActivePointersListByType("mouse");return C(e,t,g),!1}for(s=0;s<p;s++)a=i[s],(l=c.getById(a.id))&&(l.captured&&(f=d=!(l.captured=!1)),l.lastPos=l.currentPos,l.lastTime=l.currentTime,l.currentPos=a.currentPos,l.currentTime=a.currentTime,l.insideElement||G(c,l),r=l.currentPos,o=l.currentTime,f?(c.removeContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.MouseTracker.gesturePointVelocityTracker.removePoint(e,l),0===c.contacts?(e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:l.type,position:y(r,e.element),buttons:c.buttons,insideElementPressed:l.insideElementPressed,insideElementReleased:l.insideElement,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),e.dragEndHandler&&!l.currentPos.equals(l.contactPos)&&!1===e.dragEndHandler({eventSource:e,pointerType:l.type,position:y(l.currentPos,e.element),speed:l.speed,direction:l.direction,shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),(e.clickHandler||e.dblClickHandler)&&l.insideElement&&(u=o-l.contactTime<=e.clickTimeThreshold&&l.contactPos.distanceTo(r)<=e.clickDistThreshold,e.clickHandler&&!1===e.clickHandler({eventSource:e,pointerType:l.type,position:y(l.currentPos,e.element),quick:u,shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),e.dblClickHandler&&u&&(c.clicks++,1===c.clicks?(h.lastClickPos=r,h.dblClickTimeOut=setTimeout(function(){c.clicks=0},e.dblClickTimeThreshold)):2===c.clicks&&(clearTimeout(h.dblClickTimeOut),c.clicks=0,h.lastClickPos.distanceTo(r)<=e.dblClickDistThreshold&&!1===e.dblClickHandler({eventSource:e,pointerType:l.type,position:y(l.currentPos,e.element),shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),h.lastClickPos=null)))):2===c.contacts&&e.pinchHandler&&"touch"===l.type&&(h.pinchGPoints=c.asArray(),h.lastPinchDist=h.currentPinchDist=h.pinchGPoints[0].currentPos.distanceTo(h.pinchGPoints[1].currentPos),h.lastPinchCenter=h.currentPinchCenter=w(h.pinchGPoints[0].currentPos,h.pinchGPoints[1].currentPos))):e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:l.type,position:y(r,e.element),buttons:c.buttons,insideElementPressed:l.insideElementPressed,insideElementReleased:l.insideElement,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t));return d}function q(e,t,i){var n,r,o,s,a,l=v[e.hash],u=e.getActivePointersListByType(i[0].type),h=i.length;for(void 0!==t.buttons&&(u.buttons=t.buttons),n=0;n<h;n++)r=i[n],(o=u.getById(r.id))?(r.hasOwnProperty("isPrimary")&&(o.isPrimary=r.isPrimary),o.lastPos=o.currentPos,o.lastTime=o.currentTime,o.currentPos=r.currentPos,o.currentTime=r.currentTime):(r.captured=!1,r.insideElementPressed=!1,r.insideElement=!0,B(u,r));e.stopHandler&&"mouse"===i[0].type&&(clearTimeout(e.stopTimeOut),e.stopTimeOut=setTimeout(function(){!function(e,t,i){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:i,position:g(t,e.element),buttons:e.getActivePointersListByType(i).buttons,isTouchEvent:"touch"===i,originalEvent:t,preventDefaultAction:!1,userData:e.userData})}(e,t,i[0].type)},e.stopDelay)),0===u.contacts?e.moveHandler&&!1===e.moveHandler({eventSource:e,pointerType:i[0].type,position:y(i[0].currentPos,e.element),buttons:u.buttons,isTouchEvent:"touch"===i[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t):1===u.contacts?(e.moveHandler&&(o=u.asArray()[0],!1===e.moveHandler({eventSource:e,pointerType:o.type,position:y(o.currentPos,e.element),buttons:u.buttons,isTouchEvent:"touch"===o.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)),e.dragHandler&&(a=(o=u.asArray()[0]).currentPos.minus(o.lastPos),!1===e.dragHandler({eventSource:e,pointerType:o.type,position:y(o.currentPos,e.element),buttons:u.buttons,delta:a,speed:o.speed,direction:o.direction,shift:t.shiftKey,isTouchEvent:"touch"===o.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))):2===u.contacts&&(e.moveHandler&&(s=u.asArray(),!1===e.moveHandler({eventSource:e,pointerType:s[0].type,position:y(w(s[0].currentPos,s[1].currentPos),e.element),buttons:u.buttons,isTouchEvent:"touch"===s[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)),e.pinchHandler&&"touch"===i[0].type&&(a=l.pinchGPoints[0].currentPos.distanceTo(l.pinchGPoints[1].currentPos))!=l.currentPinchDist&&(l.lastPinchDist=l.currentPinchDist,l.currentPinchDist=a,l.lastPinchCenter=l.currentPinchCenter,l.currentPinchCenter=w(l.pinchGPoints[0].currentPos,l.pinchGPoints[1].currentPos),!1===e.pinchHandler({eventSource:e,pointerType:"touch",gesturePoints:l.pinchGPoints,lastCenter:y(l.lastPinchCenter,e.element),center:y(l.currentPinchCenter,e.element),lastDistance:l.lastPinchDist,distance:l.currentPinchDist,shift:t.shiftKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)))}m.MouseTracker=function(e){h.push(this);var t=arguments;m.isPlainObject(e)||(e={element:t[0],clickTimeThreshold:t[1],clickDistThreshold:t[2]}),this.hash=Math.random(),this.element=m.getElement(e.element),this.clickTimeThreshold=e.clickTimeThreshold||m.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=e.clickDistThreshold||m.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=e.dblClickTimeThreshold||m.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=e.dblClickDistThreshold||m.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=e.userData||null,this.stopDelay=e.stopDelay||50,this.enterHandler=e.enterHandler||null,this.exitHandler=e.exitHandler||null,this.pressHandler=e.pressHandler||null,this.nonPrimaryPressHandler=e.nonPrimaryPressHandler||null,this.releaseHandler=e.releaseHandler||null,this.nonPrimaryReleaseHandler=e.nonPrimaryReleaseHandler||null,this.moveHandler=e.moveHandler||null,this.scrollHandler=e.scrollHandler||null,this.clickHandler=e.clickHandler||null,this.dblClickHandler=e.dblClickHandler||null,this.dragHandler=e.dragHandler||null,this.dragEndHandler=e.dragEndHandler||null,this.pinchHandler=e.pinchHandler||null,this.stopHandler=e.stopHandler||null,this.keyDownHandler=e.keyDownHandler||null,this.keyUpHandler=e.keyUpHandler||null,this.keyHandler=e.keyHandler||null,this.focusHandler=e.focusHandler||null,this.blurHandler=e.blurHandler||null;var i=this;v[this.hash]={click:function(e){!function(e,t){e.clickHandler&&m.cancelEvent(t)}(i,e)},dblclick:function(e){!function(e,t){e.dblClickHandler&&m.cancelEvent(t)}(i,e)},keydown:function(e){!function(e,t){e.keyDownHandler&&(t=m.getEvent(t),e.keyDownHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(i,e)},keyup:function(e){!function(e,t){e.keyUpHandler&&(t=m.getEvent(t),e.keyUpHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(i,e)},keypress:function(e){!function(e,t){e.keyHandler&&(t=m.getEvent(t),e.keyHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(i,e)},focus:function(e){!function(e,t){e.focusHandler&&(t=m.getEvent(t),!1===e.focusHandler({eventSource:e,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))}(i,e)},blur:function(e){!function(e,t){e.blurHandler&&(t=m.getEvent(t),!1===e.blurHandler({eventSource:e,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))}(i,e)},wheel:function(e){!function(e,t){_(e,t,t)}(i,e)},mousewheel:function(e){S(i,e)},DOMMouseScroll:function(e){S(i,e)},MozMousePixelScroll:function(e){S(i,e)},mouseenter:function(e){!function(e,t){t=m.getEvent(t),b(e,t)}(i,e)},mouseleave:function(e){!function(e,t){t=m.getEvent(t),E(e,t)}(i,e)},mouseover:function(e){!function(e,t){if((t=m.getEvent(t)).currentTarget===t.relatedTarget||T(t.currentTarget,t.relatedTarget))return;b(e,t)}(i,e)},mouseout:function(e){!function(e,t){if((t=m.getEvent(t)).currentTarget===t.relatedTarget||T(t.currentTarget,t.relatedTarget))return;E(e,t)}(i,e)},mousedown:function(e){!function(e,t){var i;t=m.getEvent(t),i={id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:f(t),currentTime:m.now()},j(e,t,[i],x(t.button))&&(m.stopEvent(t),c(e,"mouse"));(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler)&&m.cancelEvent(t)}(i,e)},mouseup:function(e){!function(e,t){P(e,t)}(i,e)},mouseupcaptured:function(e){!function(e,t){P(e,t),m.stopEvent(t)}(i,e)},mousemove:function(e){!function(e,t){I(e,t)}(i,e)},mousemovecaptured:function(e){!function(e,t){I(e,t),m.stopEvent(t)}(i,e)},touchstart:function(e){!function(e,t){var i,n,r,o,s=t.changedTouches.length,a=[],l=e.getActivePointersListByType("touch");i=m.now(),l.getLength()>t.touches.length-s&&(m.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),C(e,t,l));for(n=0;n<s;n++)a.push({id:t.changedTouches[n].identifier,type:"touch",currentPos:f(t.changedTouches[n]),currentTime:i});for(U(e,t,a),n=0;n<h.length;n++)if(h[n]!==e&&h[n].isTracking()&&T(h[n].element,e.element)){for(o=[],r=0;r<s;r++)o.push({id:t.changedTouches[r].identifier,type:"touch",currentPos:f(t.changedTouches[r]),currentTime:i});U(h[n],t,o)}j(e,t,a,0)&&(m.stopEvent(t),c(e,"touch",s));m.cancelEvent(t)}(i,e)},touchend:function(e){!function(e,t){O(e,t)}(i,e)},touchendcaptured:function(e){!function(e,t){O(e,t),m.stopEvent(t)}(i,e)},touchmove:function(e){!function(e,t){R(e,t)}(i,e)},touchmovecaptured:function(e){!function(e,t){R(e,t),m.stopEvent(t)}(i,e)},touchcancel:function(e){!function(e,t){var i=e.getActivePointersListByType("touch");C(e,t,i)}(i,e)},gesturestart:function(e){!function(e,t){t.stopPropagation(),t.preventDefault()}(0,e)},gesturechange:function(e){!function(e,t){t.stopPropagation(),t.preventDefault()}(0,e)},pointerover:function(e){A(i,e)},MSPointerOver:function(e){A(i,e)},pointerout:function(e){L(i,e)},MSPointerOut:function(e){L(i,e)},pointerdown:function(e){k(i,e)},MSPointerDown:function(e){k(i,e)},pointerup:function(e){M(i,e)},MSPointerUp:function(e){M(i,e)},pointermove:function(e){D(i,e)},MSPointerMove:function(e){D(i,e)},pointercancel:function(e){H(i,e)},MSPointerCancel:function(e){H(i,e)},pointerupcaptured:function(e){!function(e,t){e.getActivePointersListByType(d(t)).getById(t.pointerId)&&N(e,t);m.stopEvent(t)}(i,e)},pointermovecaptured:function(e){!function(e,t){e.getActivePointersListByType(d(t)).getById(t.pointerId)&&F(e,t);m.stopEvent(t)}(i,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},e.startDisabled||this.setTracking(!0)},m.MouseTracker.prototype={destroy:function(){var e;for(t(this),this.element=null,e=0;e<h.length;e++)if(h[e]===this){h.splice(e,1);break}v[this.hash]=null,delete v[this.hash]},isTracking:function(){return v[this.hash].tracking},setTracking:function(e){return e?function(e){var t,i,n=v[e.hash];if(!n.tracking){for(i=0;i<m.MouseTracker.subscribeEvents.length;i++)t=m.MouseTracker.subscribeEvents[i],m.addEvent(e.element,t,n[t],!1);r(e),n.tracking=!0}}(this):t(this),this},getActivePointersListsExceptType:function(e){for(var t=v[this.hash],i=[],n=0;n<t.activePointersLists.length;++n)t.activePointersLists[n].type!==e&&i.push(t.activePointersLists[n]);return i},getActivePointersListByType:function(e){var t,i,n=v[this.hash],r=n.activePointersLists.length;for(t=0;t<r;t++)if(n.activePointersLists[t].type===e)return n.activePointersLists[t];return i=new m.MouseTracker.GesturePointList(e),n.activePointersLists.push(i),i},getActivePointerCount:function(){var e,t=v[this.hash],i=t.activePointersLists.length,n=0;for(e=0;e<i;e++)n+=t.activePointersLists[e].getLength();return n},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},m.MouseTracker.resetAllMouseTrackers=function(){for(var e=0;e<h.length;e++)h[e].isTracking()&&(h[e].setTracking(!1),h[e].setTracking(!0))},m.MouseTracker.gesturePointVelocityTracker=(l=[],u=o=0,{addPoint:function(e,t){var i=s(e,t);l.push({guid:i,gPoint:t,lastPos:t.currentPos}),1===l.length&&(u=m.now(),o=window.setInterval(n,50))},removePoint:function(e,t){var i,n=s(e,t),r=l.length;for(i=0;i<r;i++)if(l[i].guid===n){l.splice(i,1),0==--r&&window.clearInterval(o);break}}}),m.MouseTracker.captureElement=document,m.MouseTracker.wheelEventName=m.Browser.vendor==m.BROWSERS.IE&&8<m.Browser.version||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",m.MouseTracker.supportsMouseCapture=(e=document.createElement("div"),m.isFunction(e.setCapture)&&m.isFunction(e.releaseCapture)),m.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",m.MouseTracker.wheelEventName],"DOMMouseScroll"==m.MouseTracker.wheelEventName&&m.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||m.Browser.vendor!==m.BROWSERS.IE)?(m.MouseTracker.havePointerEvents=!0,m.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),m.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?m.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:m.MouseTracker.maxTouchPoints=0,m.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(m.MouseTracker.havePointerEvents=!0,m.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),m.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?m.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:m.MouseTracker.maxTouchPoints=0,m.MouseTracker.haveMouseEnter=!1):(m.MouseTracker.havePointerEvents=!1,m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?(m.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),m.MouseTracker.haveMouseEnter=!0):(m.MouseTracker.subscribeEvents.push("mouseover","mouseout"),m.MouseTracker.haveMouseEnter=!1),m.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&m.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&m.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),m.MouseTracker.mousePointerId="legacy-mouse",m.MouseTracker.maxTouchPoints=10),m.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},m.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].id===e){this._gPoints.splice(t,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].id===e)return this._gPoints[t];return null},getPrimary:function(e){var t,i=this._gPoints.length;for(t=0;t<i;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,1<this.contacts&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var W=function(){try{return window.self!==window.top}catch(e){return!0}}();function $(e){try{return e.addEventListener&&e.removeEventListener}catch(e){return!1}}}(OpenSeadragon),gta=OpenSeadragon,gta.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},gta.Control=function(e,t,i){var n=e.parentNode;"number"==typeof t&&(gta.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),t={anchor:t}),t.attachToViewer=void 0===t.attachToViewer||t.attachToViewer,this.autoFade=void 0===t.autoFade||t.autoFade,this.element=e,this.anchor=t.anchor,this.container=i,this.anchor==gta.ControlAnchor.ABSOLUTE?(this.wrapper=gta.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof t.top?t.top+"px":t.top,this.wrapper.style.left="number"==typeof t.left?t.left+"px":t.left,this.wrapper.style.height="number"==typeof t.height?t.height+"px":t.height,this.wrapper.style.width="number"==typeof t.width?t.width+"px":t.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=gta.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==gta.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),t.attachToViewer?this.anchor==gta.ControlAnchor.TOP_RIGHT||this.anchor==gta.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):n.appendChild(this.wrapper)},gta.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?this.anchor==gta.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(e){this.element[gta.SIGNAL]&&gta.Browser.vendor==gta.BROWSERS.IE?gta.setElementOpacity(this.element,e,!0):gta.setElementOpacity(this.wrapper,e,!0)}},nta=OpenSeadragon,nta.ControlDock=function(e){var t,i,n=["topleft","topright","bottomright","bottomleft"];for(nta.extend(!0,this,{id:"controldock-"+nta.now()+"-"+Math.floor(1e6*Math.random()),container:nta.makeNeutralElement("div"),controls:[]},e),this.container.onsubmit=function(){return!1},this.element&&(this.element=nta.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),i=0;i<n.length;i++)t=n[i],this.controls[t]=nta.makeNeutralElement("div"),this.controls[t].style.position="absolute",t.match("left")&&(this.controls[t].style.left="0px"),t.match("right")&&(this.controls[t].style.right="0px"),t.match("top")&&(this.controls[t].style.top="0px"),t.match("bottom")&&(this.controls[t].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},nta.ControlDock.prototype={addControl:function(e,t){var i=null;if(!(0<=ota(this,e=nta.getElement(e)))){switch(t.anchor){case nta.ControlAnchor.TOP_RIGHT:i=this.controls.topright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingTop="0px";break;case nta.ControlAnchor.BOTTOM_RIGHT:i=this.controls.bottomright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingBottom="0px";break;case nta.ControlAnchor.BOTTOM_LEFT:i=this.controls.bottomleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingBottom="0px";break;case nta.ControlAnchor.TOP_LEFT:i=this.controls.topleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingTop="0px";break;case nta.ControlAnchor.ABSOLUTE:i=this.container,e.style.margin="0px",e.style.padding="0px";break;default:case nta.ControlAnchor.NONE:i=this.container,e.style.margin="0px",e.style.padding="0px"}this.controls.push(new nta.Control(e,t,i)),e.style.display="inline-block"}},removeControl:function(e){var t=ota(this,e=nta.getElement(e));return 0<=t&&(this.controls[t].destroy(),this.controls.splice(t,1)),this},clearControls:function(){for(;0<this.controls.length;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;0<=e;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;0<=t;t--)this.controls[t].setVisible(e);return this}},Fta=OpenSeadragon,Fta.Placement=Fta.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}}),Gta=OpenSeadragon,Hta={},Ita=1,Gta.Viewer=function(e){var t,i,n,r=arguments,o=this;if(Gta.isPlainObject(e)||(e={id:r[0],xmlPath:1<r.length?r[1]:void 0,prefixUrl:2<r.length?r[2]:void 0,controls:3<r.length?r[3]:void 0,overlays:4<r.length?r[4]:void 0}),e.config&&(Gta.extend(!0,e,e.config),delete e.config),Gta.extend(!0,this,{id:e.id,hash:e.hash||Ita++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},Gta.DEFAULT_SETTINGS,e),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==Hta[this.hash]&&Gta.console.warn("Hash "+this.hash+" has already been used."),Hta[this.hash]={fsBoundsDelta:new Gta.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=Gta.now(),Gta.EventSource.call(this),this.addHandler("open-failed",function(e){var t=Gta.getString("Errors.OpenFailed",e.eventSource,e.message);o._showMessage(t)}),Gta.ControlDock.call(this,e),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=Gta.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(i=this.canvas.style).width="100%",i.height="100%",i.overflow="hidden",i.position="absolute",i.top="0px",i.left="0px",Gta.setElementTouchActionNone(this.canvas),""!==e.tabIndex&&(this.canvas.tabIndex=void 0===e.tabIndex?0:e.tabIndex),this.container.className="openseadragon-container",(n=this.container.style).width="100%",n.height="100%",n.position="relative",n.overflow="hidden",n.left="0px",n.top="0px",n.textAlign="left",this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new Gta.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:Gta.delegate(this,Uta),keyHandler:Gta.delegate(this,Vta),clickHandler:Gta.delegate(this,Wta),dblClickHandler:Gta.delegate(this,Xta),dragHandler:Gta.delegate(this,Yta),dragEndHandler:Gta.delegate(this,Zta),enterHandler:Gta.delegate(this,$ta),exitHandler:Gta.delegate(this,_ta),pressHandler:Gta.delegate(this,aua),releaseHandler:Gta.delegate(this,bua),nonPrimaryPressHandler:Gta.delegate(this,cua),nonPrimaryReleaseHandler:Gta.delegate(this,dua),scrollHandler:Gta.delegate(this,fua),pinchHandler:Gta.delegate(this,eua)}),this.outerTracker=new Gta.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:Gta.delegate(this,gua),exitHandler:Gta.delegate(this,hua)}),this.toolbar&&(this.toolbar=new Gta.ControlDock({element:this.toolbar})),this.bindStandardControls(),Hta[this.hash].prevContainerSize=Jta(this.container),this.world=new Gta.World({viewer:this}),this.world.addHandler("add-item",function(e){o.source=o.world.getItemAt(0).source,Hta[o.hash].forceRedraw=!0,o._updateRequestId||(o._updateRequestId=Nta(o,iua))}),this.world.addHandler("remove-item",function(e){o.world.getItemCount()?o.source=o.world.getItemAt(0).source:o.source=null,Hta[o.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(e){o.viewport&&o.viewport._setContentBounds(o.world.getHomeBounds(),o.world.getContentFactor())}),this.world.addHandler("item-index-change",function(e){o.source=o.world.getItemAt(0).source}),this.viewport=new Gta.Viewport({containerSize:Hta[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new Gta.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:e.timeout}),this.tileCache=new Gta.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new Gta.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=Gta.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(t=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(t,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(t=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(t,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new Gta.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),t=0;t<this.customControls.length;t++)this.addControl(this.customControls[t].id,{anchor:this.customControls[t].anchor});Gta.requestAnimationFrame(function(){Pta(o)}),void 0===this.imageSmoothingEnabled||this.imageSmoothingEnabled||this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},Gta.extend(Gta.Viewer.prototype,Gta.EventSource.prototype,Gta.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(e){return Gta.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(e)},openTileSource:function(e){return Gta.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(e)},open:function(i,e){var r=this;if(this.close(),i){if(this.sequenceMode&&Gta.isArray(i))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===e||isNaN(e)||(this.initialPage=e),this.tileSources=i,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(Gta.isArray(i)||(i=[i]),i.length){function o(){if(a+l===n)if(a){!r._firstOpen&&r.preserveViewport||(r.viewport.goHome(!0),r.viewport.update()),r._firstOpen=!1;var e=i[0];if(e.tileSource&&(e=e.tileSource),r.overlays&&!r.preserveOverlays)for(var t=0;t<r.overlays.length;t++)r.currentOverlays[t]=Lta(r,r.overlays[t]);r._drawOverlays(),r._opening=!1,r.raiseEvent("open",{source:e})}else r._opening=!1,r.raiseEvent("open-failed",s)}function t(i){Gta.isPlainObject(i)&&i.tileSource||(i={tileSource:i}),void 0!==i.index&&(Gta.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete i.index),void 0===i.collectionImmediately&&(i.collectionImmediately=!0);var n=i.success;i.success=function(e){if(a++,i.tileSource.overlays)for(var t=0;t<i.tileSource.overlays.length;t++)r.addOverlay(i.tileSource.overlays[t]);n&&n(e),o()};var t=i.error;i.error=function(e){l++,s=s||e,t&&t(e),o()},r.addTiledImage(i)}this._opening=!0;for(var s,n=i.length,a=0,l=0,u=0;u<i.length;u++)t(i[u]);return this}}},close:function(){return Hta[this.hash]&&(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),Hta[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close")),this},destroy:function(){if(Hta[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(Gta.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),Hta[this.hash]=null,delete Hta[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisible();return t},setControlsEnabled:function(e){return e?Rta(this):Pta(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return Hta[this.hash].fullPage},setFullPage:function(e){var t,i,n=document.body,r=n.style,o=document.documentElement.style,s=this;if(e==this.isFullPage())return this;var a={fullPage:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",a),a.preventDefaultAction)return this;if(e){for(this.elementSize=Gta.getElementSize(this.element),this.pageScroll=Gta.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=r.margin,this.docMargin=o.margin,r.margin="0",o.margin="0",this.bodyPadding=r.padding,this.docPadding=o.padding,r.padding="0",o.padding="0",this.bodyWidth=r.width,this.docWidth=o.width,r.width="100%",o.width="100%",this.bodyHeight=r.height,this.docHeight=o.height,r.height="100%",o.height="100%",this.previousBody=[],Hta[this.hash].prevElementParent=this.element.parentNode,Hta[this.hash].prevNextSibling=this.element.nextSibling,Hta[this.hash].prevElementWidth=this.element.style.width,Hta[this.hash].prevElementHeight=this.element.style.height,t=n.childNodes.length,i=0;i<t;i++)this.previousBody.push(n.childNodes[0]),n.removeChild(n.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,n.appendChild(this.toolbar.element),Gta.addClass(this.toolbar.element,"fullpage")),Gta.addClass(this.element,"fullpage"),n.appendChild(this.element),this.element.style.height=Gta.getWindowSize().y+"px",this.element.style.width=Gta.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=Gta.getElementSize(this.element).y-Gta.getElementSize(this.toolbar.element).y+"px"),Hta[this.hash].fullPage=!0,Gta.delegate(this,gua)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,r.margin=this.bodyMargin,o.margin=this.docMargin,r.padding=this.bodyPadding,o.padding=this.docPadding,r.width=this.bodyWidth,o.width=this.docWidth,r.height=this.bodyHeight,o.height=this.docHeight,n.removeChild(this.element),t=this.previousBody.length,i=0;i<t;i++)n.appendChild(this.previousBody.shift());Gta.removeClass(this.element,"fullpage"),Hta[this.hash].prevElementParent.insertBefore(this.element,Hta[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(n.removeChild(this.toolbar.element),Gta.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=Hta[this.hash].prevElementWidth,this.element.style.height=Hta[this.hash].prevElementHeight;var l=0,u=function(){Gta.setPageScroll(s.pageScroll);var e=Gta.getPageScroll();++l<10&&(e.x!==s.pageScroll.x||e.y!==s.pageScroll.y)&&Gta.requestAnimationFrame(u)};Gta.requestAnimationFrame(u),Hta[this.hash].fullPage=!1,Gta.delegate(this,hua)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:e}),this},setFullScreen:function(e){var t=this;if(!Gta.supportsFullScreen)return this.setFullPage(e);if(Gta.isFullScreen()===e)return this;var i={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",i),i.preventDefaultAction)return this;if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var n=function(){var e=Gta.isFullScreen();e||(Gta.removeEvent(document,Gta.fullScreenEventName,n),Gta.removeEvent(document,Gta.fullScreenErrorEventName,n),t.setFullPage(!1),t.isFullPage()&&(t.element.style.width=t.fullPageStyleWidth,t.element.style.height=t.fullPageStyleHeight)),t.navigator&&t.viewport&&setTimeout(function(){t.navigator.update(t.viewport)}),t.raiseEvent("full-screen",{fullScreen:e})};Gta.addEvent(document,Gta.fullScreenEventName,n),Gta.addEvent(document,Gta.fullScreenErrorEventName,n),Gta.requestFullScreen(document.body)}else Gta.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(i){Gta.console.assert(i,"[Viewer.addTiledImage] options is required"),Gta.console.assert(i.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),Gta.console.assert(!i.replace||-1<i.index&&i.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var r=this;i.replace&&(i.replaceItem=r.world.getItemAt(i.index)),this._hideMessage(),void 0===i.placeholderFillStyle&&(i.placeholderFillStyle=this.placeholderFillStyle),void 0===i.opacity&&(i.opacity=this.opacity),void 0===i.preload&&(i.preload=this.preload),void 0===i.compositeOperation&&(i.compositeOperation=this.compositeOperation),void 0===i.crossOriginPolicy&&(i.crossOriginPolicy=void 0!==i.tileSource.crossOriginPolicy?i.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===i.ajaxWithCredentials&&(i.ajaxWithCredentials=this.ajaxWithCredentials),void 0===i.loadTilesWithAjax&&(i.loadTilesWithAjax=this.loadTilesWithAjax),void 0===i.ajaxHeaders||null===i.ajaxHeaders?i.ajaxHeaders=this.ajaxHeaders:Gta.isPlainObject(i.ajaxHeaders)&&Gta.isPlainObject(this.ajaxHeaders)&&(i.ajaxHeaders=Gta.extend({},this.ajaxHeaders,i.ajaxHeaders));var n={options:i};function t(e){for(var t=0;t<r._loadQueue.length;t++)if(r._loadQueue[t]===n){r._loadQueue.splice(t,1);break}0===r._loadQueue.length&&o(n),r.raiseEvent("add-item-failed",e),i.error&&i.error(e)}function o(e){r.collectionMode&&(r.world.arrange({immediately:e.options.collectionImmediately,rows:r.collectionRows,columns:r.collectionColumns,layout:r.collectionLayout,tileSize:r.collectionTileSize,tileMargin:r.collectionTileMargin}),r.world.setAutoRefigureSizes(!0))}function s(){for(var e,t,i;r._loadQueue.length&&(e=r._loadQueue[0]).tileSource;){if(r._loadQueue.splice(0,1),e.options.replace){var n=r.world.getIndexOfItem(e.options.replaceItem);-1!=n&&(e.options.index=n),r.world.removeItem(e.options.replaceItem)}t=new Gta.TiledImage({viewer:r,source:e.tileSource,viewport:r.viewport,drawer:r.drawer,tileCache:r.tileCache,imageLoader:r.imageLoader,x:e.options.x,y:e.options.y,width:e.options.width,height:e.options.height,fitBounds:e.options.fitBounds,fitBoundsPlacement:e.options.fitBoundsPlacement,clip:e.options.clip,placeholderFillStyle:e.options.placeholderFillStyle,opacity:e.options.opacity,preload:e.options.preload,degrees:e.options.degrees,compositeOperation:e.options.compositeOperation,springStiffness:r.springStiffness,animationTime:r.animationTime,minZoomImageRatio:r.minZoomImageRatio,wrapHorizontal:r.wrapHorizontal,wrapVertical:r.wrapVertical,immediateRender:r.immediateRender,blendTime:r.blendTime,alwaysBlend:r.alwaysBlend,minPixelRatio:r.minPixelRatio,smoothTileEdgesMinZoom:r.smoothTileEdgesMinZoom,iOSDevice:r.iOSDevice,crossOriginPolicy:e.options.crossOriginPolicy,ajaxWithCredentials:e.options.ajaxWithCredentials,loadTilesWithAjax:e.options.loadTilesWithAjax,ajaxHeaders:e.options.ajaxHeaders,debugMode:r.debugMode}),r.collectionMode&&r.world.setAutoRefigureSizes(!1),r.world.addItem(t,{index:e.options.index}),0===r._loadQueue.length&&o(e),1!==r.world.getItemCount()||r.preserveViewport||r.viewport.goHome(!0),r.navigator&&(i=Gta.extend({},e.options,{replace:!1,originalTiledImage:t,tileSource:e.tileSource}),r.navigator.addTiledImage(i)),e.options.success&&e.options.success({item:t})}}Gta.isArray(i.tileSource)?setTimeout(function(){t({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:i.tileSource,options:i})}):(this._loadQueue.push(n),function(i,n,r,o,s){var a=i;if("string"==Gta.type(n))if(n.match(/^\s*<.*>\s*$/))n=Gta.parseXml(n);else if(n.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var e=Gta.parseJSON(n);n=e}catch(e){}function l(e,t){e.ready?o(e):(e.addHandler("ready",function(){o(e)}),e.addHandler("open-failed",function(e){s({message:e.message,source:t})}))}setTimeout(function(){if("string"==Gta.type(n))(n=new Gta.TileSource({url:n,crossOriginPolicy:void 0!==r.crossOriginPolicy?r.crossOriginPolicy:i.crossOriginPolicy,ajaxWithCredentials:i.ajaxWithCredentials,ajaxHeaders:i.ajaxHeaders,useCanvas:i.useCanvas,success:function(e){o(e.tileSource)}})).addHandler("open-failed",function(e){s(e)});else if(Gta.isPlainObject(n)||n.nodeType)if(void 0!==n.crossOriginPolicy||void 0===r.crossOriginPolicy&&void 0===i.crossOriginPolicy||(n.crossOriginPolicy=void 0!==r.crossOriginPolicy?r.crossOriginPolicy:i.crossOriginPolicy),void 0===n.ajaxWithCredentials&&(n.ajaxWithCredentials=i.ajaxWithCredentials),void 0===n.useCanvas&&(n.useCanvas=i.useCanvas),Gta.isFunction(n.getTileUrl)){var e=new Gta.TileSource(n);e.getTileUrl=n.getTileUrl,o(e)}else{var t=Gta.TileSource.determineType(a,n);if(!t)return void s({message:"Unable to load TileSource",source:n});l(new t(t.prototype.configure.apply(a,[n])),n)}else l(n,n)})}(this,i.tileSource,i,function(e){n.tileSource=e,s()},function(e){e.options=i,t(e),s()}))},addSimpleImage:function(e){Gta.console.assert(e,"[Viewer.addSimpleImage] options is required"),Gta.console.assert(e.url,"[Viewer.addSimpleImage] options.url is required");var t=Gta.extend({},e,{tileSource:{type:"image",url:e.url}});delete t.url,this.addTiledImage(t)},addLayer:function(t){var i=this;Gta.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var e=Gta.extend({},t,{success:function(e){i.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){i.raiseEvent("add-layer-failed",e)}});return this.addTiledImage(e),this},getLayerAtLevel:function(e){return Gta.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(e)},getLevelOfLayer:function(e){return Gta.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(e)},getLayersCount:function(){return Gta.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(e,t){return Gta.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(e,t)},removeLayer:function(e){return Gta.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(e)},forceRedraw:function(){return Hta[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var e=Gta.delegate(this,Sta),t=Gta.delegate(this,Tta),i=Gta.delegate(this,Aua),n=Gta.delegate(this,zua),r=this.navImages,o=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(o=!1),this.previousButton=new Gta.Button({element:this.previousButton?Gta.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.PreviousPage"),srcRest:lua(this.prefixUrl,r.previous.REST),srcGroup:lua(this.prefixUrl,r.previous.GROUP),srcHover:lua(this.prefixUrl,r.previous.HOVER),srcDown:lua(this.prefixUrl,r.previous.DOWN),onRelease:n,onFocus:e,onBlur:t}),this.nextButton=new Gta.Button({element:this.nextButton?Gta.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.NextPage"),srcRest:lua(this.prefixUrl,r.next.REST),srcGroup:lua(this.prefixUrl,r.next.GROUP),srcHover:lua(this.prefixUrl,r.next.HOVER),srcDown:lua(this.prefixUrl,r.next.DOWN),onRelease:i,onFocus:e,onBlur:t}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),o&&(this.paging=new Gta.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:Gta.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||Gta.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var e=Gta.delegate(this,mua),t=Gta.delegate(this,oua),i=Gta.delegate(this,rua),n=Gta.delegate(this,nua),r=Gta.delegate(this,sua),o=Gta.delegate(this,uua),s=Gta.delegate(this,vua),a=Gta.delegate(this,wua),l=Gta.delegate(this,xua),u=Gta.delegate(this,yua),h=Gta.delegate(this,Sta),c=Gta.delegate(this,Tta),p=this.navImages,d=[],f=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(f=!1),this.showZoomControl&&(d.push(this.zoomInButton=new Gta.Button({element:this.zoomInButton?Gta.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.ZoomIn"),srcRest:lua(this.prefixUrl,p.zoomIn.REST),srcGroup:lua(this.prefixUrl,p.zoomIn.GROUP),srcHover:lua(this.prefixUrl,p.zoomIn.HOVER),srcDown:lua(this.prefixUrl,p.zoomIn.DOWN),onPress:e,onRelease:t,onClick:i,onEnter:e,onExit:t,onFocus:h,onBlur:c})),d.push(this.zoomOutButton=new Gta.Button({element:this.zoomOutButton?Gta.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.ZoomOut"),srcRest:lua(this.prefixUrl,p.zoomOut.REST),srcGroup:lua(this.prefixUrl,p.zoomOut.GROUP),srcHover:lua(this.prefixUrl,p.zoomOut.HOVER),srcDown:lua(this.prefixUrl,p.zoomOut.DOWN),onPress:n,onRelease:t,onClick:r,onEnter:n,onExit:t,onFocus:h,onBlur:c}))),this.showHomeControl&&d.push(this.homeButton=new Gta.Button({element:this.homeButton?Gta.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.Home"),srcRest:lua(this.prefixUrl,p.home.REST),srcGroup:lua(this.prefixUrl,p.home.GROUP),srcHover:lua(this.prefixUrl,p.home.HOVER),srcDown:lua(this.prefixUrl,p.home.DOWN),onRelease:o,onFocus:h,onBlur:c})),this.showFullPageControl&&d.push(this.fullPageButton=new Gta.Button({element:this.fullPageButton?Gta.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.FullPage"),srcRest:lua(this.prefixUrl,p.fullpage.REST),srcGroup:lua(this.prefixUrl,p.fullpage.GROUP),srcHover:lua(this.prefixUrl,p.fullpage.HOVER),srcDown:lua(this.prefixUrl,p.fullpage.DOWN),onRelease:s,onFocus:h,onBlur:c})),this.showRotationControl&&(d.push(this.rotateLeftButton=new Gta.Button({element:this.rotateLeftButton?Gta.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.RotateLeft"),srcRest:lua(this.prefixUrl,p.rotateleft.REST),srcGroup:lua(this.prefixUrl,p.rotateleft.GROUP),srcHover:lua(this.prefixUrl,p.rotateleft.HOVER),srcDown:lua(this.prefixUrl,p.rotateleft.DOWN),onRelease:a,onFocus:h,onBlur:c})),d.push(this.rotateRightButton=new Gta.Button({element:this.rotateRightButton?Gta.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.RotateRight"),srcRest:lua(this.prefixUrl,p.rotateright.REST),srcGroup:lua(this.prefixUrl,p.rotateright.GROUP),srcHover:lua(this.prefixUrl,p.rotateright.HOVER),srcDown:lua(this.prefixUrl,p.rotateright.DOWN),onRelease:l,onFocus:h,onBlur:c}))),this.showFlipControl&&d.push(this.flipButton=new Gta.Button({element:this.flipButton?Gta.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:Gta.getString("Tooltips.Flip"),srcRest:lua(this.prefixUrl,p.flip.REST),srcGroup:lua(this.prefixUrl,p.flip.GROUP),srcHover:lua(this.prefixUrl,p.flip.HOVER),srcDown:lua(this.prefixUrl,p.flip.DOWN),onRelease:u,onFocus:h,onBlur:c})),f&&(this.buttons=new Gta.ButtonGroup({buttons:d,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",Gta.delegate(this,tua)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||Gta.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||Gta.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&0<=e&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(e,t,i,n){var r;if(r=Gta.isPlainObject(e)?e:{element:e,location:t,placement:i,onDraw:n},e=Gta.getElement(r.element),0<=Mta(this.currentOverlays,e))return this;var o=Lta(this,r);return this.currentOverlays.push(o),o.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:e,location:r.location,placement:r.placement}),this},updateOverlay:function(e,t,i){var n;return e=Gta.getElement(e),0<=(n=Mta(this.currentOverlays,e))&&(this.currentOverlays[n].update(t,i),Hta[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:e,location:t,placement:i})),this},removeOverlay:function(e){var t;return e=Gta.getElement(e),0<=(t=Mta(this.currentOverlays,e))&&(this.currentOverlays[t].destroy(),this.currentOverlays.splice(t,1),Hta[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:e})),this},clearOverlays:function(){for(;0<this.currentOverlays.length;)this.currentOverlays.pop().destroy();return Hta[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(e){var t;return e=Gta.getElement(e),0<=(t=Mta(this.currentOverlays,e))?this.currentOverlays[t]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(0<e?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var t=Gta.makeNeutralElement("div");t.appendChild(document.createTextNode(e)),this.messageDiv=Gta.makeCenteredNode(t),Gta.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,t=this.currentOverlays.length;for(e=0;e<t;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&1<this.tileSources.length&&(this.referenceStrip=new Gta.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else Gta.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}}),Sya=OpenSeadragon,Sya.Navigator=function(e){var t,i,n,r,o,s,a=e.viewer,l=this;function u(e){Xya(l.displayRegionContainer,e),Xya(l.displayRegion,-e),l.viewport.setRotation(e)}e.id?(this.element=document.getElementById(e.id),e.controlOptions={anchor:Sya.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(e.id="navigator-"+Sya.now(),this.element=Sya.makeNeutralElement("div"),e.controlOptions={anchor:Sya.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:e.autoFade},e.position&&("BOTTOM_RIGHT"==e.position?e.controlOptions.anchor=Sya.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==e.position?e.controlOptions.anchor=Sya.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==e.position?e.controlOptions.anchor=Sya.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==e.position?e.controlOptions.anchor=Sya.ControlAnchor.TOP_LEFT:"ABSOLUTE"==e.position&&(e.controlOptions.anchor=Sya.ControlAnchor.ABSOLUTE,e.controlOptions.top=e.top,e.controlOptions.left=e.left,e.controlOptions.height=e.height,e.controlOptions.width=e.width))),this.element.id=e.id,this.element.className+=" navigator",(e=Sya.extend(!0,{sizeRatio:Sya.DEFAULT_SETTINGS.navigatorSizeRatio},e,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:e.autoResize,minZoomImageRatio:1,background:e.background,opacity:e.opacity,borderColor:e.borderColor,displayRegionColor:e.displayRegionColor})).minPixelRatio=this.minPixelRatio=a.minPixelRatio,Sya.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new Sya.Point(1,1),this.totalBorderWidths=new Sya.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),e.controlOptions.anchor!=Sya.ControlAnchor.NONE&&(n=this.element.style,r=this.borderWidth,n.margin="0px",n.border=r+"px solid "+e.borderColor,n.padding="0px",n.background=e.background,n.opacity=e.opacity,n.overflow="hidden"),this.displayRegion=Sya.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",o=this.displayRegion.style,s=this.borderWidth,o.position="relative",o.top="0px",o.left="0px",o.fontSize="0px",o.overflow="hidden",o.border=s+"px solid "+e.displayRegionColor,o.margin="0px",o.padding="0px",o.background="transparent",o.float="left",o.cssFloat="left",o.styleFloat="left",o.zIndex=999999999,o.cursor="default",this.displayRegionContainer=Sya.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",a.addControl(this.element,e.controlOptions),this._resizeWithViewer=e.controlOptions.anchor!=Sya.ControlAnchor.ABSOLUTE&&e.controlOptions.anchor!=Sya.ControlAnchor.NONE,this._resizeWithViewer&&(e.width&&e.height?(this.element.style.height="number"==typeof e.height?e.height+"px":e.height,this.element.style.width="number"==typeof e.width?e.width+"px":e.width):(t=Sya.getElementSize(a.element),this.element.style.height=Math.round(t.y*e.sizeRatio)+"px",this.element.style.width=Math.round(t.x*e.sizeRatio)+"px",this.oldViewerSize=t),i=Sya.getElementSize(this.element),this.elementArea=i.x*i.y),this.oldContainerSize=new Sya.Point(0,0),Sya.Viewer.apply(this,[e]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),e.navigatorRotate&&(u(e.viewer.viewport?e.viewer.viewport.getRotation():e.viewer.degrees||0),e.viewer.addHandler("rotate",function(e){u(e.degrees)})),this.innerTracker.destroy(),this.innerTracker=new Sya.MouseTracker({element:this.element,dragHandler:Sya.delegate(this,Uya),clickHandler:Sya.delegate(this,Tya),releaseHandler:Sya.delegate(this,Vya),scrollHandler:Sya.delegate(this,Wya)}),this.addHandler("reset-size",function(){l.viewport&&l.viewport.goHome(!0)}),a.world.addHandler("item-index-change",function(t){window.setTimeout(function(){var e=l.world.getItemAt(t.previousIndex);l.world.setItemIndex(e,t.newIndex)},1)}),a.world.addHandler("remove-item",function(e){var t=e.item,i=l._getMatchingItem(t);i&&l.world.removeItem(i)}),this.update(a.viewport)},Sya.extend(Sya.Navigator.prototype,Sya.EventSource.prototype,Sya.Viewer.prototype,{updateSize:function(){if(this.viewport){var e=new Sya.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);e.equals(this.oldContainerSize)||(this.viewport.resize(e,!0),this.viewport.goHome(!0),this.oldContainerSize=e,this.drawer.clear(),this.world.draw())}},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){Yya(this.displayRegion,e),Yya(this.canvas,e),Yya(this.element,e)},update:function(e){var t,i,n,r,o,s;if(t=Sya.getElementSize(this.viewer.element),this._resizeWithViewer&&t.x&&t.y&&!t.equals(this.oldViewerSize)&&(this.oldViewerSize=t,n=this.maintainSizeRatio||!this.elementArea?(i=t.x*this.sizeRatio,t.y*this.sizeRatio):(i=Math.sqrt(this.elementArea*(t.x/t.y)),this.elementArea/i),this.element.style.width=Math.round(i)+"px",this.element.style.height=Math.round(n)+"px",this.elementArea||(this.elementArea=i*n),this.updateSize()),e&&this.viewport){r=e.getBoundsNoRotate(!0),o=this.viewport.pixelFromPointNoRotate(r.getTopLeft(),!1),s=this.viewport.pixelFromPointNoRotate(r.getBottomRight(),!1).minus(this.totalBorderWidths);var a=this.displayRegion.style;a.display=this.world.getItemCount()?"block":"none",a.top=Math.round(o.y)+"px",a.left=Math.round(o.x)+"px";var l=Math.abs(o.x-s.x),u=Math.abs(o.y-s.y);a.width=Math.round(Math.max(l,0))+"px",a.height=Math.round(Math.max(u,0))+"px"}},addTiledImage:function(e){var n=this,r=e.originalTiledImage;delete e.original;var t=Sya.extend({},e,{success:function(e){var t=e.item;function i(){n._matchBounds(t,r)}t._originalForNavigator=r,n._matchBounds(t,r,!0),r.addHandler("bounds-change",i),r.addHandler("clip-change",i),r.addHandler("opacity-change",function(){n._matchOpacity(t,r)}),r.addHandler("composite-operation-change",function(){n._matchCompositeOperation(t,r)})}});return Sya.Viewer.prototype.addTiledImage.apply(this,[t])},_getMatchingItem:function(e){for(var t,i=this.world.getItemCount(),n=0;n<i;n++)if((t=this.world.getItemAt(n))._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,i){var n=t.getBoundsNoRotate();e.setPosition(n.getTopLeft(),i),e.setWidth(n.width,i),e.setRotation(t.getRotation(),i),e.setClip(t.getClip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}}),gAa=OpenSeadragon,hAa={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}},gAa.extend(gAa,{getString:function(e){var t,i=e.split("."),n=null,r=arguments,o=hAa;for(t=0;t<i.length-1;t++)o=o[i[t]]||{};return"string"!=typeof(n=o[i[t]])&&(gAa.console.log("Untranslated source string:",e),n=""),n.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<r.length?r[t]:""})},setString:function(e,t){var i,n=e.split("."),r=hAa;for(i=0;i<n.length-1;i++)r[n[i]]||(r[n[i]]={}),r=r[n[i]];r[n[i]]=t}}),vAa=OpenSeadragon,vAa.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},vAa.Point.prototype={clone:function(){return new vAa.Point(this.x,this.y)},plus:function(e){return new vAa.Point(this.x+e.x,this.y+e.y)},minus:function(e){return new vAa.Point(this.x-e.x,this.y-e.y)},times:function(e){return new vAa.Point(this.x*e,this.y*e)},divide:function(e){return new vAa.Point(this.x/e,this.y/e)},negate:function(){return new vAa.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(e){return new vAa.Point(e(this.x),e(this.y))},equals:function(e){return e instanceof vAa.Point&&this.x===e.x&&this.y===e.y},rotate:function(e,t){var i,n;if(t=t||new vAa.Point(0,0),e%90==0)switch(vAa.positiveModulo(e,360)){case 0:i=1,n=0;break;case 90:i=0,n=1;break;case 180:i=-1,n=0;break;case 270:i=0,n=-1}else{var r=e*Math.PI/180;i=Math.cos(r),n=Math.sin(r)}var o=i*(this.x-t.x)-n*(this.y-t.y)+t.x,s=n*(this.x-t.x)+i*(this.y-t.y)+t.y;return new vAa.Point(o,s)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}},OAa=OpenSeadragon,OAa.TileSource=function(e,t,i,n,r,o){var s,a,l=this,u=arguments;if(s=OAa.isPlainObject(e)?e:{width:u[0],height:u[1],tileSize:u[2],tileOverlap:u[3],minLevel:u[4],maxLevel:u[5]},OAa.EventSource.call(this),OAa.extend(!0,this,s),!this.success)for(a=0;a<arguments.length;a++)if(OAa.isFunction(arguments[a])){this.success=arguments[a];break}this.success&&this.addHandler("ready",function(e){l.success(e)}),"string"==OAa.type(e)&&(this.url=e),this.url?(this.aspectRatio=1,this.dimensions=new OAa.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=s.width&&s.height?s.width/s.height:1,this.dimensions=new OAa.Point(s.width,s.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=s.tileOverlap?s.tileOverlap:0,this.minLevel=s.minLevel?s.minLevel:0,this.maxLevel=void 0!==s.maxLevel&&null!==s.maxLevel?s.maxLevel:s.width&&s.height?Math.ceil(Math.log(Math.max(s.width,s.height))/Math.log(2)):0,this.success&&OAa.isFunction(this.success)&&this.success(this))},OAa.TileSource.prototype={getTileSize:function(e){return OAa.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},getLevelScale:function(e){var t,i={};for(t=0;t<=this.maxLevel;t++)i[t]=1/Math.pow(2,this.maxLevel-t);return this.getLevelScale=function(e){return i[e]},this.getLevelScale(e)},getNumTiles:function(e){var t=this.getLevelScale(e),i=Math.ceil(t*this.dimensions.x/this.getTileWidth(e)),n=Math.ceil(t*this.dimensions.y/this.getTileHeight(e));return new OAa.Point(i,n)},getPixelRatio:function(e){var t=this.dimensions.times(this.getLevelScale(e)),i=1/t.x,n=1/t.y;return new OAa.Point(i,n)},getClosestLevel:function(){var e,t;for(e=this.minLevel+1;e<=this.maxLevel&&!(1<(t=this.getNumTiles(e)).x||1<t.y);e++);return e-1},getTileAtPoint:function(e,t){var i=0<=t.x&&t.x<=1&&0<=t.y&&t.y<=1/this.aspectRatio;OAa.console.assert(i,"[TileSource.getTileAtPoint] must be called with a valid point.");var n=this.dimensions.x*this.getLevelScale(e),r=t.x*n,o=t.y*n,s=Math.floor(r/this.getTileWidth(e)),a=Math.floor(o/this.getTileHeight(e));return 1<=t.x&&(s=this.getNumTiles(e).x-1),t.y>=1/this.aspectRatio-1e-15&&(a=this.getNumTiles(e).y-1),new OAa.Point(s,a)},getTileBounds:function(e,t,i,n){var r=this.dimensions.times(this.getLevelScale(e)),o=this.getTileWidth(e),s=this.getTileHeight(e),a=0===t?0:o*t-this.tileOverlap,l=0===i?0:s*i-this.tileOverlap,u=o+(0===t?1:2)*this.tileOverlap,h=s+(0===i?1:2)*this.tileOverlap,c=1/r.x;return u=Math.min(u,r.x-a),h=Math.min(h,r.y-l),n?new OAa.Rect(0,0,u,h):new OAa.Rect(a*c,l*c,u*c,h*c)},getImageInfo:function(n){var e,i,r,o,t,s,a,l=this;n&&-1<(a=(s=(t=n.split("/"))[t.length-1]).lastIndexOf("."))&&(t[t.length-1]=s.slice(0,a)),i=function(e){"string"==typeof e&&(e=OAa.parseXml(e));var t=OAa.TileSource.determineType(l,e,n);t?(void 0===(o=t.prototype.configure.apply(l,[e,n])).ajaxWithCredentials&&(o.ajaxWithCredentials=l.ajaxWithCredentials),r=new t(o),l.ready=!0,l.raiseEvent("ready",{tileSource:r})):l.raiseEvent("open-failed",{message:"Unable to load TileSource",source:n})},n.match(/\.js$/)?(e=n.split("/").pop().replace(".js",""),OAa.jsonp({url:n,async:!1,callbackName:e,callback:i})):OAa.makeAjaxRequest({url:n,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var t=function(t){var e,i,n=t.responseText,r=t.status;if(!t)throw new Error(OAa.getString("Errors.Security"));if(200!==t.status&&0!==t.status)throw r=t.status,e=404==r?"Not Found":t.statusText,new Error(OAa.getString("Errors.Status",r,e));if(n.match(/\s*<.*/))try{i=t.responseXML&&t.responseXML.documentElement?t.responseXML:OAa.parseXml(n)}catch(e){i=t.responseText}else if(n.match(/\s*[\{\[].*/))try{i=OAa.parseJSON(n)}catch(e){i=n}else i=n;return i}(e);i(t)},error:function(e,t){var i;try{i="HTTP "+e.status+" attempting to load TileSource"}catch(e){i=(void 0!==t&&t.toString?t.toString():"Unknown error")+" attempting to load TileSource"}l.raiseEvent("open-failed",{message:i,source:n})}})},supports:function(e,t){return!1},configure:function(e,t){throw new Error("Method not implemented.")},getTileUrl:function(e,t,i){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(e,t,i){return{}},tileExists:function(e,t,i){var n=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&0<=t&&0<=i&&t<n.x&&i<n.y}},OAa.extend(!0,OAa.TileSource.prototype,OAa.EventSource.prototype),OAa.TileSource.determineType=function(e,t,i){var n;for(n in OpenSeadragon)if(n.match(/.+TileSource$/)&&OAa.isFunction(OpenSeadragon[n])&&OAa.isFunction(OpenSeadragon[n].prototype.supports)&&OpenSeadragon[n].prototype.supports.call(e,t,i))return OpenSeadragon[n];OAa.console.error("No TileSource was able to open %s %s",i,t)},ACa=OpenSeadragon,ACa.DziTileSource=function(e,t,i,n,r,o,s,a,l){var u,h,c,p;if(p=ACa.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:r,fileFormat:o,displayRects:s,minLevel:a,maxLevel:l},this._levelRects={},this.tilesUrl=p.tilesUrl,this.fileFormat=p.fileFormat,this.displayRects=p.displayRects,this.displayRects)for(u=this.displayRects.length-1;0<=u;u--)for(c=(h=this.displayRects[u]).minLevel;c<=h.maxLevel;c++)this._levelRects[c]||(this._levelRects[c]=[]),this._levelRects[c].push(h);ACa.TileSource.apply(this,[p])},ACa.extend(ACa.DziTileSource.prototype,ACa.TileSource.prototype,{supports:function(e,t){var i;return e.Image?i=e.Image.xmlns:e.documentElement&&("Image"!=e.documentElement.localName&&"Image"!=e.documentElement.tagName||(i=e.documentElement.namespaceURI)),-1!==(i=(i||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==i.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(e,t){var i;return i=ACa.isPlainObject(e)?CCa(0,e):function(e,t){if(!t||!t.documentElement)throw new Error(ACa.getString("Errors.Xml"));var i,n,r,o,s,a=t.documentElement,l=a.localName||a.tagName,u=t.documentElement.namespaceURI,h=null,c=[];if("Image"==l)try{if(void 0===(o=a.getElementsByTagName("Size")[0])&&(o=a.getElementsByTagNameNS(u,"Size")[0]),h={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:a.getAttribute("Url"),Format:a.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(a.getAttribute("Overlap"),10),TileSize:parseInt(a.getAttribute("TileSize"),10),Size:{Height:parseInt(o.getAttribute("Height"),10),Width:parseInt(o.getAttribute("Width"),10)}}},!ACa.imageFormatSupported(h.Image.Format))throw new Error(ACa.getString("Errors.ImageFormat",h.Image.Format.toUpperCase()));for(void 0===(i=a.getElementsByTagName("DisplayRect"))&&(i=a.getElementsByTagNameNS(u,"DisplayRect")[0]),s=0;s<i.length;s++)n=i[s],void 0===(r=n.getElementsByTagName("Rect")[0])&&(r=n.getElementsByTagNameNS(u,"Rect")[0]),c.push({Rect:{X:parseInt(r.getAttribute("X"),10),Y:parseInt(r.getAttribute("Y"),10),Width:parseInt(r.getAttribute("Width"),10),Height:parseInt(r.getAttribute("Height"),10),MinLevel:parseInt(n.getAttribute("MinLevel"),10),MaxLevel:parseInt(n.getAttribute("MaxLevel"),10)}});return c.length&&(h.Image.DisplayRect=c),CCa(0,h)}catch(e){throw e instanceof Error?e:new Error(ACa.getString("Errors.Dzi"))}else{if("Collection"==l)throw new Error(ACa.getString("Errors.Dzc"));if("Error"==l){var p=a.getElementsByTagName("Message")[0].firstChild.nodeValue;throw new Error(p)}}throw new Error(ACa.getString("Errors.Dzi"))}(0,e),t&&!i.tilesUrl&&(i.tilesUrl=t.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=t.search(/\.(dzi|xml|js)\?/)?i.queryParams=t.match(/\?.*/):i.queryParams=""),i},getTileUrl:function(e,t,i){return[this.tilesUrl,e,"/",t,"_",i,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,i){var n,r,o,s,a,l,u,h=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!h||!h.length)return!0;for(u=h.length-1;0<=u;u--)if(!(e<(n=h[u]).minLevel||e>n.maxLevel)&&(r=this.getLevelScale(e),o=n.x*r,s=n.y*r,a=o+n.width*r,l=s+n.height*r,o=Math.floor(o/this._tileWidth),s=Math.floor(s/this._tileWidth),a=Math.ceil(a/this._tileWidth),l=Math.ceil(l/this._tileWidth),o<=t&&t<a&&s<=i&&i<l))return!0;return!1}}),LDa=OpenSeadragon,LDa.IIIFTileSource=function(e){if(LDa.extend(!0,this,e),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(e.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.tile_width&&this.tile_height)e.tileWidth=this.tile_width,e.tileHeight=this.tile_height;else if(this.tile_width)e.tileSize=this.tile_width;else if(this.tile_height)e.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)e.tileWidth=this.tiles[0].width,e.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var t=0;t<this.tiles.length;t++)for(var i=0;i<this.tiles[t].scaleFactors.length;i++){var n=this.tiles[t].scaleFactors[i];this.scale_factors.push(n),e.tileSizePerScaleFactor[n]={width:this.tiles[t].width,height:this.tiles[t].height||this.tiles[t].width}}}else if(function(e){var t=-1!==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"].indexOf(e[0]),i=!1;return 1<e.length&&e[1].supports&&(i=-1!==e[1].supports.indexOf("sizeByW")),!t||i}(e.profile)){for(var r=Math.min(this.height,this.width),o=[256,512,1024],s=[],a=0;a<o.length;a++)o[a]<=r&&s.push(o[a]);0<s.length?e.tileSize=Math.max.apply(null,s):e.tileSize=r}else this.sizes&&0<this.sizes.length?(this.emulateLegacyImagePyramid=!0,e.levels=function(e){for(var t=[],i=0;i<e.sizes.length;i++)t.push({url:e["@id"]+"/full/"+e.sizes[i].width+",/0/default."+e.tileFormat,width:e.sizes[i].width,height:e.sizes[i].height});return t.sort(function(e,t){return e.width-t.width})}(this),LDa.extend(!0,e,{width:e.levels[e.levels.length-1].width,height:e.levels[e.levels.length-1].height,tileSize:Math.max(e.height,e.width),tileOverlap:0,minLevel:0,maxLevel:e.levels.length-1}),this.levels=e.levels):LDa.console.error("Nothing in the info.json to construct image pyramids from");if(!e.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var l=Math.max.apply(null,this.scale_factors);e.maxLevel=Math.round(Math.log(l)*Math.LOG2E)}else e.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));LDa.TileSource.apply(this,[e])},LDa.extend(LDa.IIIFTileSource.prototype,LDa.TileSource.prototype,{supports:function(e,t){return!!(e.protocol&&"http://iiif.io/api/image"==e.protocol||e["@context"]&&("http://library.stanford.edu/iiif/image-api/1.1/context.json"==e["@context"]||"http://iiif.io/api/image/1/context.json"==e["@context"])||e.profile&&0===e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")||e.identifier&&e.width&&e.height||e.documentElement&&"info"==e.documentElement.tagName&&"http://library.stanford.edu/iiif/image-api/ns/"==e.documentElement.namespaceURI)},configure:function(e,t){if(LDa.isPlainObject(e)){if(e["@context"]||(e["@context"]="http://iiif.io/api/image/1.0/context.json",e["@id"]=t.replace("/info.json","")),e.preferredFormats)for(var i=0;i<e.preferredFormats.length;i++)if(OpenSeadragon.imageFormatSupported(e.preferredFormats[i])){e.tileFormat=e.preferredFormats[i];break}return e}var n=function(e){if(!e||!e.documentElement)throw new Error(LDa.getString("Errors.Xml"));var t=e.documentElement,i=t.tagName,n=null;if("info"==i)try{return function e(t,i,n){var r,o;if(3==t.nodeType&&n)(o=t.nodeValue.trim()).match(/^\d*$/)&&(o=Number(o)),i[n]?(LDa.isArray(i[n])||(i[n]=[i[n]]),i[n].push(o)):i[n]=o;else if(1==t.nodeType)for(r=0;r<t.childNodes.length;r++)e(t.childNodes[r],i,t.nodeName)}(t,n={}),n}catch(e){throw e instanceof Error?e:new Error(LDa.getString("Errors.IIIF"))}throw new Error(LDa.getString("Errors.IIIF"))}(e);return n["@context"]="http://iiif.io/api/image/1.0/context.json",n["@id"]=t.replace("/info.xml",""),n},getTileWidth:function(e){if(this.emulateLegacyImagePyramid)return LDa.TileSource.prototype.getTileWidth.call(this,e);var t=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].width:this._tileWidth},getTileHeight:function(e){if(this.emulateLegacyImagePyramid)return LDa.TileSource.prototype.getTileHeight.call(this,e);var t=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].height:this._tileHeight},getLevelScale:function(e){if(this.emulateLegacyImagePyramid){var t=NaN;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t}return LDa.TileSource.prototype.getLevelScale.call(this,e)},getNumTiles:function(e){return this.emulateLegacyImagePyramid?this.getLevelScale(e)?new LDa.Point(1,1):new LDa.Point(0,0):LDa.TileSource.prototype.getNumTiles.call(this,e)},getTileAtPoint:function(e,t){return this.emulateLegacyImagePyramid?new LDa.Point(0,0):LDa.TileSource.prototype.getTileAtPoint.call(this,e,t)},getTileUrl:function(e,t,i){if(this.emulateLegacyImagePyramid){var n=null;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n}var r,o,s,a,l,u,h,c,p,d,f,g,m,v=Math.pow(.5,this.maxLevel-e),y=Math.ceil(this.width*v),w=Math.ceil(this.height*v);return r=this.getTileWidth(e),o=this.getTileHeight(e),s=Math.ceil(r/v),a=Math.ceil(o/v),g=(m=-1<this["@context"].indexOf("/1.0/context.json")||-1<this["@context"].indexOf("/1.1/context.json")||-1<this["@context"].indexOf("/1/context.json"))?"native."+this.tileFormat:"default."+this.tileFormat,y<r&&w<o?(d=m||y!==this.width?y+",":"max",l="full"):(u=t*s,h=i*a,c=Math.min(s,this.width-u),p=Math.min(a,this.height-h),l=0===t&&0===i&&c===this.width&&p===this.height?"full":[u,h,c,p].join(","),f=Math.ceil(c*v),d=m||f!==this.width?f+",":"max"),[this["@id"],l,d,"0",g].join("/")}}),aFa=OpenSeadragon,aFa.OsmTileSource=function(e,t,i,n,r){var o;(o=aFa.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:r}).width&&o.height||(o.width=65572864,o.height=65572864),o.tileSize||(o.tileSize=256,o.tileOverlap=0),o.tilesUrl||(o.tilesUrl="http://tile.openstreetmap.org/"),o.minLevel=8,aFa.TileSource.apply(this,[o])},aFa.extend(aFa.OsmTileSource.prototype,aFa.TileSource.prototype,{supports:function(e,t){return e.type&&"openstreetmaps"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){return this.tilesUrl+(e-8)+"/"+t+"/"+i+".png"}}),oFa=OpenSeadragon,oFa.TmsTileSource=function(e,t,i,n,r){var o;o=oFa.isPlainObject(e)?e:{width:e,height:t,tileSize:i,tileOverlap:n,tilesUrl:r};var s,a=256*Math.ceil(o.width/256),l=256*Math.ceil(o.height/256);s=l<a?a/256:l/256,o.maxLevel=Math.ceil(Math.log(s)/Math.log(2))-1,o.tileSize=256,o.width=a,o.height=l,oFa.TileSource.apply(this,[o])},oFa.extend(oFa.TmsTileSource.prototype,oFa.TileSource.prototype,{supports:function(e,t){return e.type&&"tiledmapservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){var n=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(n-i)+".png"}}),GFa=OpenSeadragon,GFa.ZoomifyTileSource=function(e){e.tileSize=256;var t={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(t.x,10)>e.tileSize||parseInt(t.y,10)>e.tileSize;)t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e.imageSizes.push({x:t.x,y:t.y}),e.gridSize.push(this._getGridSize(t.x,t.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},GFa.extend(GFa.ZoomifyTileSource.prototype,GFa.TileSource.prototype,{_getGridSize:function(e,t,i){return{x:Math.ceil(e/i),y:Math.ceil(t/i)}},_calculateAbsoluteTileNumber:function(e,t,i){for(var n=0,r={},o=0;o<e;o++)n+=(r=this.gridSize[o]).x*r.y;return n+=(r=this.gridSize[e]).x*i+t},supports:function(e,t){return e.type&&"zoomifytileservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,i){var n,r=this._calculateAbsoluteTileNumber(e,t,i);return n=Math.floor(r/256),this.tilesUrl+"TileGroup"+n+"/"+e+"-"+t+"-"+i+".jpg"}}),_Fa=OpenSeadragon,_Fa.LegacyTileSource=function(e){var t,i,n;_Fa.isArray(e)&&(t={type:"legacy-image-pyramid",levels:e}),t.levels=function(e){var t,i,n=[];for(i=0;i<e.length;i++)(t=e[i]).height&&t.width&&t.url?n.push({url:t.url,width:Number(t.width),height:Number(t.height)}):_Fa.console.error("Unsupported image format: %s",t.url?t.url:"<no URL>");return n.sort(function(e,t){return e.height-t.height})}(t.levels),0<t.levels.length?(i=t.levels[t.levels.length-1].width,n=t.levels[t.levels.length-1].height):(n=i=0,_Fa.console.error("No supported image formats found")),_Fa.extend(!0,t,{width:i,height:n,tileSize:Math.max(n,i),tileOverlap:0,minLevel:0,maxLevel:0<t.levels.length?t.levels.length-1:0}),_Fa.TileSource.apply(this,[t]),this.levels=t.levels},_Fa.extend(_Fa.LegacyTileSource.prototype,_Fa.TileSource.prototype,{supports:function(e,t){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(e,t){return _Fa.isPlainObject(e)?cGa(0,e):function(e,t){if(!t||!t.documentElement)throw new Error(_Fa.getString("Errors.Xml"));var i,n,r=t.documentElement,o=r.tagName,s=null,a=[];if("image"==o)try{for(s={type:r.getAttribute("type"),levels:[]},a=r.getElementsByTagName("level"),n=0;n<a.length;n++)i=a[n],s.levels.push({url:i.getAttribute("url"),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10)});return cGa(0,s)}catch(e){throw e instanceof Error?e:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==o)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==o)throw new Error("Error: "+t)}throw new Error("Unknown element "+o)}(0,e)},getLevelScale:function(e){var t=NaN;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(e){return this.getLevelScale(e)?new _Fa.Point(1,1):new _Fa.Point(0,0)},getTileUrl:function(e,t,i){var n=null;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n}}),LGa=OpenSeadragon,LGa.ImageTileSource=function(e){e=LGa.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},e),LGa.TileSource.apply(this,[e])},LGa.extend(LGa.ImageTileSource.prototype,LGa.TileSource.prototype,{supports:function(e,t){return e.type&&"image"===e.type},configure:function(e,t){return e},getImageInfo:function(e){var t=this._image=new Image,i=this;this.crossOriginPolicy&&(t.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(t.useCredentials=this.ajaxWithCredentials),LGa.addEvent(t,"load",function(){i.width=Object.prototype.hasOwnProperty.call(t,"naturalWidth")?t.naturalWidth:t.width,i.height=Object.prototype.hasOwnProperty.call(t,"naturalHeight")?t.naturalHeight:t.height,i.aspectRatio=i.width/i.height,i.dimensions=new LGa.Point(i.width,i.height),i._tileWidth=i.width,i._tileHeight=i.height,i.tileOverlap=0,i.minLevel=0,i.levels=i._buildLevels(),i.maxLevel=i.levels.length-1,i.ready=!0,i.raiseEvent("ready",{tileSource:i})}),LGa.addEvent(t,"error",function(){i.raiseEvent("open-failed",{message:"Error loading image at "+e,source:e})}),t.src=e},getLevelScale:function(e){var t=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(e){return this.getLevelScale(e)?new LGa.Point(1,1):new LGa.Point(0,0)},getTileUrl:function(e,t,i){var n=null;return e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].url),n},getContext2D:function(e,t,i){var n=null;return e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].context2D),n},_buildLevels:function(){var e=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!LGa.supportsCanvas||!this.useCanvas)return delete this._image,e;var t=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,i=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,n=document.createElement("canvas"),r=n.getContext("2d");if(n.width=t,n.height=i,r.drawImage(this._image,0,0,t,i),e[0].context2D=r,delete this._image,LGa.isCanvasTainted(n))return e;for(;2<=t&&2<=i;){t=Math.floor(t/2),i=Math.floor(i/2);var o=document.createElement("canvas"),s=o.getContext("2d");o.width=t,o.height=i,s.drawImage(n,0,0,t,i),e.splice(0,0,{context2D:s,width:t,height:i}),n=o,r=s}return e}}),lHa=OpenSeadragon,lHa.TileSourceCollection=function(e,t,i,n){lHa.console.error("TileSourceCollection is deprecated; use World instead")},qHa=OpenSeadragon,qHa.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},qHa.Button=function(e){var t=this;qHa.EventSource.call(this),qHa.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:qHa.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:qHa.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},e),this.element=e.element||qHa.makeNeutralElement("div"),e.element||(this.imgRest=qHa.makeTransparentImage(this.srcRest),this.imgGroup=qHa.makeTransparentImage(this.srcGroup),this.imgHover=qHa.makeTransparentImage(this.srcHover),this.imgDown=qHa.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",qHa.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",qHa.Browser.vendor==qHa.BROWSERS.FIREFOX&&qHa.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=qHa.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new qHa.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){e.insideElementPressed?(vHa(t,qHa.ButtonState.DOWN),t.raiseEvent("enter",{originalEvent:e.originalEvent})):e.buttonDownAny||vHa(t,qHa.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),t.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(e){wHa(t,qHa.ButtonState.GROUP),e.insideElementPressed&&t.raiseEvent("exit",{originalEvent:e.originalEvent})},blurHandler:function(e){this.exitHandler(e),t.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(e){vHa(t,qHa.ButtonState.DOWN),t.raiseEvent("press",{originalEvent:e.originalEvent})},releaseHandler:function(e){e.insideElementPressed&&e.insideElementReleased?(wHa(t,qHa.ButtonState.HOVER),t.raiseEvent("release",{originalEvent:e.originalEvent})):e.insideElementPressed?wHa(t,qHa.ButtonState.GROUP):vHa(t,qHa.ButtonState.HOVER)},clickHandler:function(e){e.quick&&t.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13!==e.keyCode||(t.raiseEvent("click",{originalEvent:e.originalEvent}),t.raiseEvent("release",{originalEvent:e.originalEvent}),!1)}}),wHa(this,qHa.ButtonState.REST)},qHa.extend(qHa.Button.prototype,qHa.EventSource.prototype,{notifyGroupEnter:function(){vHa(this,qHa.ButtonState.GROUP)},notifyGroupExit:function(){wHa(this,qHa.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,qHa.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,qHa.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}}),SHa=OpenSeadragon,SHa.ButtonGroup=function(e){SHa.extend(!0,this,{buttons:[],clickTimeThreshold:SHa.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:SHa.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},e);var t,i=this.buttons.concat([]),n=this;if(this.element=e.element||SHa.makeNeutralElement("div"),!e.group)for(this.element.style.display="inline-block",t=0;t<i.length;t++)this.element.appendChild(i[t].element);SHa.setElementTouchActionNone(this.element),this.tracker=new SHa.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){var t;for(t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupEnter()},exitHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<n.buttons.length;t++)n.buttons[t].notifyGroupExit()}})},SHa.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}},_Ha=OpenSeadragon,_Ha.Rect=function(e,t,i,n,r){var o,s;this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.width="number"==typeof i?i:0,this.height="number"==typeof n?n:0,this.degrees="number"==typeof r?r:0,this.degrees=_Ha.positiveModulo(this.degrees,360),270<=this.degrees?(o=this.getTopRight(),this.x=o.x,this.y=o.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=270):180<=this.degrees?(o=this.getBottomRight(),this.x=o.x,this.y=o.y,this.degrees-=180):90<=this.degrees&&(o=this.getBottomLeft(),this.x=o.x,this.y=o.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=90)},_Ha.Rect.fromSummits=function(e,t,i){var n=e.distanceTo(t),r=e.distanceTo(i),o=t.minus(e),s=Math.atan(o.y/o.x);return o.x<0?s+=Math.PI:o.y<0&&(s+=2*Math.PI),new _Ha.Rect(e.x,e.y,n,r,s/Math.PI*180)},_Ha.Rect.prototype={clone:function(){return new _Ha.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new _Ha.Point(this.x,this.y)},getBottomRight:function(){return new _Ha.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new _Ha.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new _Ha.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new _Ha.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new _Ha.Point(this.width,this.height)},equals:function(e){return e instanceof _Ha.Rect&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height&&this.degrees===e.degrees},times:function(e){return new _Ha.Rect(this.x*e,this.y*e,this.width*e,this.height*e,this.degrees)},translate:function(e){return new _Ha.Rect(this.x+e.x,this.y+e.y,this.width,this.height,this.degrees)},union:function(e){var t=this.getBoundingBox(),i=e.getBoundingBox(),n=Math.min(t.x,i.x),r=Math.min(t.y,i.y),o=Math.max(t.x+t.width,i.x+i.width),s=Math.max(t.y+t.height,i.y+i.height);return new _Ha.Rect(n,r,o-n,s-r)},intersection:function(e){var u=1e-10,t=[],i=this.getTopLeft();e.containsPoint(i,u)&&t.push(i);var n=this.getTopRight();e.containsPoint(n,u)&&t.push(n);var r=this.getBottomLeft();e.containsPoint(r,u)&&t.push(r);var o=this.getBottomRight();e.containsPoint(o,u)&&t.push(o);var s=e.getTopLeft();this.containsPoint(s,u)&&t.push(s);var a=e.getTopRight();this.containsPoint(a,u)&&t.push(a);var l=e.getBottomLeft();this.containsPoint(l,u)&&t.push(l);var h=e.getBottomRight();this.containsPoint(h,u)&&t.push(h);for(var c=this._getSegments(),p=e._getSegments(),d=0;d<c.length;d++)for(var f=c[d],g=0;g<p.length;g++){var m=p[g],v=y(f[0],f[1],m[0],m[1]);v&&t.push(v)}function y(e,t,i,n){var r=t.minus(e),o=n.minus(i),s=-o.x*r.y+r.x*o.y;if(0==s)return null;var a=(r.x*(e.y-i.y)-r.y*(e.x-i.x))/s,l=(o.x*(e.y-i.y)-o.y*(e.x-i.x))/s;return-u<=a&&a<=1-u&&-u<=l&&l<=1-u?new _Ha.Point(e.x+l*r.x,e.y+l*r.y):null}if(0===t.length)return null;for(var w=t[0].x,S=t[0].x,_=t[0].y,T=t[0].y,b=1;b<t.length;b++){var E=t[b];E.x<w&&(w=E.x),E.x>S&&(S=E.x),E.y<_&&(_=E.y),E.y>T&&(T=E.y)}return new _Ha.Rect(w,_,S-w,T-_)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),i=this.getBottomLeft(),n=this.getBottomRight();return[[e,t],[t,n],[n,i],[i,e]]},rotate:function(e,t){if(0===(e=_Ha.positiveModulo(e,360)))return this.clone();t=t||this.getCenter();var i=this.getTopLeft().rotate(e,t),n=this.getTopRight().rotate(e,t).minus(i);n=n.apply(function(e){return Math.abs(e)<1e-15?0:e});var r=Math.atan(n.y/n.x);return n.x<0?r+=Math.PI:n.y<0&&(r+=2*Math.PI),new _Ha.Rect(i.x,i.y,this.width,this.height,r/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var e=this.getTopLeft(),t=this.getTopRight(),i=this.getBottomLeft(),n=this.getBottomRight(),r=Math.min(e.x,t.x,i.x,n.x),o=Math.max(e.x,t.x,i.x,n.x),s=Math.min(e.y,t.y,i.y,n.y),a=Math.max(e.y,t.y,i.y,n.y);return new _Ha.Rect(r,s,o-r,a-s)},getIntegerBoundingBox:function(){var e=this.getBoundingBox(),t=Math.floor(e.x),i=Math.floor(e.y),n=Math.ceil(e.width+e.x-t),r=Math.ceil(e.height+e.y-i);return new _Ha.Rect(t,i,n,r)},containsPoint:function(e,t){t=t||0;var i=this.getTopLeft(),n=this.getTopRight(),r=this.getBottomLeft(),o=n.minus(i),s=r.minus(i);return(e.x-i.x)*o.x+(e.y-i.y)*o.y>=-t&&(e.x-n.x)*o.x+(e.y-n.y)*o.y<=t&&(e.x-i.x)*s.x+(e.y-i.y)*s.y>=-t&&(e.x-r.x)*s.x+(e.y-r.y)*s.y<=t},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}},KJa=OpenSeadragon,LJa={},KJa.ReferenceStrip=function(e){var t,i,n,o=e.viewer,r=KJa.getElementSize(o.element);for(e.id||(e.id="referencestrip-"+KJa.now(),this.element=KJa.makeNeutralElement("div"),this.element.id=e.id,this.element.className="referencestrip"),e=KJa.extend(!0,{sizeRatio:KJa.DEFAULT_SETTINGS.referenceStripSizeRatio,position:KJa.DEFAULT_SETTINGS.referenceStripPosition,scroll:KJa.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:KJa.DEFAULT_SETTINGS.clickTimeThreshold},e,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),KJa.extend(this,e),LJa[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(i=this.element.style).marginTop="0px",i.marginRight="0px",i.marginBottom="0px",i.marginLeft="0px",i.left="0px",i.bottom="0px",i.border="0px",i.background="#000",i.position="relative",KJa.setElementTouchActionNone(this.element),KJa.setElementOpacity(this.element,.8),this.viewer=o,this.innerTracker=new KJa.MouseTracker({element:this.element,dragHandler:KJa.delegate(this,MJa),scrollHandler:KJa.delegate(this,NJa),enterHandler:KJa.delegate(this,PJa),exitHandler:KJa.delegate(this,QJa),keyDownHandler:KJa.delegate(this,RJa),keyHandler:KJa.delegate(this,SJa)}),e.width&&e.height?(this.element.style.width=e.width+"px",this.element.style.height=e.height+"px",o.addControl(this.element,{anchor:KJa.ControlAnchor.BOTTOM_LEFT})):"horizontal"==e.scroll?(this.element.style.width=r.x*e.sizeRatio*o.tileSources.length+12*o.tileSources.length+"px",this.element.style.height=r.y*e.sizeRatio+"px",o.addControl(this.element,{anchor:KJa.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=r.y*e.sizeRatio*o.tileSources.length+12*o.tileSources.length+"px",this.element.style.width=r.x*e.sizeRatio+"px",o.addControl(this.element,{anchor:KJa.ControlAnchor.TOP_LEFT})),this.panelWidth=r.x*this.sizeRatio+8,this.panelHeight=r.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},n=0;n<o.tileSources.length;n++)(t=KJa.makeNeutralElement("div")).id=this.element.id+"-"+n,t.style.width=this.panelWidth+"px",t.style.height=this.panelHeight+"px",t.style.display="inline",t.style.float="left",t.style.cssFloat="left",t.style.styleFloat="left",t.style.padding="2px",KJa.setElementTouchActionNone(t),t.innerTracker=new KJa.MouseTracker({element:t,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(e){e.eventSource.dragging=KJa.now()},releaseHandler:function(e){var t=e.eventSource,i=t.element.id,n=Number(i.split("-")[2]),r=KJa.now();e.insideElementPressed&&e.insideElementReleased&&t.dragging&&r-t.dragging<t.clickTimeThreshold&&(t.dragging=null,o.goToPage(n))}}),this.element.appendChild(t),t.activePanel=!1,this.panels.push(t);OJa(this,"vertical"==this.scroll?r.y:r.x,0),this.setFocus(0)},KJa.extend(KJa.ReferenceStrip.prototype,KJa.EventSource.prototype,KJa.Viewer.prototype,{setFocus:function(e){var t,i=KJa.getElement(this.element.id+"-"+e),n=KJa.getElementSize(this.viewer.canvas),r=Number(this.element.style.width.replace("px","")),o=Number(this.element.style.height.replace("px","")),s=-Number(this.element.style.marginLeft.replace("px","")),a=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==i&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=i,this.currentSelected.style.background="#999","horizontal"==this.scroll?(t=Number(e)*(this.panelWidth+3))>s+n.x-this.panelWidth?(t=Math.min(t,r-n.x),this.element.style.marginLeft=-t+"px",OJa(this,n.x,-t)):t<s&&(t=Math.max(0,t-n.x/2),this.element.style.marginLeft=-t+"px",OJa(this,n.x,-t)):(t=Number(e)*(this.panelHeight+3))>a+n.y-this.panelHeight?(t=Math.min(t,o-n.y),this.element.style.marginTop=-t+"px",OJa(this,n.y,-t)):t<a&&(t=Math.max(0,t-n.y/2),this.element.style.marginTop=-t+"px",OJa(this,n.y,-t)),this.currentPage=e,PJa.call(this,{eventSource:this.innerTracker}))},update:function(){return!!LJa[this.id].animating&&(KJa.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.element&&this.element.parentNode.removeChild(this.element)}}),RKa=OpenSeadragon,RKa.DisplayRect=function(e,t,i,n,r,o){RKa.Rect.apply(this,[e,t,i,n]),this.minLevel=r,this.maxLevel=o},RKa.extend(RKa.DisplayRect.prototype,RKa.Rect.prototype),YKa=OpenSeadragon,YKa.Spring=function(e){var t=arguments;"object"!=typeof e&&(e={initial:t.length&&"number"==typeof t[0]?t[0]:void 0,springStiffness:1<t.length?t[1].springStiffness:5,animationTime:1<t.length?t[1].animationTime:1.5}),YKa.console.assert("number"==typeof e.springStiffness&&0!==e.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),YKa.console.assert("number"==typeof e.animationTime&&0<=e.animationTime,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),e.exponential&&(this._exponential=!0,delete e.exponential),YKa.extend(!0,this,e),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:YKa.now()},YKa.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},YKa.Spring.prototype={resetTo:function(e){YKa.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=e,this.start.time=this.target.time=this.current.time=YKa.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(e){YKa.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(e){this.start.value+=e,this.target.value+=e,this._exponential&&(YKa.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(e){this._exponential=e,this._exponential&&(YKa.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var e,t;this.current.time=YKa.now(),t=this._exponential?(e=this.start._logValue,this.target._logValue):(e=this.start.value,this.target.value);var i=this.current.time>=this.target.time?t:e+(t-e)*function(e,t){return(1-Math.exp(e*-t))/(1-Math.exp(-e))}(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),n=this.current.value;return this._exponential?this.current.value=Math.exp(i):this.current.value=i,n!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}},kLa=OpenSeadragon,lLa.prototype={errorMsg:null,start:function(){var o=this,e=this.abort;this.image=new Image,this.image.onload=function(){o.finish(!0)},this.image.onabort=this.image.onerror=function(){o.errorMsg="Image load aborted",o.finish(!1)},this.jobId=window.setTimeout(function(){o.errorMsg="Image load exceeded timeout ("+o.timeout+" ms)",o.finish(!1)},this.timeout),this.loadWithAjax?(this.request=kLa.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(t){var i;try{i=new window.Blob([t.response])}catch(e){var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===e.name&&n){var r=new n;r.append(t.response),i=r.getBlob()}}0===i.size&&(o.errorMsg="Empty image response.",o.finish(!1));var e=(window.URL||window.webkitURL).createObjectURL(i);o.image.src=e},error:function(e){o.errorMsg="Image load aborted - XHR error",o.finish(!1)}}),this.abort=function(){o.request.abort(),"function"==typeof e&&e()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},kLa.ImageLoader=function(e){kLa.extend(!0,this,{jobLimit:kLa.DEFAULT_SETTINGS.imageLoaderLimit,timeout:kLa.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},e)},kLa.ImageLoader.prototype={addJob:function(t){var i=this,e=new lLa({src:t.src,loadWithAjax:t.loadWithAjax,ajaxHeaders:t.loadWithAjax?t.ajaxHeaders:null,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:function(e){!function(e,t,i){e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&0<e.jobQueue.length&&(e.jobQueue.shift().start(),e.jobsInProgress++),i(t.image,t.errorMsg,t.request)}(i,e,t.callback)},abort:t.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(e.start(),this.jobsInProgress++):this.jobQueue.push(e)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var t=this.jobQueue[e];"function"==typeof t.abort&&t.abort()}this.jobQueue=[]}},LLa=OpenSeadragon,LLa.Tile=function(e,t,i,n,r,o,s,a,l,u){this.level=e,this.x=t,this.y=i,this.bounds=n,this.sourceBounds=u,this.exists=r,this.url=o,this.context2D=s,this.loadWithAjax=a,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},LLa.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(e){this.cacheImageRecord?this.loaded?(this.element||(this.element=LLa.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=e&&e.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",LLa.setElementOpacity(this.element,this.opacity)):LLa.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):LLa.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(e,t,i,n){var r,o,s,a=this.position.times(LLa.pixelDensityRatio),l=this.size.times(LLa.pixelDensityRatio);this.context2D||this.cacheImageRecord?(r=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&r?(e.save(),e.globalAlpha=this.opacity,"number"==typeof i&&1!==i&&(a=a.times(i),l=l.times(i)),n instanceof LLa.Point&&(a=a.plus(n)),1===e.globalAlpha&&this._hasTransparencyChannel()&&e.clearRect(a.x,a.y,l.x,l.y),t({context:e,tile:this,rendered:r}),s=this.sourceBounds?(o=Math.min(this.sourceBounds.width,r.canvas.width),Math.min(this.sourceBounds.height,r.canvas.height)):(o=r.canvas.width,r.canvas.height),e.drawImage(r.canvas,0,0,o,s,a.x,a.y,l.x,l.y),e.restore()):LLa.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):LLa.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var e;if(this.cacheImageRecord)e=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return LLa.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;e=this.context2D}return e.canvas.width/(this.size.x*LLa.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(e,t,i){var n=Math.max(1,Math.ceil((i.x-t.x)/2)),r=Math.max(1,Math.ceil((i.y-t.y)/2));return new LLa.Point(n,r).minus(this.position.times(LLa.pixelDensityRatio).times(e||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}},lMa=OpenSeadragon,lMa.OverlayPlacement=lMa.Placement,lMa.OverlayRotationMode=lMa.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),lMa.Overlay=function(e,t,i){var n;n=lMa.isPlainObject(e)?e:{element:e,location:t,placement:i},this.element=n.element,this.style=n.element.style,this._init(n)},lMa.Overlay.prototype={_init:function(e){this.location=e.location,this.placement=void 0===e.placement?lMa.Placement.TOP_LEFT:e.placement,this.onDraw=e.onDraw,this.checkResize=void 0===e.checkResize||e.checkResize,this.width=void 0===e.width?null:e.width,this.height=void 0===e.height?null:e.height,this.rotationMode=e.rotationMode||lMa.OverlayRotationMode.EXACT,this.location instanceof lMa.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=lMa.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new lMa.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(e,t){var i=lMa.Placement.properties[this.placement];i&&(i.isHorizontallyCentered?e.x-=t.x/2:i.isRight&&(e.x-=t.x),i.isVerticallyCentered?e.y-=t.y/2:i.isBottom&&(e.y-=t.y))},destroy:function(){var e=this.element,t=this.style;e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent&&(t.display="none",document.body.appendChild(e))),this.onDraw=null,t.top="",t.left="",t.position="",null!==this.width&&(t.width=""),null!==this.height&&(t.height="");var i=lMa.getCssPropertyWithVendorPrefix("transformOrigin"),n=lMa.getCssPropertyWithVendorPrefix("transform");i&&n&&(t[i]="",t[n]="")},drawHTML:function(e,t){var i=this.element;i.parentNode!==e&&(i.prevElementParent=i.parentNode,i.prevNextSibling=i.nextSibling,e.appendChild(i),this.style.position="absolute",this.size=lMa.getElementSize(i));var n=this._getOverlayPositionAndSize(t),r=n.position,o=this.size=n.size,s=n.rotate;if(this.onDraw)this.onDraw(r,o,this.element);else{var a=this.style;a.left=r.x+"px",a.top=r.y+"px",null!==this.width&&(a.width=o.x+"px"),null!==this.height&&(a.height=o.y+"px");var l=lMa.getCssPropertyWithVendorPrefix("transformOrigin"),u=lMa.getCssPropertyWithVendorPrefix("transform");l&&u&&(s?(a[l]=this._getTransformOrigin(),a[u]="rotate("+s+"deg)"):(a[l]="",a[u]="")),"none"!==a.display&&(a.display="block")}},_getOverlayPositionAndSize:function(e){var t=e.pixelFromPoint(this.location,!0),i=this._getSizeInPixels(e);this.adjust(t,i);var n=0;if(e.degrees&&this.rotationMode!==lMa.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===lMa.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var r=new lMa.Rect(t.x,t.y,i.x,i.y),o=this._getBoundingBox(r,e.degrees);t=o.getTopLeft(),i=o.getSize()}else n=e.degrees;return{position:t,size:i,rotate:n}},_getSizeInPixels:function(e){var t=this.size.x,i=this.size.y;if(null!==this.width||null!==this.height){var n=e.deltaPixelsFromPointsNoRotate(new lMa.Point(this.width||0,this.height||0),!0);null!==this.width&&(t=n.x),null!==this.height&&(i=n.y)}if(this.checkResize&&(null===this.width||null===this.height)){var r=this.size=lMa.getElementSize(this.element);null===this.width&&(t=r.x),null===this.height&&(i=r.y)}return new lMa.Point(t,i)},_getBoundingBox:function(e,t){var i=this._getPlacementPoint(e);return e.rotate(t,i).getBoundingBox()},_getPlacementPoint:function(e){var t=new lMa.Point(e.x,e.y),i=lMa.Placement.properties[this.placement];return i&&(i.isHorizontallyCentered?t.x+=e.width/2:i.isRight&&(t.x+=e.width),i.isVerticallyCentered?t.y+=e.height/2:i.isBottom&&(t.y+=e.height)),t},_getTransformOrigin:function(){var e="",t=lMa.Placement.properties[this.placement];return t&&(t.isLeft?e="left":t.isRight&&(e="right"),t.isTop?e+=" top":t.isBottom&&(e+=" bottom")),e},update:function(e,t){var i=lMa.isPlainObject(e)?e:{location:e,placement:t};this._init({location:i.location||this.location,placement:void 0!==i.placement?i.placement:this.placement,onDraw:i.onDraw||this.onDraw,checkResize:i.checkResize||this.checkResize,width:void 0!==i.width?i.width:this.width,height:void 0!==i.height?i.height:this.height,rotationMode:i.rotationMode||this.rotationMode})},getBounds:function(e){lMa.console.assert(e,"A viewport must now be passed to Overlay.getBounds.");var t=this.width,i=this.height;if(null===t||null===i){var n=e.deltaPointsFromPixelsNoRotate(this.size,!0);null===t&&(t=n.x),null===i&&(i=n.y)}var r=this.location.clone();return this.adjust(r,new lMa.Point(t,i)),this._adjustBoundsForRotation(e,new lMa.Rect(r.x,r.y,t,i))},_adjustBoundsForRotation:function(e,t){if(!e||0===e.degrees||this.rotationMode===lMa.OverlayRotationMode.EXACT)return t;if(this.rotationMode!==lMa.OverlayRotationMode.BOUNDING_BOX)return t.rotate(-e.degrees,this._getPlacementPoint(t));if(null===this.width||null===this.height)return t;var i=this._getOverlayPositionAndSize(e);return e.viewerElementToViewportRectangle(new lMa.Rect(i.position.x,i.position.y,i.size.x,i.size.y))}},kNa=OpenSeadragon,kNa.Drawer=function(e){kNa.console.assert(e.viewer,"[Drawer] options.viewer is required");var t=arguments;if(kNa.isPlainObject(e)||(e={source:t[0],viewport:t[1],element:t[2]}),kNa.console.assert(e.viewport,"[Drawer] options.viewport is required"),kNa.console.assert(e.element,"[Drawer] options.element is required"),e.source&&kNa.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=e.viewer,this.viewport=e.viewport,this.debugGridColor="string"==typeof e.debugGridColor?[e.debugGridColor]:e.debugGridColor||kNa.DEFAULT_SETTINGS.debugGridColor,e.opacity&&kNa.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=kNa.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=kNa.getElement(e.element),this.canvas=kNa.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var i=this._calculateCanvasSize();this.canvas.width=i.x,this.canvas.height=i.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",kNa.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},kNa.Drawer.prototype={addOverlay:function(e,t,i,n){return kNa.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(e,t,i,n),this},updateOverlay:function(e,t,i){return kNa.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(e,t,i),this},removeOverlay:function(e){return kNa.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(e),this},clearOverlays:function(){return kNa.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(e){kNa.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var t=this.viewer.world,i=0;i<t.getItemCount();i++)t.getItemAt(i).setOpacity(e);return this},getOpacity:function(){kNa.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var e=this.viewer.world,t=0,i=0;i<e.getItemCount();i++){var n=e.getItemAt(i).getOpacity();t<n&&(t=n)}return t},needsUpdate:function(){return kNa.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return kNa.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return kNa.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return kNa.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var e=this._calculateCanvasSize();if((this.canvas.width!=e.x||this.canvas.height!=e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas)){var t=this._calculateSketchCanvasSize();this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(e,t){if(this.useCanvas){var i=this._getContext(e);if(t)i.clearRect(t.x,t.y,t.width,t.height);else{var n=i.canvas;i.clearRect(0,0,n.width,n.height)}}},viewportToDrawerRectangle:function(e){var t=this.viewport.pixelFromPointNoRotate(e.getTopLeft(),!0),i=this.viewport.deltaPixelsFromPointsNoRotate(e.getSize(),!0);return new kNa.Rect(t.x*kNa.pixelDensityRatio,t.y*kNa.pixelDensityRatio,i.x*kNa.pixelDensityRatio,i.y*kNa.pixelDensityRatio)},drawTile:function(e,t,i,n,r){if(kNa.console.assert(e,"[Drawer.drawTile] tile is required"),kNa.console.assert(t,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var o=this._getContext(i);n=n||1,e.drawCanvas(o,t,n,r)}else e.drawHTML(this.canvas)},_getContext:function(e){var t=this.context;if(e){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var i=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=i.x,this.sketchCanvas.height=i.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var n=this;this.viewer.addHandler("rotate",function e(){if(0!==n.viewport.getRotation()){n.viewer.removeHandler("rotate",e);var t=n._calculateSketchCanvasSize();n.sketchCanvas.width=t.x,n.sketchCanvas.height=t.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}t=this.sketchContext}return t},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,t){if(this.useCanvas){var i=this._getContext(t);i.beginPath(),i.rect(e.x,e.y,e.width,e.height),i.clip()}},drawRectangle:function(e,t,i){if(this.useCanvas){var n=this._getContext(i);n.save(),n.fillStyle=t,n.fillRect(e.x,e.y,e.width,e.height),n.restore()}},blendSketch:function(e,t,i,n){var r=e;if(kNa.isPlainObject(r)||(r={opacity:e,scale:t,translate:i,compositeOperation:n}),this.useCanvas&&this.sketchCanvas){e=r.opacity,n=r.compositeOperation;var o=r.bounds;if(this.context.save(),this.context.globalAlpha=e,n&&(this.context.globalCompositeOperation=n),o)o.x<0&&(o.width+=o.x,o.x=0),o.x+o.width>this.canvas.width&&(o.width=this.canvas.width-o.x),o.y<0&&(o.height+=o.y,o.y=0),o.y+o.height>this.canvas.height&&(o.height=this.canvas.height-o.y),this.context.drawImage(this.sketchCanvas,o.x,o.y,o.width,o.height,o.x,o.y,o.width,o.height);else{t=r.scale||1;var s=(i=r.translate)instanceof kNa.Point?i:new kNa.Point(0,0),a=0,l=0;if(i){var u=this.sketchCanvas.width-this.canvas.width,h=this.sketchCanvas.height-this.canvas.height;a=Math.round(u/2),l=Math.round(h/2)}this.context.drawImage(this.sketchCanvas,s.x-a*t,s.y-l*t,(this.canvas.width+2*a)*t,(this.canvas.height+2*l)*t,-a,-l,this.canvas.width+2*a,this.canvas.height+2*l)}this.context.restore()}},drawDebugInfo:function(e,t,i,n){if(this.useCanvas){var r=this.viewer.world.getIndexOfItem(n)%this.debugGridColor.length,o=this.context;o.save(),o.lineWidth=2*kNa.pixelDensityRatio,o.font="small-caps bold "+13*kNa.pixelDensityRatio+"px arial",o.strokeStyle=this.debugGridColor[r],o.fillStyle=this.debugGridColor[r],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),n.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:n.getRotation(!0),point:n.viewport.pixelFromPointNoRotate(n._getRotationPoint(!0),!0)}),0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip(),o.strokeRect(e.position.x*kNa.pixelDensityRatio,e.position.y*kNa.pixelDensityRatio,e.size.x*kNa.pixelDensityRatio,e.size.y*kNa.pixelDensityRatio);var s=(e.position.x+e.size.x/2)*kNa.pixelDensityRatio,a=(e.position.y+e.size.y/2)*kNa.pixelDensityRatio;o.translate(s,a),o.rotate(Math.PI/180*-this.viewport.degrees),o.translate(-s,-a),0===e.x&&0===e.y&&(o.fillText("Zoom: "+this.viewport.getZoom(),e.position.x*kNa.pixelDensityRatio,(e.position.y-30)*kNa.pixelDensityRatio),o.fillText("Pan: "+this.viewport.getBounds().toString(),e.position.x*kNa.pixelDensityRatio,(e.position.y-20)*kNa.pixelDensityRatio)),o.fillText("Level: "+e.level,(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+20)*kNa.pixelDensityRatio),o.fillText("Column: "+e.x,(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+30)*kNa.pixelDensityRatio),o.fillText("Row: "+e.y,(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+40)*kNa.pixelDensityRatio),o.fillText("Order: "+i+" of "+t,(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+50)*kNa.pixelDensityRatio),o.fillText("Size: "+e.size.toString(),(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+60)*kNa.pixelDensityRatio),o.fillText("Position: "+e.position.toString(),(e.position.x+10)*kNa.pixelDensityRatio,(e.position.y+70)*kNa.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),n.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip(),o.restore()}},debugRect:function(e){if(this.useCanvas){var t=this.context;t.save(),t.lineWidth=2*kNa.pixelDensityRatio,t.strokeStyle=this.debugGridColor[0],t.fillStyle=this.debugGridColor[0],t.strokeRect(e.x*kNa.pixelDensityRatio,e.y*kNa.pixelDensityRatio,e.width*kNa.pixelDensityRatio,e.height*kNa.pixelDensityRatio),t.restore()}},setImageSmoothingEnabled:function(e){this.useCanvas&&(this._imageSmoothingEnabled=e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(e){e.mozImageSmoothingEnabled=this._imageSmoothingEnabled,e.webkitImageSmoothingEnabled=this._imageSmoothingEnabled,e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(e){var t=this._getContext(e).canvas;return new kNa.Point(t.width,t.height)},getCanvasCenter:function(){return new kNa.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(e){var t=e.point?e.point.times(kNa.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(e.useSketch);i.save(),i.translate(t.x,t.y),this.viewer.viewport.flipped?(i.rotate(Math.PI/180*-e.degrees),i.scale(-1,1)):i.rotate(Math.PI/180*e.degrees),i.translate(-t.x,-t.y)},_flip:function(e){var t=(e=e||{}).point?e.point.times(kNa.pixelDensityRatio):this.getCanvasCenter(),i=this._getContext(e.useSketch);i.translate(t.x,0),i.scale(-1,1),i.translate(-t.x,0)},_restoreRotationChanges:function(e){this._getContext(e).restore()},_calculateCanvasSize:function(){var e=kNa.pixelDensityRatio,t=this.viewport.getContainerSize();return{x:Math.round(t.x*e),y:Math.round(t.y*e)}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();if(0===this.viewport.getRotation())return e;var t=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y));return{x:t,y:t}}},QOa=OpenSeadragon,QOa.Viewport=function(e){var t=arguments;t.length&&t[0]instanceof QOa.Point&&(e={containerSize:t[0],contentSize:t[1],config:t[2]}),e.config&&(QOa.extend(!0,e,e.config),delete e.config),this._margins=QOa.extend({left:0,top:0,right:0,bottom:0},e.margins||{}),delete e.margins,QOa.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:QOa.DEFAULT_SETTINGS.springStiffness,animationTime:QOa.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:QOa.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:QOa.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:QOa.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:QOa.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:QOa.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:QOa.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:QOa.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:QOa.DEFAULT_SETTINGS.maxZoomLevel,degrees:QOa.DEFAULT_SETTINGS.degrees,flipped:QOa.DEFAULT_SETTINGS.flipped,homeFillsViewer:QOa.DEFAULT_SETTINGS.homeFillsViewer},e),this._updateContainerInnerSize(),this.centerSpringX=new QOa.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new QOa.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new QOa.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new QOa.Rect(0,0,1,1),1),this.goHome(!0),this.update()},QOa.Viewport.prototype={resetContentSize:function(e){return QOa.console.assert(e,"[Viewport.resetContentSize] contentSize is required"),QOa.console.assert(e instanceof QOa.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),QOa.console.assert(0<e.x,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),QOa.console.assert(0<e.y,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new QOa.Rect(0,0,1,e.y/e.x),e.x),this},setHomeBounds:function(e,t){QOa.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(e,t)},_setContentBounds:function(e,t){QOa.console.assert(e,"[Viewport._setContentBounds] bounds is required"),QOa.console.assert(e instanceof QOa.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),QOa.console.assert(0<e.width,"[Viewport._setContentBounds] bounds.width must be greater than 0"),QOa.console.assert(0<e.height,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=e.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(t),this._contentBounds=e.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(t),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:t,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var e=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?1<=e?e:1:1<=e?1:e)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var e=this._contentBounds.getCenter(),t=1/this.getHomeZoom(),i=t/this.getAspectRatio();return new QOa.Rect(e.x-t/2,e.y-i/2,t,i)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new QOa.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return QOa.extend({},this._margins)},setMargins:function(e){QOa.console.assert("object"===QOa.type(e),"[Viewport.setMargins] margins must be an object"),this._margins=QOa.extend({left:0,top:0,right:0,bottom:0},e),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(e){var t=this.getCenter(e),i=1/this.getZoom(e),n=i/this.getAspectRatio();return new QOa.Rect(t.x-i/2,t.y-n/2,i,n)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e),i=this._containerInnerSize.x*this.getZoom(e);return t.x-=this._margins.left/i,t.y-=this._margins.top/i,t.width+=(this._margins.left+this._margins.right)/i,t.height+=(this._margins.top+this._margins.bottom)/i,t},getCenter:function(e){var t,i,n,r,o,s,a=new QOa.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),l=new QOa.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return e?a:this.zoomPoint?(t=this.pixelFromPoint(this.zoomPoint,!0),r=(n=1/(i=this.getZoom()))/this.getAspectRatio(),o=new QOa.Rect(a.x-n/2,a.y-r/2,n,r),s=this._pixelFromPoint(this.zoomPoint,o).minus(t).divide(this._containerInnerSize.x*i),l.plus(s)):l},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var t=new QOa.Rect(e.x,e.y,e.width,e.height);if(this.wrapHorizontal);else{var i=this.visibilityRatio*t.width,n=t.x+t.width,r=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,o=this._contentBoundsNoRotate.x-n+i,s=r-t.x-i;i>this._contentBoundsNoRotate.width?t.x+=(o+s)/2:s<0?t.x+=s:0<o&&(t.x+=o)}if(this.wrapVertical);else{var a=this.visibilityRatio*t.height,l=t.y+t.height,u=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,h=this._contentBoundsNoRotate.y-l+a,c=u-t.y-a;a>this._contentBoundsNoRotate.height?t.y+=(h+c)/2:c<0?t.y+=c:0<h&&(t.y+=h)}return t},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t=this.getZoom(),i=this._applyZoomConstraints(t);t!==i&&this.zoomTo(i,this.zoomPoint,e);var n=this.getBoundsNoRotate(),r=this._applyBoundaryConstraints(n);return this._raiseConstraintsEvent(e),n.x===r.x&&n.y===r.y&&!e||this.fitBounds(r.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(e,t){var i=(t=t||{}).immediately||!1,n=t.constraints||!1,r=this.getAspectRatio(),o=e.getCenter(),s=new QOa.Rect(e.x,e.y,e.width,e.height,e.degrees+this.getRotation()).getBoundingBox();s.getAspectRatio()>=r?s.height=s.width/r:s.width=s.height*r,s.x=o.x-s.width/2,s.y=o.y-s.height/2;var a=1/s.width;if(n){var l=s.getAspectRatio(),u=this._applyZoomConstraints(a);a!==u&&(a=u,s.width=1/a,s.x=o.x-s.width/2,s.height=s.width/l,s.y=o.y-s.height/2),o=(s=this._applyBoundaryConstraints(s)).getCenter(),this._raiseConstraintsEvent(i)}if(i)return this.panTo(o,!0),this.zoomTo(a,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var h=this.getBounds(),c=this.getZoom();if(0===c||Math.abs(a/c-1)<1e-8)return this.zoomTo(a,!0),this.panTo(o,i);var p=(s=s.rotate(-this.getRotation())).getTopLeft().times(a).minus(h.getTopLeft().times(c)).divide(a-c);return this.zoomTo(a,p,i)},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(e){var t=new QOa.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(t,e)},fitHorizontally:function(e){var t=new QOa.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(t,e)},getConstrainedBounds:function(e){var t;return t=this.getBounds(e),this._applyBoundaryConstraints(t)},panBy:function(e,t){var i=new QOa.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(i.plus(e),t)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,i){return this.zoomTo(this.zoomSpring.target.value*e,t,i)},zoomTo:function(e,t,i){var n=this;return this.zoomPoint=t instanceof QOa.Point&&!isNaN(t.x)&&!isNaN(t.y)?t:null,i?this._adjustCenterSpringsForZoomPoint(function(){n.zoomSpring.resetTo(e)}):this.zoomSpring.springTo(e),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:e,refPoint:t,immediately:i}),this},setRotation:function(e){return this.viewer&&this.viewer.drawer.canRotate()&&(this.degrees=QOa.positiveModulo(e,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:e})),this},getRotation:function(){return this.degrees},resize:function(e,t){var i,n=this.getBoundsNoRotate(),r=n;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(i=e.x/this.containerSize.x,r.width=n.width*i,r.height=r.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),this.fitBounds(r,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new QOa.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this;this._adjustCenterSpringsForZoomPoint(function(){e.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var t=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,t},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){var t=this.pixelFromPoint(this.zoomPoint,!0);e();var i=this.pixelFromPoint(this.zoomPoint,!0).minus(t),n=this.deltaPointsFromPixels(i,!0);this.centerSpringX.shiftBy(n.x),this.centerSpringY.shiftBy(n.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(e,t){return e.minus(t.getTopLeft()).times(this._containerInnerSize.x/t.width).plus(new QOa.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(e,t){var i=this.getBoundsNoRotate(t);return e.minus(new QOa.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/i.width).plus(i.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(e,t){var i=this._contentBoundsNoRotate.width;return new QOa.Point(e*this._contentSizeNoRotate.x/i,t*this._contentSizeNoRotate.x/i)},viewportToImageCoordinates:function(e,t){if(e instanceof QOa.Point)return this.viewportToImageCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(1<i)QOa.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===i)return this.viewer.world.getItemAt(0).viewportToImageCoordinates(e,t,!0)}return this._viewportToImageDelta(e-this._contentBoundsNoRotate.x,t-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(e,t){var i=this._contentBoundsNoRotate.width;return new QOa.Point(e/this._contentSizeNoRotate.x*i,t/this._contentSizeNoRotate.x*i)},imageToViewportCoordinates:function(e,t){if(e instanceof QOa.Point)return this.imageToViewportCoordinates(e.x,e.y);if(this.viewer){var i=this.viewer.world.getItemCount();if(1<i)QOa.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===i)return this.viewer.world.getItemAt(0).imageToViewportCoordinates(e,t,!0)}var n=this._imageToViewportDelta(e,t);return n.x+=this._contentBoundsNoRotate.x,n.y+=this._contentBoundsNoRotate.y,n},imageToViewportRectangle:function(e,t,i,n){var r=e;if(r instanceof QOa.Rect||(r=new QOa.Rect(e,t,i,n)),this.viewer){var o=this.viewer.world.getItemCount();if(1<o)QOa.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===o)return this.viewer.world.getItemAt(0).imageToViewportRectangle(e,t,i,n,!0)}var s=this.imageToViewportCoordinates(r.x,r.y),a=this._imageToViewportDelta(r.width,r.height);return new QOa.Rect(s.x,s.y,a.x,a.y,r.degrees)},viewportToImageRectangle:function(e,t,i,n){var r=e;if(r instanceof QOa.Rect||(r=new QOa.Rect(e,t,i,n)),this.viewer){var o=this.viewer.world.getItemCount();if(1<o)QOa.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===o)return this.viewer.world.getItemAt(0).viewportToImageRectangle(e,t,i,n,!0)}var s=this.viewportToImageCoordinates(r.x,r.y),a=this._viewportToImageDelta(r.width,r.height);return new QOa.Rect(s.x,s.y,a.x,a.y,r.degrees)},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){QOa.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var t=e.minus(QOa.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){return QOa.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(e).plus(QOa.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(e){return QOa.Rect.fromSummits(this.pointFromPixel(e.getTopLeft(),!0),this.pointFromPixel(e.getTopRight(),!0),this.pointFromPixel(e.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(e){return QOa.Rect.fromSummits(this.pixelFromPoint(e.getTopLeft(),!0),this.pixelFromPoint(e.getTopRight(),!0),this.pixelFromPoint(e.getBottomLeft(),!0))},windowToViewportCoordinates:function(e){QOa.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var t=e.minus(QOa.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(t)},viewportToWindowCoordinates:function(e){return QOa.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(e).plus(QOa.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)QOa.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===t)return this.viewer.world.getItemAt(0).viewportToImageZoom(e)}var i=this._contentSizeNoRotate.x;return e*(this._containerInnerSize.x/i*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)QOa.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===t)return this.viewer.world.getItemAt(0).imageToViewportZoom(e)}return e*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e||(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e})),this}},tSa=OpenSeadragon,tSa.TiledImage=function(e){var t=this;tSa.console.assert(e.tileCache,"[TiledImage] options.tileCache is required"),tSa.console.assert(e.drawer,"[TiledImage] options.drawer is required"),tSa.console.assert(e.viewer,"[TiledImage] options.viewer is required"),tSa.console.assert(e.imageLoader,"[TiledImage] options.imageLoader is required"),tSa.console.assert(e.source,"[TiledImage] options.source is required"),tSa.console.assert(!e.clip||e.clip instanceof tSa.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),tSa.EventSource.call(this),this._tileCache=e.tileCache,delete e.tileCache,this._drawer=e.drawer,delete e.drawer,this._imageLoader=e.imageLoader,delete e.imageLoader,e.clip instanceof tSa.Rect&&(this._clip=e.clip.clone()),delete e.clip;var i=e.x||0;delete e.x;var n=e.y||0;delete e.y,this.normHeight=e.source.dimensions.y/e.source.dimensions.x,this.contentAspectX=e.source.dimensions.x/e.source.dimensions.y;var r=1;e.width?(r=e.width,delete e.width,e.height&&(tSa.console.error("specifying both width and height to a tiledImage is not supported"),delete e.height)):e.height&&(r=e.height/this.normHeight,delete e.height);var o=e.fitBounds;delete e.fitBounds;var s=e.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete e.fitBoundsPlacement;var a=e.degrees||0;delete e.degrees,tSa.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:tSa.DEFAULT_SETTINGS.springStiffness,animationTime:tSa.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:tSa.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:tSa.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:tSa.DEFAULT_SETTINGS.wrapVertical,immediateRender:tSa.DEFAULT_SETTINGS.immediateRender,blendTime:tSa.DEFAULT_SETTINGS.blendTime,alwaysBlend:tSa.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:tSa.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:tSa.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:tSa.DEFAULT_SETTINGS.iOSDevice,debugMode:tSa.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:tSa.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:tSa.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:tSa.DEFAULT_SETTINGS.placeholderFillStyle,opacity:tSa.DEFAULT_SETTINGS.opacity,preload:tSa.DEFAULT_SETTINGS.preload,compositeOperation:tSa.DEFAULT_SETTINGS.compositeOperation},e),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new tSa.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new tSa.Spring({initial:n,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new tSa.Spring({initial:r,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new tSa.Spring({initial:a,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),o&&this.fitBounds(o,s,!0),this._drawingHandler=function(e){t.viewer.raiseEvent("tile-drawing",tSa.extend({tiledImage:t},e))}},tSa.extend(tSa.TiledImage.prototype,tSa.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=tSa.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),t=this._ySpring.update(),i=this._scaleSpring.update(),n=this._degreesSpring.update();return!!(e||t||i||n)&&(this._updateForScale(),this._needsDraw=!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(e){return e?new tSa.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new tSa.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return tSa.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(e){var t=this.getBoundsNoRotate(e);if(this._clip){var i=(e?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,n=this._clip.times(i);t=new tSa.Rect(t.x+n.x,t.y+n.y,n.width,n.height)}return t.rotate(this.getRotation(e),this._getRotationPoint(e))},getContentSize:function(){return new tSa.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(e,t,i){var n=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new tSa.Point(e*(this.source.dimensions.x/n),t*(this.source.dimensions.y*this.contentAspectX/n))},viewportToImageCoordinates:function(e,t,i){var n;return n=(n=e instanceof tSa.Point?(i=t,e):new tSa.Point(e,t)).rotate(-this.getRotation(i),this._getRotationPoint(i)),i?this._viewportToImageDelta(n.x-this._xSpring.current.value,n.y-this._ySpring.current.value):this._viewportToImageDelta(n.x-this._xSpring.target.value,n.y-this._ySpring.target.value)},_imageToViewportDelta:function(e,t,i){var n=i?this._scaleSpring.current.value:this._scaleSpring.target.value;return new tSa.Point(e/this.source.dimensions.x*n,t/this.source.dimensions.y/this.contentAspectX*n)},imageToViewportCoordinates:function(e,t,i){e instanceof tSa.Point&&(i=t,t=e.y,e=e.x);var n=this._imageToViewportDelta(e,t);return i?(n.x+=this._xSpring.current.value,n.y+=this._ySpring.current.value):(n.x+=this._xSpring.target.value,n.y+=this._ySpring.target.value),n.rotate(this.getRotation(i),this._getRotationPoint(i))},imageToViewportRectangle:function(e,t,i,n,r){var o=e;o instanceof tSa.Rect?r=t:o=new tSa.Rect(e,t,i,n);var s=this.imageToViewportCoordinates(o.getTopLeft(),r),a=this._imageToViewportDelta(o.width,o.height,r);return new tSa.Rect(s.x,s.y,a.x,a.y,o.degrees+this.getRotation(r))},viewportToImageRectangle:function(e,t,i,n,r){var o=e;e instanceof tSa.Rect?r=t:o=new tSa.Rect(e,t,i,n);var s=this.viewportToImageCoordinates(o.getTopLeft(),r),a=this._viewportToImageDelta(o.width,o.height,r);return new tSa.Rect(s.x,s.y,a.x,a.y,o.degrees-this.getRotation(r))},viewerElementToImageCoordinates:function(e){var t=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){return this.imageToViewerElementCoordinates(e).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(e){var t=this._scaleSpring.current.value;return e=e.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new tSa.Rect((e.x-this._xSpring.current.value)/t,(e.y-this._ySpring.current.value)/t,e.width/t,e.height/t,e.degrees)},viewportToImageZoom:function(e){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*e},imageToViewportZoom:function(e){return e/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(e,t){var i=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(i&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0}else{if(i)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0}i||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},fitBounds:function(e,t,i){t=t||tSa.Placement.CENTER;var n=tSa.Placement.properties[t],r=this.contentAspectX,o=0,s=0,a=1,l=1;if(this._clip&&(r=this._clip.getAspectRatio(),a=this._clip.width/this.source.dimensions.x,l=this._clip.height/this.source.dimensions.y,s=e.getAspectRatio()>r?(o=this._clip.x/this._clip.height*e.height,this._clip.y/this._clip.height*e.height):(o=this._clip.x/this._clip.width*e.width,this._clip.y/this._clip.width*e.width)),e.getAspectRatio()>r){var u=e.height/l,h=0;n.isHorizontallyCentered?h=(e.width-e.height*r)/2:n.isRight&&(h=e.width-e.height*r),this.setPosition(new tSa.Point(e.x-o+h,e.y-s),i),this.setHeight(u,i)}else{var c=e.width/a,p=0;n.isVerticallyCentered?p=(e.height-e.width/r)/2:n.isBottom&&(p=e.height-e.width/r),this.setPosition(new tSa.Point(e.x-o,e.y-s+p),i),this.setWidth(c,i)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(e){tSa.console.assert(!e||e instanceof tSa.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),e instanceof tSa.Rect?this._clip=e.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,t){var i=this._scaleSpring.target.value===e;if(t){if(i&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0}else{if(i)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0}i||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),t=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,i=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(t/this.minPixelRatio)/Math.log(2))));return i=Math.max(i,this.source.minLevel||0),{lowestLevel:e=Math.min(e,i),highestLevel:i}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};0<this.lastDrawn.length;)this.lastDrawn.pop().beingDrawn=!1;var e=this.viewport,t=this._viewportToTiledImageRectangle(e.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var i=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(t=t.intersection(i)))return}for(var n=this._getLevelsInterval(),r=n.lowestLevel,o=n.highestLevel,s=null,a=!1,l=tSa.now(),u=o;r<=u;u--){var h=!1,c=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(u),!0).x*this._scaleSpring.current.value;if(u===r||!a&&c>=this.minPixelRatio)a=h=!0;else if(!a)continue;var p=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(u),!1).x*this._scaleSpring.current.value,d=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,f=this.immediateRender?1:d;if(s=uSa(this,a,h,u,Math.min(1,(c-.5)/.5),f/Math.abs(f-p),t,l,s),CSa(this.coverage,u))break}!function(e,t){if(0!==e.opacity&&(0!==t.length||e.placeholderFillStyle)){var i,n,r,o=t[0];o&&(i=e.opacity<1||e.compositeOperation&&"source-over"!==e.compositeOperation||!e._isBottomItem()&&o._hasTransparencyChannel());var s,a=e.viewport.getZoom(!0),l=e.viewportToImageZoom(a);1<t.length&&l>e.smoothTileEdgesMinZoom&&!e.iOSDevice&&e.getRotation(!0)%360==0&&tSa.supportsCanvas&&(i=!0,n=o.getScaleForEdgeSmoothing(),r=o.getTranslationForEdgeSmoothing(n,e._drawer.getCanvasSize(!1),e._drawer.getCanvasSize(!0))),i&&(n||(s=e.viewport.viewportToViewerElementRectangle(e.getClippedBounds(!0)).getIntegerBoundingBox().times(tSa.pixelDensityRatio),e._drawer.viewer.viewport.getFlip()&&(0===e.viewport.degrees&&e.getRotation(!0)%360==0||(s.x=e._drawer.viewer.container.clientWidth-(s.x+s.width)))),e._drawer._clear(!0,s)),n||(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:i}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:i}),0===e.viewport.degrees&&e.getRotation(!0)%360==0&&e._drawer.viewer.viewport.getFlip()&&e._drawer._flip());var u=!1;if(e._clip){e._drawer.saveContext(i);var h=e.imageToViewportRectangle(e._clip,!0);h=h.rotate(-e.getRotation(!0),e._getRotationPoint(!0));var c=e._drawer.viewportToDrawerRectangle(h);n&&(c=c.times(n)),r&&(c=c.translate(r)),e._drawer.setClip(c,i),u=!0}if(e.placeholderFillStyle&&!1===e._hasOpaqueTile){var p=e._drawer.viewportToDrawerRectangle(e.getBounds(!0));n&&(p=p.times(n)),r&&(p=p.translate(r));var d=null;d="function"==typeof e.placeholderFillStyle?e.placeholderFillStyle(e,e._drawer.context):e.placeholderFillStyle,e._drawer.drawRectangle(p,d,i)}for(var f=t.length-1;0<=f;f--)o=t[f],e._drawer.drawTile(o,e._drawingHandler,i,n,r),o.beingDrawn=!0,e.viewer&&e.viewer.raiseEvent("tile-drawn",{tiledImage:e,tile:o});u&&e._drawer.restoreContext(i),n||(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(i),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(i)),i&&(n&&(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:!1}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:!1})),e._drawer.blendSketch({opacity:e.opacity,scale:n,translate:r,compositeOperation:e.compositeOperation,bounds:s}),n&&(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(!1),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(!1))),n||0===e.viewport.degrees&&e.getRotation(!0)%360==0&&e._drawer.viewer.viewport.getFlip()&&e._drawer._flip(),function(e,t){if(e.debugMode)for(var i=t.length-1;0<=i;i--){var n=t[i];try{e._drawer.drawDebugInfo(n,t.length,i,e)}catch(e){tSa.console.error(e)}}}(e,t)}}(this,this.lastDrawn),s&&!s.context2D?(function(n,r,o){r.loading=!0,n._imageLoader.addJob({src:r.url,loadWithAjax:r.loadWithAjax,ajaxHeaders:r.ajaxHeaders,crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,callback:function(e,t,i){!function(t,i,e,n,r,o){if(!n)return tSa.console.log("Tile %s failed to load: %s - error: %s",i,i.url,r),t.viewer.raiseEvent("tile-load-failed",{tile:i,tiledImage:t,time:e,message:r,tileRequest:o}),i.loading=!1,i.exists=!1;if(e<t.lastResetTime)return tSa.console.log("Ignoring tile %s loaded before reset: %s",i,i.url),i.loading=!1;function s(){var e=t.source.getClosestLevel();zSa(t,i,n,e,o)}t._midDraw?window.setTimeout(s,1):s()}(n,r,o,e,t,i)},abort:function(){r.loading=!1}})}(this,s,l),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(e,t,i){var n,r,o,s;r=this.wrapHorizontal?(n=tSa.positiveModulo(t.x,1),tSa.positiveModulo(i.x,1)):(n=Math.max(0,t.x),Math.min(1,i.x));var a=1/this.source.aspectRatio;s=this.wrapVertical?(o=tSa.positiveModulo(t.y,a),tSa.positiveModulo(i.y,a)):(o=Math.max(0,t.y),Math.min(a,i.y));var l=this.source.getTileAtPoint(e,new tSa.Point(n,o)),u=this.source.getTileAtPoint(e,new tSa.Point(r,s)),h=this.source.getNumTiles(e);return this.wrapHorizontal&&(l.x+=h.x*Math.floor(t.x),u.x+=h.x*Math.floor(i.x)),this.wrapVertical&&(l.y+=h.y*Math.floor(t.y/a),u.y+=h.y*Math.floor(i.y/a)),{topLeft:l,bottomRight:u}}}),MXa=OpenSeadragon,OXa.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var e=document.createElement("canvas");e.width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(e){MXa.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=e},addTile:function(e){MXa.console.assert(e,"[ImageRecord.addTile] tile is required"),this._tiles.push(e)},removeTile:function(e){for(var t=0;t<this._tiles.length;t++)if(this._tiles[t]===e)return void this._tiles.splice(t,1);MXa.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",e)},getTileCount:function(){return this._tiles.length}},MXa.TileCache=function(e){e=e||{},this._maxImageCacheCount=e.maxImageCacheCount||MXa.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},MXa.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(e){MXa.console.assert(e,"[TileCache.cacheTile] options is required"),MXa.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),MXa.console.assert(e.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),MXa.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var t=e.cutoff||0,i=this._tilesLoaded.length,n=this._imagesLoaded[e.tile.cacheKey];if(n||(MXa.console.assert(e.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),n=this._imagesLoaded[e.tile.cacheKey]=new OXa({image:e.image}),this._imagesLoadedCount++),n.addTile(e.tile),e.tile.cacheImageRecord=n,this._imagesLoadedCount>this._maxImageCacheCount){for(var r,o,s,a,l,u,h=null,c=-1,p=null,d=this._tilesLoaded.length-1;0<=d;d--)(r=(u=this._tilesLoaded[d]).tile).level<=t||r.beingDrawn||(h?(a=r.lastTouchTime,o=h.lastTouchTime,l=r.level,s=h.level,(a<o||a==o&&s<l)&&(h=r,c=d,p=u)):(h=r,c=d,p=u));h&&0<=c&&(this._unloadTile(p),i=c)}this._tilesLoaded[i]=new NXa({tile:e.tile,tiledImage:e.tiledImage})},clearTilesFor:function(e){var t;MXa.console.assert(e,"[TileCache.clearTilesFor] tiledImage is required");for(var i=0;i<this._tilesLoaded.length;++i)(t=this._tilesLoaded[i]).tiledImage===e&&(this._unloadTile(t),this._tilesLoaded.splice(i,1),i--)},getImageRecord:function(e){return MXa.console.assert(e,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[e]},_unloadTile:function(e){MXa.console.assert(e,"[TileCache._unloadTile] tileRecord is required");var t=e.tile,i=e.tiledImage;t.unload(),t.cacheImageRecord=null;var n=this._imagesLoaded[t.cacheKey];n.removeTile(t),n.getTileCount()||(n.destroy(),delete this._imagesLoaded[t.cacheKey],this._imagesLoadedCount--),i.viewer.raiseEvent("tile-unloaded",{tile:t,tiledImage:i})}},rYa=OpenSeadragon,rYa.World=function(e){var t=this;rYa.console.assert(e.viewer,"[World] options.viewer is required"),rYa.EventSource.call(this),this.viewer=e.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){t._autoRefigureSizes?t._figureSizes():t._needsSizesFigured=!0},this._figureSizes()},rYa.extend(rYa.World.prototype,rYa.EventSource.prototype,{addItem:function(e,t){if(rYa.console.assert(e,"[World.addItem] item is required"),rYa.console.assert(e instanceof rYa.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(t=t||{}).index){var i=Math.max(0,Math.min(this._items.length,t.index));this._items.splice(i,0,e)}else this._items.push(e);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,e.addHandler("bounds-change",this._delegatedFigureSizes),e.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:e})},getItemAt:function(e){return rYa.console.assert(void 0!==e,"[World.getItemAt] index is required"),this._items[e]},getIndexOfItem:function(e){return rYa.console.assert(e,"[World.getIndexOfItem] item is required"),rYa.indexOf(this._items,e)},getItemCount:function(){return this._items.length},setItemIndex:function(e,t){rYa.console.assert(e,"[World.setItemIndex] item is required"),rYa.console.assert(void 0!==t,"[World.setItemIndex] index is required");var i=this.getIndexOfItem(e);if(t>=this._items.length)throw new Error("Index bigger than number of layers.");t!==i&&-1!==i&&(this._items.splice(i,1),this._items.splice(t,0,e),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:e,previousIndex:i,newIndex:t}))},removeItem:function(e){rYa.console.assert(e,"[World.removeItem] item is required");var t=rYa.indexOf(this._items,e);-1!==t&&(e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy(),this._items.splice(t,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(e))},removeAll:function(){var e,t;for(this.viewer._cancelPendingImages(),t=0;t<this._items.length;t++)(e=this._items[t]).removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var i=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,t=0;t<i.length;t++)e=i[t],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,t=0;t<this._items.length;t++)e=this._items[t].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){(this._autoRefigureSizes=e)&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(e){var t,i=(e=e||{}).immediately||!1,n=e.layout||rYa.DEFAULT_SETTINGS.collectionLayout,r=e.rows||rYa.DEFAULT_SETTINGS.collectionRows,o=e.columns||rYa.DEFAULT_SETTINGS.collectionColumns,s=e.tileSize||rYa.DEFAULT_SETTINGS.collectionTileSize,a=s+(e.tileMargin||rYa.DEFAULT_SETTINGS.collectionTileMargin);t=!e.rows&&o?o:Math.ceil(this._items.length/r);var l,u,h,c,p,d=0,f=0;this.setAutoRefigureSizes(!1);for(var g=0;g<this._items.length;g++)g&&g%t==0&&("horizontal"===n?(f+=a,d=0):(d+=a,f=0)),c=(h=(u=(l=this._items[g]).getBounds()).width>u.height?s:s*(u.width/u.height))*(u.height/u.width),p=new rYa.Point(d+(s-h)/2,f+(s-c)/2),l.setPosition(p,i),l.setWidth(h,i),"horizontal"===n?d+=a:f+=a;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var e=this._homeBounds?this._homeBounds.clone():null,t=this._contentSize?this._contentSize.clone():null,i=this._contentFactor||0;if(this._items.length){var n=this._items[0],r=n.getBounds();this._contentFactor=n.getContentSize().x/r.width;for(var o=n.getClippedBounds().getBoundingBox(),s=o.x,a=o.y,l=o.x+o.width,u=o.y+o.height,h=1;h<this._items.length;h++)r=(n=this._items[h]).getBounds(),this._contentFactor=Math.max(this._contentFactor,n.getContentSize().x/r.width),o=n.getClippedBounds().getBoundingBox(),s=Math.min(s,o.x),a=Math.min(a,o.y),l=Math.max(l,o.x+o.width),u=Math.max(u,o.y+o.height);this._homeBounds=new rYa.Rect(s,a,l-s,u-a),this._contentSize=new rYa.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new rYa.Rect(0,0,1,1),this._contentSize=new rYa.Point(1,1),this._contentFactor=1;this._contentFactor===i&&this._homeBounds.equals(e)&&this._contentSize.equals(t)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})},{}],59:[function(e,t,i){(function(a){"use strict";void 0===a||!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?t.exports={nextTick:function(e,t,i,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var r,o,s=arguments.length;switch(s){case 0:case 1:return a.nextTick(e);case 2:return a.nextTick(function(){e.call(null,t)});case 3:return a.nextTick(function(){e.call(null,t,i)});case 4:return a.nextTick(function(){e.call(null,t,i,n)});default:for(r=new Array(s-1),o=0;o<r.length;)r[o++]=arguments[o];return a.nextTick(function(){e.apply(null,r)})}}}:t.exports=a}).call(this,e("_process"))},{_process:60}],60:[function(e,t,i){var n,r,o=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,h=[],c=!1,p=-1;function d(){c&&u&&(c=!1,u.length?h=u.concat(h):p=-1,h.length&&f())}function f(){if(!c){var e=l(d);c=!0;for(var t=h.length;t;){for(u=h,h=[];++p<t;)u&&u[p].run();p=-1,t=h.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new g(e,t)),1!==h.length||c||l(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],61:[function(e,t,i){"use strict";t.exports=function(e,t,i,n){t=t||"&",i=i||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a,l,u=e.length;0<s&&s<u&&(u=s);for(var h=0;h<u;++h){var c,p,d,f,g=e[h].replace(o,"%20"),m=g.indexOf(i);p=0<=m?(c=g.substr(0,m),g.substr(m+1)):(c=g,""),d=decodeURIComponent(c),f=decodeURIComponent(p),a=r,l=d,Object.prototype.hasOwnProperty.call(a,l)?v(r[d])?r[d].push(f):r[d]=[r[d],f]:r[d]=f}return r};var v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],62:[function(e,t,i){"use strict";function o(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(i,n,r,e){return n=n||"&",r=r||"=",null===i&&(i=void 0),"object"==typeof i?a(l(i),function(e){var t=encodeURIComponent(o(e))+r;return s(i[e])?a(i[e],function(e){return t+encodeURIComponent(o(e))}).join(n):t+encodeURIComponent(o(i[e]))}).join(n):e?encodeURIComponent(o(e))+r+encodeURIComponent(o(i)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}var l=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],63:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":61,"./encode":62}],64:[function(e,t,i){var n=e("buffer"),r=n.Buffer;function o(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?t.exports=n:(o(n,i),i.Buffer=s),o(r,s),s.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},s.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"==typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:6}],65:[function(i,e,r){(function(l){var u=i("./lib/request"),e=i("./lib/response"),h=i("xtend"),t=i("builtin-status-codes"),c=i("url"),n=r;n.request=function(e,t){e="string"==typeof e?c.parse(e):h(e);var i=-1===l.location.protocol.search(/^https?:$/)?"http:":"",n=e.protocol||i,r=e.hostname||e.host,o=e.port,s=e.path||"/";r&&-1!==r.indexOf(":")&&(r="["+r+"]"),e.url=(r?n+"//"+r:"")+(o?":"+o:"")+s,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var a=new u(e);return t&&a.on("response",t),a},n.get=function(e,t){var i=n.request(e,t);return i.end(),i},n.ClientRequest=u,n.IncomingMessage=e.IncomingMessage,n.Agent=function(){},n.Agent.defaultMaxSockets=4,n.globalAgent=new n.Agent,n.STATUS_CODES=t,n.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":67,"./lib/response":68,"builtin-status-codes":7,url:82,xtend:85}],66:[function(e,t,a){(function(e){a.fetch=s(e.fetch)&&s(e.ReadableStream),a.writableStream=s(e.WritableStream),a.abortController=s(e.AbortController),a.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),a.blobConstructor=!0}catch(e){}var t;function i(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function n(e){var t=i();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var r=void 0!==e.ArrayBuffer,o=r&&s(e.ArrayBuffer.prototype.slice);function s(e){return"function"==typeof e}a.arraybuffer=a.fetch||r&&n("arraybuffer"),a.msstream=!a.fetch&&o&&n("ms-stream"),a.mozchunkedarraybuffer=!a.fetch&&r&&n("moz-chunked-arraybuffer"),a.overrideMimeType=a.fetch||!!i()&&s(i().overrideMimeType),a.vbArray=s(e.VBArray),t=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],67:[function(s,a,e){(function(l,u,h){var c=s("./capability"),e=s("inherits"),t=s("./response"),r=s("readable-stream"),p=s("to-arraybuffer"),i=t.IncomingMessage,d=t.readyStates;var n=a.exports=function(t){var e,i=this;r.Writable.call(i),i._opts=t,i._body=[],i._headers={},t.auth&&i.setHeader("Authorization","Basic "+new h(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){i.setHeader(e,t.headers[e])});var n=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!c.abortController)e=!(n=!1);else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!c.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}i._mode=function(e,t){return c.fetch&&t?"fetch":c.mozchunkedarraybuffer?"moz-chunked-arraybuffer":c.msstream?"ms-stream":c.arraybuffer&&e?"arraybuffer":c.vbArray&&e?"text:vbarray":"text"}(e,n),i._fetchTimer=null,i.on("finish",function(){i._onFinish()})};e(n,r.Writable),n.prototype.setHeader=function(e,t){var i=e.toLowerCase();-1===o.indexOf(i)&&(this._headers[i]={name:e,value:t})},n.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},n.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},n.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,n=t._headers,i=null;"GET"!==e.method&&"HEAD"!==e.method&&(i=c.arraybuffer?p(h.concat(t._body)):c.blobConstructor?new u.Blob(t._body.map(function(e){return p(e)}),{type:(n["content-type"]||{}).value||""}):h.concat(t._body).toString());var r=[];if(Object.keys(n).forEach(function(e){var t=n[e].name,i=n[e].value;Array.isArray(i)?i.forEach(function(e){r.push([t,e])}):r.push([t,i])}),"fetch"===t._mode){var o=null;if(c.abortController){var s=new AbortController;o=s.signal,t._fetchAbortController=s,"requestTimeout"in e&&0!==e.requestTimeout&&(t._fetchTimer=u.setTimeout(function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()},e.requestTimeout))}u.fetch(t._opts.url,{method:t._opts.method,headers:r,body:i||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:o}).then(function(e){t._fetchResponse=e,t._connect()},function(e){u.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)})}else{var a=t._xhr=new u.XMLHttpRequest;try{a.open(t._opts.method,t._opts.url,!0)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}"responseType"in a&&(a.responseType=t._mode.split(":")[0]),"withCredentials"in a&&(a.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in a&&a.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(a.timeout=e.requestTimeout,a.ontimeout=function(){t.emit("requestTimeout")}),r.forEach(function(e){a.setRequestHeader(e[0],e[1])}),t._response=null,a.onreadystatechange=function(){switch(a.readyState){case d.LOADING:case d.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(a.onprogress=function(){t._onXHRProgress()}),a.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{a.send(i)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}}}},n.prototype._onXHRProgress=function(){!function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}(this._xhr)||this._destroyed||(this._response||this._connect(),this._response._onXHRProgress())},n.prototype._connect=function(){var t=this;t._destroyed||(t._response=new i(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",function(e){t.emit("error",e)}),t.emit("response",t._response))},n.prototype._write=function(e,t,i){this._body.push(e),i()},n.prototype.abort=n.prototype.destroy=function(){this._destroyed=!0,u.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},n.prototype.end=function(e,t,i){"function"==typeof e&&(i=e,e=void 0),r.Writable.prototype.end.call(this,e,t,i)},n.prototype.flushHeaders=function(){},n.prototype.setTimeout=function(){},n.prototype.setNoDelay=function(){},n.prototype.setSocketKeepAlive=function(){};var o=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,s("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},s("buffer").Buffer)},{"./capability":66,"./response":68,_process:60,buffer:6,inherits:54,"readable-stream":78,"to-arraybuffer":81}],68:[function(i,e,n){(function(u,h,c){var p=i("./capability"),e=i("inherits"),d=i("readable-stream"),a=n.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=n.IncomingMessage=function(e,t,i,n){var r=this;if(d.Readable.call(r),r._mode=i,r.headers={},r.rawHeaders=[],r.trailers={},r.rawTrailers=[],r.on("end",function(){u.nextTick(function(){r.emit("close")})}),"fetch"===i){if(r._fetchResponse=t,r.url=t.url,r.statusCode=t.status,r.statusMessage=t.statusText,t.headers.forEach(function(e,t){r.headers[t.toLowerCase()]=e,r.rawHeaders.push(t,e)}),p.writableStream){var o=new WritableStream({write:function(i){return new Promise(function(e,t){r._destroyed?t():r.push(new c(i))?e():r._resumeFetch=e})},close:function(){h.clearTimeout(n),r._destroyed||r.push(null)},abort:function(e){r._destroyed||r.emit("error",e)}});try{return void t.body.pipeTo(o).catch(function(e){h.clearTimeout(n),r._destroyed||r.emit("error",e)})}catch(e){}}var s=t.body.getReader();!function t(){s.read().then(function(e){if(!r._destroyed){if(e.done)return h.clearTimeout(n),void r.push(null);r.push(new c(e.value)),t()}}).catch(function(e){h.clearTimeout(n),r._destroyed||r.emit("error",e)})}()}else{if(r._xhr=e,r._pos=0,r.url=e.responseURL,r.statusCode=e.status,r.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var i=t[1].toLowerCase();"set-cookie"===i?(void 0===r.headers[i]&&(r.headers[i]=[]),r.headers[i].push(t[2])):void 0!==r.headers[i]?r.headers[i]+=", "+t[2]:r.headers[i]=t[2],r.rawHeaders.push(t[1],t[2])}}),r._charset="x-user-defined",!p.overrideMimeType){var a=r.rawHeaders["mime-type"];if(a){var l=a.match(/;\s*charset=([^;])(;|$)/);l&&(r._charset=l[1].toLowerCase())}r._charset||(r._charset="utf-8")}}};e(t,d.Readable),t.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},t.prototype._onXHRProgress=function(){var t=this,e=t._xhr,i=null;switch(t._mode){case"text:vbarray":if(e.readyState!==a.DONE)break;try{i=new h.VBArray(e.responseBody).toArray()}catch(e){}if(null!==i){t.push(new c(i));break}case"text":try{i=e.responseText}catch(e){t._mode="text:vbarray";break}if(i.length>t._pos){var n=i.substr(t._pos);if("x-user-defined"===t._charset){for(var r=new c(n.length),o=0;o<n.length;o++)r[o]=255&n.charCodeAt(o);t.push(r)}else t.push(n,t._charset);t._pos=i.length}break;case"arraybuffer":if(e.readyState!==a.DONE||!e.response)break;i=e.response,t.push(new c(new Uint8Array(i)));break;case"moz-chunked-arraybuffer":if(i=e.response,e.readyState!==a.LOADING||!i)break;t.push(new c(new Uint8Array(i)));break;case"ms-stream":if(i=e.response,e.readyState!==a.LOADING)break;var s=new h.MSStreamReader;s.onprogress=function(){s.result.byteLength>t._pos&&(t.push(new c(new Uint8Array(s.result.slice(t._pos)))),t._pos=s.result.byteLength)},s.onload=function(){t.push(null)},s.readAsArrayBuffer(i)}t._xhr.readyState===a.DONE&&"ms-stream"!==t._mode&&t.push(null)}}).call(this,i("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i("buffer").Buffer)},{"./capability":66,_process:60,buffer:6,inherits:54,"readable-stream":78}],69:[function(e,t,i){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],70:[function(e,t,i){"use strict";var n=e("process-nextick-args"),r=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};t.exports=c;var o=e("core-util-is");o.inherits=e("inherits");var s=e("./_stream_readable"),a=e("./_stream_writable");o.inherits(c,s);for(var l=r(a.prototype),u=0;u<l.length;u++){var h=l[u];c.prototype[h]||(c.prototype[h]=a.prototype[h])}function c(e){if(!(this instanceof c))return new c(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),c.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},{"./_stream_readable":72,"./_stream_writable":74,"core-util-is":8,inherits:54,"process-nextick-args":59}],71:[function(e,t,i){"use strict";t.exports=o;var n=e("./_stream_transform"),r=e("core-util-is");function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}r.inherits=e("inherits"),r.inherits(o,n),o.prototype._transform=function(e,t,i){i(null,e)}},{"./_stream_transform":73,"core-util-is":8,inherits:54}],72:[function(k,M,e){(function(g,e){"use strict";var m=k("process-nextick-args");M.exports=p;var s,v=k("isarray");p.ReadableState=o;function y(e,t){return e.listeners(t).length}k("events").EventEmitter;var r=k("./internal/streams/stream"),a=k("safe-buffer").Buffer,l=e.Uint8Array||function(){};var t=k("core-util-is");t.inherits=k("inherits");var i=k("util"),w=void 0;w=i&&i.debuglog?i.debuglog("stream"):function(){};var u,h=k("./internal/streams/BufferList"),n=k("./internal/streams/destroy");t.inherits(p,r);var c=["error","close","destroy","pause","resume"];function o(e,t){e=e||{};var i=t instanceof(s=s||k("./_stream_duplex"));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=e.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(r||0===r)?r:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u=u||k("string_decoder/").StringDecoder,this.decoder=new u(e.encoding),this.encoding=e.encoding)}function p(e){if(s=s||k("./_stream_duplex"),!(this instanceof p))return new p(e);this._readableState=new o(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),r.call(this)}function d(e,t,i,n,r){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,T(e)}(e,s)):(r||(o=function(e,t){var i;(function(e){return a.isBuffer(e)||e instanceof l})(t)||"string"==typeof t||void 0===t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));return i}(s,t)),o?e.emit("error",o):s.objectMode||t&&0<t.length?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):f(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?f(e,s,t,!1):E(e,s)):f(e,s,t,!1))):n||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function f(e,t,i,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,n?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&T(e)),E(e,t)}Object.defineProperty(p.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),p.prototype.destroy=n.destroy,p.prototype._undestroy=n.undestroy,p.prototype._destroy=function(e,t){this.push(null),t(e)},p.prototype.push=function(e,t){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),i=!0),d(this,e,t,!1,i)},p.prototype.unshift=function(e){return d(this,e,null,!0,!1)},p.prototype.isPaused=function(){return!1===this._readableState.flowing},p.prototype.setEncoding=function(e){return u=u||k("string_decoder/").StringDecoder,this._readableState.decoder=new u(e),this._readableState.encoding=e,this};var S=8388608;function _(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return S<=e?e=S:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(w("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?m.nextTick(b,e):b(e))}function b(e){w("emit readable"),e.emit("readable"),C(e)}function E(e,t){t.readingMore||(t.readingMore=!0,m.nextTick(x,e,t))}function x(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(w("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}function P(e){w("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(w("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),C(e),t.flowing&&!t.reading&&e.read(0)}function C(e){var t=e._readableState;for(w("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):i=function(e,t,i){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():i?function(e,t){var i=t.head,n=1,r=i.data;e-=r.length;for(;i=i.next;){var o=i.data,s=e>o.length?o.length:e;if(s===o.length?r+=o:r+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i).data=o.slice(s);break}++n}return t.length-=n,r}(e,t):function(e,t){var i=a.allocUnsafe(e),n=t.head,r=1;n.data.copy(i),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(i,i.length-e,0,s),0===(e-=s)){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=o.slice(s);break}++r}return t.length-=r,i}(e,t);return n}(e,t.buffer,t.decoder),i);var i}function R(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,m.nextTick(A,t,e))}function A(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}p.prototype.read=function(e){w("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return w("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):T(this),null;if(0===(e=_(e,t))&&t.ended)return 0===t.length&&R(this),null;var n,r=t.needReadable;return w("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&w("length less than watermark",r=!0),t.ended||t.reading?w("reading or ended",r=!1):r&&(w("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=_(i,t))),null===(n=0<e?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&R(this)),null!==n&&this.emit("data",n),n},p.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},p.prototype.pipe=function(i,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=i;break;case 1:r.pipes=[r.pipes,i];break;default:r.pipes.push(i)}r.pipesCount+=1,w("pipe count=%d opts=%j",r.pipesCount,e);var t=(!e||!1!==e.end)&&i!==g.stdout&&i!==g.stderr?s:f;function o(e,t){w("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,w("cleanup"),i.removeListener("close",p),i.removeListener("finish",d),i.removeListener("drain",a),i.removeListener("error",c),i.removeListener("unpipe",o),n.removeListener("end",s),n.removeListener("end",f),n.removeListener("data",h),l=!0,!r.awaitDrain||i._writableState&&!i._writableState.needDrain||a())}function s(){w("onend"),i.end()}r.endEmitted?m.nextTick(t):n.once("end",t),i.on("unpipe",o);var a=function(t){return function(){var e=t._readableState;w("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&y(t,"data")&&(e.flowing=!0,C(t))}}(n);i.on("drain",a);var l=!1;var u=!1;function h(e){w("ondata"),(u=!1)!==i.write(e)||u||((1===r.pipesCount&&r.pipes===i||1<r.pipesCount&&-1!==L(r.pipes,i))&&!l&&(w("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,u=!0),n.pause())}function c(e){w("onerror",e),f(),i.removeListener("error",c),0===y(i,"error")&&i.emit("error",e)}function p(){i.removeListener("finish",d),f()}function d(){w("onfinish"),i.removeListener("close",p),f()}function f(){w("unpipe"),n.unpipe(i)}return n.on("data",h),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?v(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(i,"error",c),i.once("close",p),i.once("finish",d),i.emit("pipe",n),r.flowing||(w("pipe resume"),n.resume()),i},p.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,i);return this}var s=L(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},p.prototype.addListener=p.prototype.on=function(e,t){var i=r.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&T(this):m.nextTick(P,this))}return i},p.prototype.resume=function(){var e=this._readableState;return e.flowing||(w("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,m.nextTick(I,e,t))}(this,e)),this},p.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this},p.prototype.wrap=function(t){var i=this,n=this._readableState,r=!1;for(var e in t.on("end",function(){if(w("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&i.push(e)}i.push(null)}),t.on("data",function(e){w("wrapped data"),n.decoder&&(e=n.decoder.write(e)),n.objectMode&&null==e||(n.objectMode||e&&e.length)&&(i.push(e)||(r=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var o=0;o<c.length;o++)t.on(c[o],this.emit.bind(this,c[o]));return this._read=function(e){w("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),p._fromList=O}).call(this,k("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":70,"./internal/streams/BufferList":75,"./internal/streams/destroy":76,"./internal/streams/stream":77,_process:60,"core-util-is":8,events:9,inherits:54,isarray:69,"process-nextick-args":59,"safe-buffer":64,"string_decoder/":79,util:3}],73:[function(e,t,i){"use strict";t.exports=o;var n=e("./_stream_duplex"),r=e("core-util-is");function o(e){if(!(this instanceof o))return new o(e);n.call(this,e),this._transformState={afterTransform:function(e,t){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,(i.writecb=null)!=t&&this.push(t),n(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var i=this;"function"==typeof this._flush?this._flush(function(e,t){a(i,e,t)}):a(this,null,null)}function a(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=e("inherits"),r.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var i=this;n.prototype._destroy.call(this,e,function(e){t(e),i.emit("close")})}},{"./_stream_duplex":70,"core-util-is":8,inherits:54}],74:[function(b,E,e){(function(e,t,i){"use strict";var a=b("process-nextick-args");function c(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var n=e.entry;e.entry=null;for(;n;){var r=n.callback;t.pendingcb--,r(i),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}E.exports=m;var l,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?i:a.nextTick;m.WritableState=g;var n=b("core-util-is");n.inherits=b("inherits");var r={deprecate:b("util-deprecate")},o=b("./internal/streams/stream"),h=b("safe-buffer").Buffer,s=t.Uint8Array||function(){};var p,d=b("./internal/streams/destroy");function f(){}function g(e,t){l=l||b("./_stream_duplex"),e=e||{};var i=t instanceof l;this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=e.writableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i&&(r||0===r)?r:o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,r=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,n,r){--t.pendingcb,i?(a.nextTick(r,n),a.nextTick(T,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(r(n),e._writableState.errorEmitted=!0,e.emit("error",n),T(e,t))}(e,i,n,t,r);else{var o=S(i);o||i.corked||i.bufferProcessing||!i.bufferedRequest||w(e,i),n?u(y,e,i,o,r):y(e,i,o,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function m(e){if(l=l||b("./_stream_duplex"),!(p.call(m,this)||this instanceof l))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),o.call(this)}function v(e,t,i,n,r,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,i?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function y(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),T(e,t)}function w(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var n=t.bufferedRequestCount,r=new Array(n),o=t.corkedRequestsFree;o.entry=i;for(var s=0,a=!0;i;)(r[s]=i).isBuf||(a=!1),i=i.next,s+=1;r.allBuffers=a,v(e,t,!0,t.length,r,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new c(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,u=i.encoding,h=i.callback;if(v(e,t,!1,t.objectMode?1:l.length,l,u,h),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function S(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function _(t,i){t._final(function(e){i.pendingcb--,e&&t.emit("error",e),i.prefinished=!0,t.emit("prefinish"),T(t,i)})}function T(e,t){var i=S(t);return i&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(_,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}n.inherits(m,o),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,i){var n=this._writableState,r=!1,o=!n.objectMode&&function(e){return h.isBuffer(e)||e instanceof s}(e);return o&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(i=t,t=null),t=o?"buffer":t||n.defaultEncoding,"function"!=typeof i&&(i=f),n.ended?function(e,t){var i=new Error("write after end");e.emit("error",i),a.nextTick(t,i)}(this,i):(o||function(e,t,i,n){var r=!0,o=!1;return null===i?o=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(n,o),r=!1),r}(this,n,e,i))&&(n.pendingcb++,r=function(e,t,i,n,r,o){if(!i){var s=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,i));return t}(t,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,a,n,r,o);return l}(this,n,o,e,t,i)),r},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,i){var n=this._writableState;"function"==typeof e?(i=e,t=e=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,i){t.ending=!0,T(e,t),i&&(t.finished?a.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,n,i)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=d.destroy,m.prototype._undestroy=d.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},b("timers").setImmediate)},{"./_stream_duplex":70,"./internal/streams/destroy":76,"./internal/streams/stream":77,_process:60,"core-util-is":8,inherits:54,"process-nextick-args":59,"safe-buffer":64,timers:80,"util-deprecate":84}],75:[function(e,t,i){"use strict";var a=e("safe-buffer").Buffer,n=e("util");function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.head=null,this.tail=null,this.length=0}t.exports=(r.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},r.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},r.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i},r.prototype.concat=function(e){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var t,i,n,r=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,i=r,n=s,t.copy(i,n),s+=o.data.length,o=o.next;return r},r),n&&n.inspect&&n.inspect.custom&&(t.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":64,util:3}],76:[function(e,t,i){"use strict";var o=e("process-nextick-args");function s(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var i=this,n=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return n||r?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||o.nextTick(s,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(o.nextTick(s,i,e),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":59}],77:[function(e,t,i){t.exports=e("events").EventEmitter},{events:9}],78:[function(e,t,i){(((i=t.exports=e("./lib/_stream_readable.js")).Stream=i).Readable=i).Writable=e("./lib/_stream_writable.js"),i.Duplex=e("./lib/_stream_duplex.js"),i.Transform=e("./lib/_stream_transform.js"),i.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":70,"./lib/_stream_passthrough.js":71,"./lib/_stream_readable.js":72,"./lib/_stream_transform.js":73,"./lib/_stream_writable.js":74}],79:[function(e,t,i){"use strict";var n=e("safe-buffer").Buffer,r=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=h,this.end=c,t=3;break;default:return this.write=p,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,i=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var i=e.toString("utf16le",t);if(i){var n=i.charCodeAt(i.length-1);if(55296<=n&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function h(e,t){var i=(e.length-t)%3;return 0==i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1==i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function c(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}(i.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var i=function(e,t,i){var n=t.length-1;if(n<i)return 0;var r=s(t[n]);if(0<=r)return 0<r&&(e.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if(0<=(r=s(t[n])))return 0<r&&(e.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if(0<=(r=s(t[n])))return 0<r&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var n=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":64}],80:[function(l,e,u){(function(e,t){var n=l("process/browser.js").nextTick,i=Function.prototype.apply,r=Array.prototype.slice,o={},s=0;function a(e,t){this._id=e,this._clearFn=t}u.setTimeout=function(){return new a(i.call(setTimeout,window,arguments),clearTimeout)},u.setInterval=function(){return new a(i.call(setInterval,window,arguments),clearInterval)},u.clearTimeout=u.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},u.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},u.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},u._unrefActive=u.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},u.setImmediate="function"==typeof e?e:function(e){var t=s++,i=!(arguments.length<2)&&r.call(arguments,1);return o[t]=!0,n(function(){o[t]&&(i?e.apply(null,i):e.call(null),u.clearImmediate(t))}),t},u.clearImmediate="function"==typeof t?t:function(e){delete o[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":60,timers:80}],81:[function(e,t,i){var r=e("buffer").Buffer;t.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(r.isBuffer(e)){for(var t=new Uint8Array(e.length),i=e.length,n=0;n<i;n++)t[n]=e[n];return t.buffer}throw new Error("Argument must be a Buffer")}},{buffer:6}],82:[function(e,t,i){"use strict";var k=e("punycode"),M=e("./util");function I(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=o,i.resolve=function(e,t){return o(e,!1,!0).resolve(t)},i.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},i.format=function(e){M.isString(e)&&(e=o(e));return e instanceof I?e.format():I.prototype.format.call(e)},i.Url=I;var N=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,D=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,r=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),F=["'"].concat(r),H=["%","/","?",";","#"].concat(F),B=["/","?","#"],G=/^[+a-z0-9A-Z_-]{0,63}$/,U=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,z={javascript:!0,"javascript:":!0},j={javascript:!0,"javascript:":!0},V={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},q=e("querystring");function o(e,t,i){if(e&&M.isObject(e)&&e instanceof I)return e;var n=new I;return n.parse(e,t,i),n}I.prototype.parse=function(e,t,i){if(!M.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),r=-1!==n&&n<e.indexOf("#")?"?":"#",o=e.split(r);o[0]=o[0].replace(/\\/g,"/");var s=e=o.join(r);if(s=s.trim(),!i&&1===e.split("#").length){var a=D.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?q.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=N.exec(s);if(l){var u=(l=l[0]).toLowerCase();this.protocol=u,s=s.substr(l.length)}if(i||l||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var h="//"===s.substr(0,2);!h||l&&j[l]||(s=s.substr(2),this.slashes=!0)}if(!j[l]&&(h||l&&!V[l])){for(var c,p,d=-1,f=0;f<B.length;f++){-1!==(g=s.indexOf(B[f]))&&(-1===d||g<d)&&(d=g)}-1!==(p=-1===d?s.lastIndexOf("@"):s.lastIndexOf("@",d))&&(c=s.slice(0,p),s=s.slice(p+1),this.auth=decodeURIComponent(c)),d=-1;for(f=0;f<H.length;f++){var g;-1!==(g=s.indexOf(H[f]))&&(-1===d||g<d)&&(d=g)}-1===d&&(d=s.length),this.host=s.slice(0,d),s=s.slice(d),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),y=(f=0,v.length);f<y;f++){var w=v[f];if(w&&!w.match(G)){for(var S="",_=0,T=w.length;_<T;_++)127<w.charCodeAt(_)?S+="x":S+=w[_];if(!S.match(G)){var b=v.slice(0,f),E=v.slice(f+1),x=w.match(U);x&&(b.push(x[1]),E.unshift(x[2])),E.length&&(s="/"+E.join(".")+s),this.hostname=b.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),m||(this.hostname=k.toASCII(this.hostname));var P=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+P,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!z[u])for(f=0,y=F.length;f<y;f++){var C=F[f];if(-1!==s.indexOf(C)){var O=encodeURIComponent(C);O===C&&(O=escape(C)),s=s.split(C).join(O)}}var R=s.indexOf("#");-1!==R&&(this.hash=s.substr(R),s=s.slice(0,R));var A=s.indexOf("?");if(-1!==A?(this.search=s.substr(A),this.query=s.substr(A+1),t&&(this.query=q.parse(this.query)),s=s.slice(0,A)):t&&(this.search="",this.query={}),s&&(this.pathname=s),V[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){P=this.pathname||"";var L=this.search||"";this.path=P+L}return this.href=this.format(),this},I.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&M.isObject(this.query)&&Object.keys(this.query).length&&(o=q.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||V[t])&&!1!==r?(r="//"+(r||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):r=r||"",n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+r+(i=i.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},I.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},I.prototype.resolveObject=function(e){if(M.isString(e)){var t=new I;t.parse(e,!1,!0),e=t}for(var i=new I,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];i[o]=this[o]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),a=0;a<s.length;a++){var l=s[a];"protocol"!==l&&(i[l]=e[l])}return V[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!V[e.protocol]){for(var u=Object.keys(e),h=0;h<u.length;h++){var c=u[h];i[c]=e[c]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||j[e.protocol])i.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var d=i.pathname||"",f=i.search||"";i.path=d+f}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var g=i.pathname&&"/"===i.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=m||g||i.host&&e.pathname,y=v,w=i.pathname&&i.pathname.split("/")||[],S=(p=e.pathname&&e.pathname.split("/")||[],i.protocol&&!V[i.protocol]);if(S&&(i.hostname="",i.port=null,i.host&&(""===w[0]?w[0]=i.host:w.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),v=v&&(""===p[0]||""===w[0])),m)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,w=p;else if(p.length)(w=w||[]).pop(),w=w.concat(p),i.search=e.search,i.query=e.query;else if(!M.isNullOrUndefined(e.search)){if(S)i.hostname=i.host=w.shift(),(x=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=x.shift(),i.host=i.hostname=x.shift());return i.search=e.search,i.query=e.query,M.isNull(i.pathname)&&M.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!w.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var _=w.slice(-1)[0],T=(i.host||e.host||1<w.length)&&("."===_||".."===_)||""===_,b=0,E=w.length;0<=E;E--)"."===(_=w[E])?w.splice(E,1):".."===_?(w.splice(E,1),b++):b&&(w.splice(E,1),b--);if(!v&&!y)for(;b--;)w.unshift("..");!v||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),T&&"/"!==w.join("/").substr(-1)&&w.push("");var x,P=""===w[0]||w[0]&&"/"===w[0].charAt(0);S&&(i.hostname=i.host=P?"":w.length?w.shift():"",(x=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=x.shift(),i.host=i.hostname=x.shift()));return(v=v||i.host&&w.length)&&!P&&w.unshift(""),w.length?i.pathname=w.join("/"):(i.pathname=null,i.path=null),M.isNull(i.pathname)&&M.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},I.prototype.parseHost=function(){var e=this.host,t=n.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":83,punycode:5,querystring:63}],83:[function(e,t,i){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],84:[function(e,t,i){(function(i){function n(e){try{if(!i.localStorage)return!1}catch(e){return!1}var t=i.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var i=!1;return function(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],85:[function(e,t,i){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var n in i)r.call(i,n)&&(e[n]=i[n])}return e};var r=Object.prototype.hasOwnProperty},{}]},{},[1]);