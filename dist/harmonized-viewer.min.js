!function(l,o,n,h){"use strict";var s,i="harmonizedViewer",a={locale:"en-GB",manifest:null,navigation:{enableCustomScrollbar:!0}};function t(e,t){this.element=e,this.settings=l.extend({},a,t),this._defaults=a,this._name=i,this.displayMode=1,this.manifest=null,this.currentPage=0,this.pages=[],this.carousel=null,this.init()}l.extend(t.prototype,{init:function(){this.events={},this.configureLocales(),this.initSpinner(),this.initToolbar(),this.loadManifest();var i=this;this.bindEventControls("page"),this.bindEventControls("previous"),this.bindEventControls("next"),this.bindEventControls("navigation"),this.bindEventControls("metadata"),this.bindEventControls("gallery"),this.bindEventControls("displayMode"),this.addHandler("navigation",function(){i.toggleSidebar(".hv-sidebar__navigation")}),this.addHandler("gallery",function(){i.toggleSidebar(".hv-overlay__gallery")}),this.addHandler("metadata",function(){i.toggleSidebar(".hv-sidebar__metadata")}),this.addHandler("displayMode",function(e){var t=parseInt(e.displayMode);i.displayMode=1===t||2===t?t:1,i.initOpenSeadragon()}),this.addHandler("previous",function(){i.goTo(i.currentPage-i.displayMode)}),this.addHandler("next",function(){i.goTo(i.currentPage+i.displayMode)}),this.addHandler("page",function(){i.enableNavigationPrevious(i.isFirstPage()),i.enableNavigationNext(i.isLastPage()),l(i.element).find(".hv-navigation__carousel")[0].swiper.slideTo(i.currentPage);var e=l(i.element).find(".hv-navigation__item--active");i.scrollTo(e)}),this.addHandler("loaded",function(){i.getViewport().removeClass("hv-viewport--loading"),i.hideSpinner(),l(s.element).show(),i.showToolbars(),i.enableToolbar(".hv-toolbar__secondary"),i.updateNavigationControls()})},configureLocales:function(){},populateAnnotations:function(){var e=this.getSidebar(".hv-sidebar__metadata"),t=l("<div/>").addClass("hv-sidebar-content").appendTo(e),i=l("<dl/>").addClass("hv-annotations").appendTo(t);l.each(this.manifest.getMetadata(),function(e,t){l("<dt/>").text(t.getLabel()).appendTo(i),l("<dd/>").html(t.getValue()).appendTo(i),i.append(i)})},populateNavigation:function(){var a=this,t=this.getSidebar(".hv-sidebar__navigation"),e=this.getSidebar(".hv-overlay__gallery"),i=t.find(".hv-navigation__items"),n=e.find(".hv-navigation__items"),o=[];this.manifest.getSequenceByIndex(0).getCanvases().forEach(function(e){var t=e.getImages()[0],i=e.getLabel()[0],n=a.getThumbnail(t,h,120);o.push({title:i.value,imageUrl:n})});var s=l("<ol/>");o.forEach(function(e,t){var i=l("<li/>").attr("data-index",t).appendTo(s),n=l("<a/>").attr("href","javascript:;").addClass("hv-navigation__item").attr("title",e.title).attr("data-toggle","page").attr("data-page",t).appendTo(i);a.createThumbnail(e.imageUrl).appendTo(n)}),i.html(s[0].outerHTML),n.html(s[0].outerHTML),t.mCustomScrollbar({skin:"dark-think",scrollInertia:0,keyboard:{enable:!1},advanced:{autoScrollOnFocus:".hv-navigation__item"}}),e.mCustomScrollbar({skin:"dark-think",scrollInertia:0,keyboard:{enable:!1},advanced:{autoScrollOnFocus:".hv-navigation__item"}});var r=l(this.element).find(".hv-navigation__carousel .swiper-wrapper");o.forEach(function(e){var t=l("<li/>").addClass("swiper-slide").css({width:"90px",height:"90px"}).appendTo(r);a.createThumbnail(e.imageUrl).appendTo(t)}),this.carousel=new Swiper(".hv-navigation__carousel",{slidesPerView:"auto",centeredSlides:!0,slidesPerColumnFill:"row",spaceBetween:3}),this.initLazyLoading();var d={trigger:"hover focus",placement:"bottom",template:'<div class="tooltip hv-tooltip" role="tooltip"><div class="tooltip-inner"></div></div>'};t.find(".hv-navigation__item").tooltip(d),e.find(".hv-navigation__item").tooltip(d),t.keydown(function(e){switch(e.which){case 37:case 38:t.find(".hv-navigation__item:focus").parent().prev().children(".hv-navigation__item").eq(0).focus();break;case 39:case 40:t.find(".hv-navigation__item:focus").parent().next().children(".hv-navigation__item").eq(0).focus();break;default:return}e.preventDefault()})},goTo:function(e){e<0?console.error("Page index must be equal to or greater than zero."):e>this.pages.length-1?console.error("Page index must be less than the total number of pages."):(this.currentPage=e,this.initOpenSeadragon(),this.raiseEvent("page",{page:e}))},isFirstPage:function(){return this.currentPage<this.displayMode},isLastPage:function(){return this.currentPage>=this.pages.length-1-(this.displayMode-1)},getThumbnail:function(e,t,i){var n=e.getResource().getServices()[0];return this.format("{0}/full/{1},{2}/0/default.{3}",n.id,t!==h?t:"",i!==h?i:"","jpg")},bindProperty:function(e,t){l(this.element).find("[data-bind]").filter(function(){return-1<l(this).attr("data-bind").toLowerCase().indexOf(e.toLowerCase())}).text(t).removeClass("hv-skeleton")},getContent:function(){return l(this.element).find(".hv-content")},getViewport:function(){return l(this.element).find(".hv-viewport")},getSidebar:function(e){return l(this.element).find(e)},openSidebar:function(e){var t=this.getSidebar(e).removeClass("hv-sidebar--closing hv-sidebar--closed hv-sidebar--opened").addClass("hv-sidebar--opening");t.hasClass("hv-sidebar__right")||t.hasClass("hv-sidebar__top")||t.hasClass("hv-sidebar__bottom");t.addClass("hv-sidebar--opened"),this.resizeViewport()},closeSidebar:function(e){var t=this.getSidebar(e).removeClass("hv-sidebar--opening hv-sidebar--opened hv-sidebar--closed").addClass("hv-sidebar--closing");t.hasClass("hv-sidebar__right")||t.hasClass("hv-sidebar__top")||t.hasClass("hv-sidebar__bottom");t.addClass("hv-sidebar--closed"),this.resizeViewport()},isSidebarOpened:function(e){var t=this.getSidebar(e);return t.hasClass("hv-sidebar--opened")||t.hasClass("hv-sidebar--opening")},resizeViewport:function(){var e=this.caculateSidebarWidth(".hv-sidebar.hv-sidebar__push.hv-sidebar__left"),t=this.caculateSidebarWidth(".hv-sidebar.hv-sidebar__push.hv-sidebar__right");this.getContent().find(".hv-content__container").css("padding-left",this.format("{0}px",e)).css("padding-right",this.format("{0}px",t))},caculateSidebarWidth:function(e){var t=this,i=0;return l(this.element).find(e).each(function(){t.isSidebarOpened(this)&&(i+=l(this).outerWidth())}),i},toggleSidebar:function(e){this.isSidebarOpened(e)?this.closeSidebar(e):this.openSidebar(e)},enableButton:function(e,t){void 0===t&&(t=!0),l(this.element).find(e).prop("disabled",!t)},disableButton:function(e,t){return this.enableButton(e,!1)},initSpinner:function(){this.showSpinner()},getSpinner:function(){var e=this.getViewport(),t=e.find(".hv-spinner");if(0===t.length){t=l("<div/>").addClass("hv-spinner animated fadeIn").attr("role","status").appendTo(e);var i=l("<div/>").addClass("spinner-border").appendTo(t);l("<span/>").addClass("sr-only").text("Loading...").appendTo(i)}return t},showSpinner:function(){this.getSpinner().show()},hideSpinner:function(){this.getSpinner().hide()},showToolbars:function(){l(this.element).find(".hv-toolbar__secondary.invisible").removeClass("invisible")},initToolbar:function(){l(this.element).on("click",".hv-button-toggle",function(){l(this).toggleClass("hv-button-toggle--active")})},enableToolbar:function(e,t){void 0===t&&(t=!0),l(this.element).find(e).find(".hv-button").prop("disabled",!t)},disableToolbar:function(e){this.enableToolbar(e,!1)},scrollTo:function(e){var t=this.getSidebar(".hv-sidebar__navigation");this.settings.navigation.enableCustomScrollbar?t.mCustomScrollbar("scrollTo",l(e)):l(e)[0].scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})},enableNavigation:function(e){this.enableNavigationPrevious(e),this.enableNavigationNext(e)},disableNavigation:function(){return this.enableNavigation(!1)},enableNavigationPrevious:function(e){var t=this.getViewport().find(".hv-viewport__prev");return this.enableButton(t,e)},disableNavigationPrevious:function(){return enableNavigationPrevious(!1)},enableNavigationNext:function(e){var t=this.getViewport().find(".hv-viewport__next");return this.enableButton(t,e)},disableNavigationNext:function(){return enableNavigationNext(!1)},updateNavigationControls:function(){var e=s.currentPage();this.getEventControls("previous").prop("disabled",this.isFirstPage()),this.getEventControls("next").prop("disabled",this.isLastPage()),l(this.element).find(".hv-sidebar__navigation ol > li .hv-navigation__item").removeClass("hv-navigation__item--active"),l(this.element).find(".hv-sidebar__navigation ol > li[data-index="+e+"] .hv-navigation__item").addClass("hv-navigation__item--active")},getManifestCanvas:function(e){return this.manifest.getSequenceByIndex(0).getCanvasByIndex(e)},bindEventControls:function(e,t){var i=this;l(n).find(this.element).on("click","[data-toggle="+e+"]",function(){i.raiseEvent(e,l(this).data())})},getEventControls:function(e){return l(this.element).find("[data-toggle="+e+"]")},raiseEvent:function(e,t){var i=this.getHandler(e);i&&i(this,t=t||{})},addHandler:function(e,t,i){var n=this.events[e];n||(this.events[e]=n=[]),t&&"function"==typeof t&&(n[n.length]={handler:t,userData:i||null})},getHandler:function(e){var a=this.events[e];return a&&a.length?(a=1===a.length?[a[0]]:Array.apply(null,a),function(e,t){var i,n=a.length;for(i=0;i<n;i++)a[i]&&(t.eventSource=e,t.userData=a[i].userData,a[i].handler(t))}):null},createThumbnail:function(e){return l("<img/>").attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==").addClass("hv-thumbnail hv-lazy").attr("data-src",e).attr("data-srcset",this.format("{0} 1x",e))},initOpenSeadragon:function(){var a=this;s!==h&&(s.destroy(),s=null);var e=this.getViewport();e.find(".hv-openseadragon").remove();var t=l("<div/>").addClass("hv-openseadragon").hide().width("100%").height("100%").appendTo(e),i=this.getUniqueId(t[0]),n=a.pages.slice(a.currentPage,a.currentPage+a.displayMode);(s=new OpenSeadragon({id:i,prefixUrl:"../node_modules/openseadragon/build/openseadragon/images/",tileSources:n,sequenceMode:!1,collectionMode:!0,collectionRows:1,collectionColumns:1,collectionLayout:"horizontal",collectionTileMargin:30,showNavigator:!0,navigatorPosition:"BOTTOM_RIGHT",showNavigationControl:!1,showSequenceControl:!1,minZoomImageRatio:1,preserveViewport:!0,animationTime:.25,springStiffness:10})).addHandler("open",function(e){a.raiseEvent("loaded",e)}),s.addHandler("page",function(e){}),s.addHandler("tile-loaded",function(e){a.raiseEvent("tile-loaded",e)}),s.addHandler("open-failed",function(e){l(s.element).hide(),a.showError(e)}),s.addHandler("animation",function(){var e=s.viewport.getMinZoom(),t=s.viewport.getMaxZoom(),i=s.viewport.getZoom(!1),n=Math.round(100*(i-e)/(t-e),0);l(a.element).find(".hv-zoom").text(a.format("{0}%",n))})},loadManifest:function(){var t=this;manifesto.loadManifest(this.settings.manifest).then(function(e){t.manifest=manifesto.create(e),t.manifest.getSequences()[0].getCanvases().map(function(e){return e.getImages()[0].getResource().getServices()[0].id+"/info.json"}).forEach(function(e){t.pages.push(e)}),t.bindProperty("total-pages",t.pages.length),t.initOpenSeadragon(),t.initPageSlider(),t.populateAnnotations(),t.populateNavigation()},function(e){t.hideSpinner(),console.error(e),t.showError(e)}).catch(function(e){t.hideSpinner(),t.showError(e.message)})},initPageSlider:function(){var e=this.manifest.getSequenceByIndex(0).getCanvases().length,t=l(this.element).find(".hv-pageslider")[0];noUiSlider.create(t,{start:[1],step:1,range:{min:[1],max:[e]},behaviour:"hover-snap"});var n=this;l(t).hover(function(){},function(){l(".hv-tooltip").remove()}),l(t).mousemove(function(e){n.setSliderTooltipPosition(t,{x:e.pageX,y:e.pageY})}),t.noUiSlider.on("hover",function(e){var t=parseInt(e)-1;n.updateSliderPreview(t)}),t.noUiSlider.on("slide",function(e,t){var i=parseInt(e[t])-1;n.updateSliderPreview(i)}),t.noUiSlider.on("end",function(e,t){})},setSliderTooltipPosition:function(e,t){var i=l(".hv-tooltip"),n=l(e).offset().top,a=l(o).height()-n;i.css({bottom:a,left:t.x-i.outerWidth()/2})},updateSliderPreview:function(e){var t=this.getManifestCanvas(e).getImages(0)[0],i=this.getThumbnail(t,h,120);if(0===l(".hv-tooltip").length){var n=l("<div/>").addClass("hv-tooltip animated bounceIn2 faster").attr("role","tooltip").appendTo("body"),a=(l("<div/>").addClass("arrow").appendTo(n),l("<div/>").addClass("tooltip-inner").appendTo(n));l("<img/>").addClass("hv-thumbnail").appendTo(a)}l(".hv-tooltip").find("img").one("load",function(){l(".hv-tooltip").find(".arrow").css({left:l(this).width()/2})}).attr("src",i)},getUniqueId:function(e){var t=l(e).attr("id");if(t)return t;var i=6,n="0123456789abcdef".split("");i=i||Math.floor(Math.random()*n.length);for(var a="",o=0;o<i;o++)a+=n[Math.floor(Math.random()*n.length)];var s=this.format("#{0}",a);return 0==l(s).length?(l(e).attr("id",a),a):this.getUniqueId(e)},format:function(e){for(var t=0;t<arguments.length-1;t++){var i=new RegExp("\\{"+t+"\\}","gi");e=e.replace(i,arguments[t+1])}return e},showError:function(e){this.hideSpinner();var t=l("<div />").addClass("hv-error");l("<i/>").addClass("hv-error-icon fas fa-exclamation-triangle").appendTo(t),l("<div/>").addClass("hv-error-text").html("Something went wrong.<br />Please try again later.").appendTo(t),this.debug&&l("<div />").addClass("hv-debug").html(e.message).appendTo(t);var i=this.getViewport();t.appendTo(i)},animate:function(e,t,i){var n=l(this.element).find(e);n.addClass("animated").addClass(t),n[0].addEventListener("animationend",function e(){n.removeClass("animated").removeClass(t),n[0].removeEventListener("animationend",e),"function"==typeof i&&i()})},initLazyLoading:function(){var e=[].slice.call(n.querySelectorAll(".hv-lazy"));if(l(e).addClass("hv-lazy--pending"),"IntersectionObserver"in o){var i=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){var t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("hv-lazy--pending"),t.classList.add("hv-lazy--loaded"),i.unobserve(t)}})});e.forEach(function(e){i.observe(e)})}}}),l.fn.harmonizedViewer=function(e){return this.each(function(){l.data(this,"plugin_"+i)||l.data(this,"plugin_"+i,new t(this,e))})}}(jQuery,window,document);