function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}!function(e,n,t,a){"use strict";function o(n,t){this.element=n,this.settings=e.extend({},d,t),this._defaults=d,this._name=r,this.init()}var i,r="harmonizedViewer",d={locale:"en-GB"};e.extend(o.prototype,{init:function(){this.events={},this.initSpinner(),this.initToolbar(),this.initOpenSeadragon();var e=this;this.bindEventControls("debug"),this.bindEventControls("page"),this.bindEventControls("previous"),this.bindEventControls("next"),this.bindEventControls("navigation"),this.bindEventControls("annotations"),this.addHandler("debug",function(){e.debug=!e.debug,n.sessionStorage.setItem("debug",e.debug)}),this.addHandler("navigation",function(){e.toggleDrawer(e.getNavigation()),e.updateLayout()}),this.addHandler("annotations",function(){e.toggleDrawer(e.getAnnotation())}),this.addHandler("previous",function(){var e=i.currentPage();e>0&&i.goToPage(e-1)}),this.addHandler("next",function(){var e=i.currentPage();e<i.tileSources.length-1&&i.goToPage(e+1)}),this.addHandler("page",function(n){console.log("raising page"),e.enableToggleButtons(!1),i.goToPage(n.page)}),this.debug="true"===n.sessionStorage.getItem("debug"),this.debug&&this.getEventControls("debug").addClass("hv-button-toggle--active")},populateAnnotations:function(){var n=e("<dl/>").addClass("hv-annotations").appendTo(this.getAnnotation());e.each(this.manifest.getMetadata(),function(t,a){e("<dt/>").text(a.getLabel()).appendTo(n),e("<dd/>").html(a.getValue()).appendTo(n),n.append(n)})},populateNavigation:function(){var n=this,t=e("<ol/>"),o=this.manifest.getSequenceByIndex(0);e.each(o.getCanvases(),function(o,i){var r=i.getImages()[0],d=i.getLabel()[0],l=n.getThumbnail(r,a,120),s=e("<li/>").attr("data-index",o).appendTo(t),c=e("<a/>").attr("href","javascript:;").addClass("hv-navigation__item").attr("title",n.format("Go to page {0}",d.value)).attr("data-toggle","page").attr("data-page",o).appendTo(s);e("<img/>").attr("src",l).addClass("hv-thumbnail").appendTo(c),e("<div/>").addClass("hv-navigation__item-page").text(d.value).appendTo(c)}),this.getNavigation().html(t).mCustomScrollbar({scrollInertia:250})},getThumbnail:function(e,n,t){var o=e.getResource(),i=o.getServices()[0];return this.format("{0}/full/{1},{2}/0/default.{3}",i.id,n!==a?n:"",t!==a?t:"","jpg")},setManifestLabel:function(n){e(this.element).find(".hv-manifest-label").html(n)},getContent:function(){return e(this.element).find(".hv-content")},getViewport:function(){return e(this.element).find(".hv-viewport")},getNavigation:function(){return e(this.element).find(".hv-drawer__navigation")},isNavigationVisible:function(){return e(this.element).find(".hv-drawer__navigation").hasClass("hv-drawer--visible")},getAnnotation:function(){return e(this.element).find(".hv-drawer__annotations")},isAnnotationVisible:function(){return e(this.element).find(".hv-drawer__annotations").hasClass("hv-drawer--visible")},openNavigation:function(){this.openDrawer(this.getNavigation()),e(this.element).trigger("navigation")},openDrawer:function(n){e(n).addClass("hv-drawer--visible")},closeDrawer:function(n){e(n).removeClass("hv-drawer--visible"),this.updateLayout(n)},updateLayout:function(){var e=this.getContent();e.removeClass("hv-content--push-left hv-content--push-right"),this.isNavigationVisible()&&e.addClass("hv-content--push-left"),this.isAnnotationVisible()&&e.addClass("hv-content--push-right")},toggleNavigation:function(){this.toggleDrawer(this.getNavigation())},toggleDrawer:function(e){this.isDrawerVisible(e)?this.closeDrawer(e):this.openDrawer(e),this.updateLayout()},isDrawerVisible:function(n){return e(n).hasClass("hv-drawer--visible")},enableButton:function(n){e(this.element).find(n).prop("disabled",!1)},disableButton:function(n){e(this.element).find(n).prop("disabled",!0)},initSpinner:function(){this.showSpinner()},getSpinner:function(){var n=this.getViewport(),t=n.find(".hv-spinner");return 0===t.length&&(t=e("<div/>").addClass("hv-spinner").appendTo(n)),t},showSpinner:function(){this.getSpinner().css("opacity",0).animate({opacity:1},800)},hideSpinner:function(){this.getSpinner().css("opacity",0).hide()},initToolbar:function(){e(this.element).on("click",".hv-toolbar .hv-button-toggle",function(){e(this).toggleClass("hv-button-toggle--active")})},enableToggleButtons:function(n){e(this.element).find(".hv-button[data-toggle]").prop("disabled",!1===n)},isFirstPage:function(){return 0===i.currentPage()},isLastPage:function(){return i.currentPage()>=i.tileSources.length-1},updateNavigationControls:function(){var n=i.currentPage();this.getEventControls("previous").prop("disabled",this.isFirstPage()),this.getEventControls("next").prop("disabled",this.isLastPage()),e(this.element).find(".hv-drawer__navigation ol > li").removeClass("active"),e(this.element).find(".hv-drawer__navigation ol > li[data-index="+n+"]").addClass("active")},getManifestCanvas:function(){return this.manifest.getSequenceByIndex(0).getCanvasByIndex(i.currentPage())},bindEventControls:function(n,a){var o=this;e(t).find(this.element).on("click","[data-toggle="+n+"]",function(){o.raiseEvent(n,e(this).data())})},getEventControls:function(n){return e(this.element).find("[data-toggle="+n+"]")},raiseEvent:function(e,n){this.debug&&console.log(this.format("Event raised: {0}",e));var t=this.getHandler(e);t&&(n||(n={}),t(this,n))},addHandler:function(e,n,t){var a=this.events[e];a||(this.events[e]=a=[]),n&&"function"==typeof n&&(a[a.length]={handler:n,userData:t||null})},getHandler:function(e){var n=this.events[e];return n&&n.length?(n=1===n.length?[n[0]]:Array.apply(null,n),function(e,t){var a,o=n.length;for(a=0;a<o;a++)n[a]&&(t.eventSource=e,t.userData=n[a].userData,n[a].handler(t))}):null},initOpenSeadragon:function(){var n=this;i!==a&&(i.destroy(),i=null);var t=this.getViewport(),o=e("<div/>").hide().width("100%").height("100%").appendTo(t),r=this.getUniqueId(o[0]);manifesto.loadManifest("https://d.lib.ncsu.edu/collections/catalog/nubian-message-1992-11-30/manifest").then(function(t){n.manifest=manifesto.create(t);var a=new Array;e.each(n.manifest.getSequences(),function(n,t){var o=t.getCanvases();e.each(o,function(e,t){var o=t.getImages(),i=o[0].getResource().getServices()[0].id;a.push({id:i,sequenceIndex:n,canvasIndex:e})})}),i=new OpenSeadragon({id:r,prefixUrl:"../node_modules/openseadragon/build/openseadragon/images/",tileSources:a.map(function(e){return e.id}),sequenceMode:!0,showNavigator:!0,navigatorPosition:"BOTTOM_RIGHT",showNavigationControl:!1,showSequenceControl:!1,minZoomImageRatio:1,preserveViewport:!0,animationTime:.25,springStiffness:10}),i.addHandler("open",function(){n.hideSpinner(),e(i.element).show(),n.enableToggleButtons(!0),n.updateNavigationControls(),e(n.element).find(".hv-logo").css("background-image",n.format("url('{0}')",n.manifest.getLogo())),n.setManifestLabel(n.manifest.getDefaultLabel()),n.getManifestCanvas()}),i.addHandler("page",function(){}),i.addHandler("open-failed",function(t){e(i.element).hide(),n.showError(t)}),i.addHandler("animation",function(){var t=i.viewport.getMinZoom(),a=i.viewport.getMaxZoom(),o=i.viewport.getZoom(!1),r=Math.round(100*(o-t)/(a-t),0);e(n.element).find(".hv-zoom").text(n.format("{0}%",r))}),n.populateAnnotations(),n.populateNavigation()},function(e){console.error(e),n.hideSpinner(),n.showError(e)})},getUniqueId:function(n){var t=e(n).attr("id");if(t)return t;var a=6,o="0123456789abcdef".split("");a||(a=Math.floor(Math.random()*o.length));for(var i="",r=0;r<a;r++)i+=o[Math.floor(Math.random()*o.length)];var d=this.format("#{0}",i);return 0==e(d).length?(e(n).attr("id",i),i):this.getUniqueId(n)},format:function(e){for(var n=0;n<arguments.length-1;n++){var t=new RegExp("\\{"+n+"\\}","gi");e=e.replace(t,arguments[n+1])}return e},showError:function(n){console.log("error"),this.hideSpinner();var t=e("<div />").addClass("hv-error");e("<i />").addClass("hv-error-icon").addClass("material-icons").text("error_outline").appendTo(t),e("<div />").addClass("hv-error-text").html("An unexpected error occurred.<br />Please try again later.").appendTo(t),this.debug&&e("<div />").addClass("hv-debug").html(n.message).appendTo(t);var a=this.getViewport();t.appendTo(a)}}),e.fn.harmonizedViewer=function(n){return this.each(function(){e.data(this,"plugin_"+r)||e.data(this,"plugin_"+r,new o(this,n))})}}(jQuery,window,document),function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],n):(e=e||self,n(e.bootstrap={},e.jQuery))}(this,function(e,n){"use strict";function t(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},a=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.forEach(function(n){o(e,n,t[n])})}return e}function r(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n}function d(e){return{}.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase()}function l(){return{bindType:Ee,delegateType:Ee,handle:function(e){if(n(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}}}function s(e){var t=this,a=!1;return n(this).one(be.TRANSITION_END,function(){a=!0}),setTimeout(function(){a||be.triggerTransitionEnd(t)},e),this}function c(){n.fn.emulateTransitionEnd=s,n.event.special[be.TRANSITION_END]=l()}function f(e){var n=!1;return function(){n||(n=!0,window.Promise.resolve().then(function(){n=!1,e()}))}}function u(e){var n=!1;return function(){n||(n=!0,setTimeout(function(){n=!1,e()},xn))}}function g(e){var n={};return e&&"[object Function]"===n.toString.call(e)}function h(e,n){if(1!==e.nodeType)return[];var t=e.ownerDocument.defaultView,a=t.getComputedStyle(e,null);return n?a[n]:a}function A(e){return"HTML"===e.nodeName?e:e.parentNode||e.host}function v(e){if(!e)return document.body;switch(e.nodeName){case"HTML":case"BODY":return e.ownerDocument.body;case"#document":return e.body}var n=h(e),t=n.overflow,a=n.overflowX;return/(auto|scroll|overlay)/.test(t+n.overflowY+a)?e:v(A(e))}function m(e){return 11===e?In:10===e?On:In||On}function S(e){if(!e)return document.documentElement;for(var n=m(10)?document.body:null,t=e.offsetParent||null;t===n&&e.nextElementSibling;)t=(e=e.nextElementSibling).offsetParent;var a=t&&t.nodeName;return a&&"BODY"!==a&&"HTML"!==a?-1!==["TH","TD","TABLE"].indexOf(t.nodeName)&&"static"===h(t,"position")?S(t):t:e?e.ownerDocument.documentElement:document.documentElement}function p(e){var n=e.nodeName;return"BODY"!==n&&("HTML"===n||S(e.firstElementChild)===e)}function w(e){return null!==e.parentNode?w(e.parentNode):e}function E(e,n){if(!(e&&e.nodeType&&n&&n.nodeType))return document.documentElement;var t=e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_FOLLOWING,a=t?e:n,o=t?n:e,i=document.createRange();i.setStart(a,0),i.setEnd(o,0);var r=i.commonAncestorContainer;if(e!==r&&n!==r||a.contains(o))return p(r)?r:S(r);var d=w(e);return d.host?E(d.host,n):E(e,w(n).host)}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",t="top"===n?"scrollTop":"scrollLeft",a=e.nodeName;if("BODY"===a||"HTML"===a){var o=e.ownerDocument.documentElement;return(e.ownerDocument.scrollingElement||o)[t]}return e[t]}function C(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=y(n,"top"),o=y(n,"left"),i=t?-1:1;return e.top+=a*i,e.bottom+=a*i,e.left+=o*i,e.right+=o*i,e}function b(e,n){var t="x"===n?"Left":"Top",a="Left"===t?"Right":"Bottom";return parseFloat(e["border"+t+"Width"],10)+parseFloat(e["border"+a+"Width"],10)}function x(e,n,t,a){return Math.max(n["offset"+e],n["scroll"+e],t["client"+e],t["offset"+e],t["scroll"+e],m(10)?parseInt(t["offset"+e])+parseInt(a["margin"+("Height"===e?"Top":"Left")])+parseInt(a["margin"+("Height"===e?"Bottom":"Right")]):0)}function L(e){var n=e.body,t=e.documentElement,a=m(10)&&getComputedStyle(t);return{height:x("Height",n,t,a),width:x("Width",n,t,a)}}function N(e){return Qn({},e,{right:e.left+e.width,bottom:e.top+e.height})}function B(e){var n={};try{if(m(10)){n=e.getBoundingClientRect();var t=y(e,"top"),a=y(e,"left");n.top+=t,n.left+=a,n.bottom+=t,n.right+=a}else n=e.getBoundingClientRect()}catch(f){}var o={left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top},i="HTML"===e.nodeName?L(e.ownerDocument):{},r=i.width||e.clientWidth||o.right-o.left,d=i.height||e.clientHeight||o.bottom-o.top,l=e.offsetWidth-r,s=e.offsetHeight-d;if(l||s){var c=h(e);l-=b(c,"x"),s-=b(c,"y"),o.width-=l,o.height-=s}return N(o)}function I(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=m(10),o="HTML"===n.nodeName,i=B(e),r=B(n),d=v(e),l=h(n),s=parseFloat(l.borderTopWidth,10),c=parseFloat(l.borderLeftWidth,10);t&&o&&(r.top=Math.max(r.top,0),r.left=Math.max(r.left,0));var f=N({top:i.top-r.top-s,left:i.left-r.left-c,width:i.width,height:i.height});if(f.marginTop=0,f.marginLeft=0,!a&&o){var u=parseFloat(l.marginTop,10),g=parseFloat(l.marginLeft,10);f.top-=s-u,f.bottom-=s-u,f.left-=c-g,f.right-=c-g,f.marginTop=u,f.marginLeft=g}return(a&&!t?n.contains(d):n===d&&"BODY"!==d.nodeName)&&(f=C(f,n)),f}function O(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=e.ownerDocument.documentElement,a=I(e,t),o=Math.max(t.clientWidth,window.innerWidth||0),i=Math.max(t.clientHeight,window.innerHeight||0),r=n?0:y(t),d=n?0:y(t,"left");return N({top:r-a.top+a.marginTop,left:d-a.left+a.marginLeft,width:o,height:i})}function T(e){var n=e.nodeName;if("BODY"===n||"HTML"===n)return!1;if("fixed"===h(e,"position"))return!0;var t=A(e);return!!t&&T(t)}function G(e){if(!e||!e.parentElement||m())return document.documentElement;for(var n=e.parentElement;n&&"none"===h(n,"transform");)n=n.parentElement;return n||document.documentElement}function R(e,n,t,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i={top:0,left:0},r=o?G(e):E(e,n);if("viewport"===a)i=O(r,o);else{var d=void 0;"scrollParent"===a?(d=v(A(n)),"BODY"===d.nodeName&&(d=e.ownerDocument.documentElement)):d="window"===a?e.ownerDocument.documentElement:a;var l=I(d,r,o);if("HTML"!==d.nodeName||T(r))i=l;else{var s=L(e.ownerDocument),c=s.height,f=s.width;i.top+=l.top-l.marginTop,i.bottom=c+l.top,i.left+=l.left-l.marginLeft,i.right=f+l.left}}t=t||0;var u="number"==typeof t;return i.left+=u?t:t.left||0,i.top+=u?t:t.top||0,i.right-=u?t:t.right||0,i.bottom-=u?t:t.bottom||0,i}function Q(e){return e.width*e.height}function V(e,n,t,a,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===e.indexOf("auto"))return e;var r=R(t,a,i,o),d={top:{width:r.width,height:n.top-r.top},right:{width:r.right-n.right,height:r.height},bottom:{width:r.width,height:r.bottom-n.bottom},left:{width:n.left-r.left,height:r.height}},l=Object.keys(d).map(function(e){return Qn({key:e},d[e],{area:Q(d[e])})}).sort(function(e,n){return n.area-e.area}),s=l.filter(function(e){var n=e.width,a=e.height;return n>=t.clientWidth&&a>=t.clientHeight}),c=s.length>0?s[0].key:l[0].key,f=e.split("-")[1];return c+(f?"-"+f:"")}function k(e,n,t){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return I(t,a?G(n):E(n,t),a)}function D(e){var n=e.ownerDocument.defaultView,t=n.getComputedStyle(e),a=parseFloat(t.marginTop||0)+parseFloat(t.marginBottom||0),o=parseFloat(t.marginLeft||0)+parseFloat(t.marginRight||0);return{width:e.offsetWidth+o,height:e.offsetHeight+a}}function F(e){var n={left:"right",right:"left",bottom:"top",top:"bottom"};return e.replace(/left|right|bottom|top/g,function(e){return n[e]})}function P(e,n,t){t=t.split("-")[0];var a=D(e),o={width:a.width,height:a.height},i=-1!==["right","left"].indexOf(t),r=i?"top":"left",d=i?"left":"top",l=i?"height":"width",s=i?"width":"height";return o[r]=n[r]+n[l]/2-a[l]/2,o[d]=t===d?n[d]-a[s]:n[F(d)],o}function U(e,n){return Array.prototype.find?e.find(n):e.filter(n)[0]}function j(e,n,t){if(Array.prototype.findIndex)return e.findIndex(function(e){return e[n]===t});var a=U(e,function(e){return e[n]===t});return e.indexOf(a)}function q(e,n,t){return(void 0===t?e:e.slice(0,j(e,"name",t))).forEach(function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var t=e.function||e.fn;e.enabled&&g(t)&&(n.offsets.popper=N(n.offsets.popper),n.offsets.reference=N(n.offsets.reference),n=t(n,e))}),n}function z(){if(!this.state.isDestroyed){var e={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};e.offsets.reference=k(this.state,this.popper,this.reference,this.options.positionFixed),e.placement=V(this.options.placement,e.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),e.originalPlacement=e.placement,e.positionFixed=this.options.positionFixed,e.offsets.popper=P(this.popper,e.offsets.reference,e.placement),e.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",e=q(this.modifiers,e),this.state.isCreated?this.options.onUpdate(e):(this.state.isCreated=!0,this.options.onCreate(e))}}function H(e,n){return e.some(function(e){var t=e.name;return e.enabled&&t===n})}function J(e){for(var n=[!1,"ms","Webkit","Moz","O"],t=e.charAt(0).toUpperCase()+e.slice(1),a=0;a<n.length;a++){var o=n[a],i=o?""+o+t:e;if(void 0!==document.body.style[i])return i}return null}function K(){return this.state.isDestroyed=!0,H(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[J("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function M(e){var n=e.ownerDocument;return n?n.defaultView:window}function W(e,n,t,a){var o="BODY"===e.nodeName,i=o?e.ownerDocument.defaultView:e;i.addEventListener(n,t,{passive:!0}),o||W(v(i.parentNode),n,t,a),a.push(i)}function X(e,n,t,a){t.updateBound=a,M(e).addEventListener("resize",t.updateBound,{passive:!0});var o=v(e);return W(o,"scroll",t.updateBound,t.scrollParents),t.scrollElement=o,t.eventsEnabled=!0,t}function Y(){this.state.eventsEnabled||(this.state=X(this.reference,this.options,this.state,this.scheduleUpdate))}function Z(e,n){return M(e).removeEventListener("resize",n.updateBound),n.scrollParents.forEach(function(e){e.removeEventListener("scroll",n.updateBound)}),n.updateBound=null,n.scrollParents=[],n.scrollElement=null,n.eventsEnabled=!1,n}function $(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Z(this.reference,this.state))}function _(e){return""!==e&&!isNaN(parseFloat(e))&&isFinite(e)}function ee(e,n){Object.keys(n).forEach(function(t){var a="";-1!==["width","height","top","right","bottom","left"].indexOf(t)&&_(n[t])&&(a="px"),e.style[t]=n[t]+a})}function ne(e,n){Object.keys(n).forEach(function(t){!1!==n[t]?e.setAttribute(t,n[t]):e.removeAttribute(t)})}function te(e){return ee(e.instance.popper,e.styles),ne(e.instance.popper,e.attributes),e.arrowElement&&Object.keys(e.arrowStyles).length&&ee(e.arrowElement,e.arrowStyles),e}function ae(e,n,t,a,o){var i=k(o,n,e,t.positionFixed),r=V(t.placement,i,n,e,t.modifiers.flip.boundariesElement,t.modifiers.flip.padding);return n.setAttribute("x-placement",r),ee(n,{position:t.positionFixed?"fixed":"absolute"}),t}function oe(e,n){var t=e.offsets,a=t.popper,o=t.reference,i=Math.round,r=Math.floor,d=function(e){return e},l=i(o.width),s=i(a.width),c=-1!==["left","right"].indexOf(e.placement),f=-1!==e.placement.indexOf("-"),u=l%2==s%2,g=l%2==1&&s%2==1,h=n?c||f||u?i:r:d,A=n?i:d;return{left:h(g&&!f&&n?a.left-1:a.left),top:A(a.top),bottom:A(a.bottom),right:h(a.right)}}function ie(e,n){var t=n.x,a=n.y,o=e.offsets.popper,i=U(e.instance.modifiers,function(e){return"applyStyle"===e.name}).gpuAcceleration;void 0!==i&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var r=void 0!==i?i:n.gpuAcceleration,d=S(e.instance.popper),l=B(d),s={position:o.position},c=oe(e,window.devicePixelRatio<2||!Vn),f="bottom"===t?"top":"bottom",u="right"===a?"left":"right",g=J("transform"),h=void 0,A=void 0;if(A="bottom"===f?"HTML"===d.nodeName?-d.clientHeight+c.bottom:-l.height+c.bottom:c.top,h="right"===u?"HTML"===d.nodeName?-d.clientWidth+c.right:-l.width+c.right:c.left,r&&g)s[g]="translate3d("+h+"px, "+A+"px, 0)",s[f]=0,s[u]=0,s.willChange="transform";else{var v="bottom"===f?-1:1,m="right"===u?-1:1;s[f]=A*v,s[u]=h*m,s.willChange=f+", "+u}var p={"x-placement":e.placement};return e.attributes=Qn({},p,e.attributes),e.styles=Qn({},s,e.styles),e.arrowStyles=Qn({},e.offsets.arrow,e.arrowStyles),e}function re(e,n,t){var a=U(e,function(e){return e.name===n}),o=!!a&&e.some(function(e){return e.name===t&&e.enabled&&e.order<a.order});if(!o){var i="`"+n+"`",r="`"+t+"`";console.warn(r+" modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return o}function de(e,n){var t;if(!re(e.instance.modifiers,"arrow","keepTogether"))return e;var a=n.element;if("string"==typeof a){if(!(a=e.instance.popper.querySelector(a)))return e}else if(!e.instance.popper.contains(a))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),e;var o=e.placement.split("-")[0],i=e.offsets,r=i.popper,d=i.reference,l=-1!==["left","right"].indexOf(o),s=l?"height":"width",c=l?"Top":"Left",f=c.toLowerCase(),u=l?"left":"top",g=l?"bottom":"right",A=D(a)[s];d[g]-A<r[f]&&(e.offsets.popper[f]-=r[f]-(d[g]-A)),d[f]+A>r[g]&&(e.offsets.popper[f]+=d[f]+A-r[g]),e.offsets.popper=N(e.offsets.popper);var v=d[f]+d[s]/2-A/2,m=h(e.instance.popper),S=parseFloat(m["margin"+c],10),p=parseFloat(m["border"+c+"Width"],10),w=v-e.offsets.popper[f]-S-p;return w=Math.max(Math.min(r[s]-A,w),0),e.arrowElement=a,e.offsets.arrow=(t={},Rn(t,f,Math.round(w)),Rn(t,u,""),t),e}function le(e){return"end"===e?"start":"start"===e?"end":e}function se(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=Dn.indexOf(e),a=Dn.slice(t+1).concat(Dn.slice(0,t));return n?a.reverse():a}function ce(e,n){if(H(e.instance.modifiers,"inner"))return e;if(e.flipped&&e.placement===e.originalPlacement)return e;var t=R(e.instance.popper,e.instance.reference,n.padding,n.boundariesElement,e.positionFixed),a=e.placement.split("-")[0],o=F(a),i=e.placement.split("-")[1]||"",r=[];switch(n.behavior){case Fn.FLIP:r=[a,o];break;case Fn.CLOCKWISE:r=se(a);break;case Fn.COUNTERCLOCKWISE:r=se(a,!0);break;default:r=n.behavior}return r.forEach(function(d,l){if(a!==d||r.length===l+1)return e;a=e.placement.split("-")[0],o=F(a);var s=e.offsets.popper,c=e.offsets.reference,f=Math.floor,u="left"===a&&f(s.right)>f(c.left)||"right"===a&&f(s.left)<f(c.right)||"top"===a&&f(s.bottom)>f(c.top)||"bottom"===a&&f(s.top)<f(c.bottom),g=f(s.left)<f(t.left),h=f(s.right)>f(t.right),A=f(s.top)<f(t.top),v=f(s.bottom)>f(t.bottom),m="left"===a&&g||"right"===a&&h||"top"===a&&A||"bottom"===a&&v,S=-1!==["top","bottom"].indexOf(a),p=!!n.flipVariations&&(S&&"start"===i&&g||S&&"end"===i&&h||!S&&"start"===i&&A||!S&&"end"===i&&v);(u||m||p)&&(e.flipped=!0,(u||m)&&(a=r[l+1]),p&&(i=le(i)),e.placement=a+(i?"-"+i:""),e.offsets.popper=Qn({},e.offsets.popper,P(e.instance.popper,e.offsets.reference,e.placement)),e=q(e.instance.modifiers,e,"flip"))}),e}function fe(e){var n=e.offsets,t=n.popper,a=n.reference,o=e.placement.split("-")[0],i=Math.floor,r=-1!==["top","bottom"].indexOf(o),d=r?"right":"bottom",l=r?"left":"top",s=r?"width":"height";return t[d]<i(a[l])&&(e.offsets.popper[l]=i(a[l])-t[s]),t[l]>i(a[d])&&(e.offsets.popper[l]=i(a[d])),e}function ue(e,n,t,a){var o=e.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+o[1],r=o[2];if(!i)return e;if(0===r.indexOf("%")){var d=void 0;switch(r){case"%p":d=t;break;case"%":case"%r":default:d=a}return N(d)[n]/100*i}if("vh"===r||"vw"===r){return("vh"===r?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*i}return i}function ge(e,n,t,a){var o=[0,0],i=-1!==["right","left"].indexOf(a),r=e.split(/(\+|\-)/).map(function(e){return e.trim()}),d=r.indexOf(U(r,function(e){return-1!==e.search(/,|\s/)}));r[d]&&-1===r[d].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,s=-1!==d?[r.slice(0,d).concat([r[d].split(l)[0]]),[r[d].split(l)[1]].concat(r.slice(d+1))]:[r];return s=s.map(function(e,a){var o=(1===a?!i:i)?"height":"width",r=!1;return e.reduce(function(e,n){return""===e[e.length-1]&&-1!==["+","-"].indexOf(n)?(e[e.length-1]=n,r=!0,e):r?(e[e.length-1]+=n,r=!1,e):e.concat(n)},[]).map(function(e){return ue(e,o,n,t)})}),s.forEach(function(e,n){e.forEach(function(t,a){_(t)&&(o[n]+=t*("-"===e[a-1]?-1:1))})}),o}function he(e,n){var t=n.offset,a=e.placement,o=e.offsets,i=o.popper,r=o.reference,d=a.split("-")[0],l=void 0;return l=_(+t)?[+t,0]:ge(t,i,r,d),"left"===d?(i.top+=l[0],i.left-=l[1]):"right"===d?(i.top+=l[0],i.left+=l[1]):"top"===d?(i.left+=l[0],i.top-=l[1]):"bottom"===d&&(i.left+=l[0],i.top+=l[1]),e.popper=i,e}function Ae(e,n){var t=n.boundariesElement||S(e.instance.popper);e.instance.reference===t&&(t=S(t));var a=J("transform"),o=e.instance.popper.style,i=o.top,r=o.left,d=o[a];o.top="",o.left="",o[a]="";var l=R(e.instance.popper,e.instance.reference,n.padding,t,e.positionFixed);o.top=i,o.left=r,o[a]=d,n.boundaries=l;var s=n.priority,c=e.offsets.popper,f={primary:function(e){var t=c[e];return c[e]<l[e]&&!n.escapeWithReference&&(t=Math.max(c[e],l[e])),Rn({},e,t)},secondary:function(e){var t="right"===e?"left":"top",a=c[t];return c[e]>l[e]&&!n.escapeWithReference&&(a=Math.min(c[t],l[e]-("right"===e?c.width:c.height))),Rn({},t,a)}};return s.forEach(function(e){var n=-1!==["left","top"].indexOf(e)?"primary":"secondary";c=Qn({},c,f[n](e))}),e.offsets.popper=c,e}function ve(e){var n=e.placement,t=n.split("-")[0],a=n.split("-")[1];if(a){var o=e.offsets,i=o.reference,r=o.popper,d=-1!==["bottom","top"].indexOf(t),l=d?"left":"top",s=d?"width":"height",c={start:Rn({},l,i[l]),end:Rn({},l,i[l]+i[s]-r[s])};e.offsets.popper=Qn({},r,c[a])}return e}function me(e){if(!re(e.instance.modifiers,"hide","preventOverflow"))return e;var n=e.offsets.reference,t=U(e.instance.modifiers,function(e){return"preventOverflow"===e.name}).boundaries;if(n.bottom<t.top||n.left>t.right||n.top>t.bottom||n.right<t.left){if(!0===e.hide)return e;e.hide=!0,e.attributes["x-out-of-boundaries"]=""}else{if(!1===e.hide)return e;e.hide=!1,e.attributes["x-out-of-boundaries"]=!1}return e}function Se(e){var n=e.placement,t=n.split("-")[0],a=e.offsets,o=a.popper,i=a.reference,r=-1!==["left","right"].indexOf(t),d=-1===["top","left"].indexOf(t);return o[r?"left":"top"]=i[t]-(d?o[r?"width":"height"]:0),e.placement=F(n),e.offsets.popper=N(o),e}function pe(e,n){var t=e.nodeName.toLowerCase();if(-1!==n.indexOf(t))return-1===Et.indexOf(t)||Boolean(e.nodeValue.match(bt)||e.nodeValue.match(xt));for(var a=n.filter(function(e){return e instanceof RegExp}),o=0,i=a.length;o<i;o++)if(t.match(a[o]))return!0;return!1}function we(e,n,t){if(0===e.length)return e;if(t&&"function"==typeof t)return t(e);for(var a=new window.DOMParser,o=a.parseFromString(e,"text/html"),i=Object.keys(n),r=[].slice.call(o.body.querySelectorAll("*")),d=function(e,t){var a=r[e],o=a.nodeName.toLowerCase();if(-1===i.indexOf(a.nodeName.toLowerCase()))return a.parentNode.removeChild(a),"continue";var d=[].slice.call(a.attributes),l=[].concat(n["*"]||[],n[o]||[]);d.forEach(function(e){pe(e,l)||a.removeAttribute(e.nodeName)})},l=0,s=r.length;l<s;l++){d(l,s)}return o.body.innerHTML}n=n&&n.hasOwnProperty("default")?n.default:n;var Ee="transitionend",ye=1e6,Ce=1e3,be={TRANSITION_END:"bsTransitionEnd",getUID:function(e){do{e+=~~(Math.random()*ye)}while(document.getElementById(e));return e},getSelectorFromElement:function(e){var n=e.getAttribute("data-target");if(!n||"#"===n){var t=e.getAttribute("href");n=t&&"#"!==t?t.trim():""}try{return document.querySelector(n)?n:null}catch(a){return null}},getTransitionDurationFromElement:function(e){if(!e)return 0;var t=n(e).css("transition-duration"),a=n(e).css("transition-delay"),o=parseFloat(t),i=parseFloat(a);return o||i?(t=t.split(",")[0],a=a.split(",")[0],(parseFloat(t)+parseFloat(a))*Ce):0},reflow:function(e){return e.offsetHeight},triggerTransitionEnd:function(e){n(e).trigger(Ee)},supportsTransitionEnd:function(){return Boolean(Ee)},isElement:function(e){return(e[0]||e).nodeType},typeCheckConfig:function(e,n,t){for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var o=t[a],i=n[a],r=i&&be.isElement(i)?"element":d(i);if(!new RegExp(o).test(r))throw new Error(e.toUpperCase()+': Option "'+a+'" provided type "'+r+'" but expected type "'+o+'".')}},findShadowRoot:function(e){if(!document.documentElement.attachShadow)return null;if("function"==typeof e.getRootNode){var n=e.getRootNode();return n instanceof ShadowRoot?n:null}return e instanceof ShadowRoot?e:e.parentNode?be.findShadowRoot(e.parentNode):null}};c();var xe="alert",Le="4.3.1",Ne="bs.alert",Be="."+Ne,Ie=".data-api",Oe=n.fn[xe],Te={DISMISS:'[data-dismiss="alert"]'},Ge={CLOSE:"close"+Be,CLOSED:"closed"+Be,CLICK_DATA_API:"click"+Be+Ie},Re={ALERT:"alert",FADE:"fade",SHOW:"show"},Qe=function(){function e(e){this._element=e}var t=e.prototype;return t.close=function(e){var n=this._element;e&&(n=this._getRootElement(e)),this._triggerCloseEvent(n).isDefaultPrevented()||this._removeElement(n)},t.dispose=function(){n.removeData(this._element,Ne),this._element=null},t._getRootElement=function(e){var t=be.getSelectorFromElement(e),a=!1;return t&&(a=document.querySelector(t)),a||(a=n(e).closest("."+Re.ALERT)[0]),a},t._triggerCloseEvent=function(e){var t=n.Event(Ge.CLOSE);return n(e).trigger(t),t},t._removeElement=function(e){var t=this;if(n(e).removeClass(Re.SHOW),!n(e).hasClass(Re.FADE))return void this._destroyElement(e);var a=be.getTransitionDurationFromElement(e);n(e).one(be.TRANSITION_END,function(n){return t._destroyElement(e,n)}).emulateTransitionEnd(a)},t._destroyElement=function(e){n(e).detach().trigger(Ge.CLOSED).remove()},e._jQueryInterface=function(t){return this.each(function(){var a=n(this),o=a.data(Ne);o||(o=new e(this),a.data(Ne,o)),"close"===t&&o[t](this)})},e._handleDismiss=function(e){return function(n){n&&n.preventDefault(),e.close(this)}},a(e,null,[{key:"VERSION",get:function(){return Le}}]),e}();n(document).on(Ge.CLICK_DATA_API,Te.DISMISS,Qe._handleDismiss(new Qe)),n.fn[xe]=Qe._jQueryInterface,n.fn[xe].Constructor=Qe,n.fn[xe].noConflict=function(){return n.fn[xe]=Oe,Qe._jQueryInterface};var Ve="button",ke="4.3.1",De="bs.button",Fe="."+De,Pe=".data-api",Ue=n.fn[Ve],je={ACTIVE:"active",BUTTON:"btn",FOCUS:"focus"},qe={DATA_TOGGLE_CARROT:'[data-toggle^="button"]',DATA_TOGGLE:'[data-toggle="buttons"]',INPUT:'input:not([type="hidden"])',ACTIVE:".active",BUTTON:".btn"},ze={CLICK_DATA_API:"click"+Fe+Pe,FOCUS_BLUR_DATA_API:"focus"+Fe+Pe+" blur"+Fe+Pe},He=function(){function e(e){this._element=e}var t=e.prototype;return t.toggle=function(){var e=!0,t=!0,a=n(this._element).closest(qe.DATA_TOGGLE)[0];if(a){var o=this._element.querySelector(qe.INPUT);if(o){if("radio"===o.type)if(o.checked&&this._element.classList.contains(je.ACTIVE))e=!1;else{var i=a.querySelector(qe.ACTIVE);i&&n(i).removeClass(je.ACTIVE)}if(e){if(o.hasAttribute("disabled")||a.hasAttribute("disabled")||o.classList.contains("disabled")||a.classList.contains("disabled"))return;o.checked=!this._element.classList.contains(je.ACTIVE),n(o).trigger("change")}o.focus(),t=!1}}
t&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(je.ACTIVE)),e&&n(this._element).toggleClass(je.ACTIVE)},t.dispose=function(){n.removeData(this._element,De),this._element=null},e._jQueryInterface=function(t){return this.each(function(){var a=n(this).data(De);a||(a=new e(this),n(this).data(De,a)),"toggle"===t&&a[t]()})},a(e,null,[{key:"VERSION",get:function(){return ke}}]),e}();n(document).on(ze.CLICK_DATA_API,qe.DATA_TOGGLE_CARROT,function(e){e.preventDefault();var t=e.target;n(t).hasClass(je.BUTTON)||(t=n(t).closest(qe.BUTTON)),He._jQueryInterface.call(n(t),"toggle")}).on(ze.FOCUS_BLUR_DATA_API,qe.DATA_TOGGLE_CARROT,function(e){var t=n(e.target).closest(qe.BUTTON)[0];n(t).toggleClass(je.FOCUS,/^focus(in)?$/.test(e.type))}),n.fn[Ve]=He._jQueryInterface,n.fn[Ve].Constructor=He,n.fn[Ve].noConflict=function(){return n.fn[Ve]=Ue,He._jQueryInterface};var Je="carousel",Ke="4.3.1",Me="bs.carousel",We="."+Me,Xe=".data-api",Ye=n.fn[Je],Ze=37,$e=39,_e=500,en=40,nn={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},tn={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},an={NEXT:"next",PREV:"prev",LEFT:"left",RIGHT:"right"},on={SLIDE:"slide"+We,SLID:"slid"+We,KEYDOWN:"keydown"+We,MOUSEENTER:"mouseenter"+We,MOUSELEAVE:"mouseleave"+We,TOUCHSTART:"touchstart"+We,TOUCHMOVE:"touchmove"+We,TOUCHEND:"touchend"+We,POINTERDOWN:"pointerdown"+We,POINTERUP:"pointerup"+We,DRAG_START:"dragstart"+We,LOAD_DATA_API:"load"+We+Xe,CLICK_DATA_API:"click"+We+Xe},rn={CAROUSEL:"carousel",ACTIVE:"active",SLIDE:"slide",RIGHT:"carousel-item-right",LEFT:"carousel-item-left",NEXT:"carousel-item-next",PREV:"carousel-item-prev",ITEM:"carousel-item",POINTER_EVENT:"pointer-event"},dn={ACTIVE:".active",ACTIVE_ITEM:".active.carousel-item",ITEM:".carousel-item",ITEM_IMG:".carousel-item img",NEXT_PREV:".carousel-item-next, .carousel-item-prev",INDICATORS:".carousel-indicators",DATA_SLIDE:"[data-slide], [data-slide-to]",DATA_RIDE:'[data-ride="carousel"]'},ln={TOUCH:"touch",PEN:"pen"},sn=function(){function e(e,n){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(n),this._element=e,this._indicatorsElement=this._element.querySelector(dn.INDICATORS),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var t=e.prototype;return t.next=function(){this._isSliding||this._slide(an.NEXT)},t.nextWhenVisible=function(){!document.hidden&&n(this._element).is(":visible")&&"hidden"!==n(this._element).css("visibility")&&this.next()},t.prev=function(){this._isSliding||this._slide(an.PREV)},t.pause=function(e){e||(this._isPaused=!0),this._element.querySelector(dn.NEXT_PREV)&&(be.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},t.cycle=function(e){e||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},t.to=function(e){var t=this;this._activeElement=this._element.querySelector(dn.ACTIVE_ITEM);var a=this._getItemIndex(this._activeElement);if(!(e>this._items.length-1||e<0)){if(this._isSliding)return void n(this._element).one(on.SLID,function(){return t.to(e)});if(a===e)return this.pause(),void this.cycle();var o=e>a?an.NEXT:an.PREV;this._slide(o,this._items[e])}},t.dispose=function(){n(this._element).off(We),n.removeData(this._element,Me),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},t._getConfig=function(e){return e=i({},nn,e),be.typeCheckConfig(Je,e,tn),e},t._handleSwipe=function(){var e=Math.abs(this.touchDeltaX);if(!(e<=en)){var n=e/this.touchDeltaX;n>0&&this.prev(),n<0&&this.next()}},t._addEventListeners=function(){var e=this;this._config.keyboard&&n(this._element).on(on.KEYDOWN,function(n){return e._keydown(n)}),"hover"===this._config.pause&&n(this._element).on(on.MOUSEENTER,function(n){return e.pause(n)}).on(on.MOUSELEAVE,function(n){return e.cycle(n)}),this._config.touch&&this._addTouchEventListeners()},t._addTouchEventListeners=function(){var e=this;if(this._touchSupported){var t=function(n){e._pointerEvent&&ln[n.originalEvent.pointerType.toUpperCase()]?e.touchStartX=n.originalEvent.clientX:e._pointerEvent||(e.touchStartX=n.originalEvent.touches[0].clientX)},a=function(n){n.originalEvent.touches&&n.originalEvent.touches.length>1?e.touchDeltaX=0:e.touchDeltaX=n.originalEvent.touches[0].clientX-e.touchStartX},o=function(n){e._pointerEvent&&ln[n.originalEvent.pointerType.toUpperCase()]&&(e.touchDeltaX=n.originalEvent.clientX-e.touchStartX),e._handleSwipe(),"hover"===e._config.pause&&(e.pause(),e.touchTimeout&&clearTimeout(e.touchTimeout),e.touchTimeout=setTimeout(function(n){return e.cycle(n)},_e+e._config.interval))};n(this._element.querySelectorAll(dn.ITEM_IMG)).on(on.DRAG_START,function(e){return e.preventDefault()}),this._pointerEvent?(n(this._element).on(on.POINTERDOWN,function(e){return t(e)}),n(this._element).on(on.POINTERUP,function(e){return o(e)}),this._element.classList.add(rn.POINTER_EVENT)):(n(this._element).on(on.TOUCHSTART,function(e){return t(e)}),n(this._element).on(on.TOUCHMOVE,function(e){return a(e)}),n(this._element).on(on.TOUCHEND,function(e){return o(e)}))}},t._keydown=function(e){if(!/input|textarea/i.test(e.target.tagName))switch(e.which){case Ze:e.preventDefault(),this.prev();break;case $e:e.preventDefault(),this.next()}},t._getItemIndex=function(e){return this._items=e&&e.parentNode?[].slice.call(e.parentNode.querySelectorAll(dn.ITEM)):[],this._items.indexOf(e)},t._getItemByDirection=function(e,n){var t=e===an.NEXT,a=e===an.PREV,o=this._getItemIndex(n),i=this._items.length-1;if((a&&0===o||t&&o===i)&&!this._config.wrap)return n;var r=e===an.PREV?-1:1,d=(o+r)%this._items.length;return-1===d?this._items[this._items.length-1]:this._items[d]},t._triggerSlideEvent=function(e,t){var a=this._getItemIndex(e),o=this._getItemIndex(this._element.querySelector(dn.ACTIVE_ITEM)),i=n.Event(on.SLIDE,{relatedTarget:e,direction:t,from:o,to:a});return n(this._element).trigger(i),i},t._setActiveIndicatorElement=function(e){if(this._indicatorsElement){var t=[].slice.call(this._indicatorsElement.querySelectorAll(dn.ACTIVE));n(t).removeClass(rn.ACTIVE);var a=this._indicatorsElement.children[this._getItemIndex(e)];a&&n(a).addClass(rn.ACTIVE)}},t._slide=function(e,t){var a,o,i,r=this,d=this._element.querySelector(dn.ACTIVE_ITEM),l=this._getItemIndex(d),s=t||d&&this._getItemByDirection(e,d),c=this._getItemIndex(s),f=Boolean(this._interval);if(e===an.NEXT?(a=rn.LEFT,o=rn.NEXT,i=an.LEFT):(a=rn.RIGHT,o=rn.PREV,i=an.RIGHT),s&&n(s).hasClass(rn.ACTIVE))return void(this._isSliding=!1);if(!this._triggerSlideEvent(s,i).isDefaultPrevented()&&d&&s){this._isSliding=!0,f&&this.pause(),this._setActiveIndicatorElement(s);var u=n.Event(on.SLID,{relatedTarget:s,direction:i,from:l,to:c});if(n(this._element).hasClass(rn.SLIDE)){n(s).addClass(o),be.reflow(s),n(d).addClass(a),n(s).addClass(a);var g=parseInt(s.getAttribute("data-interval"),10);g?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=g):this._config.interval=this._config.defaultInterval||this._config.interval;var h=be.getTransitionDurationFromElement(d);n(d).one(be.TRANSITION_END,function(){n(s).removeClass(a+" "+o).addClass(rn.ACTIVE),n(d).removeClass(rn.ACTIVE+" "+o+" "+a),r._isSliding=!1,setTimeout(function(){return n(r._element).trigger(u)},0)}).emulateTransitionEnd(h)}else n(d).removeClass(rn.ACTIVE),n(s).addClass(rn.ACTIVE),this._isSliding=!1,n(this._element).trigger(u);f&&this.cycle()}},e._jQueryInterface=function(t){return this.each(function(){var a=n(this).data(Me),o=i({},nn,n(this).data());"object"==typeof t&&(o=i({},o,t));var r="string"==typeof t?t:o.slide;if(a||(a=new e(this,o),n(this).data(Me,a)),"number"==typeof t)a.to(t);else if("string"==typeof r){if(void 0===a[r])throw new TypeError('No method named "'+r+'"');a[r]()}else o.interval&&o.ride&&(a.pause(),a.cycle())})},e._dataApiClickHandler=function(t){var a=be.getSelectorFromElement(this);if(a){var o=n(a)[0];if(o&&n(o).hasClass(rn.CAROUSEL)){var r=i({},n(o).data(),n(this).data()),d=this.getAttribute("data-slide-to");d&&(r.interval=!1),e._jQueryInterface.call(n(o),r),d&&n(o).data(Me).to(d),t.preventDefault()}}},a(e,null,[{key:"VERSION",get:function(){return Ke}},{key:"Default",get:function(){return nn}}]),e}();n(document).on(on.CLICK_DATA_API,dn.DATA_SLIDE,sn._dataApiClickHandler),n(window).on(on.LOAD_DATA_API,function(){for(var e=[].slice.call(document.querySelectorAll(dn.DATA_RIDE)),t=0,a=e.length;t<a;t++){var o=n(e[t]);sn._jQueryInterface.call(o,o.data())}}),n.fn[Je]=sn._jQueryInterface,n.fn[Je].Constructor=sn,n.fn[Je].noConflict=function(){return n.fn[Je]=Ye,sn._jQueryInterface};var cn="collapse",fn="4.3.1",un="bs.collapse",gn="."+un,hn=".data-api",An=n.fn[cn],vn={toggle:!0,parent:""},mn={toggle:"boolean",parent:"(string|element)"},Sn={SHOW:"show"+gn,SHOWN:"shown"+gn,HIDE:"hide"+gn,HIDDEN:"hidden"+gn,CLICK_DATA_API:"click"+gn+hn},pn={SHOW:"show",COLLAPSE:"collapse",COLLAPSING:"collapsing",COLLAPSED:"collapsed"},wn={WIDTH:"width",HEIGHT:"height"},En={ACTIVES:".show, .collapsing",DATA_TOGGLE:'[data-toggle="collapse"]'},yn=function(){function e(e,n){this._isTransitioning=!1,this._element=e,this._config=this._getConfig(n),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'));for(var t=[].slice.call(document.querySelectorAll(En.DATA_TOGGLE)),a=0,o=t.length;a<o;a++){var i=t[a],r=be.getSelectorFromElement(i),d=[].slice.call(document.querySelectorAll(r)).filter(function(n){return n===e});null!==r&&d.length>0&&(this._selector=r,this._triggerArray.push(i))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var t=e.prototype;return t.toggle=function(){n(this._element).hasClass(pn.SHOW)?this.hide():this.show()},t.show=function(){var t=this;if(!this._isTransitioning&&!n(this._element).hasClass(pn.SHOW)){var a,o;if(this._parent&&(a=[].slice.call(this._parent.querySelectorAll(En.ACTIVES)).filter(function(e){return"string"==typeof t._config.parent?e.getAttribute("data-parent")===t._config.parent:e.classList.contains(pn.COLLAPSE)}),0===a.length&&(a=null)),!(a&&(o=n(a).not(this._selector).data(un))&&o._isTransitioning)){var i=n.Event(Sn.SHOW);if(n(this._element).trigger(i),!i.isDefaultPrevented()){a&&(e._jQueryInterface.call(n(a).not(this._selector),"hide"),o||n(a).data(un,null));var r=this._getDimension();n(this._element).removeClass(pn.COLLAPSE).addClass(pn.COLLAPSING),this._element.style[r]=0,this._triggerArray.length&&n(this._triggerArray).removeClass(pn.COLLAPSED).attr("aria-expanded",!0),this.setTransitioning(!0);var d=function(){n(t._element).removeClass(pn.COLLAPSING).addClass(pn.COLLAPSE).addClass(pn.SHOW),t._element.style[r]="",t.setTransitioning(!1),n(t._element).trigger(Sn.SHOWN)},l=r[0].toUpperCase()+r.slice(1),s="scroll"+l,c=be.getTransitionDurationFromElement(this._element);n(this._element).one(be.TRANSITION_END,d).emulateTransitionEnd(c),this._element.style[r]=this._element[s]+"px"}}}},t.hide=function(){var e=this;if(!this._isTransitioning&&n(this._element).hasClass(pn.SHOW)){var t=n.Event(Sn.HIDE);if(n(this._element).trigger(t),!t.isDefaultPrevented()){var a=this._getDimension();this._element.style[a]=this._element.getBoundingClientRect()[a]+"px",be.reflow(this._element),n(this._element).addClass(pn.COLLAPSING).removeClass(pn.COLLAPSE).removeClass(pn.SHOW);var o=this._triggerArray.length;if(o>0)for(var i=0;i<o;i++){var r=this._triggerArray[i],d=be.getSelectorFromElement(r);if(null!==d){var l=n([].slice.call(document.querySelectorAll(d)));l.hasClass(pn.SHOW)||n(r).addClass(pn.COLLAPSED).attr("aria-expanded",!1)}}this.setTransitioning(!0);var s=function(){e.setTransitioning(!1),n(e._element).removeClass(pn.COLLAPSING).addClass(pn.COLLAPSE).trigger(Sn.HIDDEN)};this._element.style[a]="";var c=be.getTransitionDurationFromElement(this._element);n(this._element).one(be.TRANSITION_END,s).emulateTransitionEnd(c)}}},t.setTransitioning=function(e){this._isTransitioning=e},t.dispose=function(){n.removeData(this._element,un),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},t._getConfig=function(e){return e=i({},vn,e),e.toggle=Boolean(e.toggle),be.typeCheckConfig(cn,e,mn),e},t._getDimension=function(){return n(this._element).hasClass(wn.WIDTH)?wn.WIDTH:wn.HEIGHT},t._getParent=function(){var t,a=this;be.isElement(this._config.parent)?(t=this._config.parent,void 0!==this._config.parent.jquery&&(t=this._config.parent[0])):t=document.querySelector(this._config.parent);var o='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',i=[].slice.call(t.querySelectorAll(o));return n(i).each(function(n,t){a._addAriaAndCollapsedClass(e._getTargetFromElement(t),[t])}),t},t._addAriaAndCollapsedClass=function(e,t){var a=n(e).hasClass(pn.SHOW);t.length&&n(t).toggleClass(pn.COLLAPSED,!a).attr("aria-expanded",a)},e._getTargetFromElement=function(e){var n=be.getSelectorFromElement(e);return n?document.querySelector(n):null},e._jQueryInterface=function(t){return this.each(function(){var a=n(this),o=a.data(un),r=i({},vn,a.data(),"object"==typeof t&&t?t:{});if(!o&&r.toggle&&/show|hide/.test(t)&&(r.toggle=!1),o||(o=new e(this,r),a.data(un,o)),"string"==typeof t){if(void 0===o[t])throw new TypeError('No method named "'+t+'"');o[t]()}})},a(e,null,[{key:"VERSION",get:function(){return fn}},{key:"Default",get:function(){return vn}}]),e}();n(document).on(Sn.CLICK_DATA_API,En.DATA_TOGGLE,function(e){"A"===e.currentTarget.tagName&&e.preventDefault();var t=n(this),a=be.getSelectorFromElement(this),o=[].slice.call(document.querySelectorAll(a));n(o).each(function(){var e=n(this),a=e.data(un),o=a?"toggle":t.data();yn._jQueryInterface.call(e,o)})}),n.fn[cn]=yn._jQueryInterface,n.fn[cn].Constructor=yn,n.fn[cn].noConflict=function(){return n.fn[cn]=An,yn._jQueryInterface};for(var Cn="undefined"!=typeof window&&"undefined"!=typeof document,bn=["Edge","Trident","Firefox"],xn=0,Ln=0;Ln<bn.length;Ln+=1)if(Cn&&navigator.userAgent.indexOf(bn[Ln])>=0){xn=1;break}var Nn=Cn&&window.Promise,Bn=Nn?f:u,In=Cn&&!(!window.MSInputMethodContext||!document.documentMode),On=Cn&&/MSIE 10/.test(navigator.userAgent),Tn=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},Gn=function(){function e(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(n,t,a){return t&&e(n.prototype,t),a&&e(n,a),n}}(),Rn=function(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e},Qn=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Vn=Cn&&/Firefox/i.test(navigator.userAgent),kn=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Dn=kn.slice(3),Fn={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},Pn={shift:{order:100,enabled:!0,fn:ve},offset:{order:200,enabled:!0,fn:he,offset:0},preventOverflow:{order:300,enabled:!0,fn:Ae,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:fe},arrow:{order:500,enabled:!0,fn:de,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:ce,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:Se},hide:{order:800,enabled:!0,fn:me},computeStyle:{order:850,enabled:!0,fn:ie,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:te,onLoad:ae,gpuAcceleration:void 0}},Un={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:Pn},jn=function(){function e(n,t){var a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Tn(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(a.update)},this.update=Bn(this.update.bind(this)),this.options=Qn({},e.Defaults,o),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=n&&n.jquery?n[0]:n,this.popper=t&&t.jquery?t[0]:t,this.options.modifiers={},Object.keys(Qn({},e.Defaults.modifiers,o.modifiers)).forEach(function(n){a.options.modifiers[n]=Qn({},e.Defaults.modifiers[n]||{},o.modifiers?o.modifiers[n]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(e){return Qn({name:e},a.options.modifiers[e])}).sort(function(e,n){return e.order-n.order}),this.modifiers.forEach(function(e){e.enabled&&g(e.onLoad)&&e.onLoad(a.reference,a.popper,a.options,e,a.state)}),this.update();var i=this.options.eventsEnabled;i&&this.enableEventListeners(),this.state.eventsEnabled=i}return Gn(e,[{key:"update",value:function(){return z.call(this)}},{key:"destroy",value:function(){return K.call(this)}},{key:"enableEventListeners",value:function(){return Y.call(this)}},{key:"disableEventListeners",value:function(){return $.call(this)}}]),e}();jn.Utils=("undefined"!=typeof window?window:global).PopperUtils,jn.placements=kn,jn.Defaults=Un;var qn="dropdown",zn="4.3.1",Hn="bs.dropdown",Jn="."+Hn,Kn=".data-api",Mn=n.fn[qn],Wn=27,Xn=32,Yn=9,Zn=38,$n=40,_n=3,et=new RegExp(Zn+"|"+$n+"|"+Wn),nt={HIDE:"hide"+Jn,HIDDEN:"hidden"+Jn,SHOW:"show"+Jn,SHOWN:"shown"+Jn,CLICK:"click"+Jn,CLICK_DATA_API:"click"+Jn+Kn,KEYDOWN_DATA_API:"keydown"+Jn+Kn,KEYUP_DATA_API:"keyup"+Jn+Kn},tt={DISABLED:"disabled",SHOW:"show",DROPUP:"dropup",DROPRIGHT:"dropright",DROPLEFT:"dropleft",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left",POSITION_STATIC:"position-static"},at={DATA_TOGGLE:'[data-toggle="dropdown"]',FORM_CHILD:".dropdown form",MENU:".dropdown-menu",NAVBAR_NAV:".navbar-nav",VISIBLE_ITEMS:".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)"},ot={TOP:"top-start",TOPEND:"top-end",BOTTOM:"bottom-start",BOTTOMEND:"bottom-end",RIGHT:"right-start",RIGHTEND:"right-end",LEFT:"left-start",LEFTEND:"left-end"},it={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic"},rt={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string"},dt=function(){function e(e,n){this._element=e,this._popper=null,this._config=this._getConfig(n),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var t=e.prototype;return t.toggle=function(){if(!this._element.disabled&&!n(this._element).hasClass(tt.DISABLED)){var t=e._getParentFromElement(this._element),a=n(this._menu).hasClass(tt.SHOW);if(e._clearMenus(),!a){var o={relatedTarget:this._element},i=n.Event(nt.SHOW,o);if(n(t).trigger(i),!i.isDefaultPrevented()){if(!this._inNavbar){if(void 0===jn)throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var r=this._element;"parent"===this._config.reference?r=t:be.isElement(this._config.reference)&&(r=this._config.reference,void 0!==this._config.reference.jquery&&(r=this._config.reference[0])),"scrollParent"!==this._config.boundary&&n(t).addClass(tt.POSITION_STATIC),this._popper=new jn(r,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===n(t).closest(at.NAVBAR_NAV).length&&n(document.body).children().on("mouseover",null,n.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),n(this._menu).toggleClass(tt.SHOW),n(t).toggleClass(tt.SHOW).trigger(n.Event(nt.SHOWN,o))}}}},t.show=function(){if(!(this._element.disabled||n(this._element).hasClass(tt.DISABLED)||n(this._menu).hasClass(tt.SHOW))){var t={relatedTarget:this._element},a=n.Event(nt.SHOW,t),o=e._getParentFromElement(this._element);n(o).trigger(a),a.isDefaultPrevented()||(n(this._menu).toggleClass(tt.SHOW),n(o).toggleClass(tt.SHOW).trigger(n.Event(nt.SHOWN,t)))}},t.hide=function(){if(!this._element.disabled&&!n(this._element).hasClass(tt.DISABLED)&&n(this._menu).hasClass(tt.SHOW)){var t={relatedTarget:this._element},a=n.Event(nt.HIDE,t),o=e._getParentFromElement(this._element);n(o).trigger(a),a.isDefaultPrevented()||(n(this._menu).toggleClass(tt.SHOW),n(o).toggleClass(tt.SHOW).trigger(n.Event(nt.HIDDEN,t)))}},t.dispose=function(){n.removeData(this._element,Hn),n(this._element).off(Jn),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},t.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},t._addEventListeners=function(){var e=this;n(this._element).on(nt.CLICK,function(n){n.preventDefault(),n.stopPropagation(),e.toggle()})},t._getConfig=function(e){return e=i({},this.constructor.Default,n(this._element).data(),e),be.typeCheckConfig(qn,e,this.constructor.DefaultType),e},t._getMenuElement=function(){if(!this._menu){var n=e._getParentFromElement(this._element);n&&(this._menu=n.querySelector(at.MENU))}return this._menu},t._getPlacement=function(){var e=n(this._element.parentNode),t=ot.BOTTOM;return e.hasClass(tt.DROPUP)?(t=ot.TOP,n(this._menu).hasClass(tt.MENURIGHT)&&(t=ot.TOPEND)):e.hasClass(tt.DROPRIGHT)?t=ot.RIGHT:e.hasClass(tt.DROPLEFT)?t=ot.LEFT:n(this._menu).hasClass(tt.MENURIGHT)&&(t=ot.BOTTOMEND),t},t._detectNavbar=function(){return n(this._element).closest(".navbar").length>0},t._getOffset=function(){var e=this,n={};return"function"==typeof this._config.offset?n.fn=function(n){return n.offsets=i({},n.offsets,e._config.offset(n.offsets,e._element)||{}),n}:n.offset=this._config.offset,n},t._getPopperConfig=function(){var e={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(e.modifiers.applyStyle={enabled:!1}),e},e._jQueryInterface=function(t){return this.each(function(){var a=n(this).data(Hn),o="object"==typeof t?t:null;if(a||(a=new e(this,o),n(this).data(Hn,a)),"string"==typeof t){if(void 0===a[t])throw new TypeError('No method named "'+t+'"');a[t]()}})},e._clearMenus=function(t){if(!t||t.which!==_n&&("keyup"!==t.type||t.which===Yn))for(var a=[].slice.call(document.querySelectorAll(at.DATA_TOGGLE)),o=0,i=a.length;o<i;o++){var r=e._getParentFromElement(a[o]),d=n(a[o]).data(Hn),l={relatedTarget:a[o]};if(t&&"click"===t.type&&(l.clickEvent=t),d){var s=d._menu;if(n(r).hasClass(tt.SHOW)&&!(t&&("click"===t.type&&/input|textarea/i.test(t.target.tagName)||"keyup"===t.type&&t.which===Yn)&&n.contains(r,t.target))){var c=n.Event(nt.HIDE,l);n(r).trigger(c),c.isDefaultPrevented()||("ontouchstart"in document.documentElement&&n(document.body).children().off("mouseover",null,n.noop),a[o].setAttribute("aria-expanded","false"),n(s).removeClass(tt.SHOW),n(r).removeClass(tt.SHOW).trigger(n.Event(nt.HIDDEN,l)))}}}},e._getParentFromElement=function(e){var n,t=be.getSelectorFromElement(e);return t&&(n=document.querySelector(t)),n||e.parentNode},e._dataApiKeydownHandler=function(t){if((/input|textarea/i.test(t.target.tagName)?!(t.which===Xn||t.which!==Wn&&(t.which!==$n&&t.which!==Zn||n(t.target).closest(at.MENU).length)):et.test(t.which))&&(t.preventDefault(),t.stopPropagation(),!this.disabled&&!n(this).hasClass(tt.DISABLED))){var a=e._getParentFromElement(this),o=n(a).hasClass(tt.SHOW);if(!o||o&&(t.which===Wn||t.which===Xn)){if(t.which===Wn){var i=a.querySelector(at.DATA_TOGGLE);n(i).trigger("focus")}return void n(this).trigger("click")}var r=[].slice.call(a.querySelectorAll(at.VISIBLE_ITEMS));if(0!==r.length){var d=r.indexOf(t.target);t.which===Zn&&d>0&&d--,t.which===$n&&d<r.length-1&&d++,d<0&&(d=0),r[d].focus()}}},a(e,null,[{key:"VERSION",get:function(){return zn}},{key:"Default",get:function(){return it}},{key:"DefaultType",get:function(){return rt}}]),e}();n(document).on(nt.KEYDOWN_DATA_API,at.DATA_TOGGLE,dt._dataApiKeydownHandler).on(nt.KEYDOWN_DATA_API,at.MENU,dt._dataApiKeydownHandler).on(nt.CLICK_DATA_API+" "+nt.KEYUP_DATA_API,dt._clearMenus).on(nt.CLICK_DATA_API,at.DATA_TOGGLE,function(e){e.preventDefault(),e.stopPropagation(),dt._jQueryInterface.call(n(this),"toggle")}).on(nt.CLICK_DATA_API,at.FORM_CHILD,function(e){e.stopPropagation()}),n.fn[qn]=dt._jQueryInterface,n.fn[qn].Constructor=dt,n.fn[qn].noConflict=function(){return n.fn[qn]=Mn,dt._jQueryInterface};var lt="modal",st="4.3.1",ct="bs.modal",ft="."+ct,ut=".data-api",gt=n.fn[lt],ht=27,At={backdrop:!0,keyboard:!0,focus:!0,show:!0},vt={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},mt={HIDE:"hide"+ft,HIDDEN:"hidden"+ft,SHOW:"show"+ft,SHOWN:"shown"+ft,FOCUSIN:"focusin"+ft,RESIZE:"resize"+ft,CLICK_DISMISS:"click.dismiss"+ft,KEYDOWN_DISMISS:"keydown.dismiss"+ft,MOUSEUP_DISMISS:"mouseup.dismiss"+ft,MOUSEDOWN_DISMISS:"mousedown.dismiss"+ft,CLICK_DATA_API:"click"+ft+ut},St={SCROLLABLE:"modal-dialog-scrollable",SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",SHOW:"show"},pt={DIALOG:".modal-dialog",MODAL_BODY:".modal-body",DATA_TOGGLE:'[data-toggle="modal"]',DATA_DISMISS:'[data-dismiss="modal"]',FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top"},wt=function(){function e(e,n){this._config=this._getConfig(n),this._element=e,this._dialog=e.querySelector(pt.DIALOG),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var t=e.prototype;return t.toggle=function(e){return this._isShown?this.hide():this.show(e)},t.show=function(e){var t=this;if(!this._isShown&&!this._isTransitioning){n(this._element).hasClass(St.FADE)&&(this._isTransitioning=!0);var a=n.Event(mt.SHOW,{relatedTarget:e});n(this._element).trigger(a),this._isShown||a.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),n(this._element).on(mt.CLICK_DISMISS,pt.DATA_DISMISS,function(e){return t.hide(e)}),n(this._dialog).on(mt.MOUSEDOWN_DISMISS,function(){n(t._element).one(mt.MOUSEUP_DISMISS,function(e){n(e.target).is(t._element)&&(t._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return t._showElement(e)}))}},t.hide=function(e){var t=this;if(e&&e.preventDefault(),this._isShown&&!this._isTransitioning){var a=n.Event(mt.HIDE);if(n(this._element).trigger(a),this._isShown&&!a.isDefaultPrevented()){this._isShown=!1;var o=n(this._element).hasClass(St.FADE);if(o&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),n(document).off(mt.FOCUSIN),n(this._element).removeClass(St.SHOW),n(this._element).off(mt.CLICK_DISMISS),n(this._dialog).off(mt.MOUSEDOWN_DISMISS),o){var i=be.getTransitionDurationFromElement(this._element);n(this._element).one(be.TRANSITION_END,function(e){return t._hideModal(e)}).emulateTransitionEnd(i)}else this._hideModal()}}},t.dispose=function(){[window,this._element,this._dialog].forEach(function(e){return n(e).off(ft)}),n(document).off(mt.FOCUSIN),n.removeData(this._element,ct),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},t.handleUpdate=function(){this._adjustDialog()},t._getConfig=function(e){return e=i({},At,e),be.typeCheckConfig(lt,e,vt),e},t._showElement=function(e){var t=this,a=n(this._element).hasClass(St.FADE);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),n(this._dialog).hasClass(St.SCROLLABLE)?this._dialog.querySelector(pt.MODAL_BODY).scrollTop=0:this._element.scrollTop=0,a&&be.reflow(this._element),n(this._element).addClass(St.SHOW),this._config.focus&&this._enforceFocus();var o=n.Event(mt.SHOWN,{relatedTarget:e}),i=function(){t._config.focus&&t._element.focus(),t._isTransitioning=!1,n(t._element).trigger(o)};if(a){var r=be.getTransitionDurationFromElement(this._dialog);n(this._dialog).one(be.TRANSITION_END,i).emulateTransitionEnd(r)}else i()},t._enforceFocus=function(){var e=this;n(document).off(mt.FOCUSIN).on(mt.FOCUSIN,function(t){document!==t.target&&e._element!==t.target&&0===n(e._element).has(t.target).length&&e._element.focus()})},t._setEscapeEvent=function(){var e=this;this._isShown&&this._config.keyboard?n(this._element).on(mt.KEYDOWN_DISMISS,function(n){n.which===ht&&(n.preventDefault(),e.hide())}):this._isShown||n(this._element).off(mt.KEYDOWN_DISMISS)},t._setResizeEvent=function(){var e=this;this._isShown?n(window).on(mt.RESIZE,function(n){return e.handleUpdate(n)}):n(window).off(mt.RESIZE)},t._hideModal=function(){var e=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._isTransitioning=!1,this._showBackdrop(function(){n(document.body).removeClass(St.OPEN),e._resetAdjustments(),e._resetScrollbar(),n(e._element).trigger(mt.HIDDEN)})},t._removeBackdrop=function(){this._backdrop&&(n(this._backdrop).remove(),this._backdrop=null)},t._showBackdrop=function(e){var t=this,a=n(this._element).hasClass(St.FADE)?St.FADE:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className=St.BACKDROP,a&&this._backdrop.classList.add(a),n(this._backdrop).appendTo(document.body),n(this._element).on(mt.CLICK_DISMISS,function(e){if(t._ignoreBackdropClick)return void(t._ignoreBackdropClick=!1);e.target===e.currentTarget&&("static"===t._config.backdrop?t._element.focus():t.hide())}),a&&be.reflow(this._backdrop),n(this._backdrop).addClass(St.SHOW),!e)return;if(!a)return void e();var o=be.getTransitionDurationFromElement(this._backdrop);n(this._backdrop).one(be.TRANSITION_END,e).emulateTransitionEnd(o)}else if(!this._isShown&&this._backdrop){n(this._backdrop).removeClass(St.SHOW);var i=function(){t._removeBackdrop(),e&&e()};if(n(this._element).hasClass(St.FADE)){var r=be.getTransitionDurationFromElement(this._backdrop);n(this._backdrop).one(be.TRANSITION_END,i).emulateTransitionEnd(r)}else i()}else e&&e()},t._adjustDialog=function(){var e=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&e&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!e&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},t._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},t._checkScrollbar=function(){var e=document.body.getBoundingClientRect();this._isBodyOverflowing=e.left+e.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},t._setScrollbar=function(){var e=this;if(this._isBodyOverflowing){var t=[].slice.call(document.querySelectorAll(pt.FIXED_CONTENT)),a=[].slice.call(document.querySelectorAll(pt.STICKY_CONTENT));n(t).each(function(t,a){var o=a.style.paddingRight,i=n(a).css("padding-right");n(a).data("padding-right",o).css("padding-right",parseFloat(i)+e._scrollbarWidth+"px")}),n(a).each(function(t,a){var o=a.style.marginRight,i=n(a).css("margin-right");n(a).data("margin-right",o).css("margin-right",parseFloat(i)-e._scrollbarWidth+"px")})
;var o=document.body.style.paddingRight,i=n(document.body).css("padding-right");n(document.body).data("padding-right",o).css("padding-right",parseFloat(i)+this._scrollbarWidth+"px")}n(document.body).addClass(St.OPEN)},t._resetScrollbar=function(){var e=[].slice.call(document.querySelectorAll(pt.FIXED_CONTENT));n(e).each(function(e,t){var a=n(t).data("padding-right");n(t).removeData("padding-right"),t.style.paddingRight=a||""});var t=[].slice.call(document.querySelectorAll(""+pt.STICKY_CONTENT));n(t).each(function(e,t){var a=n(t).data("margin-right");void 0!==a&&n(t).css("margin-right",a).removeData("margin-right")});var a=n(document.body).data("padding-right");n(document.body).removeData("padding-right"),document.body.style.paddingRight=a||""},t._getScrollbarWidth=function(){var e=document.createElement("div");e.className=St.SCROLLBAR_MEASURER,document.body.appendChild(e);var n=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),n},e._jQueryInterface=function(t,a){return this.each(function(){var o=n(this).data(ct),r=i({},At,n(this).data(),"object"==typeof t&&t?t:{});if(o||(o=new e(this,r),n(this).data(ct,o)),"string"==typeof t){if(void 0===o[t])throw new TypeError('No method named "'+t+'"');o[t](a)}else r.show&&o.show(a)})},a(e,null,[{key:"VERSION",get:function(){return st}},{key:"Default",get:function(){return At}}]),e}();n(document).on(mt.CLICK_DATA_API,pt.DATA_TOGGLE,function(e){var t,a=this,o=be.getSelectorFromElement(this);o&&(t=document.querySelector(o));var r=n(t).data(ct)?"toggle":i({},n(t).data(),n(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||e.preventDefault();var d=n(t).one(mt.SHOW,function(e){e.isDefaultPrevented()||d.one(mt.HIDDEN,function(){n(a).is(":visible")&&a.focus()})});wt._jQueryInterface.call(n(t),r,this)}),n.fn[lt]=wt._jQueryInterface,n.fn[lt].Constructor=wt,n.fn[lt].noConflict=function(){return n.fn[lt]=gt,wt._jQueryInterface};var Et=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],yt=/^aria-[\w-]*$/i,Ct={"*":["class","dir","id","lang","role",yt],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},bt=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))/gi,xt=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i,Lt="tooltip",Nt="4.3.1",Bt="bs.tooltip",It="."+Bt,Ot=n.fn[Lt],Tt="bs-tooltip",Gt=new RegExp("(^|\\s)"+Tt+"\\S+","g"),Rt=["sanitize","whiteList","sanitizeFn"],Qt={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object"},Vt={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},kt={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:Ct},Dt={SHOW:"show",OUT:"out"},Ft={HIDE:"hide"+It,HIDDEN:"hidden"+It,SHOW:"show"+It,SHOWN:"shown"+It,INSERTED:"inserted"+It,CLICK:"click"+It,FOCUSIN:"focusin"+It,FOCUSOUT:"focusout"+It,MOUSEENTER:"mouseenter"+It,MOUSELEAVE:"mouseleave"+It},Pt={FADE:"fade",SHOW:"show"},Ut={TOOLTIP:".tooltip",TOOLTIP_INNER:".tooltip-inner",ARROW:".arrow"},jt={HOVER:"hover",FOCUS:"focus",CLICK:"click",MANUAL:"manual"},qt=function(){function e(e,n){if(void 0===jn)throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=e,this.config=this._getConfig(n),this.tip=null,this._setListeners()}var t=e.prototype;return t.enable=function(){this._isEnabled=!0},t.disable=function(){this._isEnabled=!1},t.toggleEnabled=function(){this._isEnabled=!this._isEnabled},t.toggle=function(e){if(this._isEnabled)if(e){var t=this.constructor.DATA_KEY,a=n(e.currentTarget).data(t);a||(a=new this.constructor(e.currentTarget,this._getDelegateConfig()),n(e.currentTarget).data(t,a)),a._activeTrigger.click=!a._activeTrigger.click,a._isWithActiveTrigger()?a._enter(null,a):a._leave(null,a)}else{if(n(this.getTipElement()).hasClass(Pt.SHOW))return void this._leave(null,this);this._enter(null,this)}},t.dispose=function(){clearTimeout(this._timeout),n.removeData(this.element,this.constructor.DATA_KEY),n(this.element).off(this.constructor.EVENT_KEY),n(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&n(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},t.show=function(){var e=this;if("none"===n(this.element).css("display"))throw new Error("Please use show on visible elements");var t=n.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){n(this.element).trigger(t);var a=be.findShadowRoot(this.element),o=n.contains(null!==a?a:this.element.ownerDocument.documentElement,this.element);if(t.isDefaultPrevented()||!o)return;var i=this.getTipElement(),r=be.getUID(this.constructor.NAME);i.setAttribute("id",r),this.element.setAttribute("aria-describedby",r),this.setContent(),this.config.animation&&n(i).addClass(Pt.FADE);var d="function"==typeof this.config.placement?this.config.placement.call(this,i,this.element):this.config.placement,l=this._getAttachment(d);this.addAttachmentClass(l);var s=this._getContainer();n(i).data(this.constructor.DATA_KEY,this),n.contains(this.element.ownerDocument.documentElement,this.tip)||n(i).appendTo(s),n(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new jn(this.element,i,{placement:l,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:Ut.ARROW},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(n){n.originalPlacement!==n.placement&&e._handlePopperPlacementChange(n)},onUpdate:function(n){return e._handlePopperPlacementChange(n)}}),n(i).addClass(Pt.SHOW),"ontouchstart"in document.documentElement&&n(document.body).children().on("mouseover",null,n.noop);var c=function(){e.config.animation&&e._fixTransition();var t=e._hoverState;e._hoverState=null,n(e.element).trigger(e.constructor.Event.SHOWN),t===Dt.OUT&&e._leave(null,e)};if(n(this.tip).hasClass(Pt.FADE)){var f=be.getTransitionDurationFromElement(this.tip);n(this.tip).one(be.TRANSITION_END,c).emulateTransitionEnd(f)}else c()}},t.hide=function(e){var t=this,a=this.getTipElement(),o=n.Event(this.constructor.Event.HIDE),i=function(){t._hoverState!==Dt.SHOW&&a.parentNode&&a.parentNode.removeChild(a),t._cleanTipClass(),t.element.removeAttribute("aria-describedby"),n(t.element).trigger(t.constructor.Event.HIDDEN),null!==t._popper&&t._popper.destroy(),e&&e()};if(n(this.element).trigger(o),!o.isDefaultPrevented()){if(n(a).removeClass(Pt.SHOW),"ontouchstart"in document.documentElement&&n(document.body).children().off("mouseover",null,n.noop),this._activeTrigger[jt.CLICK]=!1,this._activeTrigger[jt.FOCUS]=!1,this._activeTrigger[jt.HOVER]=!1,n(this.tip).hasClass(Pt.FADE)){var r=be.getTransitionDurationFromElement(a);n(a).one(be.TRANSITION_END,i).emulateTransitionEnd(r)}else i();this._hoverState=""}},t.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},t.isWithContent=function(){return Boolean(this.getTitle())},t.addAttachmentClass=function(e){n(this.getTipElement()).addClass(Tt+"-"+e)},t.getTipElement=function(){return this.tip=this.tip||n(this.config.template)[0],this.tip},t.setContent=function(){var e=this.getTipElement();this.setElementContent(n(e.querySelectorAll(Ut.TOOLTIP_INNER)),this.getTitle()),n(e).removeClass(Pt.FADE+" "+Pt.SHOW)},t.setElementContent=function(e,t){if("object"==typeof t&&(t.nodeType||t.jquery))return void(this.config.html?n(t).parent().is(e)||e.empty().append(t):e.text(n(t).text()));this.config.html?(this.config.sanitize&&(t=we(t,this.config.whiteList,this.config.sanitizeFn)),e.html(t)):e.text(t)},t.getTitle=function(){var e=this.element.getAttribute("data-original-title");return e||(e="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),e},t._getOffset=function(){var e=this,n={};return"function"==typeof this.config.offset?n.fn=function(n){return n.offsets=i({},n.offsets,e.config.offset(n.offsets,e.element)||{}),n}:n.offset=this.config.offset,n},t._getContainer=function(){return!1===this.config.container?document.body:be.isElement(this.config.container)?n(this.config.container):n(document).find(this.config.container)},t._getAttachment=function(e){return Vt[e.toUpperCase()]},t._setListeners=function(){var e=this;this.config.trigger.split(" ").forEach(function(t){if("click"===t)n(e.element).on(e.constructor.Event.CLICK,e.config.selector,function(n){return e.toggle(n)});else if(t!==jt.MANUAL){var a=t===jt.HOVER?e.constructor.Event.MOUSEENTER:e.constructor.Event.FOCUSIN,o=t===jt.HOVER?e.constructor.Event.MOUSELEAVE:e.constructor.Event.FOCUSOUT;n(e.element).on(a,e.config.selector,function(n){return e._enter(n)}).on(o,e.config.selector,function(n){return e._leave(n)})}}),n(this.element).closest(".modal").on("hide.bs.modal",function(){e.element&&e.hide()}),this.config.selector?this.config=i({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},t._fixTitle=function(){var e=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==e)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},t._enter=function(e,t){var a=this.constructor.DATA_KEY;return t=t||n(e.currentTarget).data(a),t||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),n(e.currentTarget).data(a,t)),e&&(t._activeTrigger["focusin"===e.type?jt.FOCUS:jt.HOVER]=!0),n(t.getTipElement()).hasClass(Pt.SHOW)||t._hoverState===Dt.SHOW?void(t._hoverState=Dt.SHOW):(clearTimeout(t._timeout),t._hoverState=Dt.SHOW,t.config.delay&&t.config.delay.show?void(t._timeout=setTimeout(function(){t._hoverState===Dt.SHOW&&t.show()},t.config.delay.show)):void t.show())},t._leave=function(e,t){var a=this.constructor.DATA_KEY;if(t=t||n(e.currentTarget).data(a),t||(t=new this.constructor(e.currentTarget,this._getDelegateConfig()),n(e.currentTarget).data(a,t)),e&&(t._activeTrigger["focusout"===e.type?jt.FOCUS:jt.HOVER]=!1),!t._isWithActiveTrigger()){if(clearTimeout(t._timeout),t._hoverState=Dt.OUT,!t.config.delay||!t.config.delay.hide)return void t.hide();t._timeout=setTimeout(function(){t._hoverState===Dt.OUT&&t.hide()},t.config.delay.hide)}},t._isWithActiveTrigger=function(){for(var e in this._activeTrigger)if(this._activeTrigger[e])return!0;return!1},t._getConfig=function(e){var t=n(this.element).data();return Object.keys(t).forEach(function(e){-1!==Rt.indexOf(e)&&delete t[e]}),e=i({},this.constructor.Default,t,"object"==typeof e&&e?e:{}),"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),"number"==typeof e.title&&(e.title=e.title.toString()),"number"==typeof e.content&&(e.content=e.content.toString()),be.typeCheckConfig(Lt,e,this.constructor.DefaultType),e.sanitize&&(e.template=we(e.template,e.whiteList,e.sanitizeFn)),e},t._getDelegateConfig=function(){var e={};if(this.config)for(var n in this.config)this.constructor.Default[n]!==this.config[n]&&(e[n]=this.config[n]);return e},t._cleanTipClass=function(){var e=n(this.getTipElement()),t=e.attr("class").match(Gt);null!==t&&t.length&&e.removeClass(t.join(""))},t._handlePopperPlacementChange=function(e){var n=e.instance;this.tip=n.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(e.placement))},t._fixTransition=function(){var e=this.getTipElement(),t=this.config.animation;null===e.getAttribute("x-placement")&&(n(e).removeClass(Pt.FADE),this.config.animation=!1,this.hide(),this.show(),this.config.animation=t)},e._jQueryInterface=function(t){return this.each(function(){var a=n(this).data(Bt),o="object"==typeof t&&t;if((a||!/dispose|hide/.test(t))&&(a||(a=new e(this,o),n(this).data(Bt,a)),"string"==typeof t)){if(void 0===a[t])throw new TypeError('No method named "'+t+'"');a[t]()}})},a(e,null,[{key:"VERSION",get:function(){return Nt}},{key:"Default",get:function(){return kt}},{key:"NAME",get:function(){return Lt}},{key:"DATA_KEY",get:function(){return Bt}},{key:"Event",get:function(){return Ft}},{key:"EVENT_KEY",get:function(){return It}},{key:"DefaultType",get:function(){return Qt}}]),e}();n.fn[Lt]=qt._jQueryInterface,n.fn[Lt].Constructor=qt,n.fn[Lt].noConflict=function(){return n.fn[Lt]=Ot,qt._jQueryInterface};var zt="popover",Ht="4.3.1",Jt="bs.popover",Kt="."+Jt,Mt=n.fn[zt],Wt="bs-popover",Xt=new RegExp("(^|\\s)"+Wt+"\\S+","g"),Yt=i({},qt.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),Zt=i({},qt.DefaultType,{content:"(string|element|function)"}),$t={FADE:"fade",SHOW:"show"},_t={TITLE:".popover-header",CONTENT:".popover-body"},ea={HIDE:"hide"+Kt,HIDDEN:"hidden"+Kt,SHOW:"show"+Kt,SHOWN:"shown"+Kt,INSERTED:"inserted"+Kt,CLICK:"click"+Kt,FOCUSIN:"focusin"+Kt,FOCUSOUT:"focusout"+Kt,MOUSEENTER:"mouseenter"+Kt,MOUSELEAVE:"mouseleave"+Kt},na=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var o=t.prototype;return o.isWithContent=function(){return this.getTitle()||this._getContent()},o.addAttachmentClass=function(e){n(this.getTipElement()).addClass(Wt+"-"+e)},o.getTipElement=function(){return this.tip=this.tip||n(this.config.template)[0],this.tip},o.setContent=function(){var e=n(this.getTipElement());this.setElementContent(e.find(_t.TITLE),this.getTitle());var t=this._getContent();"function"==typeof t&&(t=t.call(this.element)),this.setElementContent(e.find(_t.CONTENT),t),e.removeClass($t.FADE+" "+$t.SHOW)},o._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},o._cleanTipClass=function(){var e=n(this.getTipElement()),t=e.attr("class").match(Xt);null!==t&&t.length>0&&e.removeClass(t.join(""))},t._jQueryInterface=function(e){return this.each(function(){var a=n(this).data(Jt),o="object"==typeof e?e:null;if((a||!/dispose|hide/.test(e))&&(a||(a=new t(this,o),n(this).data(Jt,a)),"string"==typeof e)){if(void 0===a[e])throw new TypeError('No method named "'+e+'"');a[e]()}})},a(t,null,[{key:"VERSION",get:function(){return Ht}},{key:"Default",get:function(){return Yt}},{key:"NAME",get:function(){return zt}},{key:"DATA_KEY",get:function(){return Jt}},{key:"Event",get:function(){return ea}},{key:"EVENT_KEY",get:function(){return Kt}},{key:"DefaultType",get:function(){return Zt}}]),t}(qt);n.fn[zt]=na._jQueryInterface,n.fn[zt].Constructor=na,n.fn[zt].noConflict=function(){return n.fn[zt]=Mt,na._jQueryInterface};var ta="scrollspy",aa="4.3.1",oa="bs.scrollspy",ia="."+oa,ra=".data-api",da=n.fn[ta],la={offset:10,method:"auto",target:""},sa={offset:"number",method:"string",target:"(string|element)"},ca={ACTIVATE:"activate"+ia,SCROLL:"scroll"+ia,LOAD_DATA_API:"load"+ia+ra},fa={DROPDOWN_ITEM:"dropdown-item",DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active"},ua={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",NAV_LIST_GROUP:".nav, .list-group",NAV_LINKS:".nav-link",NAV_ITEMS:".nav-item",LIST_ITEMS:".list-group-item",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},ga={OFFSET:"offset",POSITION:"position"},ha=function(){function e(e,t){var a=this;this._element=e,this._scrollElement="BODY"===e.tagName?window:e,this._config=this._getConfig(t),this._selector=this._config.target+" "+ua.NAV_LINKS+","+this._config.target+" "+ua.LIST_ITEMS+","+this._config.target+" "+ua.DROPDOWN_ITEMS,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,n(this._scrollElement).on(ca.SCROLL,function(e){return a._process(e)}),this.refresh(),this._process()}var t=e.prototype;return t.refresh=function(){var e=this,t=this._scrollElement===this._scrollElement.window?ga.OFFSET:ga.POSITION,a="auto"===this._config.method?t:this._config.method,o=a===ga.POSITION?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(e){var t,i=be.getSelectorFromElement(e);if(i&&(t=document.querySelector(i)),t){var r=t.getBoundingClientRect();if(r.width||r.height)return[n(t)[a]().top+o,i]}return null}).filter(function(e){return e}).sort(function(e,n){return e[0]-n[0]}).forEach(function(n){e._offsets.push(n[0]),e._targets.push(n[1])})},t.dispose=function(){n.removeData(this._element,oa),n(this._scrollElement).off(ia),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},t._getConfig=function(e){if(e=i({},la,"object"==typeof e&&e?e:{}),"string"!=typeof e.target){var t=n(e.target).attr("id");t||(t=be.getUID(ta),n(e.target).attr("id",t)),e.target="#"+t}return be.typeCheckConfig(ta,e,sa),e},t._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},t._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},t._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},t._process=function(){var e=this._getScrollTop()+this._config.offset,n=this._getScrollHeight(),t=this._config.offset+n-this._getOffsetHeight();if(this._scrollHeight!==n&&this.refresh(),e>=t){var a=this._targets[this._targets.length-1];return void(this._activeTarget!==a&&this._activate(a))}if(this._activeTarget&&e<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var o=this._offsets.length,i=o;i--;){this._activeTarget!==this._targets[i]&&e>=this._offsets[i]&&(void 0===this._offsets[i+1]||e<this._offsets[i+1])&&this._activate(this._targets[i])}},t._activate=function(e){this._activeTarget=e,this._clear();var t=this._selector.split(",").map(function(n){return n+'[data-target="'+e+'"],'+n+'[href="'+e+'"]'}),a=n([].slice.call(document.querySelectorAll(t.join(","))));a.hasClass(fa.DROPDOWN_ITEM)?(a.closest(ua.DROPDOWN).find(ua.DROPDOWN_TOGGLE).addClass(fa.ACTIVE),a.addClass(fa.ACTIVE)):(a.addClass(fa.ACTIVE),a.parents(ua.NAV_LIST_GROUP).prev(ua.NAV_LINKS+", "+ua.LIST_ITEMS).addClass(fa.ACTIVE),a.parents(ua.NAV_LIST_GROUP).prev(ua.NAV_ITEMS).children(ua.NAV_LINKS).addClass(fa.ACTIVE)),n(this._scrollElement).trigger(ca.ACTIVATE,{relatedTarget:e})},t._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(e){return e.classList.contains(fa.ACTIVE)}).forEach(function(e){return e.classList.remove(fa.ACTIVE)})},e._jQueryInterface=function(t){return this.each(function(){var a=n(this).data(oa),o="object"==typeof t&&t;if(a||(a=new e(this,o),n(this).data(oa,a)),"string"==typeof t){if(void 0===a[t])throw new TypeError('No method named "'+t+'"');a[t]()}})},a(e,null,[{key:"VERSION",get:function(){return aa}},{key:"Default",get:function(){return la}}]),e}();n(window).on(ca.LOAD_DATA_API,function(){for(var e=[].slice.call(document.querySelectorAll(ua.DATA_SPY)),t=e.length,a=t;a--;){var o=n(e[a]);ha._jQueryInterface.call(o,o.data())}}),n.fn[ta]=ha._jQueryInterface,n.fn[ta].Constructor=ha,n.fn[ta].noConflict=function(){return n.fn[ta]=da,ha._jQueryInterface};var Aa="tab",va="4.3.1",ma="bs.tab",Sa="."+ma,pa=".data-api",wa=n.fn[Aa],Ea={HIDE:"hide"+Sa,HIDDEN:"hidden"+Sa,SHOW:"show"+Sa,SHOWN:"shown"+Sa,CLICK_DATA_API:"click"+Sa+pa},ya={DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active",DISABLED:"disabled",FADE:"fade",SHOW:"show"},Ca={DROPDOWN:".dropdown",NAV_LIST_GROUP:".nav, .list-group",ACTIVE:".active",ACTIVE_UL:"> li > .active",DATA_TOGGLE:'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',DROPDOWN_TOGGLE:".dropdown-toggle",DROPDOWN_ACTIVE_CHILD:"> .dropdown-menu .active"},ba=function(){function e(e){this._element=e}var t=e.prototype;return t.show=function(){var e=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&n(this._element).hasClass(ya.ACTIVE)||n(this._element).hasClass(ya.DISABLED))){var t,a,o=n(this._element).closest(Ca.NAV_LIST_GROUP)[0],i=be.getSelectorFromElement(this._element);if(o){var r="UL"===o.nodeName||"OL"===o.nodeName?Ca.ACTIVE_UL:Ca.ACTIVE;a=n.makeArray(n(o).find(r)),a=a[a.length-1]}var d=n.Event(Ea.HIDE,{relatedTarget:this._element}),l=n.Event(Ea.SHOW,{relatedTarget:a});if(a&&n(a).trigger(d),n(this._element).trigger(l),!l.isDefaultPrevented()&&!d.isDefaultPrevented()){i&&(t=document.querySelector(i)),this._activate(this._element,o);var s=function(){var t=n.Event(Ea.HIDDEN,{relatedTarget:e._element}),o=n.Event(Ea.SHOWN,{relatedTarget:a});n(a).trigger(t),n(e._element).trigger(o)};t?this._activate(t,t.parentNode,s):s()}}},t.dispose=function(){n.removeData(this._element,ma),this._element=null},t._activate=function(e,t,a){var o=this,i=!t||"UL"!==t.nodeName&&"OL"!==t.nodeName?n(t).children(Ca.ACTIVE):n(t).find(Ca.ACTIVE_UL),r=i[0],d=a&&r&&n(r).hasClass(ya.FADE),l=function(){return o._transitionComplete(e,r,a)};if(r&&d){var s=be.getTransitionDurationFromElement(r);n(r).removeClass(ya.SHOW).one(be.TRANSITION_END,l).emulateTransitionEnd(s)}else l()},t._transitionComplete=function(e,t,a){if(t){n(t).removeClass(ya.ACTIVE);var o=n(t.parentNode).find(Ca.DROPDOWN_ACTIVE_CHILD)[0];o&&n(o).removeClass(ya.ACTIVE),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!1)}if(n(e).addClass(ya.ACTIVE),"tab"===e.getAttribute("role")&&e.setAttribute("aria-selected",!0),be.reflow(e),e.classList.contains(ya.FADE)&&e.classList.add(ya.SHOW),e.parentNode&&n(e.parentNode).hasClass(ya.DROPDOWN_MENU)){var i=n(e).closest(Ca.DROPDOWN)[0];if(i){var r=[].slice.call(i.querySelectorAll(Ca.DROPDOWN_TOGGLE));n(r).addClass(ya.ACTIVE)}e.setAttribute("aria-expanded",!0)}a&&a()},e._jQueryInterface=function(t){return this.each(function(){var a=n(this),o=a.data(ma);if(o||(o=new e(this),a.data(ma,o)),"string"==typeof t){if(void 0===o[t])throw new TypeError('No method named "'+t+'"');o[t]()}})},a(e,null,[{key:"VERSION",get:function(){return va}}]),e}();n(document).on(Ea.CLICK_DATA_API,Ca.DATA_TOGGLE,function(e){e.preventDefault(),ba._jQueryInterface.call(n(this),"show")}),n.fn[Aa]=ba._jQueryInterface,n.fn[Aa].Constructor=ba,n.fn[Aa].noConflict=function(){return n.fn[Aa]=wa,ba._jQueryInterface};var xa="toast",La="4.3.1",Na="bs.toast",Ba="."+Na,Ia=n.fn[xa],Oa={CLICK_DISMISS:"click.dismiss"+Ba,HIDE:"hide"+Ba,HIDDEN:"hidden"+Ba,SHOW:"show"+Ba,SHOWN:"shown"+Ba},Ta={FADE:"fade",HIDE:"hide",SHOW:"show",SHOWING:"showing"},Ga={animation:"boolean",autohide:"boolean",delay:"number"},Ra={animation:!0,autohide:!0,delay:500},Qa={DATA_DISMISS:'[data-dismiss="toast"]'},Va=function(){function e(e,n){this._element=e,this._config=this._getConfig(n),this._timeout=null,this._setListeners()}var t=e.prototype;return t.show=function(){var e=this;n(this._element).trigger(Oa.SHOW),this._config.animation&&this._element.classList.add(Ta.FADE);var t=function(){e._element.classList.remove(Ta.SHOWING),e._element.classList.add(Ta.SHOW),n(e._element).trigger(Oa.SHOWN),e._config.autohide&&e.hide()};if(this._element.classList.remove(Ta.HIDE),this._element.classList.add(Ta.SHOWING),this._config.animation){var a=be.getTransitionDurationFromElement(this._element);n(this._element).one(be.TRANSITION_END,t).emulateTransitionEnd(a)}else t()},t.hide=function(e){var t=this;this._element.classList.contains(Ta.SHOW)&&(n(this._element).trigger(Oa.HIDE),e?this._close():this._timeout=setTimeout(function(){t._close()},this._config.delay))},t.dispose=function(){clearTimeout(this._timeout),this._timeout=null,this._element.classList.contains(Ta.SHOW)&&this._element.classList.remove(Ta.SHOW),n(this._element).off(Oa.CLICK_DISMISS),n.removeData(this._element,Na),this._element=null,this._config=null},t._getConfig=function(e){return e=i({},Ra,n(this._element).data(),"object"==typeof e&&e?e:{}),be.typeCheckConfig(xa,e,this.constructor.DefaultType),e},t._setListeners=function(){var e=this;n(this._element).on(Oa.CLICK_DISMISS,Qa.DATA_DISMISS,function(){return e.hide(!0)})},t._close=function(){var e=this,t=function(){e._element.classList.add(Ta.HIDE),n(e._element).trigger(Oa.HIDDEN)};if(this._element.classList.remove(Ta.SHOW),this._config.animation){var a=be.getTransitionDurationFromElement(this._element);n(this._element).one(be.TRANSITION_END,t).emulateTransitionEnd(a)}else t()},e._jQueryInterface=function(t){return this.each(function(){var a=n(this),o=a.data(Na),i="object"==typeof t&&t;if(o||(o=new e(this,i),a.data(Na,o)),"string"==typeof t){if(void 0===o[t])throw new TypeError('No method named "'+t+'"');o[t](this)}})},a(e,null,[{key:"VERSION",get:function(){return La}},{key:"DefaultType",get:function(){return Ga}},{key:"Default",get:function(){return Ra}}]),e}();n.fn[xa]=Va._jQueryInterface,n.fn[xa].Constructor=Va,n.fn[xa].noConflict=function(){return n.fn[xa]=Ia,Va._jQueryInterface},function(){if(void 0===n)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var e=n.fn.jquery.split(" ")[0].split("."),t=9;if(e[0]<2&&e[1]<t||1===e[0]&&e[1]===t&&e[2]<1||e[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}(),e.Util=be,e.Alert=Qe,e.Button=He,e.Carousel=sn,e.Collapse=yn,e.Dropdown=dt,e.Modal=wt,e.Popover=na,e.Scrollspy=ha,e.Tab=ba,e.Toast=Va,e.Tooltip=qt,Object.defineProperty(e,"__esModule",{value:!0})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function n(n){var r=n||window.event,d=l.call(arguments,1),s=0,f=0,u=0,g=0,h=0,A=0;if(n=e.event.fix(r),n.type="mousewheel","detail"in r&&(u=-1*r.detail),"wheelDelta"in r&&(u=r.wheelDelta),"wheelDeltaY"in r&&(u=r.wheelDeltaY),"wheelDeltaX"in r&&(f=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(f=-1*u,u=0),s=0===u?f:u,"deltaY"in r&&(u=-1*r.deltaY,s=u),"deltaX"in r&&(f=r.deltaX,0===u&&(s=-1*f)),0!==u||0!==f){if(1===r.deltaMode){var v=e.data(this,"mousewheel-line-height");s*=v,u*=v,f*=v}else if(2===r.deltaMode){var m=e.data(this,"mousewheel-page-height");s*=m,u*=m,f*=m}if(g=Math.max(Math.abs(u),Math.abs(f)),(!i||i>g)&&(i=g,a(r,g)&&(i/=40)),a(r,g)&&(s/=40,f/=40,u/=40),s=Math[s>=1?"floor":"ceil"](s/i),f=Math[f>=1?"floor":"ceil"](f/i),u=Math[u>=1?"floor":"ceil"](u/i),c.settings.normalizeOffset&&this.getBoundingClientRect){var S=this.getBoundingClientRect();h=n.clientX-S.left,A=n.clientY-S.top}return n.deltaX=f,n.deltaY=u,n.deltaFactor=i,n.offsetX=h,n.offsetY=A,n.deltaMode=0,d.unshift(n,s,f,u),o&&clearTimeout(o),o=setTimeout(t,200),(e.event.dispatch||e.event.handle).apply(this,d)}}function t(){i=null}function a(e,n){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&n%120==0}var o,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],d="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var s=r.length;s;)e.event.fixHooks[r[--s]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=d.length;t;)this.addEventListener(d[--t],n,!1);else this.onmousewheel=n;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=d.length;t;)this.removeEventListener(d[--t],n,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(n){var t=e(n),a=t["offsetParent"in e.fn?"offsetParent":"parent"]();return a.length||(a=e("body")),parseInt(a.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(n){return e(n).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function n(n){var r=n||window.event,d=l.call(arguments,1),s=0,f=0,u=0,g=0,h=0,A=0;if(n=e.event.fix(r),n.type="mousewheel","detail"in r&&(u=-1*r.detail),"wheelDelta"in r&&(u=r.wheelDelta),"wheelDeltaY"in r&&(u=r.wheelDeltaY),"wheelDeltaX"in r&&(f=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(f=-1*u,u=0),s=0===u?f:u,"deltaY"in r&&(u=-1*r.deltaY,s=u),"deltaX"in r&&(f=r.deltaX,0===u&&(s=-1*f)),0!==u||0!==f){if(1===r.deltaMode){var v=e.data(this,"mousewheel-line-height");s*=v,u*=v,f*=v}else if(2===r.deltaMode){var m=e.data(this,"mousewheel-page-height");s*=m,u*=m,f*=m}if(g=Math.max(Math.abs(u),Math.abs(f)),(!i||i>g)&&(i=g,a(r,g)&&(i/=40)),a(r,g)&&(s/=40,f/=40,u/=40),s=Math[s>=1?"floor":"ceil"](s/i),f=Math[f>=1?"floor":"ceil"](f/i),u=Math[u>=1?"floor":"ceil"](u/i),c.settings.normalizeOffset&&this.getBoundingClientRect){var S=this.getBoundingClientRect();h=n.clientX-S.left,A=n.clientY-S.top}return n.deltaX=f,n.deltaY=u,n.deltaFactor=i,n.offsetX=h,n.offsetY=A,n.deltaMode=0,d.unshift(n,s,f,u),o&&clearTimeout(o),o=setTimeout(t,200),(e.event.dispatch||e.event.handle).apply(this,d)}}function t(){i=null}function a(e,n){return c.settings.adjustOldDeltas&&"mousewheel"===e.type&&n%120==0}var o,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],d="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var s=r.length;s;)e.event.fixHooks[r[--s]]=e.event.mouseHooks;var c=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=d.length;t;)this.addEventListener(d[--t],n,!1);else this.onmousewheel=n;e.data(this,"mousewheel-line-height",c.getLineHeight(this)),e.data(this,"mousewheel-page-height",c.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=d.length;t;)this.removeEventListener(d[--t],n,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(n){var t=e(n),a=t["offsetParent"in e.fn?"offsetParent":"parent"]();return a.length||(a=e("body")),parseInt(a.css("fontSize"),10)||parseInt(t.css("fontSize"),10)||16},getPageHeight:function(n){return e(n).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(n){var t="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,o="https:"==document.location.protocol?"https:":"http:";t||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+o+"//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.13/jquery.mousewheel.min.js%3E%3C/script%3E"))),n()}(function(){
var n,t="mCustomScrollbar",a="mCS",o=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,documentTouchScroll:!0,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:"auto",autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,d={},l=window.attachEvent&&!window.addEventListener?1:0,s=!1,c=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],f={init:function(n){var n=e.extend(!0,{},i,n),t=u.call(this);if(n.live){var l=n.liveSelector||this.selector||o,s=e(l);if("off"===n.live)return void h(l);d[l]=setTimeout(function(){s.mCustomScrollbar(n),"once"===n.live&&s.length&&h(l)},500)}else h(l);return n.setWidth=n.set_width?n.set_width:n.setWidth,n.setHeight=n.set_height?n.set_height:n.setHeight,n.axis=n.horizontalScroll?"x":A(n.axis),n.scrollInertia=n.scrollInertia>0&&n.scrollInertia<17?17:n.scrollInertia,"object"!=typeof n.mouseWheel&&1==n.mouseWheel&&(n.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),n.mouseWheel.scrollAmount=n.mouseWheelPixels?n.mouseWheelPixels:n.mouseWheel.scrollAmount,n.mouseWheel.normalizeDelta=n.advanced.normalizeMouseWheelDelta?n.advanced.normalizeMouseWheelDelta:n.mouseWheel.normalizeDelta,n.scrollButtons.scrollType=v(n.scrollButtons.scrollType),g(n),e(t).each(function(){var t=e(this);if(!t.data(a)){t.data(a,{idx:++r,opt:n,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:t.css("direction"),cbOffsets:null,trigger:null,poll:{size:{o:0,n:0},img:{o:0,n:0},change:{o:0,n:0}}});var o=t.data(a),i=o.opt,d=t.data("mcs-axis"),l=t.data("mcs-scrollbar-position"),s=t.data("mcs-theme");d&&(i.axis=d),l&&(i.scrollbarPosition=l),s&&(i.theme=s,g(i)),m.call(this),o&&i.callbacks.onCreate&&"function"==typeof i.callbacks.onCreate&&i.callbacks.onCreate.call(this),e("#mCSB_"+o.idx+"_container img:not(."+c[2]+")").addClass(c[2]),f.update.call(null,t)}})},update:function(n,t){var o=n||u.call(this);return e(o).each(function(){var n=e(this);if(n.data(a)){var o=n.data(a),i=o.opt,r=e("#mCSB_"+o.idx+"_container"),d=e("#mCSB_"+o.idx),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(!r.length)return;o.tweenRunning&&W(n),t&&o&&i.callbacks.onBeforeUpdate&&"function"==typeof i.callbacks.onBeforeUpdate&&i.callbacks.onBeforeUpdate.call(this),n.hasClass(c[3])&&n.removeClass(c[3]),n.hasClass(c[4])&&n.removeClass(c[4]),d.css("max-height","none"),d.height()!==n.height()&&d.css("max-height",n.height()),p.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",S(r)),o.overflowed=b.call(this),B.call(this),i.autoDraggerLength&&E.call(this),y.call(this),L.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(o.overflowed[0]?l[0].height()>l[0].parent().height()?x.call(this):(X(n,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),o.contentReset.y=null):(x.call(this),"y"===i.axis?N.call(this):"yx"===i.axis&&o.overflowed[1]&&X(n,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(o.overflowed[1]?l[1].width()>l[1].parent().width()?x.call(this):(X(n,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),o.contentReset.x=null):(x.call(this),"x"===i.axis?N.call(this):"yx"===i.axis&&o.overflowed[0]&&X(n,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),t&&o&&(2===t&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===t&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),K.call(this)}})},scrollTo:function(n,t){if(void 0!==n&&null!=n){var o=u.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){var i=o.data(a),r=i.opt,d={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},l=e.extend(!0,{},d,t),s=H.call(this,n),c=l.scrollInertia>0&&l.scrollInertia<17?17:l.scrollInertia;s[0]=J.call(this,s[0],"y"),s[1]=J.call(this,s[1],"x"),l.moveDragger&&(s[0]*=i.scrollRatio.y,s[1]*=i.scrollRatio.x),l.dur=oe()?0:c,setTimeout(function(){null!==s[0]&&void 0!==s[0]&&"x"!==r.axis&&i.overflowed[0]&&(l.dir="y",l.overwrite="all",X(o,s[0].toString(),l)),null!==s[1]&&void 0!==s[1]&&"y"!==r.axis&&i.overflowed[1]&&(l.dir="x",l.overwrite="none",X(o,s[1].toString(),l))},l.timeout)}})}},stop:function(){var n=u.call(this);return e(n).each(function(){var n=e(this);n.data(a)&&W(n)})},disable:function(n){var t=u.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&(t.data(a),K.call(this,"remove"),N.call(this),n&&x.call(this),B.call(this,!0),t.addClass(c[3]))})},destroy:function(){var n=u.call(this);return e(n).each(function(){var o=e(this);if(o.data(a)){var i=o.data(a),r=i.opt,d=e("#mCSB_"+i.idx),l=e("#mCSB_"+i.idx+"_container"),s=e(".mCSB_"+i.idx+"_scrollbar");r.live&&h(r.liveSelector||e(n).selector),K.call(this,"remove"),N.call(this),x.call(this),o.removeData(a),_(this,"mcs"),s.remove(),l.find("img."+c[2]).removeClass(c[2]),d.replaceWith(l.contents()),o.removeClass(t+" _"+a+"_"+i.idx+" "+c[6]+" "+c[7]+" "+c[5]+" "+c[3]).addClass(c[4])}})}},u=function(){return"object"!=typeof e(this)||e(this).length<1?o:this},g=function(n){var t=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],o=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];n.autoDraggerLength=!(e.inArray(n.theme,t)>-1)&&n.autoDraggerLength,n.autoExpandScrollbar=!(e.inArray(n.theme,a)>-1)&&n.autoExpandScrollbar,n.scrollButtons.enable=!(e.inArray(n.theme,o)>-1)&&n.scrollButtons.enable,n.autoHideScrollbar=e.inArray(n.theme,i)>-1||n.autoHideScrollbar,n.scrollbarPosition=e.inArray(n.theme,r)>-1?"outside":n.scrollbarPosition},h=function(e){d[e]&&(clearTimeout(d[e]),_(d,e))},A=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},v=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},m=function(){var n=e(this),o=n.data(a),i=o.opt,r=i.autoExpandScrollbar?" "+c[1]+"_expand":"",d=["<div id='mCSB_"+o.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+o.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+c[12]+"'><div id='mCSB_"+o.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+o.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+o.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+c[12]+"'><div id='mCSB_"+o.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],l="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",s="yx"===i.axis?d[0]+d[1]:"x"===i.axis?d[1]:d[0],f="yx"===i.axis?"<div id='mCSB_"+o.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",u=i.autoHideScrollbar?" "+c[6]:"",g="x"!==i.axis&&"rtl"===o.langDir?" "+c[7]:"";i.setWidth&&n.css("width",i.setWidth),i.setHeight&&n.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===o.langDir?"989999px":i.setLeft,n.addClass(t+" _"+a+"_"+o.idx+u+g).wrapInner("<div id='mCSB_"+o.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+l+"'><div id='mCSB_"+o.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir='"+o.langDir+"' /></div>");var h=e("#mCSB_"+o.idx),A=e("#mCSB_"+o.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||A.css("width",S(A)),"outside"===i.scrollbarPosition?("static"===n.css("position")&&n.css("position","relative"),n.css("overflow","visible"),h.addClass("mCSB_outside").after(s)):(h.addClass("mCSB_inside").append(s),A.wrap(f)),w.call(this);var v=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];v[0].css("min-height",v[0].height()),v[1].css("min-width",v[1].width())},S=function(n){var t=[n[0].scrollWidth,Math.max.apply(Math,n.children().map(function(){return e(this).outerWidth(!0)}).get())],a=n.parent().width();return t[0]>a?t[0]:t[1]>a?t[1]:"100%"},p=function(){var n=e(this),t=n.data(a),o=t.opt,i=e("#mCSB_"+t.idx+"_container");if(o.advanced.autoExpandHorizontalScroll&&"y"!==o.axis){i.css({width:"auto","min-width":0,"overflow-x":"scroll"});var r=Math.ceil(i[0].scrollWidth);3===o.advanced.autoExpandHorizontalScroll||2!==o.advanced.autoExpandHorizontalScroll&&r>i.parent().width()?i.css({width:r,"min-width":"100%","overflow-x":"inherit"}):i.css({"overflow-x":"inherit",position:"absolute"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),"min-width":"100%",position:"relative"}).unwrap()}},w=function(){var n=e(this),t=n.data(a),o=t.opt,i=e(".mCSB_"+t.idx+"_scrollbar:first"),r=te(o.scrollButtons.tabindex)?"tabindex='"+o.scrollButtons.tabindex+"'":"",d=["<a href='#' class='"+c[13]+"' "+r+" />","<a href='#' class='"+c[14]+"' "+r+" />","<a href='#' class='"+c[15]+"' "+r+" />","<a href='#' class='"+c[16]+"' "+r+" />"],l=["x"===o.axis?d[2]:d[0],"x"===o.axis?d[3]:d[1],d[2],d[3]];o.scrollButtons.enable&&i.prepend(l[0]).append(l[1]).next(".mCSB_scrollTools").prepend(l[2]).append(l[3])},E=function(){var n=e(this),t=n.data(a),o=e("#mCSB_"+t.idx),i=e("#mCSB_"+t.idx+"_container"),r=[e("#mCSB_"+t.idx+"_dragger_vertical"),e("#mCSB_"+t.idx+"_dragger_horizontal")],d=[o.height()/i.outerHeight(!1),o.width()/i.outerWidth(!1)],s=[parseInt(r[0].css("min-height")),Math.round(d[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(d[1]*r[1].parent().width())],c=l&&s[1]<s[0]?s[0]:s[1],f=l&&s[3]<s[2]?s[2]:s[3];r[0].css({height:c,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":s[0]+"px"}),r[1].css({width:f,"max-width":r[1].parent().width()-10})},y=function(){var n=e(this),t=n.data(a),o=e("#mCSB_"+t.idx),i=e("#mCSB_"+t.idx+"_container"),r=[e("#mCSB_"+t.idx+"_dragger_vertical"),e("#mCSB_"+t.idx+"_dragger_horizontal")],d=[i.outerHeight(!1)-o.height(),i.outerWidth(!1)-o.width()],l=[d[0]/(r[0].parent().height()-r[0].height()),d[1]/(r[1].parent().width()-r[1].width())];t.scrollRatio={y:l[0],x:l[1]}},C=function(e,n,t){var a=t?c[0]+"_expanded":"",o=e.closest(".mCSB_scrollTools");"active"===n?(e.toggleClass(c[0]+" "+a),o.toggleClass(c[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===n?(e.removeClass(c[0]),o.removeClass(c[1])):(e.addClass(c[0]),o.addClass(c[1])))},b=function(){var n=e(this),t=n.data(a),o=e("#mCSB_"+t.idx),i=e("#mCSB_"+t.idx+"_container"),r=null==t.overflowed?i.height():i.outerHeight(!1),d=null==t.overflowed?i.width():i.outerWidth(!1),l=i[0].scrollHeight,s=i[0].scrollWidth;return l>r&&(r=l),s>d&&(d=s),[r>o.height(),d>o.width()]},x=function(){var n=e(this),t=n.data(a),o=t.opt,i=e("#mCSB_"+t.idx),r=e("#mCSB_"+t.idx+"_container"),d=[e("#mCSB_"+t.idx+"_dragger_vertical"),e("#mCSB_"+t.idx+"_dragger_horizontal")];if(W(n),("x"!==o.axis&&!t.overflowed[0]||"y"===o.axis&&t.overflowed[0])&&(d[0].add(r).css("top",0),X(n,"_resetY")),"y"!==o.axis&&!t.overflowed[1]||"x"===o.axis&&t.overflowed[1]){var l=dx=0;"rtl"===t.langDir&&(l=i.width()-r.outerWidth(!1),dx=Math.abs(l/t.scrollRatio.x)),r.css("left",l),d[1].css("left",dx),X(n,"_resetX")}},L=function(){function n(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),R.call(t[0])):n()},100)}var t=e(this),o=t.data(a),i=o.opt;if(!o.bindEvents){if(O.call(this),i.contentTouchScroll&&T.call(this),G.call(this),i.mouseWheel.enable){var r;n()}F.call(this),U.call(this),i.advanced.autoScrollOnFocus&&P.call(this),i.scrollButtons.enable&&j.call(this),i.keyboard.enable&&q.call(this),o.bindEvents=!0}},N=function(){var n=e(this),t=n.data(a),o=t.opt,i=a+"_"+t.idx,r=".mCSB_"+t.idx+"_scrollbar",d=e("#mCSB_"+t.idx+",#mCSB_"+t.idx+"_container,#mCSB_"+t.idx+"_container_wrapper,"+r+" ."+c[12]+",#mCSB_"+t.idx+"_dragger_vertical,#mCSB_"+t.idx+"_dragger_horizontal,"+r+">a"),l=e("#mCSB_"+t.idx+"_container");o.advanced.releaseDraggableSelectors&&d.add(e(o.advanced.releaseDraggableSelectors)),o.advanced.extraDraggableSelectors&&d.add(e(o.advanced.extraDraggableSelectors)),t.bindEvents&&(e(document).add(e(!V()||top.document)).unbind("."+i),d.each(function(){e(this).unbind("."+i)}),clearTimeout(n[0]._focusTimeout),_(n[0],"_focusTimeout"),clearTimeout(t.sequential.step),_(t.sequential,"step"),clearTimeout(l[0].onCompleteTimeout),_(l[0],"onCompleteTimeout"),t.bindEvents=!1)},B=function(n){var t=e(this),o=t.data(a),i=o.opt,r=e("#mCSB_"+o.idx+"_container_wrapper"),d=r.length?r:e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_scrollbar_vertical"),e("#mCSB_"+o.idx+"_scrollbar_horizontal")],s=[l[0].find(".mCSB_dragger"),l[1].find(".mCSB_dragger")];"x"!==i.axis&&(o.overflowed[0]&&!n?(l[0].add(s[0]).add(l[0].children("a")).css("display","block"),d.removeClass(c[8]+" "+c[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&s[0].css("display","none"),d.removeClass(c[10])):(l[0].css("display","none"),d.addClass(c[10])),d.addClass(c[8]))),"y"!==i.axis&&(o.overflowed[1]&&!n?(l[1].add(s[1]).add(l[1].children("a")).css("display","block"),d.removeClass(c[9]+" "+c[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&s[1].css("display","none"),d.removeClass(c[11])):(l[1].css("display","none"),d.addClass(c[11])),d.addClass(c[9]))),o.overflowed[0]||o.overflowed[1]?t.removeClass(c[5]):t.addClass(c[5])},I=function(n){var t=n.type,a=n.target.ownerDocument!==document&&null!==frameElement?[e(frameElement).offset().top,e(frameElement).offset().left]:null,o=V()&&n.target.ownerDocument!==top.document&&null!==frameElement?[e(n.view.frameElement).offset().top,e(n.view.frameElement).offset().left]:[0,0];switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return a?[n.originalEvent.pageY-a[0]+o[0],n.originalEvent.pageX-a[1]+o[1],!1]:[n.originalEvent.pageY,n.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var i=n.originalEvent.touches[0]||n.originalEvent.changedTouches[0],r=n.originalEvent.touches.length||n.originalEvent.changedTouches.length;return n.target.ownerDocument!==document?[i.screenY,i.screenX,r>1]:[i.pageY,i.pageX,r>1];default:return a?[n.pageY-a[0]+o[0],n.pageX-a[1]+o[1],!1]:[n.pageY,n.pageX,!1]}},O=function(){function n(e,n,a,o){if(g[0].idleTimer=c.scrollInertia<233?250:0,t.attr("id")===u[1])var i="x",l=(t[0].offsetLeft-n+o)*d.scrollRatio.x;else var i="y",l=(t[0].offsetTop-e+a)*d.scrollRatio.y;X(r,l.toString(),{dir:i,drag:!0})}var t,o,i,r=e(this),d=r.data(a),c=d.opt,f=a+"_"+d.idx,u=["mCSB_"+d.idx+"_dragger_vertical","mCSB_"+d.idx+"_dragger_horizontal"],g=e("#mCSB_"+d.idx+"_container"),h=e("#"+u[0]+",#"+u[1]),A=c.advanced.releaseDraggableSelectors?h.add(e(c.advanced.releaseDraggableSelectors)):h,v=c.advanced.extraDraggableSelectors?e(!V()||top.document).add(e(c.advanced.extraDraggableSelectors)):e(!V()||top.document);h.bind("contextmenu."+f,function(e){e.preventDefault()}).bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f,function(n){if(n.stopImmediatePropagation(),n.preventDefault(),ee(n)){s=!0,l&&(document.onselectstart=function(){return!1}),k.call(g,!1),W(r),t=e(this);var a=t.offset(),d=I(n)[0]-a.top,f=I(n)[1]-a.left,u=t.height()+a.top,h=t.width()+a.left;u>d&&d>0&&h>f&&f>0&&(o=d,i=f),C(t,"active",c.autoExpandScrollbar)}}).bind("touchmove."+f,function(e){e.stopImmediatePropagation(),e.preventDefault();var a=t.offset(),r=I(e)[0]-a.top,d=I(e)[1]-a.left;n(o,i,r,d)}),e(document).add(v).bind("mousemove."+f+" pointermove."+f+" MSPointerMove."+f,function(e){if(t){var a=t.offset(),r=I(e)[0]-a.top,d=I(e)[1]-a.left;if(o===r&&i===d)return;n(o,i,r,d)}}).add(A).bind("mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f,function(){t&&(C(t,"active",c.autoExpandScrollbar),t=null),s=!1,l&&(document.onselectstart=null),k.call(g,!0)})},T=function(){function t(e){if(!ne(e)||s||I(e)[2])return void(n=0);n=1,y=0,C=0,c=1,b.removeClass("mCS_touch_action");var t=O.offset();f=I(e)[0]-t.top,u=I(e)[1]-t.left,D=[I(e)[0],I(e)[1]]}function o(e){if(ne(e)&&!s&&!I(e)[2]&&(L.documentTouchScroll||e.preventDefault(),e.stopImmediatePropagation(),(!C||y)&&c)){v=Z();var n=B.offset(),t=I(e)[0]-n.top,a=I(e)[1]-n.left,o="mcsLinearOut";if(G.push(t),R.push(a),D[2]=Math.abs(I(e)[0]-D[0]),D[3]=Math.abs(I(e)[1]-D[1]),x.overflowed[0])var i=T[0].parent().height()-T[0].height(),r=f-t>0&&t-f>-i*x.scrollRatio.y&&(2*D[3]<D[2]||"yx"===L.axis);if(x.overflowed[1])var d=T[1].parent().width()-T[1].width(),g=u-a>0&&a-u>-d*x.scrollRatio.x&&(2*D[2]<D[3]||"yx"===L.axis);r||g?(U||e.preventDefault(),y=1):(C=1,b.addClass("mCS_touch_action")),U&&e.preventDefault(),w="yx"===L.axis?[f-t,u-a]:"x"===L.axis?[null,u-a]:[f-t,null],O[0].idleTimer=250,x.overflowed[0]&&l(w[0],Q,o,"y","all",!0),x.overflowed[1]&&l(w[1],Q,o,"x",k,!0)}}function i(e){if(!ne(e)||s||I(e)[2])return void(n=0);n=1,e.stopImmediatePropagation(),W(b),A=Z();var t=B.offset();g=I(e)[0]-t.top,h=I(e)[1]-t.left,G=[],R=[]}function r(e){if(ne(e)&&!s&&!I(e)[2]){c=0,e.stopImmediatePropagation(),y=0,C=0,m=Z();var n=B.offset(),t=I(e)[0]-n.top,a=I(e)[1]-n.left;if(!(m-v>30)){p=1e3/(m-A);var o="mcsEaseOut",i=2.5>p,r=i?[G[G.length-2],R[R.length-2]]:[0,0];S=i?[t-r[0],a-r[1]]:[t-g,a-h];var f=[Math.abs(S[0]),Math.abs(S[1])];p=i?[Math.abs(S[0]/4),Math.abs(S[1]/4)]:[p,p];var u=[Math.abs(O[0].offsetTop)-S[0]*d(f[0]/p[0],p[0]),Math.abs(O[0].offsetLeft)-S[1]*d(f[1]/p[1],p[1])];w="yx"===L.axis?[u[0],u[1]]:"x"===L.axis?[null,u[1]]:[u[0],null],E=[4*f[0]+L.scrollInertia,4*f[1]+L.scrollInertia];var b=parseInt(L.contentTouchScroll)||0;w[0]=f[0]>b?w[0]:0,w[1]=f[1]>b?w[1]:0,x.overflowed[0]&&l(w[0],E[0],o,"y",k,!1),x.overflowed[1]&&l(w[1],E[1],o,"x",k,!1)}}}function d(e,n){var t=[1.5*n,2*n,n/1.5,n/2];return e>90?n>4?t[0]:t[3]:e>60?n>3?t[3]:t[2]:e>30?n>8?t[1]:n>6?t[0]:n>4?n:t[2]:n>8?n:t[3]}function l(e,n,t,a,o,i){e&&X(b,e.toString(),{dur:n,scrollEasing:t,dir:a,overwrite:o,drag:i})}var c,f,u,g,h,A,v,m,S,p,w,E,y,C,b=e(this),x=b.data(a),L=x.opt,N=a+"_"+x.idx,B=e("#mCSB_"+x.idx),O=e("#mCSB_"+x.idx+"_container"),T=[e("#mCSB_"+x.idx+"_dragger_vertical"),e("#mCSB_"+x.idx+"_dragger_horizontal")],G=[],R=[],Q=0,k="yx"===L.axis?"none":"all",D=[],F=O.find("iframe"),P=["touchstart."+N+" pointerdown."+N+" MSPointerDown."+N,"touchmove."+N+" pointermove."+N+" MSPointerMove."+N,"touchend."+N+" pointerup."+N+" MSPointerUp."+N],U=void 0!==document.body.style.touchAction&&""!==document.body.style.touchAction;O.bind(P[0],function(e){t(e)}).bind(P[1],function(e){o(e)}),B.bind(P[0],function(e){i(e)}).bind(P[2],function(e){r(e)}),F.length&&F.each(function(){e(this).bind("load",function(){V(this)&&e(this.contentDocument||this.contentWindow.document).bind(P[0],function(e){t(e),i(e)}).bind(P[1],function(e){o(e)}).bind(P[2],function(e){r(e)})})})},G=function(){function t(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function o(e,n,t){c.type=t&&i?"stepped":"stepless",c.scrollAmount=10,z(r,e,n,"mcsLinearOut",t?60:null)}var i,r=e(this),d=r.data(a),l=d.opt,c=d.sequential,f=a+"_"+d.idx,u=e("#mCSB_"+d.idx+"_container"),g=u.parent();u.bind("mousedown."+f,function(){n||i||(i=1,s=!0)}).add(document).bind("mousemove."+f,function(e){if(!n&&i&&t()){var a=u.offset(),r=I(e)[0]-a.top+u[0].offsetTop,s=I(e)[1]-a.left+u[0].offsetLeft;r>0&&r<g.height()&&s>0&&s<g.width()?c.step&&o("off",null,"stepped"):("x"!==l.axis&&d.overflowed[0]&&(0>r?o("on",38):r>g.height()&&o("on",40)),"y"!==l.axis&&d.overflowed[1]&&(0>s?o("on",37):s>g.width()&&o("on",39)))}}).bind("mouseup."+f+" dragend."+f,function(){n||(i&&(i=0,o("off",null)),s=!1)})},R=function(){function n(n,a){if(W(t),!D(t,n.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):l&&n.deltaFactor<100?100:n.deltaFactor||100,c=i.scrollInertia;if("x"===i.axis||"x"===i.mouseWheel.axis)var f="x",u=[Math.round(r*o.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],g="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=d.width()?.9*d.width():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetLeft),A=s[1][0].offsetLeft,v=s[1].parent().width()-s[1].width(),m="y"===i.mouseWheel.axis?n.deltaY||a:n.deltaX;else var f="y",u=[Math.round(r*o.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],g="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=d.height()?.9*d.height():u[0],h=Math.abs(e("#mCSB_"+o.idx+"_container")[0].offsetTop),A=s[0][0].offsetTop,v=s[0].parent().height()-s[0].height(),m=n.deltaY||a;"y"===f&&!o.overflowed[0]||"x"===f&&!o.overflowed[1]||((i.mouseWheel.invert||n.webkitDirectionInvertedFromDevice)&&(m=-m),i.mouseWheel.normalizeDelta&&(m=0>m?-1:1),(m>0&&0!==A||0>m&&A!==v||i.mouseWheel.preventDefault)&&(n.stopImmediatePropagation(),n.preventDefault()),n.deltaFactor<5&&!i.mouseWheel.normalizeDelta&&(g=n.deltaFactor,c=17),X(t,(h-m*g).toString(),{dir:f,dur:c}))}}if(e(this).data(a)){var t=e(this),o=t.data(a),i=o.opt,r=a+"_"+o.idx,d=e("#mCSB_"+o.idx),s=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],c=e("#mCSB_"+o.idx+"_container").find("iframe");c.length&&c.each(function(){e(this).bind("load",function(){V(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,t){n(e,t)})})}),d.bind("mousewheel."+r,function(e,t){n(e,t)})}},Q=new Object,V=function(n){var t=!1,a=!1,o=null;if(void 0===n?a="#empty":void 0!==e(n).attr("id")&&(a=e(n).attr("id")),!1!==a&&void 0!==Q[a])return Q[a];if(n){try{var i=n.contentDocument||n.contentWindow.document;o=i.body.innerHTML}catch(r){}t=null!==o}else{try{var i=top.document;o=i.body.innerHTML}catch(r){}t=null!==o}return!1!==a&&(Q[a]=t),t},k=function(e){var n=this.find("iframe");if(n.length){var t=e?"auto":"none";n.css("pointer-events",t)}},D=function(n,t){var o=t.nodeName.toLowerCase(),i=n.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(o,i)>-1&&!(e.inArray(o,r)>-1&&!e(t).is(":focus"))},F=function(){var n,t=e(this),o=t.data(a),i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),d=r.parent();e(".mCSB_"+o.idx+"_scrollbar ."+c[12]).bind("mousedown."+i+" touchstart."+i+" pointerdown."+i+" MSPointerDown."+i,function(t){s=!0,e(t.target).hasClass("mCSB_dragger")||(n=1)}).bind("touchend."+i+" pointerup."+i+" MSPointerUp."+i,function(){s=!1}).bind("click."+i,function(a){if(n&&(n=0,e(a.target).hasClass(c[12])||e(a.target).hasClass("mCSB_draggerRail"))){W(t);var i=e(this),l=i.find(".mCSB_dragger");if(i.parent(".mCSB_scrollTools_horizontal").length>0){if(!o.overflowed[1])return;var s="x",f=a.pageX>l.offset().left?-1:1,u=Math.abs(r[0].offsetLeft)-f*(.9*d.width())}else{if(!o.overflowed[0])return;var s="y",f=a.pageY>l.offset().top?-1:1,u=Math.abs(r[0].offsetTop)-f*(.9*d.height())}X(t,u.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},P=function(){var n=e(this),t=n.data(a),o=t.opt,i=a+"_"+t.idx,r=e("#mCSB_"+t.idx+"_container"),d=r.parent();r.bind("focusin."+i,function(){var t=e(document.activeElement),a=r.find(".mCustomScrollBox").length,i=0;t.is(o.advanced.autoScrollOnFocus)&&(W(n),clearTimeout(n[0]._focusTimeout),n[0]._focusTimer=a?(i+17)*a:0,n[0]._focusTimeout=setTimeout(function(){var e=[ae(t)[0],ae(t)[1]],a=[r[0].offsetTop,r[0].offsetLeft],l=[a[0]+e[0]>=0&&a[0]+e[0]<d.height()-t.outerHeight(!1),a[1]+e[1]>=0&&a[0]+e[1]<d.width()-t.outerWidth(!1)],s="yx"!==o.axis||l[0]||l[1]?"all":"none";"x"===o.axis||l[0]||X(n,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:s,dur:i}),"y"===o.axis||l[1]||X(n,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:s,dur:i})},n[0]._focusTimer))})},U=function(){var n=e(this),t=n.data(a),o=a+"_"+t.idx,i=e("#mCSB_"+t.idx+"_container").parent();i.bind("scroll."+o,function(){0===i.scrollTop()&&0===i.scrollLeft()||e(".mCSB_"+t.idx+"_scrollbar").css("visibility","hidden")})},j=function(){var n=e(this),t=n.data(a),o=t.opt,i=t.sequential,r=a+"_"+t.idx,d=".mCSB_"+t.idx+"_scrollbar";e(d+">a").bind("contextmenu."+r,function(e){e.preventDefault()}).bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,t){i.scrollAmount=o.scrollButtons.scrollAmount,z(n,e,t)}if(a.preventDefault(),ee(a)){var d=e(this).attr("class");switch(i.type=o.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;s=!0,t.tweenRunning=!1,r("on",d);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;s=!1,i.dir&&r("off",d);break;case"click":if("stepped"!==i.type||t.tweenRunning)return;r("on",d)}}})},q=function(){function n(n){function a(e,n){r.type=i.keyboard.scrollType,r.scrollAmount=i.keyboard.scrollAmount,"stepped"===r.type&&o.tweenRunning||z(t,e,n)}switch(n.type){case"blur":o.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var d=n.keyCode?n.keyCode:n.which,l="on";if("x"!==i.axis&&(38===d||40===d)||"y"!==i.axis&&(37===d||39===d)){if((38===d||40===d)&&!o.overflowed[0]||(37===d||39===d)&&!o.overflowed[1])return;"keyup"===n.type&&(l="off"),e(document.activeElement).is(f)||(n.preventDefault(),n.stopImmediatePropagation(),a(l,d))}else if(33===d||34===d){if((o.overflowed[0]||o.overflowed[1])&&(n.preventDefault(),n.stopImmediatePropagation()),"keyup"===n.type){W(t);var u=34===d?-1:1;if("x"===i.axis||"yx"===i.axis&&o.overflowed[1]&&!o.overflowed[0])var g="x",h=Math.abs(s[0].offsetLeft)-u*(.9*c.width());else var g="y",h=Math.abs(s[0].offsetTop)-u*(.9*c.height());X(t,h.toString(),{dir:g,scrollEasing:"mcsEaseInOut"})}}else if((35===d||36===d)&&!e(document.activeElement).is(f)&&((o.overflowed[0]||o.overflowed[1])&&(n.preventDefault(),n.stopImmediatePropagation()),"keyup"===n.type)){if("x"===i.axis||"yx"===i.axis&&o.overflowed[1]&&!o.overflowed[0])var g="x",h=35===d?Math.abs(c.width()-s.outerWidth(!1)):0;else var g="y",h=35===d?Math.abs(c.height()-s.outerHeight(!1)):0;X(t,h.toString(),{dir:g,scrollEasing:"mcsEaseInOut"})}}}var t=e(this),o=t.data(a),i=o.opt,r=o.sequential,d=a+"_"+o.idx,l=e("#mCSB_"+o.idx),s=e("#mCSB_"+o.idx+"_container"),c=s.parent(),f="input,textarea,select,datalist,keygen,[contenteditable='true']",u=s.find("iframe"),g=["blur."+d+" keydown."+d+" keyup."+d];u.length&&u.each(function(){e(this).bind("load",function(){V(this)&&e(this.contentDocument||this.contentWindow.document).bind(g[0],function(e){n(e)})})}),l.attr("tabindex","0").bind(g[0],function(e){n(e)})},z=function(n,t,o,i,r){function d(e){f.snapAmount&&(u.scrollAmount=f.snapAmount instanceof Array?"x"===u.dir[0]?f.snapAmount[1]:f.snapAmount[0]:f.snapAmount);var t="stepped"!==u.type,a=r||(e?t?A/1.5:v:1e3/60),o=e?t?7.5:40:2.5,l=[Math.abs(g[0].offsetTop),Math.abs(g[0].offsetLeft)],c=[s.scrollRatio.y>10?10:s.scrollRatio.y,s.scrollRatio.x>10?10:s.scrollRatio.x],h="x"===u.dir[0]?l[1]+u.dir[1]*(c[1]*o):l[0]+u.dir[1]*(c[0]*o),m="x"===u.dir[0]?l[1]+u.dir[1]*parseInt(u.scrollAmount):l[0]+u.dir[1]*parseInt(u.scrollAmount),S="auto"!==u.scrollAmount?m:h,p=i||(e?t?"mcsLinearOut":"mcsEaseInOut":"mcsLinear"),w=!!e;return e&&17>a&&(S="x"===u.dir[0]?l[1]:l[0]),X(n,S.toString(),{dir:u.dir[0],scrollEasing:p,dur:a,onComplete:w}),e?void(u.dir=!1):(clearTimeout(u.step),void(u.step=setTimeout(function(){d()},a)))}function l(){clearTimeout(u.step),_(u,"step"),W(n)}var s=n.data(a),f=s.opt,u=s.sequential,g=e("#mCSB_"+s.idx+"_container"),h="stepped"===u.type,A=f.scrollInertia<26?26:f.scrollInertia,v=f.scrollInertia<1?17:f.scrollInertia;switch(t){case"on":if(u.dir=[o===c[16]||o===c[15]||39===o||37===o?"x":"y",o===c[13]||o===c[15]||38===o||37===o?-1:1],W(n),te(o)&&"stepped"===u.type)return;d(h);break;case"off":l(),(h||s.tweenRunning&&u.dir)&&d(!0)}},H=function(n){var t=e(this).data(a).opt,o=[];return"function"==typeof n&&(n=n()),n instanceof Array?o=n.length>1?[n[0],n[1]]:"x"===t.axis?[null,n[0]]:[n[0],null]:(o[0]=n.y?n.y:n.x||"x"===t.axis?null:n,o[1]=n.x?n.x:n.y||"y"===t.axis?null:n),"function"==typeof o[0]&&(o[0]=o[0]()),"function"==typeof o[1]&&(o[1]=o[1]()),o},J=function(n,t){if(null!=n&&void 0!==n){var o=e(this),i=o.data(a),r=i.opt,d=e("#mCSB_"+i.idx+"_container"),l=d.parent(),s=typeof n;t||(t="x"===r.axis?"x":"y");var c="x"===t?d.outerWidth(!1)-l.width():d.outerHeight(!1)-l.height(),u="x"===t?d[0].offsetLeft:d[0].offsetTop,g="x"===t?"left":"top";switch(s){case"function":return n();case"object":var h=n.jquery?n:e(n);if(!h.length)return;return"x"===t?ae(h)[1]:ae(h)[0];case"string":case"number":if(te(n))return Math.abs(n);if(-1!==n.indexOf("%"))return Math.abs(c*parseInt(n)/100);if(-1!==n.indexOf("-="))return Math.abs(u-parseInt(n.split("-=")[1]));if(-1!==n.indexOf("+=")){var A=u+parseInt(n.split("+=")[1]);return A>=0?0:Math.abs(A)}if(-1!==n.indexOf("px")&&te(n.split("px")[0]))return Math.abs(n.split("px")[0]);if("top"===n||"left"===n)return 0;if("bottom"===n)return Math.abs(l.height()-d.outerHeight(!1));if("right"===n)return Math.abs(l.width()-d.outerWidth(!1));if("first"===n||"last"===n){var h=d.find(":"+n);return"x"===t?ae(h)[1]:ae(h)[0]}return e(n).length?"x"===t?ae(e(n))[1]:ae(e(n))[0]:(d.css(g,n),void f.update.call(null,o[0]))}}},K=function(n){function t(){return clearTimeout(u[0].autoUpdate),0===d.parents("html").length?void(d=null):void(u[0].autoUpdate=setTimeout(function(){return s.advanced.updateOnSelectorChange&&(l.poll.change.n=i(),l.poll.change.n!==l.poll.change.o)?(l.poll.change.o=l.poll.change.n,void r(3)):s.advanced.updateOnContentResize&&(l.poll.size.n=d[0].scrollHeight+d[0].scrollWidth+u[0].offsetHeight+d[0].offsetHeight+d[0].offsetWidth,l.poll.size.n!==l.poll.size.o)?(l.poll.size.o=l.poll.size.n,void r(1)):!s.advanced.updateOnImageLoad||"auto"===s.advanced.updateOnImageLoad&&"y"===s.axis||(l.poll.img.n=u.find("img").length,l.poll.img.n===l.poll.img.o)?void((s.advanced.updateOnSelectorChange||s.advanced.updateOnContentResize||s.advanced.updateOnImageLoad)&&t()):(l.poll.img.o=l.poll.img.n,void u.find("img").each(function(){o(this)}))},s.advanced.autoUpdateTimeout))}function o(n){function t(e,n){return function(){return n.apply(e,arguments)}}function a(){this.onload=null,e(n).addClass(c[2]),r(2)}if(e(n).hasClass(c[2]))return void r();var o=new Image;o.onload=t(o,a),o.src=n.src}function i(){!0===s.advanced.updateOnSelectorChange&&(s.advanced.updateOnSelectorChange="*");var e=0,n=u.find(s.advanced.updateOnSelectorChange);return s.advanced.updateOnSelectorChange&&n.length>0&&n.each(function(){e+=this.offsetHeight+this.offsetWidth}),e}function r(e){clearTimeout(u[0].autoUpdate),f.update.call(null,d[0],e)}var d=e(this),l=d.data(a),s=l.opt,u=e("#mCSB_"+l.idx+"_container");return n?(clearTimeout(u[0].autoUpdate),
void _(u[0],"autoUpdate")):void t()},M=function(e,n,t){return Math.round(e/n)*n-t},W=function(n){var t=n.data(a);e("#mCSB_"+t.idx+"_container,#mCSB_"+t.idx+"_container_wrapper,#mCSB_"+t.idx+"_dragger_vertical,#mCSB_"+t.idx+"_dragger_horizontal").each(function(){$.call(this)})},X=function(n,t,o){function i(e){return l&&s.callbacks[e]&&"function"==typeof s.callbacks[e]}function r(){return[s.callbacks.alwaysTriggerOffsets||w>=E[0]+b,s.callbacks.alwaysTriggerOffsets||-x>=w]}function d(){var e=[g[0].offsetTop,g[0].offsetLeft],t=[S[0].offsetTop,S[0].offsetLeft],a=[g.outerHeight(!1),g.outerWidth(!1)],i=[u.height(),u.width()];n[0].mcs={content:g,top:e[0],left:e[1],draggerTop:t[0],draggerLeft:t[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:o.dir}}var l=n.data(a),s=l.opt,c={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:s.scrollInertia,overwrite:"all",callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},o=e.extend(c,o),f=[o.dur,o.drag?0:o.dur],u=e("#mCSB_"+l.idx),g=e("#mCSB_"+l.idx+"_container"),h=g.parent(),A=s.callbacks.onTotalScrollOffset?H.call(n,s.callbacks.onTotalScrollOffset):[0,0],v=s.callbacks.onTotalScrollBackOffset?H.call(n,s.callbacks.onTotalScrollBackOffset):[0,0];if(l.trigger=o.trigger,0===h.scrollTop()&&0===h.scrollLeft()||(e(".mCSB_"+l.idx+"_scrollbar").css("visibility","visible"),h.scrollTop(0).scrollLeft(0)),"_resetY"!==t||l.contentReset.y||(i("onOverflowYNone")&&s.callbacks.onOverflowYNone.call(n[0]),l.contentReset.y=1),"_resetX"!==t||l.contentReset.x||(i("onOverflowXNone")&&s.callbacks.onOverflowXNone.call(n[0]),l.contentReset.x=1),"_resetY"!==t&&"_resetX"!==t){if(!l.contentReset.y&&n[0].mcs||!l.overflowed[0]||(i("onOverflowY")&&s.callbacks.onOverflowY.call(n[0]),l.contentReset.x=null),!l.contentReset.x&&n[0].mcs||!l.overflowed[1]||(i("onOverflowX")&&s.callbacks.onOverflowX.call(n[0]),l.contentReset.x=null),s.snapAmount){var m=s.snapAmount instanceof Array?"x"===o.dir?s.snapAmount[1]:s.snapAmount[0]:s.snapAmount;t=M(t,m,s.snapOffset)}switch(o.dir){case"x":var S=e("#mCSB_"+l.idx+"_dragger_horizontal"),p="left",w=g[0].offsetLeft,E=[u.width()-g.outerWidth(!1),S.parent().width()-S.width()],y=[t,0===t?0:t/l.scrollRatio.x],b=A[1],x=v[1],L=b>0?b/l.scrollRatio.x:0,N=x>0?x/l.scrollRatio.x:0;break;case"y":var S=e("#mCSB_"+l.idx+"_dragger_vertical"),p="top",w=g[0].offsetTop,E=[u.height()-g.outerHeight(!1),S.parent().height()-S.height()],y=[t,0===t?0:t/l.scrollRatio.y],b=A[0],x=v[0],L=b>0?b/l.scrollRatio.y:0,N=x>0?x/l.scrollRatio.y:0}y[1]<0||0===y[0]&&0===y[1]?y=[0,0]:y[1]>=E[1]?y=[E[0],E[1]]:y[0]=-y[0],n[0].mcs||(d(),i("onInit")&&s.callbacks.onInit.call(n[0])),clearTimeout(g[0].onCompleteTimeout),Y(S[0],p,Math.round(y[1]),f[1],o.scrollEasing),!l.tweenRunning&&(0===w&&y[0]>=0||w===E[0]&&y[0]<=E[0])||Y(g[0],p,Math.round(y[0]),f[0],o.scrollEasing,o.overwrite,{onStart:function(){o.callbacks&&o.onStart&&!l.tweenRunning&&(i("onScrollStart")&&(d(),s.callbacks.onScrollStart.call(n[0])),l.tweenRunning=!0,C(S),l.cbOffsets=r())},onUpdate:function(){o.callbacks&&o.onUpdate&&i("whileScrolling")&&(d(),s.callbacks.whileScrolling.call(n[0]))},onComplete:function(){if(o.callbacks&&o.onComplete){"yx"===s.axis&&clearTimeout(g[0].onCompleteTimeout);var e=g[0].idleTimer||0;g[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(d(),s.callbacks.onScroll.call(n[0])),i("onTotalScroll")&&y[1]>=E[1]-L&&l.cbOffsets[0]&&(d(),s.callbacks.onTotalScroll.call(n[0])),i("onTotalScrollBack")&&y[1]<=N&&l.cbOffsets[1]&&(d(),s.callbacks.onTotalScrollBack.call(n[0])),l.tweenRunning=!1,g[0].idleTimer=0,C(S,"hide")},e)}}})}},Y=function(e,n,t,a,o,i,r){function d(){E.stop||(S||h.call(),S=Z()-m,l(),S>=E.time&&(E.time=S>E.time?S+u-(S-E.time):S+u-1,E.time<S+1&&(E.time=S+1)),E.time<a?E.id=g(d):v.call())}function l(){a>0?(E.currVal=f(E.time,p,y,a,o),w[n]=Math.round(E.currVal)+"px"):w[n]=t+"px",A.call()}function s(){u=1e3/60,E.time=S+u,g=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return l(),setTimeout(e,.01)},E.id=g(d)}function c(){null!=E.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(E.id):clearTimeout(E.id),E.id=null)}function f(e,n,t,a,o){switch(o){case"linear":case"mcsLinear":return t*e/a+n;case"mcsLinearOut":return e/=a,e--,t*Math.sqrt(1-e*e)+n;case"easeInOutSmooth":return e/=a/2,1>e?t/2*e*e+n:(e--,-t/2*(e*(e-2)-1)+n);case"easeInOutStrong":return e/=a/2,1>e?t/2*Math.pow(2,10*(e-1))+n:(e--,t/2*(2-Math.pow(2,-10*e))+n);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?t/2*e*e*e+n:(e-=2,t/2*(e*e*e+2)+n);case"easeOutSmooth":return e/=a,e--,-t*(e*e*e*e-1)+n;case"easeOutStrong":return t*(1-Math.pow(2,-10*e/a))+n;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return n+t*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var u,g,r=r||{},h=r.onStart||function(){},A=r.onUpdate||function(){},v=r.onComplete||function(){},m=Z(),S=0,p=e.offsetTop,w=e.style,E=e._mTween[n];"left"===n&&(p=e.offsetLeft);var y=t-p;E.stop=0,"none"!==i&&c(),s()},Z=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},$=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var n=["top","left"],t=0;t<n.length;t++){var a=n[t];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},_=function(e,n){try{delete e[n]}catch(t){e[n]=null}},ee=function(e){return!(e.which&&1!==e.which)},ne=function(e){var n=e.originalEvent.pointerType;return!(n&&"touch"!==n&&2!==n)},te=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},ae=function(e){var n=e.parents(".mCSB_container");return[e.offset().top-n.offset().top,e.offset().left-n.offset().left]},oe=function(){function e(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var n=0;n<e.length;n++)if(e[n]+"Hidden"in document)return e[n]+"Hidden";return null}var n=e();return!!n&&document[n]};e.fn[t]=function(n){return f[n]?f[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist"):f.init.apply(this,arguments)},e[t]=function(n){return f[n]?f[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist"):f.init.apply(this,arguments)},e[t].defaults=i,window[t]=!0,e(window).bind("load",function(){e(o)[t](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(n){var t,a,o=e(n),i=o.parents(".mCSB_container");if(i.length)return t=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+ae(o)[0]>=0&&a[0]+ae(o)[0]<t.height()-o.outerHeight(!1)&&a[1]+ae(o)[1]>=0&&a[1]+ae(o)[1]<t.width()-o.outerWidth(!1)},mcsInSight:e.expr[":"].mcsInSight||function(n,t,a){var o,i,r,d,l=e(n),s=l.parents(".mCSB_container"),c="exact"===a[3]?[[1,0],[1,0]]:[[.9,.1],[.6,.4]];if(s.length)return o=[l.outerHeight(!1),l.outerWidth(!1)],r=[s[0].offsetTop+ae(l)[0],s[0].offsetLeft+ae(l)[1]],i=[s.parent()[0].offsetHeight,s.parent()[0].offsetWidth],d=[o[0]<i[0]?c[0]:c[1],o[1]<i[1]?c[0]:c[1]],r[0]-i[0]*d[0][0]<0&&r[0]+o[0]-i[0]*d[0][1]>=0&&r[1]-i[1]*d[1][0]<0&&r[1]+o[1]-i[1]*d[1][1]>=0},mcsOverflow:e.expr[":"].mcsOverflow||function(n){var t=e(n).data(a);if(t)return t.overflowed[0]||t.overflowed[1]}})})})}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.httpStatusCodes=e()}}(function(){return function e(n,t,a){function o(r,d){if(!t[r]){if(!n[r]){var l="function"==typeof require&&require;if(!d&&l)return l(r,!0);if(i)return i(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var c=t[r]={exports:{}};n[r][0].call(c.exports,function(e){var t=n[r][1][e];return o(t||e)},c,c.exports,e,n,t,a)}return t[r].exports}for(var i="function"==typeof require&&require,r=0;r<a.length;r++)o(a[r]);return o}({1:[function(e,n,t){(function(e){var n;!function(e){e.CONTINUE=100,e.SWITCHING_PROTOCOLS=101,e.PROCESSING=102,e.OK=200,e.CREATED=201,e.ACCEPTED=202,e.NON_AUTHORITATIVE_INFORMATION=203,e.NO_CONTENT=204,e.RESET_CONTENT=205,e.PARTIAL_CONTENT=206,e.MULTI_STATUS=207,e.MULTIPLE_CHOICES=300,e.MOVED_PERMANENTLY=301,e.MOVED_TEMPORARILY=302,e.SEE_OTHER=303,e.NOT_MODIFIED=304,e.USE_PROXY=305,e.TEMPORARY_REDIRECT=307,e.BAD_REQUEST=400,e.UNAUTHORIZED=401,e.PAYMENT_REQUIRED=402,e.FORBIDDEN=403,e.NOT_FOUND=404,e.METHOD_NOT_ALLOWED=405,e.NOT_ACCEPTABLE=406,e.PROXY_AUTHENTICATION_REQUIRED=407,e.REQUEST_TIME_OUT=408,e.CONFLICT=409,e.GONE=410,e.LENGTH_REQUIRED=411,e.PRECONDITION_FAILED=412,e.REQUEST_ENTITY_TOO_LARGE=413,e.REQUEST_URI_TOO_LARGE=414,e.UNSUPPORTED_MEDIA_TYPE=415,e.REQUESTED_RANGE_NOT_SATISFIABLE=416,e.EXPECTATION_FAILED=417,e.IM_A_TEAPOT=418,e.UNPROCESSABLE_ENTITY=422,e.LOCKED=423,e.FAILED_DEPENDENCY=424,e.UNORDERED_COLLECTION=425,e.UPGRADE_REQUIRED=426,e.PRECONDITION_REQUIRED=428,e.TOO_MANY_REQUESTS=429,e.REQUEST_HEADER_FIELDS_TOO_LARGE=431,e.INTERNAL_SERVER_ERROR=500,e.NOT_IMPLEMENTED=501,e.BAD_GATEWAY=502,e.SERVICE_UNAVAILABLE=503,e.GATEWAY_TIME_OUT=504,e.HTTP_VERSION_NOT_SUPPORTED=505,e.VARIANT_ALSO_NEGOTIATES=506,e.INSUFFICIENT_STORAGE=507,e.BANDWIDTH_LIMIT_EXCEEDED=509,e.NOT_EXTENDED=510,e.NETWORK_AUTHENTICATION_REQUIRED=511}(n||(n={})),function(e){e.HTTPStatusCode||(e.HTTPStatusCode=n)}(e)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.manifesto=e()}}(function(){var e;return function(){function e(n,t,a){function o(r,d){if(!t[r]){if(!n[r]){var l="function"==typeof require&&require;if(!d&&l)return l(r,!0);if(i)return i(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var c=t[r]={exports:{}};n[r][0].call(c.exports,function(e){return o(n[r][1][e]||e)},c,c.exports,e,n,t,a)}return t[r].exports}for(var i="function"==typeof require&&require,r=0;r<a.length;r++)o(a[r]);return o}return e}()({1:[function(e,n,t){(function(t){var a;!function(e){var n=function(){function e(e){this.value="",e&&(this.value=e.toLowerCase())}return e.prototype.toString=function(){return this.value},e}();e.StringValue=n}(a||(a={}));var a;!function(e){var n=function(){function e(e,n){this.start=e,this.end=n}return e.prototype.getLength=function(){return this.end-this.start},e}();e.Duration=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.bookmarking=function(){return new n(n.BOOKMARKING.toString())},n.prototype.classifying=function(){return new n(n.CLASSIFYING.toString())},n.prototype.commenting=function(){return new n(n.COMMENTING.toString())},n.prototype.describing=function(){return new n(n.DESCRIBING.toString())},n.prototype.editing=function(){return new n(n.EDITING.toString())},n.prototype.highlighting=function(){return new n(n.HIGHLIGHTING.toString())},n.prototype.identifying=function(){return new n(n.IDENTIFYING.toString())},n.prototype.linking=function(){return new n(n.LINKING.toString())},n.prototype.moderating=function(){return new n(n.MODERATING.toString())},n.prototype.painting=function(){return new n(n.PAINTING.toString())},n.prototype.questioning=function(){return new n(n.QUESTIONING.toString())},n.prototype.replying=function(){return new n(n.REPLYING.toString())},n.prototype.tagging=function(){return new n(n.TAGGING.toString())},n.prototype.transcribing=function(){return new n(n.TRANSCRIBING.toString())},n.BOOKMARKING=new n("oa:bookmarking"),n.CLASSIFYING=new n("oa:classifying"),n.COMMENTING=new n("oa:commenting"),n.DESCRIBING=new n("oa:describing"),n.EDITING=new n("oa:editing"),n.HIGHLIGHTING=new n("oa:highlighting"),n.IDENTIFYING=new n("oa:identifying"),n.LINKING=new n("oa:linking"),n.MODERATING=new n("oa:moderating"),n.PAINTING=new n("sc:painting"),n.QUESTIONING=new n("oa:questioning"),n.REPLYING=new n("oa:replying"),n.TAGGING=new n("oa:tagging"),n.TRANSCRIBING=new n("oad:transcribing"),n}(e.StringValue);e.AnnotationMotivation=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.autoadvance=function(){return new n(n.AUTOADVANCE.toString())},n.prototype.nonav=function(){return new n(n.NONAV.toString())},n.prototype.paged=function(){return new n(n.PAGED.toString())},n.AUTOADVANCE=new n("auto-advance"),n.NONAV=new n("no-nav"),n.PAGED=new n("paged"),n}(e.StringValue);e.Behavior=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.annotation=function(){return new n(n.ANNOTATION.toString())},n.prototype.canvas=function(){return new n(n.CANVAS.toString())},n.prototype.collection=function(){return new n(n.COLLECTION.toString())},n.prototype.manifest=function(){return new n(n.MANIFEST.toString())},n.prototype.range=function(){return new n(n.RANGE.toString())},n.prototype.sequence=function(){return new n(n.SEQUENCE.toString())},n.ANNOTATION=new n("annotation"),n.CANVAS=new n("canvas"),n.COLLECTION=new n("collection"),n.MANIFEST=new n("manifest"),n.RANGE=new n("range"),n.SEQUENCE=new n("sequence"),n}(e.StringValue);e.IIIFResourceType=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.empty=function(){return new n(n.EMPTY.toString())},n.prototype.manuscript=function(){return new n(n.MANUSCRIPT.toString())},n.prototype.monograph=function(){return new n(n.MONOGRAPH.toString())},n.EMPTY=new n(""),n.MANUSCRIPT=new n("manuscript"),n.MONOGRAPH=new n("monograph"),n}(e.StringValue);e.ManifestType=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.pdf=function(){return new n(n.PDF.toString())},n.prototype.doc=function(){return new n(n.DOC.toString())},n.prototype.docx=function(){return new n(n.DOCX.toString())},n.PDF=new n("application/pdf"),n.DOC=new n("application/msword"),n.DOCX=new n("application/vnd.openxmlformats-officedocument.wordprocessingml.document"),n}(e.StringValue);e.RenderingFormat=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.jpg=function(){return new n(n.JPG.toString())},n.prototype.mp4=function(){return new n(n.MP4.toString())},n.prototype.pdf=function(){return new n(n.PDF.toString())},n.prototype.threejs=function(){return new n(n.THREEJS.toString())},n.prototype.webm=function(){return new n(n.WEBM.toString())},n.JPG=new n("image/jpeg"),n.MP4=new n("video/mp4"),n.PDF=new n("application/pdf"),n.THREEJS=new n("application/vnd.threejs+json"),n.WEBM=new n("video/webm"),n}(e.StringValue);e.MediaType=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.canvas=function(){return new n(n.CANVAS.toString())},n.prototype.choice=function(){return new n(n.CHOICE.toString())},n.prototype.document=function(){return new n(n.DOCUMENT.toString())},n.prototype.image=function(){return new n(n.IMAGE.toString())},n.prototype.movingimage=function(){return new n(n.MOVINGIMAGE.toString())},n.prototype.physicalobject=function(){return new n(n.PHYSICALOBJECT.toString())},n.prototype.sound=function(){return new n(n.SOUND.toString())},n.prototype.text=function(){return new n(n.TEXT.toString())},n.CANVAS=new n("canvas"),n.CHOICE=new n("choice"),n.DOCUMENT=new n("document"),n.IMAGE=new n("image"),n.MOVINGIMAGE=new n("movingimage"),n.PHYSICALOBJECT=new n("physicalobject"),n.SOUND=new n("sound"),n.TEXT=new n("textualbody"),n}(e.StringValue);e.ResourceType=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.auth1Clickthrough=function(){return new n(n.AUTH1CLICKTHROUGH.toString())},n.prototype.auth1External=function(){return new n(n.AUTH1EXTERNAL.toString())},n.prototype.auth1Kiosk=function(){return new n(n.AUTH1KIOSK.toString())},n.prototype.auth1Login=function(){return new n(n.AUTH1LOGIN.toString())},n.prototype.auth1Logout=function(){return new n(n.AUTH1LOGOUT.toString())},n.prototype.auth1Probe=function(){return new n(n.AUTH1PROBE.toString())},n.prototype.auth1Token=function(){return new n(n.AUTH1TOKEN.toString())},n.prototype.autoComplete=function(){return new n(n.AUTOCOMPLETE.toString())},n.prototype.iiif1ImageLevel1=function(){return new n(n.IIIF1IMAGELEVEL1.toString())},n.prototype.iiif1ImageLevel2=function(){return new n(n.IIIF1IMAGELEVEL2.toString())},n.prototype.iiif2ImageLevel1=function(){return new n(n.IIIF2IMAGELEVEL1.toString())},n.prototype.iiif2ImageLevel2=function(){return new n(n.IIIF2IMAGELEVEL2.toString())},n.prototype.ixif=function(){return new n(n.IXIF.toString())},n.prototype.login=function(){return new n(n.AUTHLOGIN.toString())},n.prototype.clickThrough=function(){return new n(n.AUTHCLICKTHROUGH.toString())},n.prototype.restricted=function(){return new n(n.AUTHRESTRICTED.toString())},n.prototype.logout=function(){return new n(n.AUTHLOGOUT.toString())},n.prototype.otherManifestations=function(){return new n(n.OTHERMANIFESTATIONS.toString())},n.prototype.search=function(){return new n(n.SEARCH.toString())},n.prototype.stanfordIIIFImageCompliance1=function(){return new n(n.STANFORDIIIFIMAGECOMPLIANCE1.toString())},n.prototype.stanfordIIIFImageCompliance2=function(){return new n(n.STANFORDIIIFIMAGECOMPLIANCE2.toString())},n.prototype.stanfordIIIFImageConformance1=function(){return new n(n.STANFORDIIIFIMAGECONFORMANCE1.toString())},n.prototype.stanfordIIIFImageConformance2=function(){return new n(n.STANFORDIIIFIMAGECONFORMANCE2.toString())},n.prototype.stanfordIIIF1ImageCompliance1=function(){return new n(n.STANFORDIIIF1IMAGECOMPLIANCE1.toString())},n.prototype.stanfordIIIF1ImageCompliance2=function(){return new n(n.STANFORDIIIF1IMAGECOMPLIANCE2.toString())},n.prototype.stanfordIIIF1ImageConformance1=function(){return new n(n.STANFORDIIIF1IMAGECONFORMANCE1.toString())},n.prototype.stanfordIIIF1ImageConformance2=function(){return new n(n.STANFORDIIIF1IMAGECONFORMANCE2.toString())},n.prototype.token=function(){return new n(n.AUTHTOKEN.toString())},n.prototype.trackingExtensions=function(){return new n(n.TRACKINGEXTENSIONS.toString())},n.prototype.uiExtensions=function(){return new n(n.UIEXTENSIONS.toString())},n.prototype.printExtensions=function(){return new n(n.PRINTEXTENSIONS.toString())},n.prototype.shareExtensions=function(){return new n(n.SHAREEXTENSIONS.toString())},n.STANFORDIIIFIMAGECOMPLIANCE0=new n("http://library.stanford.edu/iiif/image-api/compliance.html#level0"),n.STANFORDIIIFIMAGECOMPLIANCE1=new n("http://library.stanford.edu/iiif/image-api/compliance.html#level1"),n.STANFORDIIIFIMAGECOMPLIANCE2=new n("http://library.stanford.edu/iiif/image-api/compliance.html#level2"),n.STANFORDIIIFIMAGECONFORMANCE0=new n("http://library.stanford.edu/iiif/image-api/conformance.html#level0"),n.STANFORDIIIFIMAGECONFORMANCE1=new n("http://library.stanford.edu/iiif/image-api/conformance.html#level1"),n.STANFORDIIIFIMAGECONFORMANCE2=new n("http://library.stanford.edu/iiif/image-api/conformance.html#level2"),n.STANFORDIIIF1IMAGECOMPLIANCE0=new n("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"),n.STANFORDIIIF1IMAGECOMPLIANCE1=new n("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"),n.STANFORDIIIF1IMAGECOMPLIANCE2=new n("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"),n.STANFORDIIIF1IMAGECONFORMANCE0=new n("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0"),n.STANFORDIIIF1IMAGECONFORMANCE1=new n("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1"),n.STANFORDIIIF1IMAGECONFORMANCE2=new n("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2"),n.IIIF1IMAGELEVEL0=new n("http://iiif.io/api/image/1/level0.json"),n.IIIF1IMAGELEVEL0PROFILE=new n("http://iiif.io/api/image/1/profiles/level0.json"),n.IIIF1IMAGELEVEL1=new n("http://iiif.io/api/image/1/level1.json"),n.IIIF1IMAGELEVEL1PROFILE=new n("http://iiif.io/api/image/1/profiles/level1.json"),n.IIIF1IMAGELEVEL2=new n("http://iiif.io/api/image/1/level2.json"),n.IIIF1IMAGELEVEL2PROFILE=new n("http://iiif.io/api/image/1/profiles/level2.json"),n.IIIF2IMAGELEVEL0=new n("http://iiif.io/api/image/2/level0.json"),n.IIIF2IMAGELEVEL0PROFILE=new n("http://iiif.io/api/image/2/profiles/level0.json"),n.IIIF2IMAGELEVEL1=new n("http://iiif.io/api/image/2/level1.json"),n.IIIF2IMAGELEVEL1PROFILE=new n("http://iiif.io/api/image/2/profiles/level1.json"),n.IIIF2IMAGELEVEL2=new n("http://iiif.io/api/image/2/level2.json"),n.IIIF2IMAGELEVEL2PROFILE=new n("http://iiif.io/api/image/2/profiles/level2.json"),n.AUTHCLICKTHROUGH=new n("http://iiif.io/api/auth/0/login/clickthrough"),n.AUTHLOGIN=new n("http://iiif.io/api/auth/0/login"),n.AUTHLOGOUT=new n("http://iiif.io/api/auth/0/logout"),n.AUTHRESTRICTED=new n("http://iiif.io/api/auth/0/login/restricted"),n.AUTHTOKEN=new n("http://iiif.io/api/auth/0/token"),n.AUTH1CLICKTHROUGH=new n("http://iiif.io/api/auth/1/clickthrough"),n.AUTH1EXTERNAL=new n("http://iiif.io/api/auth/1/external"),n.AUTH1KIOSK=new n("http://iiif.io/api/auth/1/kiosk"),n.AUTH1LOGIN=new n("http://iiif.io/api/auth/1/login"),n.AUTH1LOGOUT=new n("http://iiif.io/api/auth/1/logout"),n.AUTH1PROBE=new n("http://iiif.io/api/auth/1/probe"),n.AUTH1TOKEN=new n("http://iiif.io/api/auth/1/token"),n.AUTOCOMPLETE=new n("http://iiif.io/api/search/0/autocomplete"),n.SEARCH=new n("http://iiif.io/api/search/0/search"),n.TRACKINGEXTENSIONS=new n("http://universalviewer.io/tracking-extensions-profile"),n.UIEXTENSIONS=new n("http://universalviewer.io/ui-extensions-profile"),n.PRINTEXTENSIONS=new n("http://universalviewer.io/print-extensions-profile"),n.SHAREEXTENSIONS=new n("http://universalviewer.io/share-extensions-profile"),n.OTHERMANIFESTATIONS=new n("http://iiif.io/api/otherManifestations.json"),n.IXIF=new n("http://wellcomelibrary.org/ld/ixif/0/alpha.json"),n}(e.StringValue);e.ServiceProfile=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.leftToRight=function(){return new n(n.LEFTTORIGHT.toString())},n.prototype.rightToLeft=function(){return new n(n.RIGHTTOLEFT.toString())},n.prototype.topToBottom=function(){return new n(n.TOPTOBOTTOM.toString())},n.prototype.bottomToTop=function(){return new n(n.BOTTOMTOTOP.toString())},n.LEFTTORIGHT=new n("left-to-right"),n.RIGHTTOLEFT=new n("right-to-left"),n.TOPTOBOTTOM=new n("top-to-bottom"),n.BOTTOMTOTOP=new n("bottom-to-top"),n}(e.StringValue);e.ViewingDirection=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.continuous=function(){return new n(n.CONTINUOUS.toString())},n.prototype.empty=function(){return new n(n.EMPTY.toString())},n.prototype.individuals=function(){return new n(n.INDIVIDUALS.toString())},n.prototype.nonPaged=function(){return new n(n.NONPAGED.toString())},n.prototype.paged=function(){return new n(n.PAGED.toString())},n.prototype.top=function(){return new n(n.TOP.toString())},n.CONTINUOUS=new n("continuous"),n.EMPTY=new n(""),n.INDIVIDUALS=new n("individuals"),n.NONPAGED=new n("non-paged"),n.PAGED=new n("paged"),n.TOP=new n("top"),n}(e.StringValue);e.ViewingHint=n}(a||(a={}));var a;!function(e){var n=function(){function e(e){this.__jsonld=e,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return e.prototype.getProperty=function(e){var n=null;return this.__jsonld&&((n=this.__jsonld[e])||(n=this.__jsonld["@"+e])),n},e}();e.JSONLDResource=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e)||this;return a.options=t,a}return o(t,n),t.prototype.getIIIFResourceType=function(){return new e.IIIFResourceType(e.Utils.normaliseType(this.getProperty("type")))},t.prototype.getLabel=function(){var n=this.getProperty("label");return n?e.LanguageMap.parse(n,this.options.locale):[]},t.prototype.getDefaultLabel=function(){return e.LanguageMap.getValue(this.getLabel())},t.prototype.getMetadata=function(){var n=this.getProperty("metadata"),t=[];if(!n)return t;for(var a=0;a<n.length;a++){var o=n[a],i=new e.LabelValuePair(this.options.locale);i.parse(o),t.push(i)}return t},t.prototype.getRendering=function(e){var n=this.getRenderings();"string"!=typeof e&&(e=e.toString());for(var t=0;t<n.length;t++){var a=n[t];if(a.getFormat().toString()===e)return a}return null},t.prototype.getRenderings=function(){var n;n=this.__jsonld?this.__jsonld.rendering:this.rendering;var t=[];if(!n)return t;Array.isArray(n)||(n=[n]);for(var a=0;a<n.length;a++){var o=n[a];t.push(new e.Rendering(o,this.options))}return t},t.prototype.getService=function(n){return e.Utils.getService(this,n)},t.prototype.getServices=function(){return e.Utils.getServices(this)},t.prototype.getThumbnail=function(){var n=this.getProperty("thumbnail");return Array.isArray(n)&&(n=n[0]),n?new e.Thumbnail(n,this.options):null},t.prototype.isAnnotation=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.ANNOTATION.toString()},t.prototype.isCanvas=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.CANVAS.toString()},t.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.COLLECTION.toString()},t.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.MANIFEST.toString()},t.prototype.isRange=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.RANGE.toString()},t.prototype.isSequence=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.SEQUENCE.toString()},t}(e.JSONLDResource);e.ManifestResource=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}return o(t,n),t.prototype.getFormat=function(){var n=this.getProperty("format");return n?new e.MediaType(n.toLowerCase()):null},t.prototype.getResources=function(){var n=[];if(!this.__jsonld.resources)return n;for(var t=0;t<this.__jsonld.resources.length;t++){var a=this.__jsonld.resources[t],o=new e.Annotation(a,this.options);n.push(o)}return n},t.prototype.getType=function(){var n=this.getProperty("type");return n?new e.ResourceType(e.Utils.normaliseType(n)):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},t.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},t}(e.ManifestResource);e.Resource=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}
return o(t,n),t.prototype.getCanonicalImageUri=function(n){var t,a=null,o="full",i=0,r="default",d=n;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])a=this.externalResource.data["@id"],d||(d=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(r="native");else{var l=this.getImages();if(l&&l.length){var s=l[0],c=s.getResource(),f=c.getServices();if(d||(d=c.getWidth()),f.length){var u=f[0];a=u.id,r=e.Utils.getImageQuality(u.getProfile())}else if(d===c.getWidth())return c.id}if(!a){var g=this.getProperty("thumbnail");if(g){if("string"==typeof g)return g;if(g["@id"])return g["@id"];if(g.length)return g[0].id}}}return t=d+",",a&&a.endsWith("/")&&(a=a.substr(0,a.length-1)),[a,o,t,i,r+".jpg"].join("/")},t.prototype.getMaxDimensions=function(){var n,t=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(n=this.externalResource.data.profile,Array.isArray(n)&&(n=n.filter(function(e){return e.maxWidth})[0])&&(t=new e.Size(n.maxWidth,n.maxHeight?n.maxHeight:n.maxWidth))),t},t.prototype.getContent=function(){var n=[],t=this.__jsonld.items||this.__jsonld.content;if(!t)return n;var a=null;if(t.length&&(a=new e.AnnotationPage(t[0],this.options)),!a)return n;for(var o=a.getItems(),i=0;i<o.length;i++){var r=o[i],d=new e.Annotation(r,this.options);n.push(d)}return n},t.prototype.getDuration=function(){return this.getProperty("duration")},t.prototype.getImages=function(){var n=[];if(!this.__jsonld.images)return n;for(var t=0;t<this.__jsonld.images.length;t++){var a=this.__jsonld.images[t],o=new e.Annotation(a,this.options);n.push(o)}return n},t.prototype.getIndex=function(){return this.getProperty("index")},t.prototype.getOtherContent=function(){var n=this,t=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],a=function(e,n){return"string"==typeof e&&"string"==typeof n&&e.toLowerCase()===e.toLowerCase()},o=t.filter(function(e){return e&&a(e["@type"],"sc:AnnotationList")}).map(function(t,a){return new e.AnnotationList(t.label||"Annotation list "+a,t,n.options)}).map(function(e){return e.load()});return Promise.all(o)},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t}(e.Resource);e.Canvas=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e,t)||this;a.index=-1,a.isLoaded=!1;var o={defaultLabel:"-",locale:"en-GB",resource:a,pessimisticAccessControl:!1};return a.options=Object.assign(o,t),a}return o(t,n),t.prototype.getAttribution=function(){console.warn("getAttribution will be deprecated, use getRequiredStatement instead.");var n=this.getProperty("attribution");return n?e.LanguageMap.parse(n,this.options.locale):[]},t.prototype.getDescription=function(){var n=this.getProperty("description");return n?e.LanguageMap.parse(n,this.options.locale):[]},t.prototype.getIIIFResourceType=function(){return new e.IIIFResourceType(e.Utils.normaliseType(this.getProperty("type")))},t.prototype.getLogo=function(){var e=this.getProperty("logo");return e?"string"==typeof e?e:(Array.isArray(e)&&e.length&&(e=e[0]),e["@id"]||e.id):null},t.prototype.getLicense=function(){return e.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},t.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},t.prototype.getRelated=function(){return this.getProperty("related")},t.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},t.prototype.getTrackingLabel=function(){var n=this.getService(e.ServiceProfile.TRACKINGEXTENSIONS);return n?n.getProperty("trackingLabel"):""},t.prototype.getDefaultTree=function(){return this.defaultTree=new e.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},t.prototype.getRequiredStatement=function(){var n=null,t=this.getProperty("requiredStatement");if(t)n=new e.LabelValuePair(this.options.locale),n.parse(t);else{var a=this.getAttribution();a&&(n=new e.LabelValuePair(this.options.locale),n.value=a)}return n},t.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.COLLECTION.toString()},t.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===e.IIIFResourceType.MANIFEST.toString()},t.prototype.load=function(){var n=this;return new Promise(function(t,a){if(n.isLoaded)t(n);else{var o=n.options;o.navDate=n.getNavDate();var i=n.__jsonld.id;i||(i=n.__jsonld["@id"]),e.Utils.loadResource(i).then(function(a){n.parentLabel=e.LanguageMap.getValue(n.getLabel(),o.locale);var i=e.Deserialiser.parse(a,o);n=Object.assign(n,i),n.index=o.index,t(n)})}})},t}(e.ManifestResource);e.IIIFResource=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e,t)||this;if(a.index=0,a._allRanges=null,a.items=[],a._topRanges=[],a.__jsonld.structures&&a.__jsonld.structures.length)for(var o=a._getTopRanges(),i=0;i<o.length;i++){var r=o[i];a._parseRanges(r,String(i))}return a}return o(t,n),t.prototype.getPosterCanvas=function(){var n=this.getProperty("posterCanvas");return n&&(n=new e.Canvas(n,this.options)),n},t.prototype.getBehavior=function(){var n=this.getProperty("behavior");return Array.isArray(n)&&(n=n[0]),n?new e.Behavior(n):null},t.prototype.getDefaultTree=function(){if(n.prototype.getDefaultTree.call(this),this.defaultTree.data.type=e.Utils.normaliseType(e.TreeNodeType.MANIFEST.toString()),!this.isLoaded)return this.defaultTree;var t=this.getTopRanges();return t.length&&t[0].getTree(this.defaultTree),e.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},t.prototype._getTopRanges=function(){var n=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var t=0;t<this.__jsonld.structures.length;t++){var a=this.__jsonld.structures[t];a.viewingHint===e.ViewingHint.TOP.toString()&&n.push(a)}if(!n.length){var o={};o.ranges=this.__jsonld.structures,n.push(o)}}return n},t.prototype.getTopRanges=function(){return this._topRanges},t.prototype._getRangeById=function(e){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var n=0;n<this.__jsonld.structures.length;n++){var t=this.__jsonld.structures[n];if(t["@id"]===e||t.id===e)return t}return null},t.prototype._parseRanges=function(n,t,a){var o,i=null;if("string"==typeof n&&(i=n,n=this._getRangeById(i)),!n)return void console.warn("Range:",i,"does not exist");o=new e.Range(n,this.options),o.parentRange=a,o.path=t,a?a.items.push(o):this._topRanges.push(o);var r=n.items||n.members;if(r)for(var d=0;d<r.length;d++){var l=r[d];if(l["@type"]&&"sc:range"===l["@type"].toLowerCase()||l.type&&"range"===l.type.toLowerCase())this._parseRanges(l,t+"/"+d,o);else if(l["@type"]&&"sc:canvas"===l["@type"].toLowerCase()||l.type&&"canvas"===l.type.toLowerCase()){o.canvases||(o.canvases=[]);var s=l.id||l["@id"];o.canvases.push(s)}}else if(n.ranges)for(var d=0;d<n.ranges.length;d++)this._parseRanges(n.ranges[d],t+"/"+d,o)},t.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;this._allRanges=[];for(var e=this.getTopRanges(),n=function(n){var a=e[n];a.id&&t._allRanges.push(a);var o=function(e,n){e.add(n);var t=n.getRanges();return t.length?t.reduce(o,e):e},i=Array.from(a.getRanges().reduce(o,new Set));t._allRanges=t._allRanges.concat(i)},t=this,a=0;a<e.length;a++)n(a);return this._allRanges},t.prototype.getRangeById=function(e){for(var n=this.getAllRanges(),t=0;t<n.length;t++){var a=n[t];if(a.id===e)return a}return null},t.prototype.getRangeByPath=function(e){for(var n=this.getAllRanges(),t=0;t<n.length;t++){var a=n[t];if(a.path===e)return a}return null},t.prototype.getSequences=function(){if(this.items.length)return this.items;var n=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(n)for(var t=0;t<n.length;t++){var a=n[t],o=new e.Sequence(a,this.options);this.items.push(o)}else if(this.__jsonld.items){var o=new e.Sequence(this.__jsonld.items,this.options);this.items.push(o)}return this.items},t.prototype.getSequenceByIndex=function(e){return this.getSequences()[e]},t.prototype.getTotalSequences=function(){return this.getSequences().length},t.prototype.getManifestType=function(){var n=this.getService(e.ServiceProfile.UIEXTENSIONS);return n?new e.ManifestType(n.getProperty("manifestType")):new e.ManifestType("")},t.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},t.prototype.isPagingEnabled=function(){var n=this.getViewingHint();if(n)return n.toString()===e.ViewingHint.PAGED.toString();var t=this.getBehavior();return!!t&&t.toString()===e.Behavior.PAGED.toString()},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new e.ViewingDirection(this.getProperty("viewingDirection")):null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new e.ViewingHint(this.getProperty("viewingHint")):null},t}(e.IIIFResource);e.Manifest=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e,t)||this;return a.items=[],a._collections=null,a._manifests=null,e.__collection=a,a}return o(t,n),t.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(e){return e.isCollection()})},t.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(e){return e.isManifest()})},t.prototype.getCollectionByIndex=function(e){for(var n,t=this.getCollections(),a=0;a<t.length;a++){var o=t[a];o.index===e&&(n=o)}if(n)return n.options.index=e,n.load();throw new Error("Collection index not found")},t.prototype.getManifestByIndex=function(e){for(var n,t=this.getManifests(),a=0;a<t.length;a++){var o=t[a];o.index===e&&(n=o)}if(n)return n.options.index=e,n.load();throw new Error("Manifest index not found")},t.prototype.getTotalCollections=function(){return this.getCollections().length},t.prototype.getTotalManifests=function(){return this.getManifests().length},t.prototype.getTotalItems=function(){return this.items.length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new e.ViewingDirection(this.getProperty("viewingDirection")):e.ViewingDirection.LEFTTORIGHT},t.prototype.getDefaultTree=function(){return n.prototype.getDefaultTree.call(this),this.defaultTree.data.type=e.Utils.normaliseType(e.TreeNodeType.COLLECTION.toString()),this._parseManifests(this),this._parseCollections(this),e.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},t.prototype._parseManifests=function(n){if(n.getManifests()&&n.getManifests().length)for(var t=0;t<n.getManifests().length;t++){var a=n.getManifests()[t],o=a.getDefaultTree();o.label=a.parentLabel||e.LanguageMap.getValue(a.getLabel(),this.options.locale)||"manifest "+(t+1),o.navDate=a.getNavDate(),o.data.id=a.id,o.data.type=e.Utils.normaliseType(e.TreeNodeType.MANIFEST.toString()),n.defaultTree.addNode(o)}},t.prototype._parseCollections=function(n){if(n.getCollections()&&n.getCollections().length)for(var t=0;t<n.getCollections().length;t++){var a=n.getCollections()[t],o=a.getDefaultTree();o.label=a.parentLabel||e.LanguageMap.getValue(a.getLabel(),this.options.locale)||"collection "+(t+1),o.navDate=a.getNavDate(),o.data.id=a.id,o.data.type=e.Utils.normaliseType(e.TreeNodeType.COLLECTION.toString()),n.defaultTree.addNode(o)}},t}(e.IIIFResource);e.Collection=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e,t)||this;return a._ranges=null,a.canvases=null,a.items=[],a}return o(t,n),t.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},t.prototype.getDuration=function(){var n,t;if(this.canvases&&this.canvases.length)for(var a=0;a<this.canvases.length;a++){var o=this.canvases[a],i=e.Utils.getTemporalComponent(o);i&&i.length>1&&(0===a&&(n=Number(i[0])),a===this.canvases.length-1&&(t=Number(i[1])))}else for(var r=this.getRanges(),a=0;a<r.length;a++){var d=r[a],l=d.getDuration();l&&(0===a&&(n=l.start),a===r.length-1&&(t=l.end))}if(void 0!==n&&void 0!==t)return new e.Duration(n,t)},t.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(e){return e.isRange()})},t.prototype.getBehavior=function(){var n=this.getProperty("behavior");return Array.isArray(n)&&(n=n[0]),n?new e.Behavior(n):null},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new e.ViewingDirection(this.getProperty("viewingDirection")):null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new e.ViewingHint(this.getProperty("viewingHint")):null},t.prototype.getTree=function(n){n.data=this,this.treeNode=n;var t=this.getRanges();if(t&&t.length)for(var a=0;a<t.length;a++){var o=t[a],i=new e.TreeNode;n.addNode(i),this._parseTreeNode(i,o)}return e.Utils.generateTreeNodeIds(n),n},t.prototype.spansTime=function(e){var n=this.getDuration();return!!(n&&e>=n.start&&e<=n.end)},t.prototype._parseTreeNode=function(n,t){n.label=e.LanguageMap.getValue(t.getLabel(),this.options.locale),n.data=t,n.data.type=e.Utils.normaliseType(e.TreeNodeType.RANGE.toString()),t.treeNode=n;var a=t.getRanges();if(a&&a.length)for(var o=0;o<a.length;o++){var i=a[o],r=i.getBehavior();if(!r||r.toString()!==e.Behavior.NONAV.toString()){var d=new e.TreeNode;n.addNode(d),this._parseTreeNode(d,i)}}},t}(e.ManifestResource);e.Range=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}return o(t,n),t.prototype.getFormat=function(){return new e.RenderingFormat(this.getProperty("format"))},t}(e.ManifestResource);e.Rendering=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){var a=n.call(this,e,t)||this;return a.items=[],a._thumbnails=null,a}return o(t,n),t.prototype.getCanvases=function(){if(this.items.length)return this.items;var n=this.__jsonld.canvases||this.__jsonld.elements;if(n)for(var t=0;t<n.length;t++){var a=n[t],o=new e.Canvas(a,this.options);o.index=t,this.items.push(o)}else if(this.__jsonld)for(var t=0;t<this.__jsonld.length;t++){var a=this.__jsonld[t],o=new e.Canvas(a,this.options);o.index=t,this.items.push(o)}return this.items},t.prototype.getCanvasById=function(n){for(var t=0;t<this.getTotalCanvases();t++){var a=this.getCanvasByIndex(t),o=e.Utils.normaliseUrl(a.id);if(e.Utils.normaliseUrl(n)===o)return a}return null},t.prototype.getCanvasByIndex=function(e){return this.getCanvases()[e]},t.prototype.getCanvasIndexById=function(e){for(var n=0;n<this.getTotalCanvases();n++){if(this.getCanvasByIndex(n).id===e)return n}return null},t.prototype.getCanvasIndexByLabel=function(n,t){n=n.trim(),isNaN(n)||(n=parseInt(n,10).toString(),t&&(n+="r"));for(var a,o,i,r,d,l=/(\d*)\D+(\d*)/,s=0;s<this.getTotalCanvases();s++){var c=this.getCanvasByIndex(s);if(e.LanguageMap.getValue(c.getLabel(),this.options.locale)===n)return s;if((a=l.exec(n))&&(r=a[1],(d=a[2])&&(i="^"+r+"\\D+"+d+"$",o=new RegExp(i),o.test(c.getLabel().toString()))))return s}return-1},t.prototype.getLastCanvasLabel=function(n){for(var t=this.getTotalCanvases()-1;t>=0;t--){var a=this.getCanvasByIndex(t),o=e.LanguageMap.getValue(a.getLabel(),this.options.locale);if(n){if(/^[a-zA-Z0-9]*$/.test(o))return o}else if(o)return o}return this.options.defaultLabel},t.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},t.prototype.getNextPageIndex=function(n,t){var a;if(t){var o=this.getPagedIndices(n),i=this.getViewingDirection();a=i&&i.toString()===e.ViewingDirection.RIGHTTOLEFT.toString()?o[0]+1:o[o.length-1]+1}else a=n+1;return a>this.getLastPageIndex()?-1:a},t.prototype.getPagedIndices=function(n,t){var a=[];if(t){a=this.isFirstCanvas(n)||this.isLastCanvas(n)?[n]:n%2?[n,n+1]:[n-1,n];var o=this.getViewingDirection();o&&o.toString()===e.ViewingDirection.RIGHTTOLEFT.toString()&&(a=a.reverse())}else a.push(n);return a},t.prototype.getPrevPageIndex=function(n,t){var a;if(t){var o=this.getPagedIndices(n),i=this.getViewingDirection();a=i&&i.toString()===e.ViewingDirection.RIGHTTOLEFT.toString()?o[o.length-1]-1:o[0]-1}else a=n-1;return a},t.prototype.getStartCanvasIndex=function(){var e=this.getStartCanvas();if(e)for(var n=0;n<this.getTotalCanvases();n++){var t=this.getCanvasByIndex(n);if(t.id===e)return n}return 0},t.prototype.getThumbs=function(n,t){console.warn("getThumbs will be deprecated, use getThumbnails instead");for(var a=[],o=this.getTotalCanvases(),i=0;i<o;i++){var r=this.getCanvasByIndex(i),d=new e.Thumb(n,r);a.push(d)}return a},t.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var e=this.getCanvases(),n=0;n<e.length;n++){var t=e[n].getThumbnail();t&&this._thumbnails.push(t)}return this._thumbnails},t.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},t.prototype.getTotalCanvases=function(){return this.getCanvases().length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new e.ViewingDirection(this.getProperty("viewingDirection")):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new e.ViewingHint(this.getProperty("viewingHint")):null},t.prototype.isCanvasIndexOutOfRange=function(e){return e>this.getTotalCanvases()-1},t.prototype.isFirstCanvas=function(e){return 0===e},t.prototype.isLastCanvas=function(e){return e===this.getTotalCanvases()-1},t.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},t.prototype.isPagingEnabled=function(){var n=this.getViewingHint();return!!n&&n.toString()===e.ViewingHint.PAGED.toString()},t.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},t}(e.ManifestResource);e.Sequence=n}(a||(a={}));var a;!function(e){var n=function(){function n(){}return n.parse=function(e,n){return"string"==typeof e&&(e=JSON.parse(e)),this.parseJson(e,n)},n.parseJson=function(e,n){var t;if(n&&n.navDate&&!isNaN(n.navDate.getTime())&&(e.navDate=n.navDate.toString()),e["@type"])switch(e["@type"]){case"sc:Collection":t=this.parseCollection(e,n);break;case"sc:Manifest":t=this.parseManifest(e,n);break;default:return null}else switch(e.type){case"Collection":t=this.parseCollection(e,n);break;case"Manifest":t=this.parseManifest(e,n);break;default:return null}return t.isLoaded=!0,t},n.parseCollection=function(n,t){var a=new e.Collection(n,t);return t?(a.index=t.index||0,t.resource&&(a.parentCollection=t.resource.parentCollection)):a.index=0,this.parseCollections(a,t),this.parseManifests(a,t),this.parseItems(a,t),a},n.parseCollections=function(e,n){var t;if(e.__jsonld.collections?t=e.__jsonld.collections:e.__jsonld.items&&(t=e.__jsonld.items.filter(function(e){return"collection"===e.type.toLowerCase()})),t)for(var a=0;a<t.length;a++){n&&(n.index=a);var o=this.parseCollection(t[a],n);o.index=a,o.parentCollection=e,e.items.push(o)}},n.parseManifest=function(n,t){return new e.Manifest(n,t)},n.parseManifests=function(e,n){var t;if(e.__jsonld.manifests?t=e.__jsonld.manifests:e.__jsonld.items&&(t=e.__jsonld.items.filter(function(e){return"manifest"===e.type.toLowerCase()})),t)for(var a=0;a<t.length;a++){var o=this.parseManifest(t[a],n);o.index=a,o.parentCollection=e,e.items.push(o)}},n.parseItem=function(e,n){if(e["@type"]){if("sc:manifest"===e["@type"].toLowerCase())return this.parseManifest(e,n);if("sc:collection"===e["@type"].toLowerCase())return this.parseCollection(e,n)}else if(e.type){if("manifest"===e.type.toLowerCase())return this.parseManifest(e,n);if("collection"===e.type.toLowerCase())return this.parseCollection(e,n)}return null},n.parseItems=function(e,n){var t=e.__jsonld.members||e.__jsonld.items;if(t)for(var a=function(a){n&&(n.index=a);var i=o.parseItem(t[a],n);return i?e.items.filter(function(e){return e.id===i.id})[0]?"continue":(i.index=a,i.parentCollection=e,void e.items.push(i)):{value:void 0}},o=this,i=0;i<t.length;i++){var r=a(i);if("object"==typeof r)return r.value}},n}();e.Deserialiser=n;var t=function(){function e(){}return e.serialise=function(e){return""},e}();e.Serialiser=t}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}return o(t,n),t.prototype.getProfile=function(){var n=this.getProperty("profile");return n||(n=this.getProperty("dcterms:conformsTo")),Array.isArray(n)?new e.ServiceProfile(n[0]):new e.ServiceProfile(n)},t.prototype.getConfirmLabel=function(){return e.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},t.prototype.getDescription=function(){return e.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},t.prototype.getFailureDescription=function(){return e.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},t.prototype.getFailureHeader=function(){return e.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},t.prototype.getHeader=function(){return e.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},t.prototype.getServiceLabel=function(){return e.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},t.prototype.getInfoUri=function(){var e=this.id;return e.endsWith("/")||(e+="/"),e+="info.json"},t}(e.ManifestResource);e.Service=n}(a||(a={}));var a;!function(e){var n=function(){function n(n,t){this.data=t,this.index=t.index,this.width=n;var a=t.getHeight()/t.getWidth();this.height=a?Math.floor(this.width*a):n,this.uri=t.getCanonicalImageUri(n),this.label=e.LanguageMap.getValue(t.getLabel())}return n}();e.Thumb=n}(a||(a={}));var a;!function(e){var n=function(){function n(e,n){this.label=e,this.data=n||{},this.nodes=[]}return n.prototype.addNode=function(e){this.nodes.push(e),e.parentNode=this},n.prototype.isCollection=function(){return this.data.type===e.Utils.normaliseType(e.TreeNodeType.COLLECTION.toString())},n.prototype.isManifest=function(){return this.data.type===e.Utils.normaliseType(e.TreeNodeType.MANIFEST.toString())},n.prototype.isRange=function(){return this.data.type===e.Utils.normaliseType(e.TreeNodeType.RANGE.toString())},n}();e.TreeNode=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o(n,e),n.prototype.collection=function(){return new n(n.COLLECTION.toString())},n.prototype.manifest=function(){return new n(n.MANIFEST.toString())},n.prototype.range=function(){return new n(n.RANGE.toString())},n.COLLECTION=new n("collection"),n.MANIFEST=new n("manifest"),n.RANGE=new n("range"),n}(e.StringValue);e.TreeNodeType=n}(a||(a={}));var a,i=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))(function(o,i){function r(e){try{l(a.next(e))}catch(n){i(n)}}function d(e){try{l(a.throw(e))}catch(n){i(n)}}function l(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(r,d)}l((a=a.apply(e,n||[])).next())})},r=this&&this.__generator||function(e,n){function t(e){return function(n){return a([e,n])}}function a(t){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,i&&(r=2&t[0]?i.return:t[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,t[1])).done)return r;switch(i=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,i=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){l.label=t[1];break}if(6===t[0]&&l.label<r[1]){l.label=r[1],r=t;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(t);break}r[2]&&l.ops.pop(),l.trys.pop();continue}t=n.call(e,l)}catch(a){t=[6,a],i=0}finally{o=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var o,i,r,d,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return d={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(d[Symbol.iterator]=function(){return this}),d},d=e("http"),l=e("https"),s=e("url");!function(e){var n=function(){function n(){}return n.getMediaType=function(e){return e=e.toLowerCase(),e=e.split(";")[0],e.trim()},n.getImageQuality=function(n){var t=n.toString();return t===e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||t===e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||t===e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||t===e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||t===e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||t===e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||t===e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||t===e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||t===e.ServiceProfile.IIIF1IMAGELEVEL1.toString()||t===e.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||t===e.ServiceProfile.IIIF1IMAGELEVEL2.toString()||t===e.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()?"native":"default"},n.getInexactLocale=function(e){return-1!==e.indexOf("-")?e.substr(0,e.indexOf("-")):e},n.getLocalisedValue=function(e,n){if(!Array.isArray(e))return e;for(var t=0;t<e.length;t++){var a=e[t];if(n===a["@language"])return a["@value"]}for(var o=n.substr(0,n.indexOf("-")),t=0;t<e.length;t++){var i=e[t];if(i["@language"]===o)return i["@value"]}return null},n.generateTreeNodeIds=function(e,t){void 0===t&&(t=0);var a;a=e.parentNode?e.parentNode.id+"-"+t:"0",e.id=a;for(var o=0;o<e.nodes.length;o++){var i=e.nodes[o];n.generateTreeNodeIds(i,o)}},n.normaliseType=function(e){if(e=e.toLowerCase(),-1!==e.indexOf(":")){return e.split(":")[1]}return e},n.normaliseUrl=function(e){return e=e.substr(e.indexOf("://")),-1!==e.indexOf("#")&&(e=e.split("#")[0]),e},n.normalisedUrlsMatch=function(e,t){return n.normaliseUrl(e)===n.normaliseUrl(t)},n.isImageProfile=function(t){return"string"==typeof t&&(t=new e.ServiceProfile(t)),!!(n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},n.isLevel0ImageProfile=function(t){return"string"==typeof t&&(t=new e.ServiceProfile(t)),!!(n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL0.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString()))},n.isLevel1ImageProfile=function(t){
return"string"==typeof t&&(t=new e.ServiceProfile(t)),!!(n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL1.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString()))},n.isLevel2ImageProfile=function(t){return"string"==typeof t&&(t=new e.ServiceProfile(t)),!!(n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL2.toString())||n.normalisedUrlsMatch(t.toString(),e.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},n.loadResource=function(e){return new Promise(function(n,t){var a,o=s.parse(e),i={host:o.hostname,port:o.port,path:o.path,method:"GET",withCredentials:!1};switch(o.protocol){case"https:":a=l.request(i,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){n(t)})}),a.on("error",function(e){t(e)}),a.end();break;case"dat:":var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&n(r.response)},r.open("GET",e,!0),r.send();break;default:a=d.request(i,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){n(t)})}),a.on("error",function(e){t(e)}),a.end()}})},n.loadExternalResourcesAuth1=function(e,t,a,o,i,r,d,l){return new Promise(function(s,c){var f=e.map(function(e){return n.loadExternalResourceAuth1(e,t,a,o,i,r,d,l)});Promise.all(f).then(function(){s(e)}).catch(function(e){c(e)})})},n.loadExternalResourceAuth1=function(e,t,a,o,d,l,s,c){return i(this,void 0,void 0,function(){var i;return r(this,function(r){switch(r.label){case 0:return[4,o(e)];case 1:return i=r.sent(),i?[4,e.getData(i)]:[3,6];case 2:return r.sent(),e.status!==HTTPStatusCode.OK?[3,3]:[2,e];case 3:return[4,n.doAuthChain(e,t,a,d,l,s,c)];case 4:r.sent(),r.label=5;case 5:if(e.status===HTTPStatusCode.OK||e.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,e];throw n.createAuthorizationFailedError();case 6:return[4,e.getData()];case 7:return r.sent(),e.status!==HTTPStatusCode.MOVED_TEMPORARILY&&e.status!==HTTPStatusCode.UNAUTHORIZED?[3,9]:[4,n.doAuthChain(e,t,a,d,l,s,c)];case 8:r.sent(),r.label=9;case 9:if(e.status===HTTPStatusCode.OK||e.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,e];throw n.createAuthorizationFailedError()}})})},n.doAuthChain=function(e,t,a,o,d,l,s){return i(this,void 0,void 0,function(){var i,c,f,u,g,h,A,v,v;return r(this,function(r){switch(r.label){case 0:return e.isAccessControlled()?(i=e.externalService,i&&(i.options=e.options),c=e.kioskService,c&&(c.options=e.options),f=e.clickThroughService,f&&(f.options=e.options),u=e.loginService,u&&(u.options=e.options),e.isResponseHandled||e.status!==HTTPStatusCode.MOVED_TEMPORARILY?[3,2]:[4,l(e)]):[2,e];case 1:return r.sent(),[2,e];case 2:return g=null,(h=null,g=i)?(h=g,[4,n.attemptResourceWithToken(e,a,g)]):[3,4];case 3:return r.sent(),[2,e];case 4:return(g=c)?(h=g,A=t(g),A?[4,o(A)]:[3,7]):[3,7];case 5:return r.sent(),[4,n.attemptResourceWithToken(e,a,g)];case 6:return r.sent(),[2,e];case 7:return(g=f)?(h=g,[4,d(e,g)]):[3,11];case 8:return v=r.sent(),v?[4,o(v)]:[3,11];case 9:return r.sent(),[4,n.attemptResourceWithToken(e,a,g)];case 10:return r.sent(),[2,e];case 11:return(g=u)?(h=g,[4,d(e,g)]):[3,15];case 12:return v=r.sent(),v?[4,o(v)]:[3,15];case 13:return r.sent(),[4,n.attemptResourceWithToken(e,a,g)];case 14:return r.sent(),[2,e];case 15:return h&&s(e,h),[2]}})})},n.attemptResourceWithToken=function(n,t,a){return i(this,void 0,void 0,function(){var o,i;return r(this,function(r){switch(r.label){case 0:return o=a.getService(e.ServiceProfile.AUTH1TOKEN.toString()),o?[4,t(n,o)]:[3,3];case 1:return i=r.sent(),i&&i.accessToken?[4,n.getData(i)]:[3,3];case 2:return r.sent(),[2,n];case 3:return[2]}})})},n.loadExternalResourcesAuth09=function(e,t,a,o,i,r,d,l,s,c){return new Promise(function(f,u){var g=e.map(function(e){return n.loadExternalResourceAuth09(e,t,a,o,i,r,d,l,s,c)});Promise.all(g).then(function(){f(e)}).catch(function(e){u(e)})})},n.loadExternalResourceAuth09=function(e,t,a,o,i,r,d,l,s,c){return new Promise(function(f,u){c&&c.pessimisticAccessControl?e.getData().then(function(){e.isAccessControlled()?e.clickThroughService?(f(a(e)),f(o(e))):i(e).then(function(){r(e,!0).then(function(t){e.getData(t).then(function(){f(s(e))}).catch(function(e){u(n.createInternalServerError(e))})}).catch(function(e){u(n.createInternalServerError(e))})}).catch(function(e){u(n.createInternalServerError(e))}):f(e)}).catch(function(e){u(n.createInternalServerError(e))}):l(e,t).then(function(c){c?e.getData(c).then(function(){e.status===HTTPStatusCode.OK?f(s(e)):n.authorize(e,t,a,o,i,r,d,l).then(function(){f(s(e))}).catch(function(e){u(n.createAuthorizationFailedError())})}).catch(function(e){u(n.createAuthorizationFailedError())}):n.authorize(e,t,a,o,i,r,d,l).then(function(){f(s(e))}).catch(function(e){u(n.createAuthorizationFailedError())})}).catch(function(e){u(n.createAuthorizationFailedError())})})},n.createError=function(e,n){var t=new Error;return t.message=n,t.name=e,t},n.createAuthorizationFailedError=function(){return n.createError(manifesto.StatusCodes.AUTHORIZATION_FAILED.toString(),"Authorization failed")},n.createRestrictedError=function(){return n.createError(manifesto.StatusCodes.RESTRICTED.toString(),"Restricted")},n.createInternalServerError=function(e){return n.createError(manifesto.StatusCodes.INTERNAL_SERVER_ERROR.toString(),e)},n.authorize=function(e,t,a,o,i,r,d,l){return new Promise(function(s,c){e.getData().then(function(){e.isAccessControlled()?l(e,t).then(function(l){l?e.getData(l).then(function(){e.status===HTTPStatusCode.OK?s(e):n.showAuthInteraction(e,t,a,o,i,r,d,s,c)}).catch(function(e){c(n.createInternalServerError(e))}):r(e,!1).then(function(l){l?d(e,l,t).then(function(){e.getData(l).then(function(){e.status===HTTPStatusCode.OK?s(e):n.showAuthInteraction(e,t,a,o,i,r,d,s,c)}).catch(function(e){c(n.createInternalServerError(e))})}).catch(function(e){c(n.createInternalServerError(e))}):n.showAuthInteraction(e,t,a,o,i,r,d,s,c)})}).catch(function(e){c(n.createInternalServerError(e))}):s(e)})})},n.showAuthInteraction=function(e,t,a,o,i,r,d,l,s){e.status!==HTTPStatusCode.MOVED_TEMPORARILY||e.isResponseHandled?e.clickThroughService&&!e.isResponseHandled?a(e).then(function(){r(e,!0).then(function(a){d(e,a,t).then(function(){e.getData(a).then(function(){l(e)}).catch(function(e){s(n.createInternalServerError(e))})}).catch(function(e){s(n.createInternalServerError(e))})}).catch(function(e){s(n.createInternalServerError(e))})}):i(e).then(function(){r(e,!0).then(function(a){d(e,a,t).then(function(){e.getData(a).then(function(){l(e)}).catch(function(e){s(n.createInternalServerError(e))})}).catch(function(e){s(n.createInternalServerError(e))})}).catch(function(e){s(n.createInternalServerError(e))})}):l(e)},n.getService=function(e,n){var t=this.getServices(e);"string"!=typeof n&&(n=n.toString());for(var a=0;a<t.length;a++){var o=t[a];if(o.getProfile().toString()===n)return o}return null},n.getResourceById=function(e,t){return n.traverseAndFind(e.__jsonld,"@id",t)},n.traverseAndFind=function(e,t,a){if(e.hasOwnProperty(t)&&e[t]===a)return e;for(var o=0;o<Object.keys(e).length;o++)if("object"==typeof e[Object.keys(e)[o]]){var i=n.traverseAndFind(e[Object.keys(e)[o]],t,a);if(null!=i)return i}},n.getServices=function(n){var t;t=n.__jsonld?n.__jsonld.service:n.service;var a=[];if(!t)return a;Array.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++){var i=t[o];if("string"==typeof i){var r=this.getResourceById(n.options.resource,i);r&&a.push(new e.Service(r.__jsonld||r,n.options))}else a.push(new e.Service(i,n.options))}return a},n.getTemporalComponent=function(e){var n=/t=([^&]+)/g.exec(e),t=null;return n&&n[1]&&(t=n[1].split(",")),t},n}();e.Utils=n}(a||(a={}));var a;!function(e){var n=function(){function e(e,n){Array.isArray(e)?1===e.length?this.value=e[0]:this.value=e.join("<br/>"):this.value=e,this.locale=n}return e}();e.Language=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return o(t,n),t.parse=function(n,t){var a,o=[];if(!n)return o;if(Array.isArray(n))for(var i=0;i<n.length;i++){var r=n[i];a="string"==typeof r?new e.Language(r,t):new e.Language(r["@value"],r["@language"]||t),o.push(a)}else{if("string"==typeof n)return a=new e.Language(n,t),o.push(a),o;n["@value"]?(a=new e.Language(n["@value"],n["@language"]||t),o.push(a)):Object.keys(n).forEach(function(t){if(!n[t].length)throw new Error("language must have a value");a=new e.Language(n[t],t),o.push(a)})}return o},t.getValue=function(n,t){if(n.length){if(t){var a=n.filter(function(n){return n.locale===t||e.Utils.getInexactLocale(n.locale)===e.Utils.getInexactLocale(t)})[0];if(a)return a.value}return n[0].value}return null},t}(Array);e.LanguageMap=n}(a||(a={}));var a;!function(e){var n=function(){function n(e){this.defaultLocale=e}return n.prototype.parse=function(n){this.resource=n,this.label=e.LanguageMap.parse(this.resource.label,this.defaultLocale),this.value=e.LanguageMap.parse(this.resource.value,this.defaultLocale)},n.prototype.getLabel=function(){return this.label?e.LanguageMap.getValue(this.label,this.defaultLocale):null},n.prototype.setLabel=function(n){var t=this;if(this.label&&this.label.length){var a=this.label.filter(function(n){return n.locale===t.defaultLocale||n.locale===e.Utils.getInexactLocale(t.defaultLocale)})[0];a&&(a.value=n)}},n.prototype.getValue=function(){if(this.value){var n=this.defaultLocale;return this.label&&this.label.length&&this.label[0].locale&&(n=this.label[0].locale),e.LanguageMap.getValue(this.value,n)}return null},n.prototype.setValue=function(n){var t=this;if(this.value&&this.value.length){var a=this.value.filter(function(n){return n.locale===t.defaultLocale||n.locale===e.Utils.getInexactLocale(t.defaultLocale)})[0];a&&(a.value=n)}},n}();e.LabelValuePair=n}(a||(a={}));var a;!function(e){var n=function(){function e(e,n){this.width=e,this.height=n}return e}();e.Size=n}(a||(a={})),t.manifesto=t.Manifesto=n.exports={AnnotationMotivation:new a.AnnotationMotivation,Behavior:new a.Behavior,IIIFResourceType:new a.IIIFResourceType,LabelValuePair:a.LabelValuePair,Language:a.Language,LanguageMap:a.LanguageMap,ManifestType:new a.ManifestType,MediaType:new a.MediaType,RenderingFormat:new a.RenderingFormat,ResourceType:new a.ResourceType,ServiceProfile:new a.ServiceProfile,Size:a.Size,TreeNode:a.TreeNode,TreeNodeType:new a.TreeNodeType,Utils:a.Utils,ViewingDirection:new a.ViewingDirection,ViewingHint:new a.ViewingHint,Annotation:a.Annotation,AnnotationBody:a.AnnotationBody,AnnotationList:a.AnnotationList,AnnotationPage:a.AnnotationPage,Canvas:a.Canvas,Collection:a.Collection,Duration:a.Duration,Manifest:a.Manifest,Range:a.Range,Sequence:a.Sequence,Service:a.Service,Thumbnail:a.Thumbnail,Thumb:a.Thumb,StatusCodes:{AUTHORIZATION_FAILED:1,FORBIDDEN:2,INTERNAL_SERVER_ERROR:3,RESTRICTED:4},create:function(e,n){return a.Deserialiser.parse(e,n)},loadManifest:function(e){return a.Utils.loadResource(e)}};var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}return o(t,n),t.prototype.getBody=function(){var n=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var a=0;a<t.length;a++){var o=t[a];if(o.items)for(var i=0;i<o.items.length;i++){var r=o.items[i];n.push(new e.AnnotationBody(r,this.options))}else n.push(new e.AnnotationBody(o,this.options))}else if(t.items)for(var a=0;a<t.items.length;a++){var o=t.items[a];n.push(new e.AnnotationBody(o,this.options))}else n.push(new e.AnnotationBody(t,this.options));return n},t.prototype.getMotivation=function(){var n=this.getProperty("motivation");return n?new e.AnnotationMotivation(n.toLowerCase()):null},t.prototype.getOn=function(){return this.getProperty("on")},t.prototype.getTarget=function(){return this.getProperty("target")},t.prototype.getResource=function(){return new e.Resource(this.getProperty("resource"),this.options)},t}(e.ManifestResource);e.Annotation=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t){return n.call(this,e,t)||this}return o(t,n),t.prototype.getFormat=function(){var n=this.getProperty("format");return n?new e.MediaType(e.Utils.getMediaType(n)):null},t.prototype.getType=function(){return this.getProperty("type")?new e.ResourceType(e.Utils.normaliseType(this.getProperty("type"))):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t}(e.ManifestResource);e.AnnotationBody=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(n){function t(e,t,a){var o=n.call(this,t)||this;return o.label=e,o.options=a,o}return o(t,n),t.prototype.getIIIFResourceType=function(){return new e.IIIFResourceType(e.Utils.normaliseType(this.getProperty("type")))},t.prototype.getLabel=function(){return this.label},t.prototype.getResources=function(){var n=this;return this.getProperty("resources").map(function(t){return new e.Annotation(t,n.options)})},t.prototype.load=function(){var n=this;return new Promise(function(t,a){if(n.isLoaded)t(n);else{var o=n.__jsonld.id;o||(o=n.__jsonld["@id"]),e.Utils.loadResource(o).then(function(e){n.__jsonld=JSON.parse(e),n.context=n.getProperty("context"),n.id=n.getProperty("id"),n.isLoaded=!0,t(n)}).catch(a)}})},t}(e.JSONLDResource);e.AnnotationList=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(n,t){return e.call(this,n,t)||this}return o(n,e),n.prototype.getItems=function(){return this.getProperty("items")},n}(e.ManifestResource);e.AnnotationPage=n}(a||(a={}));var a,o=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function a(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var n=function(e){function n(n,t){return e.call(this,n,t)||this}return o(n,e),n}(e.Resource);e.Thumbnail=n}(a||(a={}))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{http:30,https:9,url:36}],2:[function(e,n,t){"use strict";function a(e){var n=e.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");return-1===t&&(t=n),[t,t===n?0:4-t%4]}function o(e){var n=a(e),t=n[0],o=n[1];return 3*(t+o)/4-o}function i(e,n,t){return 3*(n+t)/4-t}function r(e){for(var n,t=a(e),o=t[0],r=t[1],d=new u(i(e,o,r)),l=0,s=r>0?o-4:o,c=0;c<s;c+=4)n=f[e.charCodeAt(c)]<<18|f[e.charCodeAt(c+1)]<<12|f[e.charCodeAt(c+2)]<<6|f[e.charCodeAt(c+3)],d[l++]=n>>16&255,d[l++]=n>>8&255,d[l++]=255&n;return 2===r&&(n=f[e.charCodeAt(c)]<<2|f[e.charCodeAt(c+1)]>>4,d[l++]=255&n),1===r&&(n=f[e.charCodeAt(c)]<<10|f[e.charCodeAt(c+1)]<<4|f[e.charCodeAt(c+2)]>>2,d[l++]=n>>8&255,d[l++]=255&n),d}function d(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function l(e,n,t){for(var a,o=[],i=n;i<t;i+=3)a=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(d(a));return o.join("")}function s(e){for(var n,t=e.length,a=t%3,o=[],i=16383,r=0,d=t-a;r<d;r+=i)o.push(l(e,r,r+i>d?d:r+i));return 1===a?(n=e[t-1],o.push(c[n>>2]+c[n<<4&63]+"==")):2===a&&(n=(e[t-2]<<8)+e[t-1],o.push(c[n>>10]+c[n>>4&63]+c[n<<2&63]+"=")),o.join("")}t.byteLength=o,t.toByteArray=r,t.fromByteArray=s;for(var c=[],f=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=0,A=g.length;h<A;++h)c[h]=g[h],f[g.charCodeAt(h)]=h;f["-".charCodeAt(0)]=62,f["_".charCodeAt(0)]=63},{}],3:[function(e,n,t){},{}],4:[function(n,t,a){(function(n){!function(o){function i(e){throw new RangeError(Q[e])}function r(e,n){for(var t=e.length,a=[];t--;)a[t]=n(e[t]);return a}function d(e,n){var t=e.split("@"),a="";return t.length>1&&(a=t[0]+"@",e=t[1]),e=e.replace(R,"."),a+r(e.split("."),n).join(".")}function l(e){for(var n,t,a=[],o=0,i=e.length;o<i;)n=e.charCodeAt(o++),n>=55296&&n<=56319&&o<i?(t=e.charCodeAt(o++),56320==(64512&t)?a.push(((1023&n)<<10)+(1023&t)+65536):(a.push(n),o--)):a.push(n);return a}function s(e){return r(e,function(e){var n="";return e>65535&&(e-=65536,n+=D(e>>>10&1023|55296),e=56320|1023&e),n+=D(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:C}function f(e,n){return e+22+75*(e<26)-((0!=n)<<5)}function u(e,n,t){var a=0;for(e=t?k(e/N):e>>1,e+=k(e/n);e>V*x>>1;a+=C)e=k(e/V);return k(a+(V+1)*e/(e+L))}function g(e){var n,t,a,o,r,d,l,f,g,h,A=[],v=e.length,m=0,S=I,p=B;for(t=e.lastIndexOf(O),t<0&&(t=0),a=0;a<t;++a)e.charCodeAt(a)>=128&&i("not-basic"),A.push(e.charCodeAt(a));for(o=t>0?t+1:0;o<v;){for(r=m,d=1,l=C;o>=v&&i("invalid-input"),f=c(e.charCodeAt(o++)),(f>=C||f>k((y-m)/d))&&i("overflow"),m+=f*d,g=l<=p?b:l>=p+x?x:l-p,!(f<g);l+=C)h=C-g,d>k(y/h)&&i("overflow"),d*=h;n=A.length+1,p=u(m-r,n,0==r),k(m/n)>y-S&&i("overflow"),S+=k(m/n),m%=n,A.splice(m++,0,S)}return s(A)}function h(e){var n,t,a,o,r,d,s,c,g,h,A,v,m,S,p,w=[];for(e=l(e),v=e.length,n=I,t=0,r=B,d=0;d<v;++d)(A=e[d])<128&&w.push(D(A));for(a=o=w.length,o&&w.push(O);a<v;){for(s=y,d=0;d<v;++d)(A=e[d])>=n&&A<s&&(s=A);for(m=a+1,s-n>k((y-t)/m)&&i("overflow"),t+=(s-n)*m,n=s,d=0;d<v;++d)if(A=e[d],A<n&&++t>y&&i("overflow"),A==n){for(c=t,g=C;h=g<=r?b:g>=r+x?x:g-r,!(c<h);g+=C)p=c-h,S=C-h,w.push(D(f(h+p%S,0))),c=k(p/S);w.push(D(f(c,0))),r=u(t,m,a==o),t=0,++a}++t,++n}return w.join("")}function A(e){return d(e,function(e){return T.test(e)?g(e.slice(4).toLowerCase()):e})}function v(e){return d(e,function(e){return G.test(e)?"xn--"+h(e):e})}var m="object"==typeof a&&a&&!a.nodeType&&a,S="object"==typeof t&&t&&!t.nodeType&&t,p="object"==typeof n&&n;p.global!==p&&p.window!==p&&p.self!==p||(o=p);var w,E,y=2147483647,C=36,b=1,x=26,L=38,N=700,B=72,I=128,O="-",T=/^xn--/,G=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,Q={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},V=C-b,k=Math.floor,D=String.fromCharCode;if(w={version:"1.4.1",ucs2:{decode:l,encode:s},decode:g,encode:h,toASCII:v,toUnicode:A},"function"==typeof e&&"object"==typeof e.amd&&e.amd)e("punycode",function(){return w});else if(m&&S)if(t.exports==m)S.exports=w;else for(E in w)w.hasOwnProperty(E)&&(m[E]=w[E]);else o.punycode=w}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,n,t){(function(n){"use strict";function a(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(n){return!1}}function o(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,n){if(o()<n)throw new RangeError("Invalid typed array length");return r.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(n),e.__proto__=r.prototype):(null===e&&(e=new r(n)),e.length=n),e}function r(e,n,t){if(!(r.TYPED_ARRAY_SUPPORT||this instanceof r))return new r(e,n,t);if("number"==typeof e){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return d(this,e,n,t)}function d(e,n,t,a){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?g(e,n,t,a):"string"==typeof n?f(e,n,t):h(e,n)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function s(e,n,t,a){return l(n),n<=0?i(e,n):void 0!==t?"string"==typeof a?i(e,n).fill(t,a):i(e,n).fill(t):i(e,n)}function c(e,n){if(l(n),e=i(e,n<0?0:0|A(n)),!r.TYPED_ARRAY_SUPPORT)for(var t=0;t<n;++t)e[t]=0;return e}function f(e,n,t){if("string"==typeof t&&""!==t||(t="utf8"),!r.isEncoding(t))throw new TypeError('"encoding" must be a valid string encoding');var a=0|m(n,t);e=i(e,a);var o=e.write(n,t);return o!==a&&(e=e.slice(0,o)),e}function u(e,n){var t=n.length<0?0:0|A(n.length);e=i(e,t);for(var a=0;a<t;a+=1)e[a]=255&n[a];return e}function g(e,n,t,a){if(n.byteLength,t<0||n.byteLength<t)throw new RangeError("'offset' is out of bounds");if(n.byteLength<t+(a||0))throw new RangeError("'length' is out of bounds");return n=void 0===t&&void 0===a?new Uint8Array(n):void 0===a?new Uint8Array(n,t):new Uint8Array(n,t,a),r.TYPED_ARRAY_SUPPORT?(e=n,e.__proto__=r.prototype):e=u(e,n),e}function h(e,n){if(r.isBuffer(n)){var t=0|A(n.length);return e=i(e,t),0===e.length?e:(n.copy(e,0,0,t),e)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||Y(n.length)?i(e,0):u(e,n);if("Buffer"===n.type&&_(n.data))return u(e,n.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function A(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function v(e){return+e!=e&&(e=0),r.alloc(+e)}function m(e,n){if(r.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var t=e.length;if(0===t)return 0;for(var a=!1;;)switch(n){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return W(e).length;default:if(a)return J(e).length;n=(""+n).toLowerCase(),a=!0}}function S(e,n,t){var a=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if(t>>>=0,n>>>=0,t<=n)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,n,t);case"utf8":case"utf-8":return I(this,n,t);case"ascii":return T(this,n,t);case"latin1":case"binary":return G(this,n,t);case"base64":return B(this,n,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,n,t);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}function p(e,n,t){var a=e[n];e[n]=e[t],e[t]=a}function w(e,n,t,a,o){if(0===e.length)return-1;if("string"==typeof t?(a=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=o?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(o)return-1;t=e.length-1}else if(t<0){if(!o)return-1;t=0}if("string"==typeof n&&(n=r.from(n,a)),r.isBuffer(n))return 0===n.length?-1:E(e,n,t,a,o);if("number"==typeof n)return n&=255,r.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,n,t):Uint8Array.prototype.lastIndexOf.call(e,n,t):E(e,[n],t,a,o);throw new TypeError("val must be string, number or Buffer")}function E(e,n,t,a,o){function i(e,n){return 1===r?e[n]:e.readUInt16BE(n*r)}var r=1,d=e.length,l=n.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||n.length<2)return-1;r=2,d/=2,l/=2,t/=2}var s;if(o){var c=-1;for(s=t;s<d;s++)if(i(e,s)===i(n,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===l)return c*r}else-1!==c&&(s-=s-c),c=-1}else for(t+l>d&&(t=d-l),s=t;s>=0;s--){for(var f=!0,u=0;u<l;u++)if(i(e,s+u)!==i(n,u)){f=!1;break}if(f)return s}return-1}function y(e,n,t,a){t=Number(t)||0;var o=e.length-t;a?(a=Number(a))>o&&(a=o):a=o;var i=n.length;if(i%2!=0)throw new TypeError("Invalid hex string");a>i/2&&(a=i/2);for(var r=0;r<a;++r){var d=parseInt(n.substr(2*r,2),16);if(isNaN(d))return r;e[t+r]=d}return r}function C(e,n,t,a){return X(J(n,e.length-t),e,t,a)}function b(e,n,t,a){return X(K(n),e,t,a)}function x(e,n,t,a){return b(e,n,t,a)}function L(e,n,t,a){return X(W(n),e,t,a)}function N(e,n,t,a){return X(M(n,e.length-t),e,t,a)}function B(e,n,t){return 0===n&&t===e.length?Z.fromByteArray(e):Z.fromByteArray(e.slice(n,t))}function I(e,n,t){t=Math.min(e.length,t);for(var a=[],o=n;o<t;){var i=e[o],r=null,d=i>239?4:i>223?3:i>191?2:1;if(o+d<=t){var l,s,c,f;switch(d){case 1:i<128&&(r=i);break;case 2:l=e[o+1],128==(192&l)&&(f=(31&i)<<6|63&l)>127&&(r=f);break;case 3:l=e[o+1],s=e[o+2],128==(192&l)&&128==(192&s)&&(f=(15&i)<<12|(63&l)<<6|63&s)>2047&&(f<55296||f>57343)&&(r=f);break;case 4:l=e[o+1],s=e[o+2],c=e[o+3],128==(192&l)&&128==(192&s)&&128==(192&c)&&(f=(15&i)<<18|(63&l)<<12|(63&s)<<6|63&c)>65535&&f<1114112&&(r=f)}}null===r?(r=65533,d=1):r>65535&&(r-=65536,a.push(r>>>10&1023|55296),r=56320|1023&r),a.push(r),o+=d}return O(a)}function O(e){var n=e.length;if(n<=ee)return String.fromCharCode.apply(String,e);for(var t="",a=0;a<n;)t+=String.fromCharCode.apply(String,e.slice(a,a+=ee));return t}function T(e,n,t){var a="";t=Math.min(e.length,t);for(var o=n;o<t;++o)a+=String.fromCharCode(127&e[o]);return a}function G(e,n,t){var a="";t=Math.min(e.length,t);for(var o=n;o<t;++o)a+=String.fromCharCode(e[o]);return a}function R(e,n,t){var a=e.length;(!n||n<0)&&(n=0),(!t||t<0||t>a)&&(t=a);for(var o="",i=n;i<t;++i)o+=H(e[i]);return o}function Q(e,n,t){for(var a=e.slice(n,t),o="",i=0;i<a.length;i+=2)o+=String.fromCharCode(a[i]+256*a[i+1]);return o}function V(e,n,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+n>t)throw new RangeError("Trying to access beyond buffer length")}function k(e,n,t,a,o,i){if(!r.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>o||n<i)throw new RangeError('"value" argument is out of bounds');if(t+a>e.length)throw new RangeError("Index out of range")}function D(e,n,t,a){n<0&&(n=65535+n+1);for(var o=0,i=Math.min(e.length-t,2);o<i;++o)e[t+o]=(n&255<<8*(a?o:1-o))>>>8*(a?o:1-o)}function F(e,n,t,a){n<0&&(n=4294967295+n+1);for(var o=0,i=Math.min(e.length-t,4);o<i;++o)e[t+o]=n>>>8*(a?o:3-o)&255}function P(e,n,t,a,o,i){if(t+a>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function U(e,n,t,a,o){return o||P(e,n,t,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(e,n,t,a,23,4),t+4}function j(e,n,t,a,o){return o||P(e,n,t,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(e,n,t,a,52,8),t+8}function q(e){if(e=z(e).replace(ne,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function z(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function H(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,n){n=n||1/0;for(var t,a=e.length,o=null,i=[],r=0;r<a;++r){if((t=e.charCodeAt(r))>55295&&t<57344){if(!o){if(t>56319){(n-=3)>-1&&i.push(239,191,189);continue}if(r+1===a){(n-=3)>-1&&i.push(239,191,189);continue}o=t;continue}if(t<56320){(n-=3)>-1&&i.push(239,191,189),o=t;continue}t=65536+(o-55296<<10|t-56320)}else o&&(n-=3)>-1&&i.push(239,191,189);if(o=null,t<128){if((n-=1)<0)break;i.push(t)}else if(t<2048){if((n-=2)<0)break;i.push(t>>6|192,63&t|128)}else if(t<65536){if((n-=3)<0)break;i.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;i.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return i}function K(e){for(var n=[],t=0;t<e.length;++t)n.push(255&e.charCodeAt(t));return n}function M(e,n){for(var t,a,o,i=[],r=0;r<e.length&&!((n-=2)<0);++r)t=e.charCodeAt(r),a=t>>8,o=t%256,i.push(o),i.push(a);return i}function W(e){return Z.toByteArray(q(e))}function X(e,n,t,a){for(var o=0;o<a&&!(o+t>=n.length||o>=e.length);++o)n[o+t]=e[o];return o}function Y(e){return e!==e}var Z=e("base64-js"),$=e("ieee754"),_=e("isarray");t.Buffer=r,t.SlowBuffer=v,t.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:a(),t.kMaxLength=o(),r.poolSize=8192,r._augment=function(e){return e.__proto__=r.prototype,e},r.from=function(e,n,t){return d(null,e,n,t)},r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=function(e,n,t){return s(null,e,n,t)},r.allocUnsafe=function(e){return c(null,e)},r.allocUnsafeSlow=function(e){return c(null,e)},r.isBuffer=function(e){return!(null==e||!e._isBuffer)},r.compare=function(e,n){if(!r.isBuffer(e)||!r.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(e===n)return 0;for(var t=e.length,a=n.length,o=0,i=Math.min(t,a);o<i;++o)if(e[o]!==n[o]){t=e[o],a=n[o];break}return t<a?-1:a<t?1:0},r.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(e,n){if(!_(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return r.alloc(0);var t;if(void 0===n)for(n=0,t=0;t<e.length;++t)n+=e[t].length;var a=r.allocUnsafe(n),o=0;for(t=0;t<e.length;++t){var i=e[t];if(!r.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(a,o),o+=i.length}return a},r.byteLength=m,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<e;n+=2)p(this,n,n+1);return this},r.prototype.swap32=function(){var e=this.length
;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<e;n+=4)p(this,n,n+3),p(this,n+1,n+2);return this},r.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<e;n+=8)p(this,n,n+7),p(this,n+1,n+6),p(this,n+2,n+5),p(this,n+3,n+4);return this},r.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?I(this,0,e):S.apply(this,arguments)},r.prototype.equals=function(e){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===r.compare(this,e)},r.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},r.prototype.compare=function(e,n,t,a,o){if(!r.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===t&&(t=e?e.length:0),void 0===a&&(a=0),void 0===o&&(o=this.length),n<0||t>e.length||a<0||o>this.length)throw new RangeError("out of range index");if(a>=o&&n>=t)return 0;if(a>=o)return-1;if(n>=t)return 1;if(n>>>=0,t>>>=0,a>>>=0,o>>>=0,this===e)return 0;for(var i=o-a,d=t-n,l=Math.min(i,d),s=this.slice(a,o),c=e.slice(n,t),f=0;f<l;++f)if(s[f]!==c[f]){i=s[f],d=c[f];break}return i<d?-1:d<i?1:0},r.prototype.includes=function(e,n,t){return-1!==this.indexOf(e,n,t)},r.prototype.indexOf=function(e,n,t){return w(this,e,n,t,!0)},r.prototype.lastIndexOf=function(e,n,t){return w(this,e,n,t,!1)},r.prototype.write=function(e,n,t,a){if(void 0===n)a="utf8",t=this.length,n=0;else if(void 0===t&&"string"==typeof n)a=n,t=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(t)?(t|=0,void 0===a&&(a="utf8")):(a=t,t=void 0)}var o=this.length-n;if((void 0===t||t>o)&&(t=o),e.length>0&&(t<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var i=!1;;)switch(a){case"hex":return y(this,e,n,t);case"utf8":case"utf-8":return C(this,e,n,t);case"ascii":return b(this,e,n,t);case"latin1":case"binary":return x(this,e,n,t);case"base64":return L(this,e,n,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,n,t);default:if(i)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),i=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ee=4096;r.prototype.slice=function(e,n){var t=this.length;e=~~e,n=void 0===n?t:~~n,e<0?(e+=t)<0&&(e=0):e>t&&(e=t),n<0?(n+=t)<0&&(n=0):n>t&&(n=t),n<e&&(n=e);var a;if(r.TYPED_ARRAY_SUPPORT)a=this.subarray(e,n),a.__proto__=r.prototype;else{var o=n-e;a=new r(o,void 0);for(var i=0;i<o;++i)a[i]=this[i+e]}return a},r.prototype.readUIntLE=function(e,n,t){e|=0,n|=0,t||V(e,n,this.length);for(var a=this[e],o=1,i=0;++i<n&&(o*=256);)a+=this[e+i]*o;return a},r.prototype.readUIntBE=function(e,n,t){e|=0,n|=0,t||V(e,n,this.length);for(var a=this[e+--n],o=1;n>0&&(o*=256);)a+=this[e+--n]*o;return a},r.prototype.readUInt8=function(e,n){return n||V(e,1,this.length),this[e]},r.prototype.readUInt16LE=function(e,n){return n||V(e,2,this.length),this[e]|this[e+1]<<8},r.prototype.readUInt16BE=function(e,n){return n||V(e,2,this.length),this[e]<<8|this[e+1]},r.prototype.readUInt32LE=function(e,n){return n||V(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},r.prototype.readUInt32BE=function(e,n){return n||V(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},r.prototype.readIntLE=function(e,n,t){e|=0,n|=0,t||V(e,n,this.length);for(var a=this[e],o=1,i=0;++i<n&&(o*=256);)a+=this[e+i]*o;return o*=128,a>=o&&(a-=Math.pow(2,8*n)),a},r.prototype.readIntBE=function(e,n,t){e|=0,n|=0,t||V(e,n,this.length);for(var a=n,o=1,i=this[e+--a];a>0&&(o*=256);)i+=this[e+--a]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*n)),i},r.prototype.readInt8=function(e,n){return n||V(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},r.prototype.readInt16LE=function(e,n){n||V(e,2,this.length);var t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},r.prototype.readInt16BE=function(e,n){n||V(e,2,this.length);var t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},r.prototype.readInt32LE=function(e,n){return n||V(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},r.prototype.readInt32BE=function(e,n){return n||V(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},r.prototype.readFloatLE=function(e,n){return n||V(e,4,this.length),$.read(this,e,!0,23,4)},r.prototype.readFloatBE=function(e,n){return n||V(e,4,this.length),$.read(this,e,!1,23,4)},r.prototype.readDoubleLE=function(e,n){return n||V(e,8,this.length),$.read(this,e,!0,52,8)},r.prototype.readDoubleBE=function(e,n){return n||V(e,8,this.length),$.read(this,e,!1,52,8)},r.prototype.writeUIntLE=function(e,n,t,a){if(e=+e,n|=0,t|=0,!a){k(this,e,n,t,Math.pow(2,8*t)-1,0)}var o=1,i=0;for(this[n]=255&e;++i<t&&(o*=256);)this[n+i]=e/o&255;return n+t},r.prototype.writeUIntBE=function(e,n,t,a){if(e=+e,n|=0,t|=0,!a){k(this,e,n,t,Math.pow(2,8*t)-1,0)}var o=t-1,i=1;for(this[n+o]=255&e;--o>=0&&(i*=256);)this[n+o]=e/i&255;return n+t},r.prototype.writeUInt8=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,1,255,0),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[n]=255&e,n+1},r.prototype.writeUInt16LE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8):D(this,e,n,!0),n+2},r.prototype.writeUInt16BE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=255&e):D(this,e,n,!1),n+2},r.prototype.writeUInt32LE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=255&e):F(this,e,n,!0),n+4},r.prototype.writeUInt32BE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e):F(this,e,n,!1),n+4},r.prototype.writeIntLE=function(e,n,t,a){if(e=+e,n|=0,!a){var o=Math.pow(2,8*t-1);k(this,e,n,t,o-1,-o)}var i=0,r=1,d=0;for(this[n]=255&e;++i<t&&(r*=256);)e<0&&0===d&&0!==this[n+i-1]&&(d=1),this[n+i]=(e/r>>0)-d&255;return n+t},r.prototype.writeIntBE=function(e,n,t,a){if(e=+e,n|=0,!a){var o=Math.pow(2,8*t-1);k(this,e,n,t,o-1,-o)}var i=t-1,r=1,d=0;for(this[n+i]=255&e;--i>=0&&(r*=256);)e<0&&0===d&&0!==this[n+i+1]&&(d=1),this[n+i]=(e/r>>0)-d&255;return n+t},r.prototype.writeInt8=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,1,127,-128),r.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[n]=255&e,n+1},r.prototype.writeInt16LE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8):D(this,e,n,!0),n+2},r.prototype.writeInt16BE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=255&e):D(this,e,n,!1),n+2},r.prototype.writeInt32LE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[n]=255&e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24):F(this,e,n,!0),n+4},r.prototype.writeInt32BE=function(e,n,t){return e=+e,n|=0,t||k(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),r.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=255&e):F(this,e,n,!1),n+4},r.prototype.writeFloatLE=function(e,n,t){return U(this,e,n,!0,t)},r.prototype.writeFloatBE=function(e,n,t){return U(this,e,n,!1,t)},r.prototype.writeDoubleLE=function(e,n,t){return j(this,e,n,!0,t)},r.prototype.writeDoubleBE=function(e,n,t){return j(this,e,n,!1,t)},r.prototype.copy=function(e,n,t,a){if(t||(t=0),a||0===a||(a=this.length),n>=e.length&&(n=e.length),n||(n=0),a>0&&a<t&&(a=t),a===t)return 0;if(0===e.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-n<a-t&&(a=e.length-n+t);var o,i=a-t;if(this===e&&t<n&&n<a)for(o=i-1;o>=0;--o)e[o+n]=this[o+t];else if(i<1e3||!r.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+n]=this[o+t];else Uint8Array.prototype.set.call(e,this.subarray(t,t+i),n);return i},r.prototype.fill=function(e,n,t,a){if("string"==typeof e){if("string"==typeof n?(a=n,n=0,t=this.length):"string"==typeof t&&(a=t,t=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!r.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(n<0||this.length<n||this.length<t)throw new RangeError("Out of range index");if(t<=n)return this;n>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0);var i;if("number"==typeof e)for(i=n;i<t;++i)this[i]=e;else{var d=r.isBuffer(e)?e:J(new r(e,a).toString()),l=d.length;for(i=0;i<t-n;++i)this[i+n]=d[i%l]}return this};var ne=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:10,isarray:13}],6:[function(e,n,t){n.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],7:[function(e,n,t){(function(e){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===v(e)}function a(e){return"boolean"==typeof e}function o(e){return null===e}function i(e){return null==e}function r(e){return"number"==typeof e}function d(e){return"string"==typeof e}function l(e){return"symbol"==typeof e}function s(e){return void 0===e}function c(e){return"[object RegExp]"===v(e)}function f(e){return"object"==typeof e&&null!==e}function u(e){return"[object Date]"===v(e)}function g(e){return"[object Error]"===v(e)||e instanceof Error}function h(e){return"function"==typeof e}function A(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function v(e){return Object.prototype.toString.call(e)}t.isArray=n,t.isBoolean=a,t.isNull=o,t.isNullOrUndefined=i,t.isNumber=r,t.isString=d,t.isSymbol=l,t.isUndefined=s,t.isRegExp=c,t.isObject=f,t.isDate=u,t.isError=g,t.isFunction=h,t.isPrimitive=A,t.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":12}],8:[function(e,n,t){function a(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function r(e){return"object"==typeof e&&null!==e}function d(e){return void 0===e}n.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._maxListeners=void 0,a.defaultMaxListeners=10,a.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},a.prototype.emit=function(e){var n,t,a,i,l,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((n=arguments[1])instanceof Error)throw n;var c=new Error('Uncaught, unspecified "error" event. ('+n+")");throw c.context=n,c}if(t=this._events[e],d(t))return!1;if(o(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),t.apply(this,i)}else if(r(t))for(i=Array.prototype.slice.call(arguments,1),s=t.slice(),a=s.length,l=0;l<a;l++)s[l].apply(this,i);return!0},a.prototype.addListener=function(e,n){var t;if(!o(n))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(n.listener)?n.listener:n),this._events[e]?r(this._events[e])?this._events[e].push(n):this._events[e]=[this._events[e],n]:this._events[e]=n,r(this._events[e])&&!this._events[e].warned&&(t=d(this._maxListeners)?a.defaultMaxListeners:this._maxListeners)&&t>0&&this._events[e].length>t&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(e,n){function t(){this.removeListener(e,t),a||(a=!0,n.apply(this,arguments))}if(!o(n))throw TypeError("listener must be a function");var a=!1;return t.listener=n,this.on(e,t),this},a.prototype.removeListener=function(e,n){var t,a,i,d;if(!o(n))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(t=this._events[e],i=t.length,a=-1,t===n||o(t.listener)&&t.listener===n)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,n);else if(r(t)){for(d=i;d-- >0;)if(t[d]===n||t[d].listener&&t[d].listener===n){a=d;break}if(a<0)return this;1===t.length?(t.length=0,delete this._events[e]):t.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,n)}return this},a.prototype.removeAllListeners=function(e){var n,t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(n in this._events)"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events={},this}if(t=this._events[e],o(t))this.removeListener(e,t);else if(t)for(;t.length;)this.removeListener(e,t[t.length-1]);return delete this._events[e],this},a.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},a.prototype.listenerCount=function(e){if(this._events){var n=this._events[e];if(o(n))return 1;if(n)return n.length}return 0},a.listenerCount=function(e,n){return e.listenerCount(n)}},{}],9:[function(e,n,t){var a=e("http"),o=n.exports;for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o.request=function(e,n){return e||(e={}),e.scheme="https",e.protocol="https:",a.request.call(this,e,n)}},{http:30}],10:[function(e,n,t){t.read=function(e,n,t,a,o){var i,r,d=8*o-a-1,l=(1<<d)-1,s=l>>1,c=-7,f=t?o-1:0,u=t?-1:1,g=e[n+f];for(f+=u,i=g&(1<<-c)-1,g>>=-c,c+=d;c>0;i=256*i+e[n+f],f+=u,c-=8);for(r=i&(1<<-c)-1,i>>=-c,c+=a;c>0;r=256*r+e[n+f],f+=u,c-=8);if(0===i)i=1-s;else{if(i===l)return r?NaN:1/0*(g?-1:1);r+=Math.pow(2,a),i-=s}return(g?-1:1)*r*Math.pow(2,i-a)},t.write=function(e,n,t,a,o,i){var r,d,l,s=8*i-o-1,c=(1<<s)-1,f=c>>1,u=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=a?0:i-1,h=a?1:-1,A=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(d=isNaN(n)?1:0,r=c):(r=Math.floor(Math.log(n)/Math.LN2),n*(l=Math.pow(2,-r))<1&&(r--,l*=2),n+=r+f>=1?u/l:u*Math.pow(2,1-f),n*l>=2&&(r++,l/=2),r+f>=c?(d=0,r=c):r+f>=1?(d=(n*l-1)*Math.pow(2,o),r+=f):(d=n*Math.pow(2,f-1)*Math.pow(2,o),r=0));o>=8;e[t+g]=255&d,g+=h,d/=256,o-=8);for(r=r<<o|d,s+=o;s>0;e[t+g]=255&r,g+=h,r/=256,s-=8);e[t+g-h]|=128*A}},{}],11:[function(e,n,t){"function"==typeof Object.create?n.exports=function(e,n){e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(e,n){e.super_=n;var t=function(){};t.prototype=n.prototype,e.prototype=new t,e.prototype.constructor=e}},{}],12:[function(e,n,t){function a(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&a(e.slice(0,0))}n.exports=function(e){return null!=e&&(a(e)||o(e)||!!e._isBuffer)}},{}],13:[function(e,n,t){var a={}.toString;n.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},{}],14:[function(e,n,t){function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(f===setTimeout)return setTimeout(e,0);if((f===a||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(n){try{return f.call(null,e,0)}catch(n){return f.call(this,e,0)}}}function r(e){if(u===clearTimeout)return clearTimeout(e);if((u===o||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{return u(e)}catch(n){try{return u.call(null,e)}catch(n){return u.call(this,e)}}}function d(){v&&h&&(v=!1,h.length?A=h.concat(A):m=-1,A.length&&l())}function l(){if(!v){var e=i(d);v=!0;for(var n=A.length;n;){for(h=A,A=[];++m<n;)h&&h[m].run();m=-1,n=A.length}h=null,v=!1,r(e)}}function s(e,n){this.fun=e,this.array=n}function c(){}var f,u,g=n.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:a}catch(e){f=a}try{u="function"==typeof clearTimeout?clearTimeout:o}catch(e){u=o}}();var h,A=[],v=!1,m=-1;g.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];A.push(new s(e,n)),1!==A.length||v||i(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=c,g.addListener=c,g.once=c,g.off=c,g.removeListener=c,g.removeAllListeners=c,g.emit=c,g.prependListener=c,g.prependOnceListener=c,g.listeners=function(e){return[]},g.binding=function(e){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(e){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],15:[function(e,n,t){"use strict";function a(e,n){return Object.prototype.hasOwnProperty.call(e,n)}n.exports=function(e,n,t,i){n=n||"&",t=t||"=";var r={};if("string"!=typeof e||0===e.length)return r;var d=/\+/g;e=e.split(n);var l=1e3;i&&"number"==typeof i.maxKeys&&(l=i.maxKeys);var s=e.length;l>0&&s>l&&(s=l);for(var c=0;c<s;++c){var f,u,g,h,A=e[c].replace(d,"%20"),v=A.indexOf(t);v>=0?(f=A.substr(0,v),u=A.substr(v+1)):(f=A,u=""),g=decodeURIComponent(f),h=decodeURIComponent(u),a(r,g)?o(r[g])?r[g].push(h):r[g]=[r[g],h]:r[g]=h}return r};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],16:[function(e,n,t){"use strict";function a(e,n){if(e.map)return e.map(n);for(var t=[],a=0;a<e.length;a++)t.push(n(e[a],a));return t}var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};n.exports=function(e,n,t,d){return n=n||"&",t=t||"=",null===e&&(e=void 0),"object"==typeof e?a(r(e),function(r){var d=encodeURIComponent(o(r))+t;return i(e[r])?a(e[r],function(e){return d+encodeURIComponent(o(e))}).join(n):d+encodeURIComponent(o(e[r]))}).join(n):d?encodeURIComponent(o(d))+t+encodeURIComponent(o(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=Object.keys||function(e){var n=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}},{}],17:[function(e,n,t){"use strict";t.decode=t.parse=e("./decode"),t.encode=t.stringify=e("./encode")},{"./decode":15,"./encode":16}],18:[function(e,n,t){"use strict";function a(e){if(!(this instanceof a))return new a(e);s.call(this,e),c.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",o)}function o(){this.allowHalfOpen||this._writableState.ended||r.nextTick(i,this)}function i(e){e.end()}var r=e("process-nextick-args"),d=Object.keys||function(e){var n=[];for(var t in e)n.push(t);return n};n.exports=a;var l=e("core-util-is");l.inherits=e("inherits");var s=e("./_stream_readable"),c=e("./_stream_writable");l.inherits(a,s);for(var f=d(c.prototype),u=0;u<f.length;u++){var g=f[u];a.prototype[g]||(a.prototype[g]=c.prototype[g])}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),a.prototype._destroy=function(e,n){this.push(null),this.end(),r.nextTick(n,e)}},{"./_stream_readable":20,"./_stream_writable":22,"core-util-is":7,inherits:11,"process-nextick-args":26}],19:[function(e,n,t){"use strict";function a(e){if(!(this instanceof a))return new a(e);o.call(this,e)}n.exports=a;var o=e("./_stream_transform"),i=e("core-util-is");i.inherits=e("inherits"),i.inherits(a,o),a.prototype._transform=function(e,n,t){t(null,e)}},{"./_stream_transform":21,"core-util-is":7,inherits:11}],20:[function(e,n,t){(function(t,a){"use strict";function o(e){return D.from(e)}function i(e){return D.isBuffer(e)||e instanceof F}function r(e,n,t){if("function"==typeof e.prependListener)return e.prependListener(n,t);e._events&&e._events[n]?Q(e._events[n])?e._events[n].unshift(t):e._events[n]=[t,e._events[n]]:e.on(n,t)}function d(n,t){R=R||e("./_stream_duplex"),n=n||{};var a=t instanceof R;this.objectMode=!!n.objectMode,a&&(this.objectMode=this.objectMode||!!n.readableObjectMode);var o=n.highWaterMark,i=n.readableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:a&&(i||0===i)?i:r,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new z,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(q||(q=e("string_decoder/").StringDecoder),this.decoder=new q(n.encoding),this.encoding=n.encoding)}function l(n){if(R=R||e("./_stream_duplex"),!(this instanceof l))return new l(n);this._readableState=new d(n,this),this.readable=!0,n&&("function"==typeof n.read&&(this._read=n.read),"function"==typeof n.destroy&&(this._destroy=n.destroy)),k.call(this)}function s(e,n,t,a,i){var r=e._readableState;if(null===n)r.reading=!1,A(e,r);else{var d;i||(d=f(r,n)),d?e.emit("error",d):r.objectMode||n&&n.length>0?("string"==typeof n||r.objectMode||Object.getPrototypeOf(n)===D.prototype||(n=o(n)),a?r.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):c(e,r,n,!0):r.ended?e.emit("error",new Error("stream.push() after EOF")):(r.reading=!1,r.decoder&&!t?(n=r.decoder.write(n),r.objectMode||0!==n.length?c(e,r,n,!1):S(e,r)):c(e,r,n,!1))):a||(r.reading=!1)}return u(r)}function c(e,n,t,a){n.flowing&&0===n.length&&!n.sync?(e.emit("data",t),e.read(0)):(n.length+=n.objectMode?1:t.length,a?n.buffer.unshift(t):n.buffer.push(t),n.needReadable&&v(e)),S(e,n)}function f(e,n){var t;return i(n)||"string"==typeof n||void 0===n||e.objectMode||(t=new TypeError("Invalid non-string/buffer chunk")),t}function u(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function g(e){return e>=K?e=K:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function h(e,n){return e<=0||0===n.length&&n.ended?0:n.objectMode?1:e!==e?n.flowing&&n.length?n.buffer.head.data.length:n.length:(e>n.highWaterMark&&(n.highWaterMark=g(e)),e<=n.length?e:n.ended?n.length:(n.needReadable=!0,0))}function A(e,n){if(!n.ended){if(n.decoder){var t=n.decoder.end();t&&t.length&&(n.buffer.push(t),n.length+=n.objectMode?1:t.length)}n.ended=!0,v(e)}}function v(e){var n=e._readableState;n.needReadable=!1,n.emittedReadable||(j("emitReadable",n.flowing),n.emittedReadable=!0,n.sync?G.nextTick(m,e):m(e))}function m(e){j("emit readable"),e.emit("readable"),b(e)}function S(e,n){n.readingMore||(n.readingMore=!0,G.nextTick(p,e,n))}function p(e,n){for(var t=n.length;!n.reading&&!n.flowing&&!n.ended&&n.length<n.highWaterMark&&(j("maybeReadMore read 0"),e.read(0),t!==n.length);)t=n.length;n.readingMore=!1}function w(e){return function(){var n=e._readableState;j("pipeOnDrain",n.awaitDrain),n.awaitDrain&&n.awaitDrain--,0===n.awaitDrain&&V(e,"data")&&(n.flowing=!0,b(e))}}function E(e){j("readable nexttick read 0"),e.read(0)}function y(e,n){n.resumeScheduled||(n.resumeScheduled=!0,G.nextTick(C,e,n))}function C(e,n){n.reading||(j("resume read 0"),e.read(0)),n.resumeScheduled=!1,n.awaitDrain=0,e.emit("resume"),b(e),n.flowing&&!n.reading&&e.read(0)}function b(e){var n=e._readableState;for(j("flow",n.flowing);n.flowing&&null!==e.read(););}function x(e,n){if(0===n.length)return null;var t;return n.objectMode?t=n.buffer.shift():!e||e>=n.length?(t=n.decoder?n.buffer.join(""):1===n.buffer.length?n.buffer.head.data:n.buffer.concat(n.length),n.buffer.clear()):t=L(e,n.buffer,n.decoder),t}function L(e,n,t){var a;return e<n.head.data.length?(a=n.head.data.slice(0,e),n.head.data=n.head.data.slice(e)):a=e===n.head.data.length?n.shift():t?N(e,n):B(e,n),a}function N(e,n){var t=n.head,a=1,o=t.data;for(e-=o.length;t=t.next;){var i=t.data,r=e>i.length?i.length:e;if(r===i.length?o+=i:o+=i.slice(0,e),0===(e-=r)){r===i.length?(++a,t.next?n.head=t.next:n.head=n.tail=null):(n.head=t,t.data=i.slice(r));break}++a}return n.length-=a,o}function B(e,n){var t=D.allocUnsafe(e),a=n.head,o=1;for(a.data.copy(t),e-=a.data.length;a=a.next;){var i=a.data,r=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,r),0===(e-=r)){r===i.length?(++o,a.next?n.head=a.next:n.head=n.tail=null):(n.head=a,a.data=i.slice(r));break}++o}return n.length-=o,t}function I(e){var n=e._readableState;if(n.length>0)throw new Error('"endReadable()" called on non-empty stream');n.endEmitted||(n.ended=!0,G.nextTick(O,n,e))}function O(e,n){e.endEmitted||0!==e.length||(e.endEmitted=!0,n.readable=!1,n.emit("end"))}function T(e,n){for(var t=0,a=e.length;t<a;t++)if(e[t]===n)return t;return-1}var G=e("process-nextick-args");n.exports=l;var R,Q=e("isarray");l.ReadableState=d;var V=(e("events").EventEmitter,function(e,n){return e.listeners(n).length}),k=e("./internal/streams/stream"),D=e("safe-buffer").Buffer,F=a.Uint8Array||function(){},P=e("core-util-is");P.inherits=e("inherits");var U=e("util"),j=void 0;j=U&&U.debuglog?U.debuglog("stream"):function(){};var q,z=e("./internal/streams/BufferList"),H=e("./internal/streams/destroy");P.inherits(l,k);var J=["error","close","destroy","pause","resume"];Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),l.prototype.destroy=H.destroy,l.prototype._undestroy=H.undestroy,l.prototype._destroy=function(e,n){this.push(null),n(e)},l.prototype.push=function(e,n){var t,a=this._readableState;return a.objectMode?t=!0:"string"==typeof e&&(n=n||a.defaultEncoding,n!==a.encoding&&(e=D.from(e,n),n=""),t=!0),s(this,e,n,!1,t)},l.prototype.unshift=function(e){return s(this,e,null,!0,!1)},l.prototype.isPaused=function(){return!1===this._readableState.flowing},l.prototype.setEncoding=function(n){return q||(q=e("string_decoder/").StringDecoder),this._readableState.decoder=new q(n),this._readableState.encoding=n,this};var K=8388608;l.prototype.read=function(e){j("read",e),e=parseInt(e,10);var n=this._readableState,t=e;if(0!==e&&(n.emittedReadable=!1),0===e&&n.needReadable&&(n.length>=n.highWaterMark||n.ended))return j("read: emitReadable",n.length,n.ended),0===n.length&&n.ended?I(this):v(this),null;if(0===(e=h(e,n))&&n.ended)return 0===n.length&&I(this),null;var a=n.needReadable;j("need readable",a),(0===n.length||n.length-e<n.highWaterMark)&&(a=!0,j("length less than watermark",a)),n.ended||n.reading?(a=!1,j("reading or ended",a)):a&&(j("do read"),n.reading=!0,n.sync=!0,0===n.length&&(n.needReadable=!0),this._read(n.highWaterMark),n.sync=!1,n.reading||(e=h(t,n)));var o;return o=e>0?x(e,n):null,null===o?(n.needReadable=!0,e=0):n.length-=e,0===n.length&&(n.ended||(n.needReadable=!0),t!==e&&n.ended&&I(this)),null!==o&&this.emit("data",o),o},l.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},l.prototype.pipe=function(e,n){function a(e,n){j("onunpipe"),e===u&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,i())}function o(){j("onend"),e.end()}function i(){j("cleanup"),e.removeListener("close",s),e.removeListener("finish",c),e.removeListener("drain",v),e.removeListener("error",l),e.removeListener("unpipe",a),u.removeListener("end",o),u.removeListener("end",f),u.removeListener("data",d),m=!0,!g.awaitDrain||e._writableState&&!e._writableState.needDrain||v()}function d(n){j("ondata"),S=!1,!1!==e.write(n)||S||((1===g.pipesCount&&g.pipes===e||g.pipesCount>1&&-1!==T(g.pipes,e))&&!m&&(j("false write response, pause",u._readableState.awaitDrain),u._readableState.awaitDrain++,S=!0),u.pause())}function l(n){j("onerror",n),f(),e.removeListener("error",l),0===V(e,"error")&&e.emit("error",n)}function s(){e.removeListener("finish",c),f()}function c(){j("onfinish"),e.removeListener("close",s),f()}function f(){j("unpipe"),u.unpipe(e)}var u=this,g=this._readableState;switch(g.pipesCount){case 0:g.pipes=e;break;case 1:g.pipes=[g.pipes,e];break;default:g.pipes.push(e)}g.pipesCount+=1,j("pipe count=%d opts=%j",g.pipesCount,n);var h=(!n||!1!==n.end)&&e!==t.stdout&&e!==t.stderr,A=h?o:f;g.endEmitted?G.nextTick(A):u.once("end",A),e.on("unpipe",a);var v=w(u);e.on("drain",v);var m=!1,S=!1;return u.on("data",d),r(e,"error",l),e.once("close",s),e.once("finish",c),e.emit("pipe",u),g.flowing||(j("pipe resume"),u.resume()),e},l.prototype.unpipe=function(e){var n=this._readableState,t={hasUnpiped:!1};if(0===n.pipesCount)return this;if(1===n.pipesCount)return e&&e!==n.pipes?this:(e||(e=n.pipes),n.pipes=null,n.pipesCount=0,n.flowing=!1,e&&e.emit("unpipe",this,t),this);if(!e){var a=n.pipes,o=n.pipesCount;n.pipes=null,n.pipesCount=0,n.flowing=!1;for(var i=0;i<o;i++)a[i].emit("unpipe",this,t);return this}var r=T(n.pipes,e);return-1===r?this:(n.pipes.splice(r,1),n.pipesCount-=1,1===n.pipesCount&&(n.pipes=n.pipes[0]),e.emit("unpipe",this,t),this)},l.prototype.on=function(e,n){var t=k.prototype.on.call(this,e,n);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var a=this._readableState;a.endEmitted||a.readableListening||(a.readableListening=a.needReadable=!0,a.emittedReadable=!1,a.reading?a.length&&v(this):G.nextTick(E,this))}return t},l.prototype.addListener=l.prototype.on,l.prototype.resume=function(){var e=this._readableState;return e.flowing||(j("resume"),e.flowing=!0,y(this,e)),this},l.prototype.pause=function(){
return j("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(j("pause"),this._readableState.flowing=!1,this.emit("pause")),this},l.prototype.wrap=function(e){var n=this,t=this._readableState,a=!1;e.on("end",function(){if(j("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(o){if(j("wrapped data"),t.decoder&&(o=t.decoder.write(o)),(!t.objectMode||null!==o&&void 0!==o)&&(t.objectMode||o&&o.length)){n.push(o)||(a=!0,e.pause())}});for(var o in e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(n){return function(){return e[n].apply(e,arguments)}}(o));for(var i=0;i<J.length;i++)e.on(J[i],this.emit.bind(this,J[i]));return this._read=function(n){j("wrapped _read",n),a&&(a=!1,e.resume())},this},Object.defineProperty(l.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),l._fromList=x}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":18,"./internal/streams/BufferList":23,"./internal/streams/destroy":24,"./internal/streams/stream":25,_process:14,"core-util-is":7,events:8,inherits:11,isarray:13,"process-nextick-args":26,"safe-buffer":29,"string_decoder/":27,util:3}],21:[function(e,n,t){"use strict";function a(e,n){var t=this._transformState;t.transforming=!1;var a=t.writecb;if(!a)return this.emit("error",new Error("write callback called multiple times"));t.writechunk=null,t.writecb=null,null!=n&&this.push(n),a(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);d.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",i)}function i(){var e=this;"function"==typeof this._flush?this._flush(function(n,t){r(e,n,t)}):r(this,null,null)}function r(e,n,t){if(n)return e.emit("error",n);if(null!=t&&e.push(t),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}n.exports=o;var d=e("./_stream_duplex"),l=e("core-util-is");l.inherits=e("inherits"),l.inherits(o,d),o.prototype.push=function(e,n){return this._transformState.needTransform=!1,d.prototype.push.call(this,e,n)},o.prototype._transform=function(e,n,t){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,n,t){var a=this._transformState;if(a.writecb=t,a.writechunk=e,a.writeencoding=n,!a.transforming){var o=this._readableState;(a.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},o.prototype._read=function(e){var n=this._transformState;null!==n.writechunk&&n.writecb&&!n.transforming?(n.transforming=!0,this._transform(n.writechunk,n.writeencoding,n.afterTransform)):n.needTransform=!0},o.prototype._destroy=function(e,n){var t=this;d.prototype._destroy.call(this,e,function(e){n(e),t.emit("close")})}},{"./_stream_duplex":18,"core-util-is":7,inherits:11}],22:[function(e,n,t){(function(t,a,o){"use strict";function i(e){var n=this;this.next=null,this.entry=null,this.finish=function(){N(n,e)}}function r(e){return Q.from(e)}function d(e){return Q.isBuffer(e)||e instanceof V}function l(){}function s(n,t){I=I||e("./_stream_duplex"),n=n||{};var a=t instanceof I;this.objectMode=!!n.objectMode,a&&(this.objectMode=this.objectMode||!!n.writableObjectMode);var o=n.highWaterMark,r=n.writableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:a&&(r||0===r)?r:d,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===n.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=n.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){S(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function c(n){if(I=I||e("./_stream_duplex"),!(D.call(c,this)||this instanceof I))return new c(n);this._writableState=new s(n,this),this.writable=!0,n&&("function"==typeof n.write&&(this._write=n.write),"function"==typeof n.writev&&(this._writev=n.writev),"function"==typeof n.destroy&&(this._destroy=n.destroy),"function"==typeof n.final&&(this._final=n.final)),R.call(this)}function f(e,n){var t=new Error("write after end");e.emit("error",t),B.nextTick(n,t)}function u(e,n,t,a){var o=!0,i=!1;return null===t?i=new TypeError("May not write null values to stream"):"string"==typeof t||void 0===t||n.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),B.nextTick(a,i),o=!1),o}function g(e,n,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof n||(n=Q.from(n,t)),n}function h(e,n,t,a,o,i){if(!t){var r=g(n,a,o);a!==r&&(t=!0,o="buffer",a=r)}var d=n.objectMode?1:a.length;n.length+=d;var l=n.length<n.highWaterMark;if(l||(n.needDrain=!0),n.writing||n.corked){var s=n.lastBufferedRequest;n.lastBufferedRequest={chunk:a,encoding:o,isBuf:t,callback:i,next:null},s?s.next=n.lastBufferedRequest:n.bufferedRequest=n.lastBufferedRequest,n.bufferedRequestCount+=1}else A(e,n,!1,d,a,o,i);return l}function A(e,n,t,a,o,i,r){n.writelen=a,n.writecb=r,n.writing=!0,n.sync=!0,t?e._writev(o,n.onwrite):e._write(o,i,n.onwrite),n.sync=!1}function v(e,n,t,a,o){--n.pendingcb,t?(B.nextTick(o,a),B.nextTick(x,e,n),e._writableState.errorEmitted=!0,e.emit("error",a)):(o(a),e._writableState.errorEmitted=!0,e.emit("error",a),x(e,n))}function m(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function S(e,n){var t=e._writableState,a=t.sync,o=t.writecb;if(m(t),n)v(e,t,a,n,o);else{var i=y(t);i||t.corked||t.bufferProcessing||!t.bufferedRequest||E(e,t),a?O(p,e,t,i,o):p(e,t,i,o)}}function p(e,n,t,a){t||w(e,n),n.pendingcb--,a(),x(e,n)}function w(e,n){0===n.length&&n.needDrain&&(n.needDrain=!1,e.emit("drain"))}function E(e,n){n.bufferProcessing=!0;var t=n.bufferedRequest;if(e._writev&&t&&t.next){var a=n.bufferedRequestCount,o=new Array(a),r=n.corkedRequestsFree;r.entry=t;for(var d=0,l=!0;t;)o[d]=t,t.isBuf||(l=!1),t=t.next,d+=1;o.allBuffers=l,A(e,n,!0,n.length,o,"",r.finish),n.pendingcb++,n.lastBufferedRequest=null,r.next?(n.corkedRequestsFree=r.next,r.next=null):n.corkedRequestsFree=new i(n),n.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,c=t.encoding,f=t.callback;if(A(e,n,!1,n.objectMode?1:s.length,s,c,f),t=t.next,n.bufferedRequestCount--,n.writing)break}null===t&&(n.lastBufferedRequest=null)}n.bufferedRequest=t,n.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,n){e._final(function(t){n.pendingcb--,t&&e.emit("error",t),n.prefinished=!0,e.emit("prefinish"),x(e,n)})}function b(e,n){n.prefinished||n.finalCalled||("function"==typeof e._final?(n.pendingcb++,n.finalCalled=!0,B.nextTick(C,e,n)):(n.prefinished=!0,e.emit("prefinish")))}function x(e,n){var t=y(n);return t&&(b(e,n),0===n.pendingcb&&(n.finished=!0,e.emit("finish"))),t}function L(e,n,t){n.ending=!0,x(e,n),t&&(n.finished?B.nextTick(t):e.once("finish",t)),n.ended=!0,e.writable=!1}function N(e,n,t){var a=e.entry;for(e.entry=null;a;){var o=a.callback;n.pendingcb--,o(t),a=a.next}n.corkedRequestsFree?n.corkedRequestsFree.next=e:n.corkedRequestsFree=e}var B=e("process-nextick-args");n.exports=c;var I,O=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?o:B.nextTick;c.WritableState=s;var T=e("core-util-is");T.inherits=e("inherits");var G={deprecate:e("util-deprecate")},R=e("./internal/streams/stream"),Q=e("safe-buffer").Buffer,V=a.Uint8Array||function(){},k=e("./internal/streams/destroy");T.inherits(c,R),s.prototype.getBuffer=function(){for(var e=this.bufferedRequest,n=[];e;)n.push(e),e=e.next;return n},function(){try{Object.defineProperty(s.prototype,"buffer",{get:G.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var D;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(D=Function.prototype[Symbol.hasInstance],Object.defineProperty(c,Symbol.hasInstance,{value:function(e){return!!D.call(this,e)||this===c&&(e&&e._writableState instanceof s)}})):D=function(e){return e instanceof this},c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},c.prototype.write=function(e,n,t){var a=this._writableState,o=!1,i=!a.objectMode&&d(e);return i&&!Q.isBuffer(e)&&(e=r(e)),"function"==typeof n&&(t=n,n=null),i?n="buffer":n||(n=a.defaultEncoding),"function"!=typeof t&&(t=l),a.ended?f(this,t):(i||u(this,a,e,t))&&(a.pendingcb++,o=h(this,a,i,e,n,t)),o},c.prototype.cork=function(){this._writableState.corked++},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},c.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),c.prototype._write=function(e,n,t){t(new Error("_write() is not implemented"))},c.prototype._writev=null,c.prototype.end=function(e,n,t){var a=this._writableState;"function"==typeof e?(t=e,e=null,n=null):"function"==typeof n&&(t=n,n=null),null!==e&&void 0!==e&&this.write(e,n),a.corked&&(a.corked=1,this.uncork()),a.ending||a.finished||L(this,a,t)},Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),c.prototype.destroy=k.destroy,c.prototype._undestroy=k.undestroy,c.prototype._destroy=function(e,n){this.end(),n(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":18,"./internal/streams/destroy":24,"./internal/streams/stream":25,_process:14,"core-util-is":7,inherits:11,"process-nextick-args":26,"safe-buffer":29,timers:34,"util-deprecate":38}],23:[function(e,n,t){"use strict";function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n,t){e.copy(n,t)}var i=e("safe-buffer").Buffer,r=e("util");n.exports=function(){function e(){a(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var n={data:e,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},e.prototype.unshift=function(e){var n={data:e,next:this.head};0===this.length&&(this.tail=n),this.head=n,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var n=this.head,t=""+n.data;n=n.next;)t+=e+n.data;return t},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var n=i.allocUnsafe(e>>>0),t=this.head,a=0;t;)o(t.data,n,a),a+=t.data.length,t=t.next;return n},e}(),r&&r.inspect&&r.inspect.custom&&(n.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":29,util:3}],24:[function(e,n,t){"use strict";function a(e,n){var t=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(n?n(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!n&&e?(r.nextTick(i,t,e),t._writableState&&(t._writableState.errorEmitted=!0)):n&&n(e)}),this)}function o(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(e,n){e.emit("error",n)}var r=e("process-nextick-args");n.exports={destroy:a,undestroy:o}},{"process-nextick-args":26}],25:[function(e,n,t){n.exports=e("events").EventEmitter},{events:8}],26:[function(e,n,t){(function(e){"use strict";function t(n,t,a,o){if("function"!=typeof n)throw new TypeError('"callback" argument must be a function');var i,r,d=arguments.length;switch(d){case 0:case 1:return e.nextTick(n);case 2:return e.nextTick(function(){n.call(null,t)});case 3:return e.nextTick(function(){n.call(null,t,a)});case 4:return e.nextTick(function(){n.call(null,t,a,o)});default:for(i=new Array(d-1),r=0;r<i.length;)i[r++]=arguments[r];return e.nextTick(function(){n.apply(null,i)})}}!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?n.exports={nextTick:t}:n.exports=e}).call(this,e("_process"))},{_process:14}],27:[function(e,n,t){"use strict";function a(e){if(!e)return"utf8";for(var n;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(n)return;e=(""+e).toLowerCase(),n=!0}}function o(e){var n=a(e);if("string"!=typeof n&&(S.isEncoding===p||!p(e)))throw new Error("Unknown encoding: "+e);return n||e}function i(e){this.encoding=o(e);var n;switch(this.encoding){case"utf16le":this.text=u,this.end=g,n=4;break;case"utf8":this.fillLast=s,n=4;break;case"base64":this.text=h,this.end=A,n=3;break;default:return this.write=v,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=S.allocUnsafe(n)}function r(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function d(e,n,t){var a=n.length-1;if(a<t)return 0;var o=r(n[a]);return o>=0?(o>0&&(e.lastNeed=o-1),o):--a<t||-2===o?0:(o=r(n[a]))>=0?(o>0&&(e.lastNeed=o-2),o):--a<t||-2===o?0:(o=r(n[a]),o>=0?(o>0&&(2===o?o=0:e.lastNeed=o-3),o):0)}function l(e,n,t){if(128!=(192&n[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&n.length>1){if(128!=(192&n[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&n.length>2&&128!=(192&n[2]))return e.lastNeed=2,"�"}}function s(e){var n=this.lastTotal-this.lastNeed,t=l(this,e,n);return void 0!==t?t:this.lastNeed<=e.length?(e.copy(this.lastChar,n,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,n,0,e.length),void(this.lastNeed-=e.length))}function c(e,n){var t=d(this,e,n);if(!this.lastNeed)return e.toString("utf8",n);this.lastTotal=t;var a=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,a),e.toString("utf8",n,a)}function f(e){var n=e&&e.length?this.write(e):"";return this.lastNeed?n+"�":n}function u(e,n){if((e.length-n)%2==0){var t=e.toString("utf16le",n);if(t){var a=t.charCodeAt(t.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",n,e.length-1)}function g(e){var n=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return n+this.lastChar.toString("utf16le",0,t)}return n}function h(e,n){var t=(e.length-n)%3;return 0===t?e.toString("base64",n):(this.lastNeed=3-t,this.lastTotal=3,1===t?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",n,e.length-t))}function A(e){var n=e&&e.length?this.write(e):"";return this.lastNeed?n+this.lastChar.toString("base64",0,3-this.lastNeed):n}function v(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}var S=e("safe-buffer").Buffer,p=S.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};t.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var n,t;if(this.lastNeed){if(void 0===(n=this.fillLast(e)))return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?n?n+this.text(e,t):this.text(e,t):n||""},i.prototype.end=f,i.prototype.text=c,i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":29}],28:[function(e,n,t){t=n.exports=e("./lib/_stream_readable.js"),t.Stream=t,t.Readable=t,t.Writable=e("./lib/_stream_writable.js"),t.Duplex=e("./lib/_stream_duplex.js"),t.Transform=e("./lib/_stream_transform.js"),t.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":18,"./lib/_stream_passthrough.js":19,"./lib/_stream_readable.js":20,"./lib/_stream_transform.js":21,"./lib/_stream_writable.js":22}],29:[function(e,n,t){function a(e,n){for(var t in e)n[t]=e[t]}function o(e,n,t){return r(e,n,t)}var i=e("buffer"),r=i.Buffer;r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=i:(a(i,t),t.Buffer=o),a(r,o),o.from=function(e,n,t){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,n,t)},o.alloc=function(e,n,t){if("number"!=typeof e)throw new TypeError("Argument must be a number");var a=r(e);return void 0!==n?"string"==typeof t?a.fill(n,t):a.fill(n):a.fill(0),a},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:5}],30:[function(e,n,t){(function(n){var a=e("./lib/request"),o=e("./lib/response"),i=e("xtend"),r=e("builtin-status-codes"),d=e("url"),l=t;l.request=function(e,t){e="string"==typeof e?d.parse(e):i(e);var o=-1===n.location.protocol.search(/^https?:$/)?"http:":"",r=e.protocol||o,l=e.hostname||e.host,s=e.port,c=e.path||"/";l&&-1!==l.indexOf(":")&&(l="["+l+"]"),e.url=(l?r+"//"+l:"")+(s?":"+s:"")+c,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var f=new a(e);return t&&f.on("response",t),f},l.get=function(e,n){var t=l.request(e,n);return t.end(),t},l.ClientRequest=a,l.IncomingMessage=o.IncomingMessage,l.Agent=function(){},l.Agent.defaultMaxSockets=4,l.globalAgent=new l.Agent,l.STATUS_CODES=r,l.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":32,"./lib/response":33,"builtin-status-codes":6,url:36,xtend:39}],31:[function(e,n,t){(function(e){function n(){if(void 0!==i)return i;if(e.XMLHttpRequest){i=new e.XMLHttpRequest;try{i.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(n){i=null}}else i=null;return i}function a(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(a){}return!1}function o(e){return"function"==typeof e}t.fetch=o(e.fetch)&&o(e.ReadableStream),t.writableStream=o(e.WritableStream),t.abortController=o(e.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(l){}var i,r=void 0!==e.ArrayBuffer,d=r&&o(e.ArrayBuffer.prototype.slice);t.arraybuffer=t.fetch||r&&a("arraybuffer"),t.msstream=!t.fetch&&d&&a("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&r&&a("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!n()&&o(n().overrideMimeType),t.vbArray=o(e.VBArray),i=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(e,n,t){(function(t,a,o){function i(e,n){return d.fetch&&n?"fetch":d.mozchunkedarraybuffer?"moz-chunked-arraybuffer":d.msstream?"ms-stream":d.arraybuffer&&e?"arraybuffer":d.vbArray&&e?"text:vbarray":"text"}function r(e){try{var n=e.status;return null!==n&&0!==n}catch(t){return!1}}var d=e("./capability"),l=e("inherits"),s=e("./response"),c=e("readable-stream"),f=e("to-arraybuffer"),u=s.IncomingMessage,g=s.readyStates,h=n.exports=function(e){var n=this;c.Writable.call(n),n._opts=e,n._body=[],n._headers={},e.auth&&n.setHeader("Authorization","Basic "+new o(e.auth).toString("base64")),Object.keys(e.headers).forEach(function(t){n.setHeader(t,e.headers[t])});var t,a=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!d.abortController)a=!1,t=!0;else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!d.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}n._mode=i(t,a),n._fetchTimer=null,n.on("finish",function(){n._onFinish()})};l(h,c.Writable),h.prototype.setHeader=function(e,n){var t=this,a=e.toLowerCase();-1===A.indexOf(a)&&(t._headers[a]={name:e,value:n})},h.prototype.getHeader=function(e){var n=this._headers[e.toLowerCase()];return n?n.value:null},h.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},h.prototype._onFinish=function(){var e=this;if(!e._destroyed){var n=e._opts,i=e._headers,r=null;"GET"!==n.method&&"HEAD"!==n.method&&(r=d.arraybuffer?f(o.concat(e._body)):d.blobConstructor?new a.Blob(e._body.map(function(e){return f(e)}),{type:(i["content-type"]||{}).value||""}):o.concat(e._body).toString());var l=[];if(Object.keys(i).forEach(function(e){var n=i[e].name,t=i[e].value;Array.isArray(t)?t.forEach(function(e){l.push([n,e])}):l.push([n,t])}),"fetch"===e._mode){var s=null;if(d.abortController){var c=new AbortController;s=c.signal,e._fetchAbortController=c,"requestTimeout"in n&&0!==n.requestTimeout&&(e._fetchTimer=a.setTimeout(function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()},n.requestTimeout))}a.fetch(e._opts.url,{method:e._opts.method,headers:l,body:r||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:s}).then(function(n){e._fetchResponse=n,e._connect()},function(n){a.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",n)})}else{var u=e._xhr=new a.XMLHttpRequest;try{u.open(e._opts.method,e._opts.url,!0)}catch(h){return void t.nextTick(function(){e.emit("error",h)})}"responseType"in u&&(u.responseType=e._mode.split(":")[0]),"withCredentials"in u&&(u.withCredentials=!!n.withCredentials),"text"===e._mode&&"overrideMimeType"in u&&u.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(u.timeout=n.requestTimeout,u.ontimeout=function(){e.emit("requestTimeout")}),l.forEach(function(e){u.setRequestHeader(e[0],e[1])}),e._response=null,u.onreadystatechange=function(){switch(u.readyState){case g.LOADING:case g.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(u.onprogress=function(){e._onXHRProgress()}),u.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{u.send(r)}catch(h){return void t.nextTick(function(){e.emit("error",h)})}}}},h.prototype._onXHRProgress=function(){var e=this;r(e._xhr)&&!e._destroyed&&(e._response||e._connect(),e._response._onXHRProgress())},h.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",function(n){e.emit("error",n)}),e.emit("response",e._response))},h.prototype._write=function(e,n,t){this._body.push(e),t()},h.prototype.abort=h.prototype.destroy=function(){var e=this;e._destroyed=!0,a.clearTimeout(e._fetchTimer),e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort()},h.prototype.end=function(e,n,t){var a=this;"function"==typeof e&&(t=e,e=void 0),c.Writable.prototype.end.call(a,e,n,t)},h.prototype.flushHeaders=function(){},h.prototype.setTimeout=function(){},h.prototype.setNoDelay=function(){},h.prototype.setSocketKeepAlive=function(){};var A=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":31,"./response":33,_process:14,buffer:5,inherits:11,"readable-stream":28,"to-arraybuffer":35}],33:[function(e,n,t){(function(n,a,o){var i=e("./capability"),r=e("inherits"),d=e("readable-stream"),l=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},s=t.IncomingMessage=function(e,t,r,l){function s(){u.read().then(function(e){if(!c._destroyed){if(e.done)return a.clearTimeout(l),void c.push(null);c.push(new o(e.value)),s()}}).catch(function(e){a.clearTimeout(l),c._destroyed||c.emit("error",e)})}var c=this;if(d.Readable.call(c),c._mode=r,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",function(){n.nextTick(function(){c.emit("close")})}),"fetch"===r){if(c._fetchResponse=t,c.url=t.url,c.statusCode=t.status,c.statusMessage=t.statusText,t.headers.forEach(function(e,n){c.headers[n.toLowerCase()]=e,c.rawHeaders.push(n,e)}),i.writableStream){var f=new WritableStream({write:function(e){return new Promise(function(n,t){c._destroyed?t():c.push(new o(e))?n():c._resumeFetch=n})},close:function(){a.clearTimeout(l),c._destroyed||c.push(null)},abort:function(e){c._destroyed||c.emit("error",e)}});try{return void t.body.pipeTo(f).catch(function(e){a.clearTimeout(l),c._destroyed||c.emit("error",e)})}catch(A){}}var u=t.body.getReader();s()}else{c._xhr=e,c._pos=0,c.url=e.responseURL,c.statusCode=e.status,c.statusMessage=e.statusText;if(e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var n=e.match(/^([^:]+):\s*(.*)/);if(n){var t=n[1].toLowerCase();"set-cookie"===t?(void 0===c.headers[t]&&(c.headers[t]=[]),c.headers[t].push(n[2])):void 0!==c.headers[t]?c.headers[t]+=", "+n[2]:c.headers[t]=n[2],c.rawHeaders.push(n[1],n[2])}}),c._charset="x-user-defined",!i.overrideMimeType){var g=c.rawHeaders["mime-type"];if(g){var h=g.match(/;\s*charset=([^;])(;|$)/);h&&(c._charset=h[1].toLowerCase())}c._charset||(c._charset="utf-8")}}};r(s,d.Readable),s.prototype._read=function(){var e=this,n=e._resumeFetch;n&&(e._resumeFetch=null,n())},s.prototype._onXHRProgress=function(){var e=this,n=e._xhr,t=null;switch(e._mode){case"text:vbarray":if(n.readyState!==l.DONE)break;try{t=new a.VBArray(n.responseBody).toArray()}catch(c){}if(null!==t){e.push(new o(t));break}case"text":try{t=n.responseText}catch(c){e._mode="text:vbarray";break}if(t.length>e._pos){var i=t.substr(e._pos);if("x-user-defined"===e._charset){for(var r=new o(i.length),d=0;d<i.length;d++)r[d]=255&i.charCodeAt(d);e.push(r)}else e.push(i,e._charset);e._pos=t.length}break;case"arraybuffer":if(n.readyState!==l.DONE||!n.response)break;t=n.response,e.push(new o(new Uint8Array(t)));break;case"moz-chunked-arraybuffer":if(t=n.response,n.readyState!==l.LOADING||!t)break;e.push(new o(new Uint8Array(t)));break;case"ms-stream":if(t=n.response,n.readyState!==l.LOADING)break;var s=new a.MSStreamReader;s.onprogress=function(){s.result.byteLength>e._pos&&(e.push(new o(new Uint8Array(s.result.slice(e._pos)))),e._pos=s.result.byteLength)},s.onload=function(){e.push(null)},s.readAsArrayBuffer(t)}e._xhr.readyState===l.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":31,_process:14,buffer:5,inherits:11,"readable-stream":28}],34:[function(e,n,t){(function(n,a){function o(e,n){this._id=e,this._clearFn=n}var i=e("process/browser.js").nextTick,r=Function.prototype.apply,d=Array.prototype.slice,l={},s=0;t.setTimeout=function(){return new o(r.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,n){clearTimeout(e._idleTimeoutId),e._idleTimeout=n},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var n=e._idleTimeout;n>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},n))},t.setImmediate="function"==typeof n?n:function(e){var n=s++,a=!(arguments.length<2)&&d.call(arguments,1);return l[n]=!0,i(function(){l[n]&&(a?e.apply(null,a):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof a?a:function(e){delete l[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":14,timers:34}],35:[function(e,n,t){var a=e("buffer").Buffer;n.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(a.isBuffer(e)){for(var n=new Uint8Array(e.length),t=e.length,o=0;o<t;o++)n[o]=e[o];return n.buffer}throw new Error("Argument must be a Buffer")}},{buffer:5}],36:[function(e,n,t){"use strict";function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function o(e,n,t){if(e&&s.isObject(e)&&e instanceof a)return e;var o=new a;return o.parse(e,n,t),o}function i(e){return s.isString(e)&&(e=o(e)),e instanceof a?e.format():a.prototype.format.call(e)}function r(e,n){return o(e,!1,!0).resolve(n)}function d(e,n){return e?o(e,!1,!0).resolveObject(n):n}var l=e("punycode"),s=e("./util");t.parse=o,t.resolve=r,t.resolveObject=d,t.format=i,t.Url=a;var c=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,g=["<",">",'"',"`"," ","\r","\n","\t"],h=["{","}","|","\\","^","`"].concat(g),A=["'"].concat(h),v=["%","/","?",";","#"].concat(A),m=["/","?","#"],S=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=e("querystring");a.prototype.parse=function(e,n,t){if(!s.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),o=-1!==a&&a<e.indexOf("#")?"?":"#",i=e.split(o),r=/\\/g;i[0]=i[0].replace(r,"/"),e=i.join(o);var d=e;if(d=d.trim(),!t&&1===e.split("#").length){var f=u.exec(d);if(f)return this.path=d,this.href=d,this.pathname=f[1],f[2]?(this.search=f[2],this.query=n?C.parse(this.search.substr(1)):this.search.substr(1)):n&&(this.search="",
this.query={}),this}var g=c.exec(d);if(g){g=g[0];var h=g.toLowerCase();this.protocol=h,d=d.substr(g.length)}if(t||g||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var b="//"===d.substr(0,2);!b||g&&E[g]||(d=d.substr(2),this.slashes=!0)}if(!E[g]&&(b||g&&!y[g])){for(var x=-1,L=0;L<m.length;L++){var N=d.indexOf(m[L]);-1!==N&&(-1===x||N<x)&&(x=N)}var B,I;I=-1===x?d.lastIndexOf("@"):d.lastIndexOf("@",x),-1!==I&&(B=d.slice(0,I),d=d.slice(I+1),this.auth=decodeURIComponent(B)),x=-1;for(var L=0;L<v.length;L++){var N=d.indexOf(v[L]);-1!==N&&(-1===x||N<x)&&(x=N)}-1===x&&(x=d.length),this.host=d.slice(0,x),d=d.slice(x),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var T=this.hostname.split(/\./),L=0,G=T.length;L<G;L++){var R=T[L];if(R&&!R.match(S)){for(var Q="",V=0,k=R.length;V<k;V++)R.charCodeAt(V)>127?Q+="x":Q+=R[V];if(!Q.match(S)){var D=T.slice(0,L),F=T.slice(L+1),P=R.match(p);P&&(D.push(P[1]),F.unshift(P[2])),F.length&&(d="/"+F.join(".")+d),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=l.toASCII(this.hostname));var U=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+U,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!w[h])for(var L=0,G=A.length;L<G;L++){var q=A[L];if(-1!==d.indexOf(q)){var z=encodeURIComponent(q);z===q&&(z=escape(q)),d=d.split(q).join(z)}}var H=d.indexOf("#");-1!==H&&(this.hash=d.substr(H),d=d.slice(0,H));var J=d.indexOf("?");if(-1!==J?(this.search=d.substr(J),this.query=d.substr(J+1),n&&(this.query=C.parse(this.query)),d=d.slice(0,J)):n&&(this.search="",this.query={}),d&&(this.pathname=d),y[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",K=this.search||"";this.path=U+K}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var n=this.protocol||"",t=this.pathname||"",a=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(i=C.stringify(this.query));var r=this.search||i&&"?"+i||"";return n&&":"!==n.substr(-1)&&(n+=":"),this.slashes||(!n||y[n])&&!1!==o?(o="//"+(o||""),t&&"/"!==t.charAt(0)&&(t="/"+t)):o||(o=""),a&&"#"!==a.charAt(0)&&(a="#"+a),r&&"?"!==r.charAt(0)&&(r="?"+r),t=t.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),r=r.replace("#","%23"),n+o+t+r+a},a.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(s.isString(e)){var n=new a;n.parse(e,!1,!0),e=n}for(var t=new a,o=Object.keys(this),i=0;i<o.length;i++){var r=o[i];t[r]=this[r]}if(t.hash=e.hash,""===e.href)return t.href=t.format(),t;if(e.slashes&&!e.protocol){for(var d=Object.keys(e),l=0;l<d.length;l++){var c=d[l];"protocol"!==c&&(t[c]=e[c])}return y[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=t.format(),t}if(e.protocol&&e.protocol!==t.protocol){if(!y[e.protocol]){for(var f=Object.keys(e),u=0;u<f.length;u++){var g=f[u];t[g]=e[g]}return t.href=t.format(),t}if(t.protocol=e.protocol,e.host||E[e.protocol])t.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),t.pathname=h.join("/")}if(t.search=e.search,t.query=e.query,t.host=e.host||"",t.auth=e.auth,t.hostname=e.hostname||e.host,t.port=e.port,t.pathname||t.search){var A=t.pathname||"",v=t.search||"";t.path=A+v}return t.slashes=t.slashes||e.slashes,t.href=t.format(),t}var m=t.pathname&&"/"===t.pathname.charAt(0),S=e.host||e.pathname&&"/"===e.pathname.charAt(0),p=S||m||t.host&&e.pathname,w=p,C=t.pathname&&t.pathname.split("/")||[],h=e.pathname&&e.pathname.split("/")||[],b=t.protocol&&!y[t.protocol];if(b&&(t.hostname="",t.port=null,t.host&&(""===C[0]?C[0]=t.host:C.unshift(t.host)),t.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),p=p&&(""===h[0]||""===C[0])),S)t.host=e.host||""===e.host?e.host:t.host,t.hostname=e.hostname||""===e.hostname?e.hostname:t.hostname,t.search=e.search,t.query=e.query,C=h;else if(h.length)C||(C=[]),C.pop(),C=C.concat(h),t.search=e.search,t.query=e.query;else if(!s.isNullOrUndefined(e.search)){if(b){t.hostname=t.host=C.shift();var x=!!(t.host&&t.host.indexOf("@")>0)&&t.host.split("@");x&&(t.auth=x.shift(),t.host=t.hostname=x.shift())}return t.search=e.search,t.query=e.query,s.isNull(t.pathname)&&s.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.href=t.format(),t}if(!C.length)return t.pathname=null,t.search?t.path="/"+t.search:t.path=null,t.href=t.format(),t;for(var L=C.slice(-1)[0],N=(t.host||e.host||C.length>1)&&("."===L||".."===L)||""===L,B=0,I=C.length;I>=0;I--)L=C[I],"."===L?C.splice(I,1):".."===L?(C.splice(I,1),B++):B&&(C.splice(I,1),B--);if(!p&&!w)for(;B--;B)C.unshift("..");!p||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),N&&"/"!==C.join("/").substr(-1)&&C.push("");var O=""===C[0]||C[0]&&"/"===C[0].charAt(0);if(b){t.hostname=t.host=O?"":C.length?C.shift():"";var x=!!(t.host&&t.host.indexOf("@")>0)&&t.host.split("@");x&&(t.auth=x.shift(),t.host=t.hostname=x.shift())}return p=p||t.host&&C.length,p&&!O&&C.unshift(""),C.length?t.pathname=C.join("/"):(t.pathname=null,t.path=null),s.isNull(t.pathname)&&s.isNull(t.search)||(t.path=(t.pathname?t.pathname:"")+(t.search?t.search:"")),t.auth=e.auth||t.auth,t.slashes=t.slashes||e.slashes,t.href=t.format(),t},a.prototype.parseHost=function(){var e=this.host,n=f.exec(e);n&&(n=n[0],":"!==n&&(this.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(this.hostname=e)}},{"./util":37,punycode:4,querystring:17}],37:[function(e,n,t){"use strict";n.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],38:[function(e,n,t){(function(e){function t(e,n){function t(){if(!o){if(a("throwDeprecation"))throw new Error(n);a("traceDeprecation")?console.trace(n):console.warn(n),o=!0}return e.apply(this,arguments)}if(a("noDeprecation"))return e;var o=!1;return t}function a(n){try{if(!e.localStorage)return!1}catch(a){return!1}var t=e.localStorage[n];return null!=t&&"true"===String(t).toLowerCase()}n.exports=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,n,t){function a(){for(var e={},n=0;n<arguments.length;n++){var t=arguments[n];for(var a in t)o.call(t,a)&&(e[a]=t[a])}return e}n.exports=a;var o=Object.prototype.hasOwnProperty},{}]},{},[1])(1)}),function(e){e.version={versionStr:"2.4.1",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("1",10)};var n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},t=Object.prototype.toString,a=Object.prototype.hasOwnProperty;e.isFunction=function(n){return"function"===e.type(n)},e.isArray=Array.isArray||function(n){return"array"===e.type(n)},e.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},e.type=function(e){return null===e||void 0===e?String(e):n[t.call(e)]||"object"},e.isPlainObject=function(n){if(!n||"object"!==OpenSeadragon.type(n)||n.nodeType||e.isWindow(n))return!1;if(n.constructor&&!a.call(n,"constructor")&&!a.call(n.constructor.prototype,"isPrototypeOf"))return!1;var t;for(var o in n)t=o;return void 0===t||a.call(n,t)},e.isEmptyObject=function(e){for(var n in e)return!1;return!0},e.freezeObject=function(n){return Object.freeze?e.freezeObject=Object.freeze:e.freezeObject=function(e){return e},e.freezeObject(n)},e.supportsCanvas=function(){var n=document.createElement("canvas");return!(!e.isFunction(n.getContext)||!n.getContext("2d"))}(),e.isCanvasTainted=function(e){var n=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(t){n=!0}return n},e.pixelDensityRatio=function(){if(e.supportsCanvas){var n=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,a=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;return Math.max(t,1)/a}return 1}()}(OpenSeadragon),function($){function getOffsetParent(e,n){return n&&e!=document.body?document.body:e.offsetParent}$.extend=function(){var e,n,t,a,o,i,r=arguments[0]||{},d=arguments.length,l=!1,s=1;for("boolean"==typeof r&&(l=r,r=arguments[1]||{},s=2),"object"==typeof r||OpenSeadragon.isFunction(r)||(r={}),d===s&&(r=this,--s);s<d;s++)if(null!==(e=arguments[s])||void 0!==e)for(n in e)t=r[n],a=e[n],r!==a&&(l&&a&&(OpenSeadragon.isPlainObject(a)||(o=OpenSeadragon.isArray(a)))?(o?(o=!1,i=t&&OpenSeadragon.isArray(t)?t:[]):i=t&&OpenSeadragon.isPlainObject(t)?t:{},r[n]=OpenSeadragon.extend(l,i,a)):void 0!==a&&(r[n]=a));return r};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var e=navigator.userAgent;return"string"==typeof e&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(e,n){return function(){var t=arguments;return void 0===t&&(t=[]),n.apply(e,t)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(e){var n,t,a=new $.Point;for(e=$.getElement(e),n="fixed"==$.getElementStyle(e).position,t=getOffsetParent(e,n);t;)a.x+=e.offsetLeft,a.y+=e.offsetTop,n&&(a=a.plus($.getPageScroll())),e=t,n="fixed"==$.getElementStyle(e).position,t=getOffsetParent(e,n);return a},getElementOffset:function(e){e=$.getElement(e);var n,t,a=e&&e.ownerDocument,o={top:0,left:0};return a?(n=a.documentElement,void 0!==e.getBoundingClientRect&&(o=e.getBoundingClientRect()),t=a==a.window?a:9===a.nodeType&&(a.defaultView||a.parentWindow),new $.Point(o.left+(t.pageXOffset||n.scrollLeft)-(n.clientLeft||0),o.top+(t.pageYOffset||n.scrollTop)-(n.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return e=$.getElement(e),e.currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var n={};return $.getCssPropertyWithVendorPrefix=function(e){if(void 0!==n[e])return n[e];var t=document.createElement("div").style,a=null;if(void 0!==t[e])a=e;else for(var o=["Webkit","Moz","MS","O","webkit","moz","ms","o"],i=$.capitalizeFirstLetter(e),r=0;r<o.length;r++){var d=o[r]+i;if(void 0!==t[d]){a=d;break}}return n[e]=a,a},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,n){var t=e%n;return t<0&&(t+=n),t},pointInElement:function(e,n){e=$.getElement(e);var t=$.getElementOffset(e),a=$.getElementSize(e);return n.x>=t.x&&n.x<t.x+a.x&&n.y<t.y+a.y&&n.y>=t.y},getEvent:function(e){return $.getEvent=e?function(e){return e}:function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if("number"==typeof e.pageX)$.getMousePosition=function(e){var n=new $.Point;return e=$.getEvent(e),n.x=e.pageX,n.y=e.pageY,n};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(e){var n=new $.Point;return e=$.getEvent(e),n.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,n}}return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},n=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(n.scrollLeft||n.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(e){if(void 0!==window.scrollTo)$.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var n=$.getPageScroll();if(n.x===e.x&&n.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var t=$.getPageScroll();if(t.x!==n.x&&t.y!==n.y)return void($.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,t=$.getPageScroll(),t.x!==n.x&&t.y!==n.y)return void($.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});$.setPageScroll=function(e){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},n=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!n.clientWidth&&!n.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var n=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(n[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(n[1].style,{display:"table-row"}),$.extend(n[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),n[0].appendChild(n[1]),n[1].appendChild(n[2]),n[2].appendChild(e),n[0]},makeNeutralElement:function(e){var n=document.createElement(e),t=n.style;return t.background="transparent none",t.border="none",t.margin="0px",t.padding="0px",t.position="static",n},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(e){var n=$.makeNeutralElement("img");return n.src=e,n},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(e){var n=$.makeNeutralElement("img"),t=null;return t=$.makeNeutralElement("span"),t.style.display="inline-block",n.onload=function(){t.style.width=t.style.width||n.width+"px",t.style.height=t.style.height||n.height+"px",n.onload=null,n=null},n.src=e,t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')",t}),$.makeTransparentImage(e)},setElementOpacity:function(e,n,t){var a,o;e=$.getElement(e),t&&!$.Browser.alpha&&(n=Math.round(n)),$.Browser.opacity?e.style.opacity=n<1?n:"":n<1?(a=Math.round(100*n),o="alpha(opacity="+a+")",e.style.filter=o):e.style.filter=""},setElementTouchActionNone:function(e){e=$.getElement(e),void 0!==e.style.touchAction?e.style.touchAction="none":void 0!==e.style.msTouchAction&&(e.style.msTouchAction="none")},addClass:function(e,n){e=$.getElement(e),e.className?-1===(" "+e.className+" ").indexOf(" "+n+" ")&&(e.className+=" "+n):e.className=n},indexOf:function(e,n,t){return Array.prototype.indexOf?this.indexOf=function(e,n,t){return e.indexOf(n,t)}:this.indexOf=function(e,n,t){var a,o,i=t||0;if(!e)throw new TypeError;if(0===(o=e.length)||i>=o)return-1;for(i<0&&(i=o-Math.abs(i)),a=i;a<o;a++)if(e[a]===n)return a;return-1},this.indexOf(e,n,t)},removeClass:function(e,n){var t,a,o=[];for(e=$.getElement(e),t=e.className.split(/\s+/),a=0;a<t.length;a++)t[a]&&t[a]!==n&&o.push(t[a]);e.className=o.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,n,t,a){e=$.getElement(e),e.addEventListener(n,t,a)};if(window.attachEvent)return function(e,n,t,a){e=$.getElement(e),e.attachEvent("on"+n,t)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,n,t,a){e=$.getElement(e),e.removeEventListener(n,t,a)};if(window.detachEvent)return function(e,n,t,a){e=$.getElement(e),e.detachEvent("on"+n,t)};throw new Error("No known event model.")}(),cancelEvent:function(e){e=$.getEvent(e),e.preventDefault?$.cancelEvent=function(e){e.preventDefault()}:$.cancelEvent=function(e){e=$.getEvent(e),e.cancel=!0,e.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){e=$.getEvent(e),e.stopPropagation?$.stopEvent=function(e){e.stopPropagation()}:$.stopEvent=function(e){e=$.getEvent(e),e.cancelBubble=!0},$.stopEvent(e)},createCallback:function(e,n){var t,a=[];for(t=2;t<arguments.length;t++)a.push(arguments[t]);return function(){var t,o=a.concat([]);for(t=0;t<arguments.length;t++)o.push(arguments[t]);return n.apply(e,o)}},getUrlParameter:function(e){var n=URLPARAMS[e];return n||null},getUrlProtocol:function(e){var n=e.match(/^([a-z]+:)\/\//i);return null===n?window.location.protocol:n[1].toLowerCase()},createAjaxRequest:function(e){var n;try{n=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(t){n=!1}if(n)window.XMLHttpRequest?$.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(e)},makeAjaxRequest:function(e,n,t){var a,o,i;$.isPlainObject(e)&&(n=e.success,t=e.error,a=e.withCredentials,o=e.headers,i=e.responseType||null,e=e.url);var r=$.getUrlProtocol(e),d=$.createAjaxRequest("file:"===r);if(!$.isFunction(n))throw new Error("makeAjaxRequest requires a success callback");d.onreadystatechange=function(){4==d.readyState&&(d.onreadystatechange=function(){},d.status>=200&&d.status<300||0===d.status&&"http:"!==r&&"https:"!==r?n(d):($.console.log("AJAX request returned %d: %s",d.status,e),$.isFunction(t)&&t(d)))};try{if(d.open("GET",e,!0),i&&(d.responseType=i),o)for(var l in o)o.hasOwnProperty(l)&&o[l]&&d.setRequestHeader(l,o[l]);a&&(d.withCredentials=!0),d.send(null)}catch(u){var s=u.message,c=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10;if(c&&void 0!==u.number&&-2147024891==u.number&&(s+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",u.name,s),d.onreadystatechange=function(){},window.XDomainRequest){var f=new XDomainRequest;if(f){f.onload=function(e){$.isFunction(n)&&n({responseText:f.responseText,status:200,statusText:"OK"})},f.onerror=function(e){$.isFunction(t)&&t({responseText:f.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{f.open("GET",e),f.send()}catch(g){$.isFunction(t)&&t(d,u)}}}else $.isFunction(t)&&t(d,u)}return d},jsonp:function(e){var n,t=e.url,a=document.head||document.getElementsByTagName("head")[0]||document.documentElement,o=e.callbackName||"openseadragon"+$.now(),i=window[o],r="$1"+o+"$2",d=e.param||"callback",l=e.callback;t=t.replace(/(\=)\?(&|$)|\?\?/i,r),t+=(/\?/.test(t)?"&":"?")+d+"="+o,window[o]=function(e){if(i)window[o]=i;else try{delete window[o]}catch(n){}l&&$.isFunction(l)&&l(e)},n=document.createElement("script"),void 0===e.async&&!1===e.async||(n.async="async"),e.scriptCharset&&(n.charset=e.scriptCharset),n.src=t,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,a&&n.parentNode&&a.removeChild(n),n=void 0)},a.insertBefore(n,a.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(e){var n;return n=new DOMParser,n.parseFromString(e,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(e){var n=null;return n=new ActiveXObject("Microsoft.XMLDOM"),n.async=!1,n.loadXML(e),n}}return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return e=e||"",!!FILEFORMATS[e.toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var e,n=navigator.appVersion,t=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(t.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):t.indexOf("Safari")>=0?($.Browser.vendor=t.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==e.exec(t)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(n)}var a,o,i,r=window.location.search.substring(1),d=r.split("&");for(i=0;i<d.length;i++)a=d[i],(o=a.indexOf("="))>0&&(URLPARAMS[a.substring(0,o)]=decodeURIComponent(a.substring(o+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(e){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(e){var n=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,t=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(n&&t)$.requestAnimationFrame=function(){return n.apply(e,arguments)},$.cancelAnimationFrame=function(){return t.apply(e,arguments)};else{var a,o=[],i=[],r=0;$.requestAnimationFrame=function(e){return o.push([++r,e]),a||(a=setInterval(function(){if(o.length){var e=$.now(),n=i;for(i=o,o=n;i.length;)i.shift()[1](e)}else clearInterval(a),a=void 0},20)),r},$.cancelAnimationFrame=function(e){var n,t;for(n=0,t=o.length;n<t;n+=1)if(o[n][0]===e)return void o.splice(n,1);for(n=0,t=i.length;n<t;n+=1)if(i[n][0]===e)return void i.splice(n,1)}}}(window)}(OpenSeadragon),function(e,n){"function"==typeof define&&define.amd?define([],n):"object"==typeof module&&module.exports?module.exports=n():e.OpenSeadragon=n()}(this,function(){return OpenSeadragon}),function(e){var n={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.fullscreenElement},n.requestFullScreen=function(e){return e.requestFullscreen()},n.exitFullScreen=function(){document.exitFullscreen()},n.fullScreenEventName="fullscreenchange",n.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.msFullscreenElement},n.requestFullScreen=function(e){return e.msRequestFullscreen()},n.exitFullScreen=function(){document.msExitFullscreen()},n.fullScreenEventName="MSFullscreenChange",n.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitFullscreenElement},n.requestFullScreen=function(e){return e.webkitRequestFullscreen()},n.exitFullScreen=function(){document.webkitExitFullscreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},n.requestFullScreen=function(e){return e.webkitRequestFullScreen()},n.exitFullScreen=function(){document.webkitCancelFullScreen()},n.fullScreenEventName="webkitfullscreenchange",n.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(n.supportsFullScreen=!0,n.getFullScreenElement=function(){return document.mozFullScreenElement},n.requestFullScreen=function(e){return e.mozRequestFullScreen()},n.exitFullScreen=function(){document.mozCancelFullScreen()},n.fullScreenEventName="mozfullscreenchange",n.fullScreenErrorEventName="mozfullscreenerror"),n.isFullScreen=function(){return null!==n.getFullScreenElement()},n.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),n.exitFullScreen()},e.extend(e,n)}(OpenSeadragon),function(e){e.EventSource=function(){this.events={}},e.EventSource.prototype={addOnceHandler:function(e,n,t,a){var o=this;a=a||1;var i=0,r=function(t){i++,i===a&&o.removeHandler(e,r),n(t)};this.addHandler(e,r,t)},addHandler:function(n,t,a){var o=this.events[n];o||(this.events[n]=o=[]),t&&e.isFunction(t)&&(o[o.length]={handler:t,userData:a||null})},removeHandler:function(n,t){var a,o=this.events[n],i=[];if(o&&e.isArray(o)){for(a=0;a<o.length;a++)o[a].handler!==t&&i.push(o[a]);this.events[n]=i}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var n in this.events)this.events[n]=[]},getHandler:function(e){var n=this.events[e];return n&&n.length?(n=1===n.length?[n[0]]:Array.apply(null,n),function(e,t){var a,o=n.length;for(a=0;a<o;a++)n[a]&&(t.eventSource=e,t.userData=n[a].userData,n[a].handler(t))}):null},raiseEvent:function(e,n){var t=this.getHandler(e);t&&(n||(n={}),t(this,n))}}}(OpenSeadragon),function(e){function n(n){var t,a=Ae[n.hash],o=a.activePointersLists.length;for(t=0;t<o;t++)a.activePointersLists[t].captureCount>0&&(e.removeEvent(e.MouseTracker.captureElement,"mousemove",a.mousemovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"mouseup",a.mouseupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",a.pointermovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",a.pointerupcaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchmove",a.touchmovecaptured,!0),e.removeEvent(e.MouseTracker.captureElement,"touchend",a.touchendcaptured,!0),a.activePointersLists[t].captureCount=0);for(t=0;t<o;t++)a.activePointersLists.pop()}function t(t){var a,o,i=Ae[t.hash];if(!i.tracking){for(o=0;o<e.MouseTracker.subscribeEvents.length;o++)a=e.MouseTracker.subscribeEvents[o],e.addEvent(t.element,a,i[a],!1);n(t),i.tracking=!0}}function a(t){var a,o,i=Ae[t.hash];if(i.tracking){for(o=0;o<e.MouseTracker.subscribeEvents.length;o++)a=e.MouseTracker.subscribeEvents[o],e.removeEvent(t.element,a,i[a],!1);n(t),i.tracking=!1}}function o(n,t){var a=Ae[n.hash];if("pointerevent"===t)return{upName:e.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:a.pointerupcaptured,moveName:e.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:a.pointermovecaptured};if("mouse"===t)return{upName:"mouseup",upHandler:a.mouseupcaptured,moveName:"mousemove",
moveHandler:a.mousemovecaptured};if("touch"===t)return{upName:"touchend",upHandler:a.touchendcaptured,moveName:"touchmove",moveHandler:a.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function i(n,t,a){var i,r=n.getActivePointersListByType(t);r.captureCount+=a||1,1===r.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?n.element.setCapture(!0):(i=o(n,e.MouseTracker.havePointerEvents?"pointerevent":t),ve&&ge(window.top)&&e.addEvent(window.top,i.upName,i.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,i.upName,i.upHandler,!0),e.addEvent(e.MouseTracker.captureElement,i.moveName,i.moveHandler,!0)))}function r(n,t,a){var i,r=n.getActivePointersListByType(t);r.captureCount-=a||1,0===r.captureCount&&(e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?n.element.releaseCapture():(i=o(n,e.MouseTracker.havePointerEvents?"pointerevent":t),ve&&ge(window.top)&&e.removeEvent(window.top,i.upName,i.upHandler,!0),e.removeEvent(e.MouseTracker.captureElement,i.moveName,i.moveHandler,!0),e.removeEvent(e.MouseTracker.captureElement,i.upName,i.upHandler,!0)))}function d(n){var t;if(e.MouseTracker.unprefixedPointerEvents)t=n.pointerType;else switch(n.pointerType){case 2:t="touch";break;case 3:t="pen";break;case 4:t="mouse";break;default:t=""}return t}function l(n){return e.getMousePosition(n)}function s(e,n){return c(l(e),n)}function c(n,t){var a=e.getElementOffset(t);return n.minus(a)}function f(n,t){return new e.Point((n.x+t.x)/2,(n.y+t.y)/2)}function u(n,t){n.clickHandler&&e.cancelEvent(t)}function g(n,t){n.dblClickHandler&&e.cancelEvent(t)}function h(n,t){n.keyDownHandler&&(t=e.getEvent(t),n.keyDownHandler({eventSource:n,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:n.userData})||e.cancelEvent(t))}function A(n,t){n.keyUpHandler&&(t=e.getEvent(t),n.keyUpHandler({eventSource:n,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:n.userData})||e.cancelEvent(t))}function v(n,t){n.keyHandler&&(t=e.getEvent(t),n.keyHandler({eventSource:n,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:n.userData})||e.cancelEvent(t))}function m(n,t){n.focusHandler&&(t=e.getEvent(t),!1===n.focusHandler({eventSource:n,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t))}function S(n,t){n.blurHandler&&(t=e.getEvent(t),!1===n.blurHandler({eventSource:n,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t))}function p(e,n){E(e,n,n)}function w(n,t){t=e.getEvent(t);var a={target:t.target||t.srcElement,type:"wheel",shiftKey:t.shiftKey||!1,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX?t.pageX:t.clientX,pageY:t.pageY?t.pageY:t.clientY,deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==e.MouseTracker.wheelEventName?a.deltaY=-t.wheelDelta/e.DEFAULT_SETTINGS.pixelsPerWheelLine:a.deltaY=t.detail,E(n,a,t)}function E(n,t,a){var o=0;o=t.deltaY<0?1:-1,n.scrollHandler&&!1===n.scrollHandler({eventSource:n,pointerType:"mouse",position:s(t,n.element),scroll:o,shift:t.shiftKey,isTouchEvent:!1,originalEvent:a,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(a)}function y(e,n){if(e===n)return!1;for(;n&&n!==e;)n=n.parentNode;return n===e}function C(n,t){t=e.getEvent(t),x(n,t)}function b(n,t){t=e.getEvent(t),t.currentTarget===t.relatedTarget||y(t.currentTarget,t.relatedTarget)||x(n,t)}function x(n,t){re(n,t,[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:l(t),currentTime:e.now()}])}function L(n,t){t=e.getEvent(t),B(n,t)}function N(n,t){t=e.getEvent(t),t.currentTarget===t.relatedTarget||y(t.currentTarget,t.relatedTarget)||B(n,t)}function B(n,t){de(n,t,[{id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:l(t),currentTime:e.now()}])}function I(n){return e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?1===n?0:2===n?2:4===n?1:-1:n}function O(n,t){var a;t=e.getEvent(t),a={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:l(t),currentTime:e.now()},le(n,t,[a],I(t.button))&&(e.stopEvent(t),i(n,"mouse")),(n.clickHandler||n.dblClickHandler||n.pressHandler||n.dragHandler||n.dragEndHandler)&&e.cancelEvent(t)}function T(e,n){R(e,n)}function G(n,t){R(n,t),e.stopEvent(t)}function R(n,t){var a;t=e.getEvent(t),a={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:l(t),currentTime:e.now()},se(n,t,[a],I(t.button))&&r(n,"mouse")}function Q(e,n){k(e,n)}function V(n,t){k(n,t),e.stopEvent(t)}function k(n,t){var a;t=e.getEvent(t),a={id:e.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:l(t),currentTime:e.now()},ce(n,t,[a])}function D(e,n,t){var a,o=t.getLength(),i=[];if("touch"===t.type||t.contacts>0){for(a=0;a<o;a++)i.push(t.getByIndex(a));i.length>0&&(se(e,n,i,0),t.captureCount=1,r(e,t.type),de(e,n,i))}}function F(n,t){var a,o,r,d,s=t.changedTouches.length,c=[],f=n.getActivePointersListByType("touch");for(a=e.now(),f.getLength()>t.touches.length-s&&(e.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),D(n,t,f)),o=0;o<s;o++)c.push({id:t.changedTouches[o].identifier,type:"touch",currentPos:l(t.changedTouches[o]),currentTime:a});for(re(n,t,c),o=0;o<he.length;o++)if(he[o]!==n&&he[o].isTracking()&&y(he[o].element,n.element)){for(d=[],r=0;r<s;r++)d.push({id:t.changedTouches[r].identifier,type:"touch",currentPos:l(t.changedTouches[r]),currentTime:a});re(he[o],t,d)}le(n,t,c,0)&&(e.stopEvent(t),i(n,"touch",s)),e.cancelEvent(t)}function P(e,n){j(e,n)}function U(n,t){j(n,t),e.stopEvent(t)}function j(n,t){var a,o,i,d,s=t.changedTouches.length,c=[];for(a=e.now(),o=0;o<s;o++)c.push({id:t.changedTouches[o].identifier,type:"touch",currentPos:l(t.changedTouches[o]),currentTime:a});for(se(n,t,c,0)&&r(n,"touch",s),de(n,t,c),o=0;o<he.length;o++)if(he[o]!==n&&he[o].isTracking()&&y(he[o].element,n.element)){for(d=[],i=0;i<s;i++)d.push({id:t.changedTouches[i].identifier,type:"touch",currentPos:l(t.changedTouches[i]),currentTime:a});de(he[o],t,d)}e.cancelEvent(t)}function q(e,n){H(e,n)}function z(n,t){H(n,t),e.stopEvent(t)}function H(n,t){var a,o=t.changedTouches.length,i=[];for(a=0;a<o;a++)i.push({id:t.changedTouches[a].identifier,type:"touch",currentPos:l(t.changedTouches[a]),currentTime:e.now()});ce(n,t,i),e.cancelEvent(t)}function J(e,n){D(e,n,e.getActivePointersListByType("touch"))}function K(e,n){return n.stopPropagation(),n.preventDefault(),!1}function M(e,n){return n.stopPropagation(),n.preventDefault(),!1}function W(n,t){var a;t.currentTarget===t.relatedTarget||y(t.currentTarget,t.relatedTarget)||(a={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:l(t),currentTime:e.now()},re(n,t,[a]))}function X(n,t){var a;t.currentTarget===t.relatedTarget||y(t.currentTarget,t.relatedTarget)||(a={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:l(t),currentTime:e.now()},de(n,t,[a]))}function Y(n,t){var a;a={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:l(t),currentTime:e.now()},le(n,t,[a],t.button)&&(e.stopEvent(t),i(n,a.type)),(n.clickHandler||n.dblClickHandler||n.pressHandler||n.dragHandler||n.dragEndHandler||n.pinchHandler)&&e.cancelEvent(t)}function Z(e,n){_(e,n)}function $(n,t){n.getActivePointersListByType(d(t)).getById(t.pointerId)&&_(n,t),e.stopEvent(t)}function _(n,t){var a;a={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:l(t),currentTime:e.now()},se(n,t,[a],t.button)&&r(n,a.type)}function ee(e,n){te(e,n)}function ne(n,t){n.getActivePointersListByType(d(t)).getById(t.pointerId)&&te(n,t),e.stopEvent(t)}function te(n,t){var a;a={id:t.pointerId,type:d(t),isPrimary:t.isPrimary,currentPos:l(t),currentTime:e.now()},ce(n,t,[a])}function ae(e,n){var t;t={id:n.pointerId,type:d(n)},fe(e,n,[t])}function oe(e,n){return n.hasOwnProperty("isPrimary")||(0===e.getLength()?n.isPrimary=!0:n.isPrimary=!1),n.speed=0,n.direction=0,n.contactPos=n.currentPos,n.contactTime=n.currentTime,n.lastPos=n.currentPos,n.lastTime=n.currentTime,e.add(n)}function ie(e,n){var t,a;return e.getById(n.id)?(t=e.removeById(n.id),n.hasOwnProperty("isPrimary")||(a=e.getPrimary())||(a=e.getByIndex(0))&&(a.isPrimary=!0)):t=e.getLength(),t}function re(n,t,a){var o,i,r,d=n.getActivePointersListByType(a[0].type),l=a.length;for(o=0;o<l;o++)i=a[o],r=d.getById(i.id),r?(r.insideElement=!0,r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=i.currentPos,r.currentTime=i.currentTime,i=r):(i.captured=!1,i.insideElementPressed=!1,i.insideElement=!0,oe(d,i)),n.enterHandler&&!1===n.enterHandler({eventSource:n,pointerType:i.type,position:c(i.currentPos,n.element),buttons:d.buttons,pointers:n.getActivePointerCount(),insideElementPressed:i.insideElementPressed,buttonDownAny:0!==d.buttons,isTouchEvent:"touch"===i.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t)}function de(n,t,a){var o,i,r,d=n.getActivePointersListByType(a[0].type),l=a.length;for(o=0;o<l;o++)i=a[o],r=d.getById(i.id),r&&(r.captured?(r.insideElement=!1,r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=i.currentPos,r.currentTime=i.currentTime):ie(d,r),i=r),n.exitHandler&&!1===n.exitHandler({eventSource:n,pointerType:i.type,position:c(i.currentPos,n.element),buttons:d.buttons,pointers:n.getActivePointerCount(),insideElementPressed:!!r&&r.insideElementPressed,buttonDownAny:0!==d.buttons,isTouchEvent:"touch"===i.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t)}function le(n,t,a,o){var i,r,d,l=Ae[n.hash],s=n.getActivePointersListByType(a[0].type),u=a.length;void 0!==t.buttons?s.buttons=t.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===o?s.buttons+=1:1===o?s.buttons+=4:2===o?s.buttons+=2:3===o?s.buttons+=8:4===o?s.buttons+=16:5===o&&(s.buttons+=32):0===o?s.buttons|=1:1===o?s.buttons|=4:2===o?s.buttons|=2:3===o?s.buttons|=8:4===o?s.buttons|=16:5===o&&(s.buttons|=32);var g=n.getActivePointersListsExceptType(a[0].type);for(i=0;i<g.length;i++)D(n,t,g[i]);if(0!==o)return n.nonPrimaryPressHandler&&!1===n.nonPrimaryPressHandler({eventSource:n,pointerType:a[0].type,position:c(a[0].currentPos,n.element),button:o,buttons:s.buttons,isTouchEvent:"touch"===a[0].type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t),!1;for(i=0;i<u;i++)r=a[i],d=s.getById(r.id),d?(d.captured=!0,d.insideElementPressed=!0,d.insideElement=!0,d.contactPos=r.currentPos,d.contactTime=r.currentTime,d.lastPos=d.currentPos,d.lastTime=d.currentTime,d.currentPos=r.currentPos,d.currentTime=r.currentTime,r=d):(r.captured=!0,r.insideElementPressed=!0,r.insideElement=!0,oe(s,r)),s.addContact(),(n.dragHandler||n.dragEndHandler||n.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.addPoint(n,r),1===s.contacts?n.pressHandler&&!1===n.pressHandler({eventSource:n,pointerType:r.type,position:c(r.contactPos,n.element),buttons:s.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t):2===s.contacts&&n.pinchHandler&&"touch"===r.type&&(l.pinchGPoints=s.asArray(),l.lastPinchDist=l.currentPinchDist=l.pinchGPoints[0].currentPos.distanceTo(l.pinchGPoints[1].currentPos),l.lastPinchCenter=l.currentPinchCenter=f(l.pinchGPoints[0].currentPos,l.pinchGPoints[1].currentPos));return!0}function se(n,t,a,o){var i,r,d,l,s,u,g=Ae[n.hash],h=n.getActivePointersListByType(a[0].type),A=a.length,v=!1,m=!1;if(void 0!==t.buttons?h.buttons=t.buttons:e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?0===o?h.buttons-=1:1===o?h.buttons-=4:2===o?h.buttons-=2:3===o?h.buttons-=8:4===o?h.buttons-=16:5===o&&(h.buttons-=32):0===o?h.buttons^=-2:1===o?h.buttons^=-5:2===o?h.buttons^=-3:3===o?h.buttons^=-9:4===o?h.buttons^=-17:5===o&&(h.buttons^=-33),0!==o){n.nonPrimaryReleaseHandler&&!1===n.nonPrimaryReleaseHandler({eventSource:n,pointerType:a[0].type,position:c(a[0].currentPos,n.element),button:o,buttons:h.buttons,isTouchEvent:"touch"===a[0].type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t);return D(n,t,n.getActivePointersListByType("mouse")),!1}for(d=0;d<A;d++)l=a[d],(s=h.getById(l.id))&&(s.captured&&(s.captured=!1,v=!0,m=!0),s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=l.currentPos,s.currentTime=l.currentTime,s.insideElement||ie(h,s),i=s.currentPos,r=s.currentTime,m?(h.removeContact(),(n.dragHandler||n.dragEndHandler||n.pinchHandler)&&e.MouseTracker.gesturePointVelocityTracker.removePoint(n,s),0===h.contacts?(n.releaseHandler&&!1===n.releaseHandler({eventSource:n,pointerType:s.type,position:c(i,n.element),buttons:h.buttons,insideElementPressed:s.insideElementPressed,insideElementReleased:s.insideElement,isTouchEvent:"touch"===s.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t),n.dragEndHandler&&!s.currentPos.equals(s.contactPos)&&!1===n.dragEndHandler({eventSource:n,pointerType:s.type,position:c(s.currentPos,n.element),speed:s.speed,direction:s.direction,shift:t.shiftKey,isTouchEvent:"touch"===s.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t),(n.clickHandler||n.dblClickHandler)&&s.insideElement&&(u=r-s.contactTime<=n.clickTimeThreshold&&s.contactPos.distanceTo(i)<=n.clickDistThreshold,n.clickHandler&&!1===n.clickHandler({eventSource:n,pointerType:s.type,position:c(s.currentPos,n.element),quick:u,shift:t.shiftKey,isTouchEvent:"touch"===s.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t),n.dblClickHandler&&u&&(h.clicks++,1===h.clicks?(g.lastClickPos=i,g.dblClickTimeOut=setTimeout(function(){h.clicks=0},n.dblClickTimeThreshold)):2===h.clicks&&(clearTimeout(g.dblClickTimeOut),h.clicks=0,g.lastClickPos.distanceTo(i)<=n.dblClickDistThreshold&&!1===n.dblClickHandler({eventSource:n,pointerType:s.type,position:c(s.currentPos,n.element),shift:t.shiftKey,isTouchEvent:"touch"===s.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t),g.lastClickPos=null)))):2===h.contacts&&n.pinchHandler&&"touch"===s.type&&(g.pinchGPoints=h.asArray(),g.lastPinchDist=g.currentPinchDist=g.pinchGPoints[0].currentPos.distanceTo(g.pinchGPoints[1].currentPos),g.lastPinchCenter=g.currentPinchCenter=f(g.pinchGPoints[0].currentPos,g.pinchGPoints[1].currentPos))):n.releaseHandler&&!1===n.releaseHandler({eventSource:n,pointerType:s.type,position:c(i,n.element),buttons:h.buttons,insideElementPressed:s.insideElementPressed,insideElementReleased:s.insideElement,isTouchEvent:"touch"===s.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t));return v}function ce(n,t,a){var o,i,r,d,l,s=Ae[n.hash],u=n.getActivePointersListByType(a[0].type),g=a.length;for(void 0!==t.buttons&&(u.buttons=t.buttons),o=0;o<g;o++)i=a[o],r=u.getById(i.id),r?(i.hasOwnProperty("isPrimary")&&(r.isPrimary=i.isPrimary),r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=i.currentPos,r.currentTime=i.currentTime):(i.captured=!1,i.insideElementPressed=!1,i.insideElement=!0,oe(u,i));n.stopHandler&&"mouse"===a[0].type&&(clearTimeout(n.stopTimeOut),n.stopTimeOut=setTimeout(function(){ue(n,t,a[0].type)},n.stopDelay)),0===u.contacts?n.moveHandler&&!1===n.moveHandler({eventSource:n,pointerType:a[0].type,position:c(a[0].currentPos,n.element),buttons:u.buttons,isTouchEvent:"touch"===a[0].type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t):1===u.contacts?(n.moveHandler&&(r=u.asArray()[0],!1===n.moveHandler({eventSource:n,pointerType:r.type,position:c(r.currentPos,n.element),buttons:u.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t)),n.dragHandler&&(r=u.asArray()[0],l=r.currentPos.minus(r.lastPos),!1===n.dragHandler({eventSource:n,pointerType:r.type,position:c(r.currentPos,n.element),buttons:u.buttons,delta:l,speed:r.speed,direction:r.direction,shift:t.shiftKey,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t))):2===u.contacts&&(n.moveHandler&&(d=u.asArray(),!1===n.moveHandler({eventSource:n,pointerType:d[0].type,position:c(f(d[0].currentPos,d[1].currentPos),n.element),buttons:u.buttons,isTouchEvent:"touch"===d[0].type,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t)),n.pinchHandler&&"touch"===a[0].type&&(l=s.pinchGPoints[0].currentPos.distanceTo(s.pinchGPoints[1].currentPos))!=s.currentPinchDist&&(s.lastPinchDist=s.currentPinchDist,s.currentPinchDist=l,s.lastPinchCenter=s.currentPinchCenter,s.currentPinchCenter=f(s.pinchGPoints[0].currentPos,s.pinchGPoints[1].currentPos),!1===n.pinchHandler({eventSource:n,pointerType:"touch",gesturePoints:s.pinchGPoints,lastCenter:c(s.lastPinchCenter,n.element),center:c(s.currentPinchCenter,n.element),lastDistance:s.lastPinchDist,distance:s.currentPinchDist,shift:t.shiftKey,originalEvent:t,preventDefaultAction:!1,userData:n.userData})&&e.cancelEvent(t)))}function fe(e,n,t){se(e,n,t,0),de(e,n,t)}function ue(e,n,t){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:t,position:s(n,e.element),buttons:e.getActivePointersListByType(t).buttons,isTouchEvent:"touch"===t,originalEvent:n,preventDefaultAction:!1,userData:e.userData})}function ge(e){try{return e.addEventListener&&e.removeEventListener}catch(n){return!1}}var he=[],Ae={};e.MouseTracker=function(n){he.push(this);var t=arguments;e.isPlainObject(n)||(n={element:t[0],clickTimeThreshold:t[1],clickDistThreshold:t[2]}),this.hash=Math.random(),this.element=e.getElement(n.element),this.clickTimeThreshold=n.clickTimeThreshold||e.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=n.clickDistThreshold||e.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=n.dblClickTimeThreshold||e.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=n.dblClickDistThreshold||e.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=n.userData||null,this.stopDelay=n.stopDelay||50,this.enterHandler=n.enterHandler||null,this.exitHandler=n.exitHandler||null,this.pressHandler=n.pressHandler||null,this.nonPrimaryPressHandler=n.nonPrimaryPressHandler||null,this.releaseHandler=n.releaseHandler||null,this.nonPrimaryReleaseHandler=n.nonPrimaryReleaseHandler||null,this.moveHandler=n.moveHandler||null,this.scrollHandler=n.scrollHandler||null,this.clickHandler=n.clickHandler||null,this.dblClickHandler=n.dblClickHandler||null,this.dragHandler=n.dragHandler||null,this.dragEndHandler=n.dragEndHandler||null,this.pinchHandler=n.pinchHandler||null,this.stopHandler=n.stopHandler||null,this.keyDownHandler=n.keyDownHandler||null,this.keyUpHandler=n.keyUpHandler||null,this.keyHandler=n.keyHandler||null,this.focusHandler=n.focusHandler||null,this.blurHandler=n.blurHandler||null;var a=this;Ae[this.hash]={click:function(e){u(a,e)},dblclick:function(e){g(a,e)},keydown:function(e){h(a,e)},keyup:function(e){A(a,e)},keypress:function(e){v(a,e)},focus:function(e){m(a,e)},blur:function(e){S(a,e)},wheel:function(e){p(a,e)},mousewheel:function(e){w(a,e)},DOMMouseScroll:function(e){w(a,e)},MozMousePixelScroll:function(e){w(a,e)},mouseenter:function(e){C(a,e)},mouseleave:function(e){L(a,e)},mouseover:function(e){b(a,e)},mouseout:function(e){N(a,e)},mousedown:function(e){O(a,e)},mouseup:function(e){T(a,e)},mouseupcaptured:function(e){G(a,e)},mousemove:function(e){Q(a,e)},mousemovecaptured:function(e){V(a,e)},touchstart:function(e){F(a,e)},touchend:function(e){P(a,e)},touchendcaptured:function(e){U(a,e)},touchmove:function(e){q(a,e)},touchmovecaptured:function(e){z(a,e)},touchcancel:function(e){J(a,e)},gesturestart:function(e){K(a,e)},gesturechange:function(e){M(a,e)},pointerover:function(e){W(a,e)},MSPointerOver:function(e){W(a,e)},pointerout:function(e){X(a,e)},MSPointerOut:function(e){X(a,e)},pointerdown:function(e){Y(a,e)},MSPointerDown:function(e){Y(a,e)},pointerup:function(e){Z(a,e)},MSPointerUp:function(e){Z(a,e)},pointermove:function(e){ee(a,e)},MSPointerMove:function(e){ee(a,e)},pointercancel:function(e){ae(a,e)},MSPointerCancel:function(e){ae(a,e)},pointerupcaptured:function(e){$(a,e)},pointermovecaptured:function(e){ne(a,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},n.startDisabled||this.setTracking(!0)},e.MouseTracker.prototype={destroy:function(){var e;for(a(this),this.element=null,e=0;e<he.length;e++)if(he[e]===this){he.splice(e,1);break}Ae[this.hash]=null,delete Ae[this.hash]},isTracking:function(){return Ae[this.hash].tracking},setTracking:function(e){return e?t(this):a(this),this},getActivePointersListsExceptType:function(e){for(var n=Ae[this.hash],t=[],a=0;a<n.activePointersLists.length;++a)n.activePointersLists[a].type!==e&&t.push(n.activePointersLists[a]);return t},getActivePointersListByType:function(n){var t,a,o=Ae[this.hash],i=o.activePointersLists.length;for(t=0;t<i;t++)if(o.activePointersLists[t].type===n)return o.activePointersLists[t];return a=new e.MouseTracker.GesturePointList(n),o.activePointersLists.push(a),a},getActivePointerCount:function(){var e,n=Ae[this.hash],t=n.activePointersLists.length,a=0;for(e=0;e<t;e++)a+=n.activePointersLists[e].getLength();return a},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},e.MouseTracker.resetAllMouseTrackers=function(){for(var e=0;e<he.length;e++)he[e].isTracking()&&(he[e].setTracking(!1),he[e].setTracking(!0))},e.MouseTracker.gesturePointVelocityTracker=function(){var n=[],t=0,a=0,o=function(e,n){return e.hash.toString()+n.type+n.id.toString()},i=function(){var t,o,i,r,d,l,s=n.length,c=e.now();for(r=c-a,a=c,t=0;t<s;t++)o=n[t],i=o.gPoint,i.direction=Math.atan2(i.currentPos.y-o.lastPos.y,i.currentPos.x-o.lastPos.x),d=o.lastPos.distanceTo(i.currentPos),o.lastPos=i.currentPos,l=1e3*d/(r+1),i.speed=.75*l+.25*i.speed};return{addPoint:function(r,d){var l=o(r,d);n.push({guid:l,gPoint:d,lastPos:d.currentPos}),1===n.length&&(a=e.now(),t=window.setInterval(i,50))},removePoint:function(e,a){var i,r=o(e,a),d=n.length;for(i=0;i<d;i++)if(n[i].guid===r){n.splice(i,1),0===--d&&window.clearInterval(t);break}}}}(),e.MouseTracker.captureElement=document,e.MouseTracker.wheelEventName=e.Browser.vendor==e.BROWSERS.IE&&e.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",e.MouseTracker.supportsMouseCapture=function(){var n=document.createElement("div");return e.isFunction(n.setCapture)&&e.isFunction(n.releaseCapture)}(),e.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",e.MouseTracker.wheelEventName],"DOMMouseScroll"==e.MouseTracker.wheelEventName&&e.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||e.Browser.vendor!==e.BROWSERS.IE)?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),e.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(e.MouseTracker.havePointerEvents=!0,e.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),e.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?e.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:e.MouseTracker.maxTouchPoints=0,e.MouseTracker.haveMouseEnter=!1):(e.MouseTracker.havePointerEvents=!1,e.Browser.vendor===e.BROWSERS.IE&&e.Browser.version<9?(e.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),e.MouseTracker.haveMouseEnter=!0):(e.MouseTracker.subscribeEvents.push("mouseover","mouseout"),e.MouseTracker.haveMouseEnter=!1),e.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&e.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&e.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),e.MouseTracker.mousePointerId="legacy-mouse",e.MouseTracker.maxTouchPoints=10),e.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},e.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var n,t=this._gPoints.length;for(n=0;n<t;n++)if(this._gPoints[n].id===e){this._gPoints.splice(n,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var n,t=this._gPoints.length;for(n=0;n<t;n++)if(this._gPoints[n].id===e)return this._gPoints[n];return null},getPrimary:function(e){var n,t=this._gPoints.length;for(n=0;n<t;n++)if(this._gPoints[n].isPrimary)return this._gPoints[n];return null},addContact:function(){++this.contacts>1&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts<0&&(this.contacts=0)}};var ve=function(){try{return window.self!==window.top}catch(e){return!0}}()}(OpenSeadragon),function(e){e.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},e.Control=function(n,t,a){var o=n.parentNode;"number"==typeof t&&(e.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),t={anchor:t}),t.attachToViewer=void 0===t.attachToViewer||t.attachToViewer,this.autoFade=void 0===t.autoFade||t.autoFade,this.element=n,this.anchor=t.anchor,this.container=a,this.anchor==e.ControlAnchor.ABSOLUTE?(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof t.top?t.top+"px":t.top,this.wrapper.style.left="number"==typeof t.left?t.left+"px":t.left,this.wrapper.style.height="number"==typeof t.height?t.height+"px":t.height,this.wrapper.style.width="number"==typeof t.width?t.width+"px":t.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=e.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==e.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),t.attachToViewer?this.anchor==e.ControlAnchor.TOP_RIGHT||this.anchor==e.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):o.appendChild(this.wrapper)},e.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(n){this.wrapper.style.display=n?this.anchor==e.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(n){this.element[e.SIGNAL]&&e.Browser.vendor==e.BROWSERS.IE?e.setElementOpacity(this.element,n,!0):e.setElementOpacity(this.wrapper,n,!0)}}}(OpenSeadragon),function(e){function n(e,n){var t,a=e.controls;for(t=a.length-1;t>=0;t--)if(a[t].element==n)return t;return-1}e.ControlDock=function(n){var t,a,o=["topleft","topright","bottomright","bottomleft"];for(e.extend(!0,this,{id:"controldock-"+e.now()+"-"+Math.floor(1e6*Math.random()),container:e.makeNeutralElement("div"),controls:[]},n),this.container.onsubmit=function(){return!1},this.element&&(this.element=e.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),a=0;a<o.length;a++)t=o[a],this.controls[t]=e.makeNeutralElement("div"),this.controls[t].style.position="absolute",t.match("left")&&(this.controls[t].style.left="0px"),t.match("right")&&(this.controls[t].style.right="0px"),t.match("top")&&(this.controls[t].style.top="0px"),t.match("bottom")&&(this.controls[t].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},e.ControlDock.prototype={addControl:function(t,a){t=e.getElement(t);var o=null;if(!(n(this,t)>=0)){switch(a.anchor){case e.ControlAnchor.TOP_RIGHT:o=this.controls.topright,t.style.position="relative",t.style.paddingRight="0px",t.style.paddingTop="0px";break;case e.ControlAnchor.BOTTOM_RIGHT:o=this.controls.bottomright,t.style.position="relative",t.style.paddingRight="0px",t.style.paddingBottom="0px";break;case e.ControlAnchor.BOTTOM_LEFT:o=this.controls.bottomleft,t.style.position="relative",t.style.paddingLeft="0px",t.style.paddingBottom="0px";break;case e.ControlAnchor.TOP_LEFT:o=this.controls.topleft,t.style.position="relative",t.style.paddingLeft="0px",t.style.paddingTop="0px";break;case e.ControlAnchor.ABSOLUTE:o=this.container,t.style.margin="0px",t.style.padding="0px";break;default:case e.ControlAnchor.NONE:o=this.container,t.style.margin="0px",t.style.padding="0px"}this.controls.push(new e.Control(t,a,o)),t.style.display="inline-block"}},removeControl:function(t){t=e.getElement(t);var a=n(this,t);return a>=0&&(this.controls[a].destroy(),this.controls.splice(a,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;e>=0;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var n;for(n=this.controls.length-1;n>=0;n--)this.controls[n].setVisible(e);return this}}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(e){function n(n){return n=e.getElement(n),new e.Point(0===n.clientWidth?1:n.clientWidth,0===n.clientHeight?1:n.clientHeight)}function t(n,t,a,o,i){function r(e,n){e.ready?o(e):(e.addHandler("ready",function(){o(e)}),e.addHandler("open-failed",function(e){i({message:e.message,source:n})}))}var d=n
;if("string"==e.type(t))if(t.match(/^\s*<.*>\s*$/))t=e.parseXml(t);else if(t.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var l=e.parseJSON(t);t=l}catch(s){}setTimeout(function(){if("string"==e.type(t))t=new e.TileSource({url:t,crossOriginPolicy:void 0!==a.crossOriginPolicy?a.crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,ajaxHeaders:n.ajaxHeaders,useCanvas:n.useCanvas,success:function(e){o(e.tileSource)}}),t.addHandler("open-failed",function(e){i(e)});else if(e.isPlainObject(t)||t.nodeType)if(void 0!==t.crossOriginPolicy||void 0===a.crossOriginPolicy&&void 0===n.crossOriginPolicy||(t.crossOriginPolicy=void 0!==a.crossOriginPolicy?a.crossOriginPolicy:n.crossOriginPolicy),void 0===t.ajaxWithCredentials&&(t.ajaxWithCredentials=n.ajaxWithCredentials),void 0===t.useCanvas&&(t.useCanvas=n.useCanvas),e.isFunction(t.getTileUrl)){var l=new e.TileSource(t);l.getTileUrl=t.getTileUrl,o(l)}else{var s=e.TileSource.determineType(d,t);if(!s)return void i({message:"Unable to load TileSource",source:t});var c=s.prototype.configure.apply(d,[t]);r(new s(c),t)}else r(t,t)})}function a(n,t){if(t instanceof e.Overlay)return t;var a=null;if(t.element)a=e.getElement(t.element);else{var o=t.id?t.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());a=e.getElement(t.id),a||(a=document.createElement("a"),a.href="#/overlay/"+o),a.id=o,e.addClass(a,t.className?t.className:"openseadragon-overlay")}var i=t.location,r=t.width,d=t.height;if(!i){var l=t.x,s=t.y;if(void 0!==t.px){var c=n.viewport.imageToViewportRectangle(new e.Rect(t.px,t.py,r||0,d||0));l=c.x,s=c.y,r=void 0!==r?c.width:void 0,d=void 0!==d?c.height:void 0}i=new e.Point(l,s)}var f=t.placement;return f&&"string"===e.type(f)&&(f=e.Placement[t.placement.toUpperCase()]),new e.Overlay({element:a,location:i,placement:f,onDraw:t.onDraw,checkResize:t.checkResize,width:r,height:d,rotationMode:t.rotationMode})}function o(e,n){var t;for(t=e.length-1;t>=0;t--)if(e[t].element===n)return t;return-1}function i(n,t){return e.requestAnimationFrame(function(){t(n)})}function r(n){e.requestAnimationFrame(function(){l(n)})}function d(n){n.autoHideControls&&(n.controlsShouldFade=!0,n.controlsFadeBeginTime=e.now()+n.controlsFadeDelay,window.setTimeout(function(){r(n)},n.controlsFadeDelay))}function l(n){var t,a,o,i;if(n.controlsShouldFade){for(t=e.now(),a=t-n.controlsFadeBeginTime,o=1-a/n.controlsFadeLength,o=Math.min(1,o),o=Math.max(0,o),i=n.controls.length-1;i>=0;i--)n.controls[i].autoFade&&n.controls[i].setOpacity(o);o>0&&r(n)}}function s(e){var n;for(e.controlsShouldFade=!1,n=e.controls.length-1;n>=0;n--)e.controls[n].setOpacity(1)}function c(){s(this)}function f(){d(this)}function u(n){var t={originalEvent:n.originalEvent,preventDefaultAction:n.preventDefaultAction,preventVerticalPan:n.preventVerticalPan,preventHorizontalPan:n.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||n.ctrl||n.alt||n.meta)return!0;switch(n.keyCode){case 38:return t.preventVerticalPan||(n.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return t.preventVerticalPan||(n.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function g(n){var t={originalEvent:n.originalEvent,preventDefaultAction:n.preventDefaultAction,preventVerticalPan:n.preventVerticalPan,preventHorizontalPan:n.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||n.ctrl||n.alt||n.meta)return!0;switch(n.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return t.preventVerticalPan||(n.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return t.preventVerticalPan||(n.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new e.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(e.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(e.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function h(e){var n;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-click",t),!t.preventDefaultAction&&this.viewport&&e.quick&&(n=this.gestureSettingsByDeviceType(e.pointerType),n.clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,n.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()))}function A(e){var n,t={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-double-click",t),!t.preventDefaultAction&&this.viewport&&(n=this.gestureSettingsByDeviceType(e.pointerType),n.dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,n.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()))}function v(e){var n,t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.raiseEvent("canvas-drag",t),!t.preventDefaultAction&&this.viewport){if(n=this.gestureSettingsByDeviceType(e.pointerType),this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan){var a=this.viewport.deltaPointsFromPixels(e.delta.negate());this.viewport.centerSpringX.target.value+=a.x,this.viewport.centerSpringY.target.value+=a.y;var o=this.viewport.getBounds(),i=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=a.x,this.viewport.centerSpringY.target.value-=a.y,o.x!=i.x&&(e.delta.x=0),o.y!=i.y&&(e.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),n.flickEnabled&&!this.constrainDuringPan)}}function m(n){if(!n.preventDefaultAction&&this.viewport){var t=this.gestureSettingsByDeviceType(n.pointerType);if(t.flickEnabled&&n.speed>=t.flickMinSpeed){var a=0;this.panHorizontal&&(a=t.flickMomentum*n.speed*Math.cos(n.direction));var o=0;this.panVertical&&(o=t.flickMomentum*n.speed*Math.sin(n.direction));var i=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),r=this.viewport.pointFromPixel(new e.Point(i.x-a,i.y-o));this.viewport.panTo(r,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:n.eventSource,position:n.position,speed:n.speed,direction:n.direction,shift:n.shift,originalEvent:n.originalEvent})}function S(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function p(n){window.location!=window.parent.location&&e.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:n.eventSource,pointerType:n.pointerType,position:n.position,buttons:n.buttons,pointers:n.pointers,insideElementPressed:n.insideElementPressed,buttonDownAny:n.buttonDownAny,originalEvent:n.originalEvent})}function w(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function E(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function y(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function C(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function b(e){var n,t,a,o;if(!e.preventDefaultAction&&this.viewport&&(n=this.gestureSettingsByDeviceType(e.pointerType),n.pinchToZoom&&(t=this.viewport.pointFromPixel(e.center,!0),a=this.viewport.pointFromPixel(e.lastCenter,!0),o=a.minus(t),this.panHorizontal||(o.x=0),this.panVertical||(o.y=0),this.viewport.zoomBy(e.distance/e.lastDistance,t,!0),n.zoomToRefPoint&&this.viewport.panBy(o,!0),this.viewport.applyConstraints()),n.pinchRotate)){var i=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),r=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(i-r)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:e.eventSource,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent}),!1}function x(n){var t,a,o;if(o=e.now(),o-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=o,this.viewport.flipped&&(n.position.x=this.viewport.getContainerSize().x-n.position.x),!n.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(n.pointerType),t.scrollToZoom&&(a=Math.pow(this.zoomPerScroll,n.scroll),this.viewport.zoomBy(a,t.zoomToRefPoint?this.viewport.pointFromPixel(n.position,!0):null),this.viewport.applyConstraints())),this.raiseEvent("canvas-scroll",{tracker:n.eventSource,position:n.position,scroll:n.scroll,shift:n.shift,originalEvent:n.originalEvent}),t&&t.scrollToZoom)return!1}else if((t=this.gestureSettingsByDeviceType(n.pointerType))&&t.scrollToZoom)return!1}function L(e){M[this.hash].mouseInside=!0,s(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function N(e){e.pointers<1&&(M[this.hash].mouseInside=!1,M[this.hash].animating||d(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function B(e){I(e),e.isOpen()?e._updateRequestId=i(e,B):e._updateRequestId=!1}function I(e){if(!e._opening){if(e.autoResize){var t=n(e.container),a=M[e.hash].prevContainerSize;if(!t.equals(a)){var o=e.viewport;if(e.preserveImageSizeOnResize){var i=a.x/t.x,r=o.getZoom()*i,l=o.getCenter();o.resize(t,!1),o.zoomTo(r,null,!0),o.panTo(l,!0)}else{var c=o.getBounds();o.resize(t,!0),o.fitBoundsWithConstraints(c,!0)}M[e.hash].prevContainerSize=t,M[e.hash].forceRedraw=!0}}var f=e.viewport.update(),u=e.world.update()||f;f&&e.raiseEvent("viewport-change"),e.referenceStrip&&(u=e.referenceStrip.update(e.viewport)||u),!M[e.hash].animating&&u&&(e.raiseEvent("animation-start"),s(e)),(u||M[e.hash].forceRedraw||e.world.needsDraw())&&(O(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),M[e.hash].forceRedraw=!1,u&&e.raiseEvent("animation")),M[e.hash].animating&&!u&&(e.raiseEvent("animation-finish"),M[e.hash].mouseInside||d(e)),M[e.hash].animating=u}}function O(e){e.imageLoader.clear(),e.drawer.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}function T(e,n){return e?e+n:n}function G(){M[this.hash].lastZoomTime=e.now(),M[this.hash].zoomFactor=this.zoomPerSecond,M[this.hash].zooming=!0,V(this)}function R(){M[this.hash].lastZoomTime=e.now(),M[this.hash].zoomFactor=1/this.zoomPerSecond,M[this.hash].zooming=!0,V(this)}function Q(){M[this.hash].zooming=!1}function V(n){e.requestAnimationFrame(e.delegate(n,k))}function k(){var n,t,a;M[this.hash].zooming&&this.viewport&&(n=e.now(),t=n-M[this.hash].lastZoomTime,a=Math.pow(M[this.hash].zoomFactor,t/1e3),this.viewport.zoomBy(a),this.viewport.applyConstraints(),M[this.hash].lastZoomTime=n,V(this))}function D(){this.viewport&&(M[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function F(){this.viewport&&(M[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function P(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function U(){this.viewport&&this.viewport.goHome()}function j(){this.isFullPage()&&!e.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function q(){if(this.viewport){var n=this.viewport.getRotation();n=this.viewport.flipped?e.positiveModulo(n+this.rotationIncrement,360):e.positiveModulo(n-this.rotationIncrement,360),this.viewport.setRotation(n)}}function z(){if(this.viewport){var n=this.viewport.getRotation();n=this.viewport.flipped?e.positiveModulo(n-this.rotationIncrement,360):e.positiveModulo(n+this.rotationIncrement,360),this.viewport.setRotation(n)}}function H(){this.viewport.toggleFlip()}function J(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)}function K(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}var M={},W=1;e.Viewer=function(t){var a,o=arguments,r=this;if(e.isPlainObject(t)||(t={id:o[0],xmlPath:o.length>1?o[1]:void 0,prefixUrl:o.length>2?o[2]:void 0,controls:o.length>3?o[3]:void 0,overlays:o.length>4?o[4]:void 0}),t.config&&(e.extend(!0,t,t.config),delete t.config),e.extend(!0,this,{id:t.id,hash:t.hash||W++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},e.DEFAULT_SETTINGS,t),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==M[this.hash]&&e.console.warn("Hash "+this.hash+" has already been used."),M[this.hash]={fsBoundsDelta:new e.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=e.now(),e.EventSource.call(this),this.addHandler("open-failed",function(n){var t=e.getString("Errors.OpenFailed",n.eventSource,n.message);r._showMessage(t)}),e.ControlDock.call(this,t),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=e.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(e){e.width="100%",e.height="100%",e.overflow="hidden",e.position="absolute",e.top="0px",e.left="0px"}(this.canvas.style),e.setElementTouchActionNone(this.canvas),""!==t.tabIndex&&(this.canvas.tabIndex=void 0===t.tabIndex?0:t.tabIndex),this.container.className="openseadragon-container",function(e){e.width="100%",e.height="100%",e.position="relative",e.overflow="hidden",e.left="0px",e.top="0px",e.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new e.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:e.delegate(this,u),keyHandler:e.delegate(this,g),clickHandler:e.delegate(this,h),dblClickHandler:e.delegate(this,A),dragHandler:e.delegate(this,v),dragEndHandler:e.delegate(this,m),enterHandler:e.delegate(this,S),exitHandler:e.delegate(this,p),pressHandler:e.delegate(this,w),releaseHandler:e.delegate(this,E),nonPrimaryPressHandler:e.delegate(this,y),nonPrimaryReleaseHandler:e.delegate(this,C),scrollHandler:e.delegate(this,x),pinchHandler:e.delegate(this,b)}),this.outerTracker=new e.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:e.delegate(this,L),exitHandler:e.delegate(this,N)}),this.toolbar&&(this.toolbar=new e.ControlDock({element:this.toolbar})),this.bindStandardControls(),M[this.hash].prevContainerSize=n(this.container),this.world=new e.World({viewer:this}),this.world.addHandler("add-item",function(e){r.source=r.world.getItemAt(0).source,M[r.hash].forceRedraw=!0,r._updateRequestId||(r._updateRequestId=i(r,B))}),this.world.addHandler("remove-item",function(e){r.world.getItemCount()?r.source=r.world.getItemAt(0).source:r.source=null,M[r.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(e){r.viewport&&r.viewport._setContentBounds(r.world.getHomeBounds(),r.world.getContentFactor())}),this.world.addHandler("item-index-change",function(e){r.source=r.world.getItemAt(0).source}),this.viewport=new e.Viewport({containerSize:M[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new e.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:t.timeout}),this.tileCache=new e.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new e.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=e.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(a=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(a,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(a=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(a,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new e.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),a=0;a<this.customControls.length;a++)this.addControl(this.customControls[a].id,{anchor:this.customControls[a].anchor});e.requestAnimationFrame(function(){d(r)}),void 0===this.imageSmoothingEnabled||this.imageSmoothingEnabled||this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},e.extend(e.Viewer.prototype,e.EventSource.prototype,e.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(n){return e.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(n)},openTileSource:function(n){return e.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(n)},open:function(n,t){var o=this;if(this.close(),n){if(this.sequenceMode&&e.isArray(n))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===t||isNaN(t)||(this.initialPage=t),this.tileSources=n,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(e.isArray(n)||(n=[n]),n.length){this._opening=!0;for(var i,r=n.length,d=0,l=0,s=function(){if(d+l===r)if(d){!o._firstOpen&&o.preserveViewport||(o.viewport.goHome(!0),o.viewport.update()),o._firstOpen=!1;var e=n[0];if(e.tileSource&&(e=e.tileSource),o.overlays&&!o.preserveOverlays)for(var t=0;t<o.overlays.length;t++)o.currentOverlays[t]=a(o,o.overlays[t]);o._drawOverlays(),o._opening=!1,o.raiseEvent("open",{source:e})}else o._opening=!1,o.raiseEvent("open-failed",i)},c=function(n){e.isPlainObject(n)&&n.tileSource||(n={tileSource:n}),void 0!==n.index&&(e.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete n.index),void 0===n.collectionImmediately&&(n.collectionImmediately=!0);var t=n.success;n.success=function(e){if(d++,n.tileSource.overlays)for(var a=0;a<n.tileSource.overlays.length;a++)o.addOverlay(n.tileSource.overlays[a]);t&&t(e),s()};var a=n.error;n.error=function(e){l++,i||(i=e),a&&a(e),s()},o.addTiledImage(n)},f=0;f<n.length;f++)c(n[f]);return this}}},close:function(){return M[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),M[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(M[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(e.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),M[this.hash]=null,delete M[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,n=this.controls.length;for(e=0;e<this.controls.length;e++)n=n&&this.controls[e].isVisible();return n},setControlsEnabled:function(e){return e?s(this):d(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var n=0;n<this.world.getItemCount();n++)this.world.getItemAt(n).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return M[this.hash].fullPage},setFullPage:function(n){var t,a,o=document.body,i=o.style,r=document.documentElement.style,d=this;if(n==this.isFullPage())return this;var l={fullPage:n,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",l),l.preventDefaultAction)return this;if(n){for(this.elementSize=e.getElementSize(this.element),this.pageScroll=e.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=i.margin,this.docMargin=r.margin,i.margin="0",r.margin="0",this.bodyPadding=i.padding,this.docPadding=r.padding,i.padding="0",r.padding="0",this.bodyWidth=i.width,this.docWidth=r.width,i.width="100%",r.width="100%",this.bodyHeight=i.height,this.docHeight=r.height,i.height="100%",r.height="100%",this.previousBody=[],M[this.hash].prevElementParent=this.element.parentNode,M[this.hash].prevNextSibling=this.element.nextSibling,M[this.hash].prevElementWidth=this.element.style.width,M[this.hash].prevElementHeight=this.element.style.height,t=o.childNodes.length,a=0;a<t;a++)this.previousBody.push(o.childNodes[0]),o.removeChild(o.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,o.appendChild(this.toolbar.element),e.addClass(this.toolbar.element,"fullpage")),e.addClass(this.element,"fullpage"),o.appendChild(this.element),this.element.style.height=e.getWindowSize().y+"px",this.element.style.width=e.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=e.getElementSize(this.element).y-e.getElementSize(this.toolbar.element).y+"px"),M[this.hash].fullPage=!0,e.delegate(this,L)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,i.margin=this.bodyMargin,r.margin=this.docMargin,i.padding=this.bodyPadding,r.padding=this.docPadding,i.width=this.bodyWidth,r.width=this.docWidth,i.height=this.bodyHeight,r.height=this.docHeight,o.removeChild(this.element),t=this.previousBody.length,a=0;a<t;a++)o.appendChild(this.previousBody.shift());e.removeClass(this.element,"fullpage"),M[this.hash].prevElementParent.insertBefore(this.element,M[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(o.removeChild(this.toolbar.element),e.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=M[this.hash].prevElementWidth,this.element.style.height=M[this.hash].prevElementHeight;var s=0,c=function(){e.setPageScroll(d.pageScroll);var n=e.getPageScroll();++s<10&&(n.x!==d.pageScroll.x||n.y!==d.pageScroll.y)&&e.requestAnimationFrame(c)};e.requestAnimationFrame(c),M[this.hash].fullPage=!1,e.delegate(this,N)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:n}),this},setFullScreen:function(n){var t=this;if(!e.supportsFullScreen)return this.setFullPage(n);if(e.isFullScreen()===n)return this;var a={fullScreen:n,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",a),a.preventDefaultAction)return this;if(n){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var o=function(){var n=e.isFullScreen();n||(e.removeEvent(document,e.fullScreenEventName,o),e.removeEvent(document,e.fullScreenErrorEventName,o),t.setFullPage(!1),t.isFullPage()&&(t.element.style.width=t.fullPageStyleWidth,t.element.style.height=t.fullPageStyleHeight)),t.navigator&&t.viewport&&setTimeout(function(){t.navigator.update(t.viewport)}),t.raiseEvent("full-screen",{fullScreen:n})};e.addEvent(document,e.fullScreenEventName,o),e.addEvent(document,e.fullScreenErrorEventName,o),e.requestFullScreen(document.body)}else e.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(n){function a(e){for(var t=0;t<r._loadQueue.length;t++)if(r._loadQueue[t]===d){r._loadQueue.splice(t,1);break}0===r._loadQueue.length&&o(d),r.raiseEvent("add-item-failed",e),n.error&&n.error(e)}function o(e){r.collectionMode&&(r.world.arrange({immediately:e.options.collectionImmediately,rows:r.collectionRows,columns:r.collectionColumns,layout:r.collectionLayout,tileSize:r.collectionTileSize,tileMargin:r.collectionTileMargin}),r.world.setAutoRefigureSizes(!0))}function i(){for(var n,t,a;r._loadQueue.length&&(n=r._loadQueue[0],n.tileSource);){if(r._loadQueue.splice(0,1),n.options.replace){var i=r.world.getIndexOfItem(n.options.replaceItem);-1!=i&&(n.options.index=i),r.world.removeItem(n.options.replaceItem)}t=new e.TiledImage({viewer:r,source:n.tileSource,viewport:r.viewport,drawer:r.drawer,tileCache:r.tileCache,imageLoader:r.imageLoader,x:n.options.x,y:n.options.y,width:n.options.width,height:n.options.height,fitBounds:n.options.fitBounds,fitBoundsPlacement:n.options.fitBoundsPlacement,clip:n.options.clip,placeholderFillStyle:n.options.placeholderFillStyle,opacity:n.options.opacity,preload:n.options.preload,degrees:n.options.degrees,compositeOperation:n.options.compositeOperation,springStiffness:r.springStiffness,animationTime:r.animationTime,minZoomImageRatio:r.minZoomImageRatio,wrapHorizontal:r.wrapHorizontal,wrapVertical:r.wrapVertical,immediateRender:r.immediateRender,blendTime:r.blendTime,alwaysBlend:r.alwaysBlend,minPixelRatio:r.minPixelRatio,smoothTileEdgesMinZoom:r.smoothTileEdgesMinZoom,iOSDevice:r.iOSDevice,crossOriginPolicy:n.options.crossOriginPolicy,ajaxWithCredentials:n.options.ajaxWithCredentials,loadTilesWithAjax:n.options.loadTilesWithAjax,ajaxHeaders:n.options.ajaxHeaders,debugMode:r.debugMode}),r.collectionMode&&r.world.setAutoRefigureSizes(!1),r.world.addItem(t,{index:n.options.index}),0===r._loadQueue.length&&o(n),1!==r.world.getItemCount()||r.preserveViewport||r.viewport.goHome(!0),r.navigator&&(a=e.extend({},n.options,{replace:!1,originalTiledImage:t,tileSource:n.tileSource}),r.navigator.addTiledImage(a)),n.options.success&&n.options.success({item:t})}}e.console.assert(n,"[Viewer.addTiledImage] options is required"),e.console.assert(n.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),e.console.assert(!n.replace||n.index>-1&&n.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var r=this;n.replace&&(n.replaceItem=r.world.getItemAt(n.index)),this._hideMessage(),void 0===n.placeholderFillStyle&&(n.placeholderFillStyle=this.placeholderFillStyle),void 0===n.opacity&&(n.opacity=this.opacity),void 0===n.preload&&(n.preload=this.preload),
void 0===n.compositeOperation&&(n.compositeOperation=this.compositeOperation),void 0===n.crossOriginPolicy&&(n.crossOriginPolicy=void 0!==n.tileSource.crossOriginPolicy?n.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===n.ajaxWithCredentials&&(n.ajaxWithCredentials=this.ajaxWithCredentials),void 0===n.loadTilesWithAjax&&(n.loadTilesWithAjax=this.loadTilesWithAjax),void 0===n.ajaxHeaders||null===n.ajaxHeaders?n.ajaxHeaders=this.ajaxHeaders:e.isPlainObject(n.ajaxHeaders)&&e.isPlainObject(this.ajaxHeaders)&&(n.ajaxHeaders=e.extend({},this.ajaxHeaders,n.ajaxHeaders));var d={options:n};if(e.isArray(n.tileSource))return void setTimeout(function(){a({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:n.tileSource,options:n})});this._loadQueue.push(d),t(this,n.tileSource,n,function(e){d.tileSource=e,i()},function(e){e.options=n,a(e),i()})},addSimpleImage:function(n){e.console.assert(n,"[Viewer.addSimpleImage] options is required"),e.console.assert(n.url,"[Viewer.addSimpleImage] options.url is required");var t=e.extend({},n,{tileSource:{type:"image",url:n.url}});delete t.url,this.addTiledImage(t)},addLayer:function(n){var t=this;e.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var a=e.extend({},n,{success:function(e){t.raiseEvent("add-layer",{options:n,drawer:e.item})},error:function(e){t.raiseEvent("add-layer-failed",e)}});return this.addTiledImage(a),this},getLayerAtLevel:function(n){return e.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(n)},getLevelOfLayer:function(n){return e.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(n)},getLayersCount:function(){return e.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(n,t){return e.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(n,t)},removeLayer:function(n){return e.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(n)},forceRedraw:function(){return M[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var n=e.delegate(this,c),t=e.delegate(this,f),a=e.delegate(this,K),o=e.delegate(this,J),i=this.navImages,r=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(r=!1),this.previousButton=new e.Button({element:this.previousButton?e.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.PreviousPage"),srcRest:T(this.prefixUrl,i.previous.REST),srcGroup:T(this.prefixUrl,i.previous.GROUP),srcHover:T(this.prefixUrl,i.previous.HOVER),srcDown:T(this.prefixUrl,i.previous.DOWN),onRelease:o,onFocus:n,onBlur:t}),this.nextButton=new e.Button({element:this.nextButton?e.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.NextPage"),srcRest:T(this.prefixUrl,i.next.REST),srcGroup:T(this.prefixUrl,i.next.GROUP),srcHover:T(this.prefixUrl,i.next.HOVER),srcDown:T(this.prefixUrl,i.next.DOWN),onRelease:a,onFocus:n,onBlur:t}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),r&&(this.paging=new e.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:e.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var n=e.delegate(this,G),t=e.delegate(this,Q),a=e.delegate(this,D),o=e.delegate(this,R),i=e.delegate(this,F),r=e.delegate(this,U),d=e.delegate(this,j),l=e.delegate(this,q),s=e.delegate(this,z),u=e.delegate(this,H),g=e.delegate(this,c),h=e.delegate(this,f),A=this.navImages,v=[],m=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(m=!1),this.showZoomControl&&(v.push(this.zoomInButton=new e.Button({element:this.zoomInButton?e.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomIn"),srcRest:T(this.prefixUrl,A.zoomIn.REST),srcGroup:T(this.prefixUrl,A.zoomIn.GROUP),srcHover:T(this.prefixUrl,A.zoomIn.HOVER),srcDown:T(this.prefixUrl,A.zoomIn.DOWN),onPress:n,onRelease:t,onClick:a,onEnter:n,onExit:t,onFocus:g,onBlur:h})),v.push(this.zoomOutButton=new e.Button({element:this.zoomOutButton?e.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.ZoomOut"),srcRest:T(this.prefixUrl,A.zoomOut.REST),srcGroup:T(this.prefixUrl,A.zoomOut.GROUP),srcHover:T(this.prefixUrl,A.zoomOut.HOVER),srcDown:T(this.prefixUrl,A.zoomOut.DOWN),onPress:o,onRelease:t,onClick:i,onEnter:o,onExit:t,onFocus:g,onBlur:h}))),this.showHomeControl&&v.push(this.homeButton=new e.Button({element:this.homeButton?e.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Home"),srcRest:T(this.prefixUrl,A.home.REST),srcGroup:T(this.prefixUrl,A.home.GROUP),srcHover:T(this.prefixUrl,A.home.HOVER),srcDown:T(this.prefixUrl,A.home.DOWN),onRelease:r,onFocus:g,onBlur:h})),this.showFullPageControl&&v.push(this.fullPageButton=new e.Button({element:this.fullPageButton?e.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.FullPage"),srcRest:T(this.prefixUrl,A.fullpage.REST),srcGroup:T(this.prefixUrl,A.fullpage.GROUP),srcHover:T(this.prefixUrl,A.fullpage.HOVER),srcDown:T(this.prefixUrl,A.fullpage.DOWN),onRelease:d,onFocus:g,onBlur:h})),this.showRotationControl&&(v.push(this.rotateLeftButton=new e.Button({element:this.rotateLeftButton?e.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateLeft"),srcRest:T(this.prefixUrl,A.rotateleft.REST),srcGroup:T(this.prefixUrl,A.rotateleft.GROUP),srcHover:T(this.prefixUrl,A.rotateleft.HOVER),srcDown:T(this.prefixUrl,A.rotateleft.DOWN),onRelease:l,onFocus:g,onBlur:h})),v.push(this.rotateRightButton=new e.Button({element:this.rotateRightButton?e.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.RotateRight"),srcRest:T(this.prefixUrl,A.rotateright.REST),srcGroup:T(this.prefixUrl,A.rotateright.GROUP),srcHover:T(this.prefixUrl,A.rotateright.HOVER),srcDown:T(this.prefixUrl,A.rotateright.DOWN),onRelease:s,onFocus:g,onBlur:h}))),this.showFlipControl&&v.push(this.flipButton=new e.Button({element:this.flipButton?e.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:e.getString("Tooltips.Flip"),srcRest:T(this.prefixUrl,A.flip.REST),srcGroup:T(this.prefixUrl,A.flip.GROUP),srcHover:T(this.prefixUrl,A.flip.HOVER),srcDown:T(this.prefixUrl,A.flip.DOWN),onRelease:u,onFocus:g,onBlur:h})),m&&(this.buttons=new e.ButtonGroup({buttons:v,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",e.delegate(this,P)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||e.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&e>=0&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(n,t,i,r){var d;if(d=e.isPlainObject(n)?n:{element:n,location:t,placement:i,onDraw:r},n=e.getElement(d.element),o(this.currentOverlays,n)>=0)return this;var l=a(this,d);return this.currentOverlays.push(l),l.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:n,location:d.location,placement:d.placement}),this},updateOverlay:function(n,t,a){var i;return n=e.getElement(n),i=o(this.currentOverlays,n),i>=0&&(this.currentOverlays[i].update(t,a),M[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:n,location:t,placement:a})),this},removeOverlay:function(n){var t;return n=e.getElement(n),t=o(this.currentOverlays,n),t>=0&&(this.currentOverlays[t].destroy(),this.currentOverlays.splice(t,1),M[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:n})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return M[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(n){var t;return n=e.getElement(n),t=o(this.currentOverlays,n),t>=0?this.currentOverlays[t]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(e>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(n){this._hideMessage();var t=e.makeNeutralElement("div");t.appendChild(document.createTextNode(n)),this.messageDiv=e.makeCenteredNode(t),e.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,n=this.currentOverlays.length;for(e=0;e<n;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new e.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else e.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(e){function n(e){var n={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",n),!n.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var t=this.viewport.pointFromPixel(e.position);this.panVertical?this.panHorizontal||(t.x=this.viewer.viewport.getCenter(!0).x):t.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(t),this.viewer.viewport.applyConstraints()}}function t(e){var n={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",n),!n.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function a(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function o(e){return this.viewer.raiseEvent("navigator-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function i(e,n){r(e,"rotate("+n+"deg)")}function r(e,n){e.style.webkitTransform=n,e.style.mozTransform=n,e.style.msTransform=n,e.style.oTransform=n,e.style.transform=n}e.Navigator=function(r){function d(e){i(f.displayRegionContainer,e),i(f.displayRegion,-e),f.viewport.setRotation(e)}var l,s,c=r.viewer,f=this;if(r.id?(this.element=document.getElementById(r.id),r.controlOptions={anchor:e.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(r.id="navigator-"+e.now(),this.element=e.makeNeutralElement("div"),r.controlOptions={anchor:e.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:r.autoFade},r.position&&("BOTTOM_RIGHT"==r.position?r.controlOptions.anchor=e.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==r.position?r.controlOptions.anchor=e.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==r.position?r.controlOptions.anchor=e.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==r.position?r.controlOptions.anchor=e.ControlAnchor.TOP_LEFT:"ABSOLUTE"==r.position&&(r.controlOptions.anchor=e.ControlAnchor.ABSOLUTE,r.controlOptions.top=r.top,r.controlOptions.left=r.left,r.controlOptions.height=r.height,r.controlOptions.width=r.width))),this.element.id=r.id,this.element.className+=" navigator",r=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.navigatorSizeRatio},r,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:r.autoResize,minZoomImageRatio:1,background:r.background,opacity:r.opacity,borderColor:r.borderColor,displayRegionColor:r.displayRegionColor}),r.minPixelRatio=this.minPixelRatio=c.minPixelRatio,e.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new e.Point(1,1),this.totalBorderWidths=new e.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),r.controlOptions.anchor!=e.ControlAnchor.NONE&&function(e,n){e.margin="0px",e.border=n+"px solid "+r.borderColor,e.padding="0px",e.background=r.background,e.opacity=r.opacity,e.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=e.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(e,n){e.position="relative",e.top="0px",e.left="0px",e.fontSize="0px",e.overflow="hidden",e.border=n+"px solid "+r.displayRegionColor,e.margin="0px",e.padding="0px",e.background="transparent",e.float="left",e.cssFloat="left",e.styleFloat="left",e.zIndex=999999999,e.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=e.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",c.addControl(this.element,r.controlOptions),this._resizeWithViewer=r.controlOptions.anchor!=e.ControlAnchor.ABSOLUTE&&r.controlOptions.anchor!=e.ControlAnchor.NONE,this._resizeWithViewer&&(r.width&&r.height?(this.element.style.height="number"==typeof r.height?r.height+"px":r.height,this.element.style.width="number"==typeof r.width?r.width+"px":r.width):(l=e.getElementSize(c.element),this.element.style.height=Math.round(l.y*r.sizeRatio)+"px",this.element.style.width=Math.round(l.x*r.sizeRatio)+"px",this.oldViewerSize=l),s=e.getElementSize(this.element),this.elementArea=s.x*s.y),this.oldContainerSize=new e.Point(0,0),e.Viewer.apply(this,[r]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),r.navigatorRotate){d(r.viewer.viewport?r.viewer.viewport.getRotation():r.viewer.degrees||0),r.viewer.addHandler("rotate",function(e){d(e.degrees)})}this.innerTracker.destroy(),this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,t),clickHandler:e.delegate(this,n),releaseHandler:e.delegate(this,a),scrollHandler:e.delegate(this,o)}),this.addHandler("reset-size",function(){f.viewport&&f.viewport.goHome(!0)}),c.world.addHandler("item-index-change",function(e){window.setTimeout(function(){var n=f.world.getItemAt(e.previousIndex);f.world.setItemIndex(n,e.newIndex)},1)}),c.world.addHandler("remove-item",function(e){var n=e.item,t=f._getMatchingItem(n);t&&f.world.removeItem(t)}),this.update(c.viewport)},e.extend(e.Navigator.prototype,e.EventSource.prototype,e.Viewer.prototype,{updateSize:function(){if(this.viewport){var n=new e.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);n.equals(this.oldContainerSize)||(this.viewport.resize(n,!0),this.viewport.goHome(!0),this.oldContainerSize=n,this.drawer.clear(),this.world.draw())}},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){r(this.displayRegion,e),r(this.canvas,e),r(this.element,e)},update:function(n){var t,a,o,i,r,d;if(t=e.getElementSize(this.viewer.element),this._resizeWithViewer&&t.x&&t.y&&!t.equals(this.oldViewerSize)&&(this.oldViewerSize=t,this.maintainSizeRatio||!this.elementArea?(a=t.x*this.sizeRatio,o=t.y*this.sizeRatio):(a=Math.sqrt(this.elementArea*(t.x/t.y)),o=this.elementArea/a),this.element.style.width=Math.round(a)+"px",this.element.style.height=Math.round(o)+"px",this.elementArea||(this.elementArea=a*o),this.updateSize()),n&&this.viewport){i=n.getBoundsNoRotate(!0),r=this.viewport.pixelFromPointNoRotate(i.getTopLeft(),!1),d=this.viewport.pixelFromPointNoRotate(i.getBottomRight(),!1).minus(this.totalBorderWidths);var l=this.displayRegion.style;l.display=this.world.getItemCount()?"block":"none",l.top=Math.round(r.y)+"px",l.left=Math.round(r.x)+"px";var s=Math.abs(r.x-d.x),c=Math.abs(r.y-d.y);l.width=Math.round(Math.max(s,0))+"px",l.height=Math.round(Math.max(c,0))+"px"}},addTiledImage:function(n){var t=this,a=n.originalTiledImage;delete n.original;var o=e.extend({},n,{success:function(e){function n(){t._matchBounds(r,a)}function o(){t._matchOpacity(r,a)}function i(){t._matchCompositeOperation(r,a)}var r=e.item;r._originalForNavigator=a,t._matchBounds(r,a,!0),a.addHandler("bounds-change",n),a.addHandler("clip-change",n),a.addHandler("opacity-change",o),a.addHandler("composite-operation-change",i)}});return e.Viewer.prototype.addTiledImage.apply(this,[o])},_getMatchingItem:function(e){for(var n,t=this.world.getItemCount(),a=0;a<t;a++)if(n=this.world.getItemAt(a),n._originalForNavigator===e)return n;return null},_matchBounds:function(e,n,t){var a=n.getBoundsNoRotate();e.setPosition(a.getTopLeft(),t),e.setWidth(a.width,t),e.setRotation(n.getRotation(),t),e.setClip(n.getClip())},_matchOpacity:function(e,n){e.setOpacity(n.opacity)},_matchCompositeOperation:function(e,n){e.setCompositeOperation(n.compositeOperation)}})}(OpenSeadragon),function(e){var n={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};e.extend(e,{getString:function(t){var a,o=t.split("."),i=null,r=arguments,d=n;for(a=0;a<o.length-1;a++)d=d[o[a]]||{};return i=d[o[a]],"string"!=typeof i&&(e.console.log("Untranslated source string:",t),i=""),i.replace(/\{\d+\}/g,function(e){var n=parseInt(e.match(/\d+/),10)+1;return n<r.length?r[n]:""})},setString:function(e,t){var a,o=e.split("."),i=n;for(a=0;a<o.length-1;a++)i[o[a]]||(i[o[a]]={}),i=i[o[a]];i[o[a]]=t}})}(OpenSeadragon),function(e){e.Point=function(e,n){this.x="number"==typeof e?e:0,this.y="number"==typeof n?n:0},e.Point.prototype={clone:function(){return new e.Point(this.x,this.y)},plus:function(n){return new e.Point(this.x+n.x,this.y+n.y)},minus:function(n){return new e.Point(this.x-n.x,this.y-n.y)},times:function(n){return new e.Point(this.x*n,this.y*n)},divide:function(n){return new e.Point(this.x/n,this.y/n)},negate:function(){return new e.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(n){return new e.Point(n(this.x),n(this.y))},equals:function(n){return n instanceof e.Point&&this.x===n.x&&this.y===n.y},rotate:function(n,t){t=t||new e.Point(0,0);var a,o;if(n%90==0){switch(e.positiveModulo(n,360)){case 0:a=1,o=0;break;case 90:a=0,o=1;break;case 180:a=-1,o=0;break;case 270:a=0,o=-1}}else{var i=n*Math.PI/180;a=Math.cos(i),o=Math.sin(i)}var r=a*(this.x-t.x)-o*(this.y-t.y)+t.x,d=o*(this.x-t.x)+a*(this.y-t.y)+t.y;return new e.Point(r,d)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(e){function n(n){var t,a,o=n.responseText,i=n.status;if(!n)throw new Error(e.getString("Errors.Security"));if(200!==n.status&&0!==n.status)throw i=n.status,t=404==i?"Not Found":n.statusText,new Error(e.getString("Errors.Status",i,t));if(o.match(/\s*<.*/))try{a=n.responseXML&&n.responseXML.documentElement?n.responseXML:e.parseXml(o)}catch(r){a=n.responseText}else if(o.match(/\s*[\{\[].*/))try{a=e.parseJSON(o)}catch(r){a=o}else a=o;return a}e.TileSource=function(n,t,a,o,i,r){var d,l,s=this,c=arguments;if(d=e.isPlainObject(n)?n:{width:c[0],height:c[1],tileSize:c[2],tileOverlap:c[3],minLevel:c[4],maxLevel:c[5]},e.EventSource.call(this),e.extend(!0,this,d),!this.success)for(l=0;l<arguments.length;l++)if(e.isFunction(arguments[l])){this.success=arguments[l];break}this.success&&this.addHandler("ready",function(e){s.success(e)}),"string"==e.type(arguments[0])&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new e.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=d.width&&d.height?d.width/d.height:1,this.dimensions=new e.Point(d.width,d.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=d.tileOverlap?d.tileOverlap:0,this.minLevel=d.minLevel?d.minLevel:0,this.maxLevel=void 0!==d.maxLevel&&null!==d.maxLevel?d.maxLevel:d.width&&d.height?Math.ceil(Math.log(Math.max(d.width,d.height))/Math.log(2)):0,this.success&&e.isFunction(this.success)&&this.success(this))},e.TileSource.prototype={getTileSize:function(n){return e.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},getLevelScale:function(e){var n,t={};for(n=0;n<=this.maxLevel;n++)t[n]=1/Math.pow(2,this.maxLevel-n);return this.getLevelScale=function(e){return t[e]},this.getLevelScale(e)},getNumTiles:function(n){var t=this.getLevelScale(n),a=Math.ceil(t*this.dimensions.x/this.getTileWidth(n)),o=Math.ceil(t*this.dimensions.y/this.getTileHeight(n));return new e.Point(a,o)},getPixelRatio:function(n){var t=this.dimensions.times(this.getLevelScale(n)),a=1/t.x,o=1/t.y;return new e.Point(a,o)},getClosestLevel:function(){var e,n;for(e=this.minLevel+1;e<=this.maxLevel&&(n=this.getNumTiles(e),!(n.x>1||n.y>1));e++);return e-1},getTileAtPoint:function(n,t){var a=t.x>=0&&t.x<=1&&t.y>=0&&t.y<=1/this.aspectRatio;e.console.assert(a,"[TileSource.getTileAtPoint] must be called with a valid point.");var o=this.dimensions.x*this.getLevelScale(n),i=t.x*o,r=t.y*o,d=Math.floor(i/this.getTileWidth(n)),l=Math.floor(r/this.getTileHeight(n));return t.x>=1&&(d=this.getNumTiles(n).x-1),t.y>=1/this.aspectRatio-1e-15&&(l=this.getNumTiles(n).y-1),new e.Point(d,l)},getTileBounds:function(n,t,a,o){var i=this.dimensions.times(this.getLevelScale(n)),r=this.getTileWidth(n),d=this.getTileHeight(n),l=0===t?0:r*t-this.tileOverlap,s=0===a?0:d*a-this.tileOverlap,c=r+(0===t?1:2)*this.tileOverlap,f=d+(0===a?1:2)*this.tileOverlap,u=1/i.x;return c=Math.min(c,i.x-l),f=Math.min(f,i.y-s),o?new e.Rect(0,0,c,f):new e.Rect(l*u,s*u,c*u,f*u)},getImageInfo:function(t){var a,o,i,r,d,l,s,c=this;t&&(d=t.split("/"),l=d[d.length-1],(s=l.lastIndexOf("."))>-1&&(d[d.length-1]=l.slice(0,s))),o=function(n){"string"==typeof n&&(n=e.parseXml(n));var a=e.TileSource.determineType(c,n,t);if(!a)return void c.raiseEvent("open-failed",{message:"Unable to load TileSource",source:t});r=a.prototype.configure.apply(c,[n,t]),void 0===r.ajaxWithCredentials&&(r.ajaxWithCredentials=c.ajaxWithCredentials),i=new a(r),c.ready=!0,c.raiseEvent("ready",{tileSource:i})},t.match(/\.js$/)?(a=t.split("/").pop().replace(".js",""),e.jsonp({url:t,async:!1,callbackName:a,callback:o})):e.makeAjaxRequest({url:t,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var t=n(e);o(t)},error:function(e,n){var a;try{a="HTTP "+e.status+" attempting to load TileSource"}catch(i){var o;o=void 0!==n&&n.toString?n.toString():"Unknown error",a=o+" attempting to load TileSource"}c.raiseEvent("open-failed",{message:a,source:t})}})},supports:function(e,n){return!1},configure:function(e,n){throw new Error("Method not implemented.")},getTileUrl:function(e,n,t){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(e,n,t){return{}},tileExists:function(e,n,t){var a=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&n>=0&&t>=0&&n<a.x&&t<a.y}},e.extend(!0,e.TileSource.prototype,e.EventSource.prototype),e.TileSource.determineType=function(n,t,a){var o;for(o in OpenSeadragon)if(o.match(/.+TileSource$/)&&e.isFunction(OpenSeadragon[o])&&e.isFunction(OpenSeadragon[o].prototype.supports)&&OpenSeadragon[o].prototype.supports.call(n,t,a))return OpenSeadragon[o];e.console.error("No TileSource was able to open %s %s",a,t)}}(OpenSeadragon),function(e){function n(n,a){if(!a||!a.documentElement)throw new Error(e.getString("Errors.Xml"));var o,i,r,d,l,s=a.documentElement,c=s.localName||s.tagName,f=a.documentElement.namespaceURI,u=null,g=[];if("Image"==c)try{if(d=s.getElementsByTagName("Size")[0],void 0===d&&(d=s.getElementsByTagNameNS(f,"Size")[0]),u={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:s.getAttribute("Url"),Format:s.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(s.getAttribute("Overlap"),10),TileSize:parseInt(s.getAttribute("TileSize"),10),Size:{Height:parseInt(d.getAttribute("Height"),10),Width:parseInt(d.getAttribute("Width"),10)}}},!e.imageFormatSupported(u.Image.Format))throw new Error(e.getString("Errors.ImageFormat",u.Image.Format.toUpperCase()));for(o=s.getElementsByTagName("DisplayRect"),void 0===o&&(o=s.getElementsByTagNameNS(f,"DisplayRect")[0]),l=0;l<o.length;l++)i=o[l],r=i.getElementsByTagName("Rect")[0],void 0===r&&(r=i.getElementsByTagNameNS(f,"Rect")[0]),g.push({Rect:{X:parseInt(r.getAttribute("X"),10),Y:parseInt(r.getAttribute("Y"),10),Width:parseInt(r.getAttribute("Width"),10),Height:parseInt(r.getAttribute("Height"),10),MinLevel:parseInt(i.getAttribute("MinLevel"),10),MaxLevel:parseInt(i.getAttribute("MaxLevel"),10)}});return g.length&&(u.Image.DisplayRect=g),t(n,u)}catch(v){throw v instanceof Error?v:new Error(e.getString("Errors.Dzi"))}else{if("Collection"==c)throw new Error(e.getString("Errors.Dzc"));if("Error"==c){var h=s.getElementsByTagName("Message")[0],A=h.firstChild.nodeValue;throw new Error(A)}}throw new Error(e.getString("Errors.Dzi"))}function t(n,t){var a,o,i=t.Image,r=i.Url,d=i.Format,l=i.Size,s=i.DisplayRect||[],c=parseInt(l.Width,10),f=parseInt(l.Height,10),u=parseInt(i.TileSize,10),g=parseInt(i.Overlap,10),h=[];for(o=0;o<s.length;o++)a=s[o].Rect,h.push(new e.DisplayRect(parseInt(a.X,10),parseInt(a.Y,10),parseInt(a.Width,10),parseInt(a.Height,10),parseInt(a.MinLevel,10),parseInt(a.MaxLevel,10)));return e.extend(!0,{width:c,height:f,tileSize:u,tileOverlap:g,minLevel:null,maxLevel:null,tilesUrl:r,fileFormat:d,displayRects:h},t)}e.DziTileSource=function(n,t,a,o,i,r,d,l,s){var c,f,u,g;if(g=e.isPlainObject(n)?n:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=g.tilesUrl,this.fileFormat=g.fileFormat,this.displayRects=g.displayRects,this.displayRects)for(c=this.displayRects.length-1;c>=0;c--)for(f=this.displayRects[c],u=f.minLevel;u<=f.maxLevel;u++)this._levelRects[u]||(this._levelRects[u]=[]),this._levelRects[u].push(f);e.TileSource.apply(this,[g])},e.extend(e.DziTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){var t;return e.Image?t=e.Image.xmlns:e.documentElement&&("Image"!=e.documentElement.localName&&"Image"!=e.documentElement.tagName||(t=e.documentElement.namespaceURI)),t=(t||"").toLowerCase(),-1!==t.indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==t.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(a,o){var i;return i=e.isPlainObject(a)?t(this,a):n(this,a),o&&!i.tilesUrl&&(i.tilesUrl=o.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=o.search(/\.(dzi|xml|js)\?/)?i.queryParams=o.match(/\?.*/):i.queryParams=""),i},getTileUrl:function(e,n,t){return[this.tilesUrl,e,"/",n,"_",t,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,n,t){var a,o,i,r,d,l,s,c=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!c||!c.length)return!0;for(s=c.length-1;s>=0;s--)if(a=c[s],!(e<a.minLevel||e>a.maxLevel)&&(o=this.getLevelScale(e),i=a.x*o,r=a.y*o,d=i+a.width*o,l=r+a.height*o,i=Math.floor(i/this._tileWidth),r=Math.floor(r/this._tileWidth),d=Math.ceil(d/this._tileWidth),l=Math.ceil(l/this._tileWidth),i<=n&&n<d&&r<=t&&t<l))return!0;return!1}})}(OpenSeadragon),function(e){function n(e){var n=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"],t=-1!==n.indexOf(e[0]),a=!1;return e.length>1&&e[1].supports&&(a=-1!==e[1].supports.indexOf("sizeByW")),!t||a}function t(e){for(var n=[],t=0;t<e.sizes.length;t++)n.push({url:e["@id"]+"/full/"+e.sizes[t].width+",/0/default."+e.tileFormat,width:e.sizes[t].width,height:e.sizes[t].height});return n.sort(function(e,n){return e.width-n.width})}function a(n){if(!n||!n.documentElement)throw new Error(e.getString("Errors.Xml"));var t=n.documentElement,a=t.tagName,i=null
;if("info"==a)try{return i={},o(t,i),i}catch(r){throw r instanceof Error?r:new Error(e.getString("Errors.IIIF"))}throw new Error(e.getString("Errors.IIIF"))}function o(n,t,a){var i,r;if(3==n.nodeType&&a)r=n.nodeValue.trim(),r.match(/^\d*$/)&&(r=Number(r)),t[a]?(e.isArray(t[a])||(t[a]=[t[a]]),t[a].push(r)):t[a]=r;else if(1==n.nodeType)for(i=0;i<n.childNodes.length;i++)o(n.childNodes[i],t,n.nodeName)}e.IIIFTileSource=function(a){if(e.extend(!0,this,a),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(a.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.tile_width&&this.tile_height)a.tileWidth=this.tile_width,a.tileHeight=this.tile_height;else if(this.tile_width)a.tileSize=this.tile_width;else if(this.tile_height)a.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)a.tileWidth=this.tiles[0].width,a.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var o=0;o<this.tiles.length;o++)for(var i=0;i<this.tiles[o].scaleFactors.length;i++){var r=this.tiles[o].scaleFactors[i];this.scale_factors.push(r),a.tileSizePerScaleFactor[r]={width:this.tiles[o].width,height:this.tiles[o].height||this.tiles[o].width}}}else if(n(a.profile)){for(var d=Math.min(this.height,this.width),l=[256,512,1024],s=[],c=0;c<l.length;c++)l[c]<=d&&s.push(l[c]);s.length>0?a.tileSize=Math.max.apply(null,s):a.tileSize=d}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,a.levels=t(this),e.extend(!0,a,{width:a.levels[a.levels.length-1].width,height:a.levels[a.levels.length-1].height,tileSize:Math.max(a.height,a.width),tileOverlap:0,minLevel:0,maxLevel:a.levels.length-1}),this.levels=a.levels):e.console.error("Nothing in the info.json to construct image pyramids from");if(!a.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var f=Math.max.apply(null,this.scale_factors);a.maxLevel=Math.round(Math.log(f)*Math.LOG2E)}else a.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));e.TileSource.apply(this,[a])},e.extend(e.IIIFTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){return!(!e.protocol||"http://iiif.io/api/image"!=e.protocol)||(!(!e["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=e["@context"]&&"http://iiif.io/api/image/1/context.json"!=e["@context"])||(!(!e.profile||0!==e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(e.identifier&&e.width&&e.height)||!(!e.documentElement||"info"!=e.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=e.documentElement.namespaceURI))))},configure:function(n,t){if(e.isPlainObject(n)){if(n["@context"]||(n["@context"]="http://iiif.io/api/image/1.0/context.json",n["@id"]=t.replace("/info.json","")),n.preferredFormats)for(var o=0;o<n.preferredFormats.length;o++)if(OpenSeadragon.imageFormatSupported(n.preferredFormats[o])){n.tileFormat=n.preferredFormats[o];break}return n}var i=a(n);return i["@context"]="http://iiif.io/api/image/1.0/context.json",i["@id"]=t.replace("/info.xml",""),i},getTileWidth:function(n){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileWidth.call(this,n);var t=Math.pow(2,this.maxLevel-n);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].width:this._tileWidth},getTileHeight:function(n){if(this.emulateLegacyImagePyramid)return e.TileSource.prototype.getTileHeight.call(this,n);var t=Math.pow(2,this.maxLevel-n);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].height:this._tileHeight},getLevelScale:function(n){if(this.emulateLegacyImagePyramid){var t=NaN;return this.levels.length>0&&n>=this.minLevel&&n<=this.maxLevel&&(t=this.levels[n].width/this.levels[this.maxLevel].width),t}return e.TileSource.prototype.getLevelScale.call(this,n)},getNumTiles:function(n){if(this.emulateLegacyImagePyramid){return this.getLevelScale(n)?new e.Point(1,1):new e.Point(0,0)}return e.TileSource.prototype.getNumTiles.call(this,n)},getTileAtPoint:function(n,t){return this.emulateLegacyImagePyramid?new e.Point(0,0):e.TileSource.prototype.getTileAtPoint.call(this,n,t)},getTileUrl:function(e,n,t){if(this.emulateLegacyImagePyramid){var a=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(a=this.levels[e].url),a}var o,i,r,d,l,s,c,f,u,g,h,A,v,m="0",S=Math.pow(.5,this.maxLevel-e),p=Math.ceil(this.width*S),w=Math.ceil(this.height*S);return o=this.getTileWidth(e),i=this.getTileHeight(e),r=Math.ceil(o/S),d=Math.ceil(i/S),v=this["@context"].indexOf("/1.0/context.json")>-1||this["@context"].indexOf("/1.1/context.json")>-1||this["@context"].indexOf("/1/context.json")>-1,A=v?"native."+this.tileFormat:"default."+this.tileFormat,p<o&&w<i?(g=v||p!==this.width?p+",":"max",l="full"):(s=n*r,c=t*d,f=Math.min(r,this.width-s),u=Math.min(d,this.height-c),l=0===n&&0===t&&f===this.width&&u===this.height?"full":[s,c,f,u].join(","),h=Math.ceil(f*S),g=v||h!==this.width?h+",":"max"),[this["@id"],l,g,m,A].join("/")}})}(OpenSeadragon),function(e){e.OsmTileSource=function(n,t,a,o,i){var r;r=e.isPlainObject(n)?n:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},r.width&&r.height||(r.width=65572864,r.height=65572864),r.tileSize||(r.tileSize=256,r.tileOverlap=0),r.tilesUrl||(r.tilesUrl="http://tile.openstreetmap.org/"),r.minLevel=8,e.TileSource.apply(this,[r])},e.extend(e.OsmTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){return e.type&&"openstreetmaps"==e.type},configure:function(e,n){return e},getTileUrl:function(e,n,t){return this.tilesUrl+(e-8)+"/"+n+"/"+t+".png"}})}(OpenSeadragon),function(e){e.TmsTileSource=function(n,t,a,o,i){var r;r=e.isPlainObject(n)?n:{width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var d,l=256*Math.ceil(r.width/256),s=256*Math.ceil(r.height/256);d=l>s?l/256:s/256,r.maxLevel=Math.ceil(Math.log(d)/Math.log(2))-1,r.tileSize=256,r.width=l,r.height=s,e.TileSource.apply(this,[r])},e.extend(e.TmsTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){return e.type&&"tiledmapservice"==e.type},configure:function(e,n){return e},getTileUrl:function(e,n,t){var a=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+n+"/"+(a-t)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(e){e.tileSize=256;var n={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(n.x,10)>e.tileSize||parseInt(n.y,10)>e.tileSize;)n.x=Math.floor(n.x/2),n.y=Math.floor(n.y/2),e.imageSizes.push({x:n.x,y:n.y}),e.gridSize.push(this._getGridSize(n.x,n.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,n,t){return{x:Math.ceil(e/t),y:Math.ceil(n/t)}},_calculateAbsoluteTileNumber:function(e,n,t){for(var a=0,o={},i=0;i<e;i++)o=this.gridSize[i],a+=o.x*o.y;return o=this.gridSize[e],a+=o.x*t+n},supports:function(e,n){return e.type&&"zoomifytileservice"==e.type},configure:function(e,n){return e},getTileUrl:function(e,n,t){var a=0,o=this._calculateAbsoluteTileNumber(e,n,t);return a=Math.floor(o/256),this.tilesUrl+"TileGroup"+a+"/"+e+"-"+n+"-"+t+".jpg"}})}(OpenSeadragon),function(e){function n(n){var t,a,o=[];for(a=0;a<n.length;a++)t=n[a],t.height&&t.width&&t.url?o.push({url:t.url,width:Number(t.width),height:Number(t.height)}):e.console.error("Unsupported image format: %s",t.url?t.url:"<no URL>");return o.sort(function(e,n){return e.height-n.height})}function t(n,t){if(!t||!t.documentElement)throw new Error(e.getString("Errors.Xml"));var o,i,r=t.documentElement,d=r.tagName,l=null,s=[];if("image"==d)try{for(l={type:r.getAttribute("type"),levels:[]},s=r.getElementsByTagName("level"),i=0;i<s.length;i++)o=s[i],l.levels.push({url:o.getAttribute("url"),width:parseInt(o.getAttribute("width"),10),height:parseInt(o.getAttribute("height"),10)});return a(n,l)}catch(c){throw c instanceof Error?c:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==d)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==d)throw new Error("Error: "+t)}throw new Error("Unknown element "+d)}function a(e,n){return n.levels}e.LegacyTileSource=function(t){var a,o,i;e.isArray(t)&&(a={type:"legacy-image-pyramid",levels:t}),a.levels=n(a.levels),a.levels.length>0?(o=a.levels[a.levels.length-1].width,i=a.levels[a.levels.length-1].height):(o=0,i=0,e.console.error("No supported image formats found")),e.extend(!0,a,{width:o,height:i,tileSize:Math.max(i,o),tileOverlap:0,minLevel:0,maxLevel:a.levels.length>0?a.levels.length-1:0}),e.TileSource.apply(this,[a]),this.levels=a.levels},e.extend(e.LegacyTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(n,o){return e.isPlainObject(n)?a(this,n):t(this,n)},getLevelScale:function(e){var n=NaN;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].width/this.levels[this.maxLevel].width),n},getNumTiles:function(n){return this.getLevelScale(n)?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,n,t){var a=null;return this.levels.length>0&&e>=this.minLevel&&e<=this.maxLevel&&(a=this.levels[e].url),a}})}(OpenSeadragon),function(e){e.ImageTileSource=function(n){n=e.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},n),e.TileSource.apply(this,[n])},e.extend(e.ImageTileSource.prototype,e.TileSource.prototype,{supports:function(e,n){return e.type&&"image"===e.type},configure:function(e,n){return e},getImageInfo:function(n){var t=this._image=new Image,a=this;this.crossOriginPolicy&&(t.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(t.useCredentials=this.ajaxWithCredentials),e.addEvent(t,"load",function(){a.width=Object.prototype.hasOwnProperty.call(t,"naturalWidth")?t.naturalWidth:t.width,a.height=Object.prototype.hasOwnProperty.call(t,"naturalHeight")?t.naturalHeight:t.height,a.aspectRatio=a.width/a.height,a.dimensions=new e.Point(a.width,a.height),a._tileWidth=a.width,a._tileHeight=a.height,a.tileOverlap=0,a.minLevel=0,a.levels=a._buildLevels(),a.maxLevel=a.levels.length-1,a.ready=!0,a.raiseEvent("ready",{tileSource:a})}),e.addEvent(t,"error",function(){a.raiseEvent("open-failed",{message:"Error loading image at "+n,source:n})}),t.src=n},getLevelScale:function(e){var n=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(n=this.levels[e].width/this.levels[this.maxLevel].width),n},getNumTiles:function(n){return this.getLevelScale(n)?new e.Point(1,1):new e.Point(0,0)},getTileUrl:function(e,n,t){var a=null;return e>=this.minLevel&&e<=this.maxLevel&&(a=this.levels[e].url),a},getContext2D:function(e,n,t){var a=null;return e>=this.minLevel&&e<=this.maxLevel&&(a=this.levels[e].context2D),a},_buildLevels:function(){var n=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!e.supportsCanvas||!this.useCanvas)return delete this._image,n;var t=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,a=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,o=document.createElement("canvas"),i=o.getContext("2d");if(o.width=t,o.height=a,i.drawImage(this._image,0,0,t,a),n[0].context2D=i,delete this._image,e.isCanvasTainted(o))return n;for(;t>=2&&a>=2;){t=Math.floor(t/2),a=Math.floor(a/2);var r=document.createElement("canvas"),d=r.getContext("2d");r.width=t,r.height=a,d.drawImage(o,0,0,t,a),n.splice(0,0,{context2D:d,width:t,height:a}),o=r,i=d}return n}})}(OpenSeadragon),function(e){e.TileSourceCollection=function(n,t,a,o){e.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(e){function n(n){e.requestAnimationFrame(function(){t(n)})}function t(t){var a,o,i;t.shouldFade&&(a=e.now(),o=a-t.fadeBeginTime,i=1-o/t.fadeLength,i=Math.min(1,i),i=Math.max(0,i),t.imgGroup&&e.setElementOpacity(t.imgGroup,i,!0),i>0&&n(t))}function a(t){t.shouldFade=!0,t.fadeBeginTime=e.now()+t.fadeDelay,window.setTimeout(function(){n(t)},t.fadeDelay)}function o(n){n.shouldFade=!1,n.imgGroup&&e.setElementOpacity(n.imgGroup,1,!0)}function i(n,t){n.element.disabled||(t>=e.ButtonState.GROUP&&n.currentState==e.ButtonState.REST&&(o(n),n.currentState=e.ButtonState.GROUP),t>=e.ButtonState.HOVER&&n.currentState==e.ButtonState.GROUP&&(n.imgHover&&(n.imgHover.style.visibility=""),n.currentState=e.ButtonState.HOVER),t>=e.ButtonState.DOWN&&n.currentState==e.ButtonState.HOVER&&(n.imgDown&&(n.imgDown.style.visibility=""),n.currentState=e.ButtonState.DOWN))}function r(n,t){n.element.disabled||(t<=e.ButtonState.HOVER&&n.currentState==e.ButtonState.DOWN&&(n.imgDown&&(n.imgDown.style.visibility="hidden"),n.currentState=e.ButtonState.HOVER),t<=e.ButtonState.GROUP&&n.currentState==e.ButtonState.HOVER&&(n.imgHover&&(n.imgHover.style.visibility="hidden"),n.currentState=e.ButtonState.GROUP),t<=e.ButtonState.REST&&n.currentState==e.ButtonState.GROUP&&(a(n),n.currentState=e.ButtonState.REST))}e.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},e.Button=function(n){var t=this;e.EventSource.call(this),e.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},n),this.element=n.element||e.makeNeutralElement("div"),n.element||(this.imgRest=e.makeTransparentImage(this.srcRest),this.imgGroup=e.makeTransparentImage(this.srcGroup),this.imgHover=e.makeTransparentImage(this.srcHover),this.imgDown=e.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",e.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",e.Browser.vendor==e.BROWSERS.FIREFOX&&e.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=e.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(n){n.insideElementPressed?(i(t,e.ButtonState.DOWN),t.raiseEvent("enter",{originalEvent:n.originalEvent})):n.buttonDownAny||i(t,e.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),t.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(n){r(t,e.ButtonState.GROUP),n.insideElementPressed&&t.raiseEvent("exit",{originalEvent:n.originalEvent})},blurHandler:function(e){this.exitHandler(e),t.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(n){i(t,e.ButtonState.DOWN),t.raiseEvent("press",{originalEvent:n.originalEvent})},releaseHandler:function(n){n.insideElementPressed&&n.insideElementReleased?(r(t,e.ButtonState.HOVER),t.raiseEvent("release",{originalEvent:n.originalEvent})):n.insideElementPressed?r(t,e.ButtonState.GROUP):i(t,e.ButtonState.HOVER)},clickHandler:function(e){e.quick&&t.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13!==e.keyCode||(t.raiseEvent("click",{originalEvent:e.originalEvent}),t.raiseEvent("release",{originalEvent:e.originalEvent}),!1)}}),r(this,e.ButtonState.REST)},e.extend(e.Button.prototype,e.EventSource.prototype,{notifyGroupEnter:function(){i(this,e.ButtonState.GROUP)},notifyGroupExit:function(){r(this,e.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,e.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,e.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(e){e.ButtonGroup=function(n){e.extend(!0,this,{buttons:[],clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:e.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},n);var t,a=this.buttons.concat([]),o=this;if(this.element=n.element||e.makeNeutralElement("div"),!n.group)for(this.element.style.display="inline-block",t=0;t<a.length;t++)this.element.appendChild(a[t].element);e.setElementTouchActionNone(this.element),this.tracker=new e.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){var n;for(n=0;n<o.buttons.length;n++)o.buttons[n].notifyGroupEnter()},exitHandler:function(e){var n;if(!e.insideElementPressed)for(n=0;n<o.buttons.length;n++)o.buttons[n].notifyGroupExit()}})},e.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(e){e.Rect=function(n,t,a,o,i){this.x="number"==typeof n?n:0,this.y="number"==typeof t?t:0,this.width="number"==typeof a?a:0,this.height="number"==typeof o?o:0,this.degrees="number"==typeof i?i:0,this.degrees=e.positiveModulo(this.degrees,360);var r,d;this.degrees>=270?(r=this.getTopRight(),this.x=r.x,this.y=r.y,d=this.height,this.height=this.width,this.width=d,this.degrees-=270):this.degrees>=180?(r=this.getBottomRight(),this.x=r.x,this.y=r.y,this.degrees-=180):this.degrees>=90&&(r=this.getBottomLeft(),this.x=r.x,this.y=r.y,d=this.height,this.height=this.width,this.width=d,this.degrees-=90)},e.Rect.fromSummits=function(n,t,a){var o=n.distanceTo(t),i=n.distanceTo(a),r=t.minus(n),d=Math.atan(r.y/r.x);return r.x<0?d+=Math.PI:r.y<0&&(d+=2*Math.PI),new e.Rect(n.x,n.y,o,i,d/Math.PI*180)},e.Rect.prototype={clone:function(){return new e.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new e.Point(this.x,this.y)},getBottomRight:function(){return new e.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new e.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new e.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new e.Point(this.width,this.height)},equals:function(n){return n instanceof e.Rect&&this.x===n.x&&this.y===n.y&&this.width===n.width&&this.height===n.height&&this.degrees===n.degrees},times:function(n){return new e.Rect(this.x*n,this.y*n,this.width*n,this.height*n,this.degrees)},translate:function(n){return new e.Rect(this.x+n.x,this.y+n.y,this.width,this.height,this.degrees)},union:function(n){var t=this.getBoundingBox(),a=n.getBoundingBox(),o=Math.min(t.x,a.x),i=Math.min(t.y,a.y),r=Math.max(t.x+t.width,a.x+a.width),d=Math.max(t.y+t.height,a.y+a.height);return new e.Rect(o,i,r-o,d-i)},intersection:function(n){function t(n,t,o,i){var r=t.minus(n),d=i.minus(o),l=-d.x*r.y+r.x*d.y;if(0===l)return null;var s=(r.x*(n.y-o.y)-r.y*(n.x-o.x))/l,c=(d.x*(n.y-o.y)-d.y*(n.x-o.x))/l;return-a<=s&&s<=1-a&&-a<=c&&c<=1-a?new e.Point(n.x+c*r.x,n.y+c*r.y):null}var a=1e-10,o=[],i=this.getTopLeft();n.containsPoint(i,a)&&o.push(i);var r=this.getTopRight();n.containsPoint(r,a)&&o.push(r);var d=this.getBottomLeft();n.containsPoint(d,a)&&o.push(d);var l=this.getBottomRight();n.containsPoint(l,a)&&o.push(l);var s=n.getTopLeft();this.containsPoint(s,a)&&o.push(s);var c=n.getTopRight();this.containsPoint(c,a)&&o.push(c);var f=n.getBottomLeft();this.containsPoint(f,a)&&o.push(f);var u=n.getBottomRight();this.containsPoint(u,a)&&o.push(u);for(var g=this._getSegments(),h=n._getSegments(),A=0;A<g.length;A++)for(var v=g[A],m=0;m<h.length;m++){var S=h[m],p=t(v[0],v[1],S[0],S[1]);p&&o.push(p)}if(0===o.length)return null;for(var w=o[0].x,E=o[0].x,y=o[0].y,C=o[0].y,b=1;b<o.length;b++){var x=o[b];x.x<w&&(w=x.x),x.x>E&&(E=x.x),x.y<y&&(y=x.y),x.y>C&&(C=x.y)}return new e.Rect(w,y,E-w,C-y)},_getSegments:function(){var e=this.getTopLeft(),n=this.getTopRight(),t=this.getBottomLeft(),a=this.getBottomRight();return[[e,n],[n,a],[a,t],[t,e]]},rotate:function(n,t){if(0===(n=e.positiveModulo(n,360)))return this.clone();t=t||this.getCenter();var a=this.getTopLeft().rotate(n,t),o=this.getTopRight().rotate(n,t),i=o.minus(a);i=i.apply(function(e){return Math.abs(e)<1e-15?0:e});var r=Math.atan(i.y/i.x);return i.x<0?r+=Math.PI:i.y<0&&(r+=2*Math.PI),new e.Rect(a.x,a.y,this.width,this.height,r/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var n=this.getTopLeft(),t=this.getTopRight(),a=this.getBottomLeft(),o=this.getBottomRight(),i=Math.min(n.x,t.x,a.x,o.x),r=Math.max(n.x,t.x,a.x,o.x),d=Math.min(n.y,t.y,a.y,o.y),l=Math.max(n.y,t.y,a.y,o.y);return new e.Rect(i,d,r-i,l-d)},getIntegerBoundingBox:function(){var n=this.getBoundingBox(),t=Math.floor(n.x),a=Math.floor(n.y),o=Math.ceil(n.width+n.x-t),i=Math.ceil(n.height+n.y-a);return new e.Rect(t,a,o,i)},containsPoint:function(e,n){n=n||0;var t=this.getTopLeft(),a=this.getTopRight(),o=this.getBottomLeft(),i=a.minus(t),r=o.minus(t);return(e.x-t.x)*i.x+(e.y-t.y)*i.y>=-n&&(e.x-a.x)*i.x+(e.y-a.y)*i.y<=n&&(e.x-t.x)*r.x+(e.y-t.y)*r.y>=-n&&(e.x-o.x)*r.x+(e.y-o.y)*r.y<=n},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(e){function n(n){var t=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),i=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),d=e.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?-n.delta.x>0?t>-(i-d.x)&&(this.element.style.marginLeft=t+2*n.delta.x+"px",a(this,d.x,t+2*n.delta.x)):-n.delta.x<0&&t<0&&(this.element.style.marginLeft=t+2*n.delta.x+"px",a(this,d.x,t+2*n.delta.x)):-n.delta.y>0?o>-(r-d.y)&&(this.element.style.marginTop=o+2*n.delta.y+"px",a(this,d.y,o+2*n.delta.y)):-n.delta.y<0&&o<0&&(this.element.style.marginTop=o+2*n.delta.y+"px",a(this,d.y,o+2*n.delta.y))),!1}function t(n){var t=Number(this.element.style.marginLeft.replace("px","")),o=Number(this.element.style.marginTop.replace("px","")),i=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),d=e.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?n.scroll>0?t>-(i-d.x)&&(this.element.style.marginLeft=t-60*n.scroll+"px",a(this,d.x,t-60*n.scroll)):n.scroll<0&&t<0&&(this.element.style.marginLeft=t-60*n.scroll+"px",a(this,d.x,t-60*n.scroll)):n.scroll<0?o>d.y-r&&(this.element.style.marginTop=o+60*n.scroll+"px",a(this,d.y,o+60*n.scroll)):n.scroll>0&&o<0&&(this.element.style.marginTop=o+60*n.scroll+"px",a(this,d.y,o+60*n.scroll))),!1}function a(n,t,a){var o,i,r,d,l,s,c;for(o="horizontal"==n.scroll?n.panelWidth:n.panelHeight,i=Math.ceil(t/o)+5,r=Math.ceil((Math.abs(a)+t)/o)+1,i=r-i,i=i<0?0:i,s=i;s<r&&s<n.panels.length;s++)if(c=n.panels[s],!c.activePanel){var f,u=n.viewer.tileSources[s];f=u.referenceStripThumbnailUrl?{type:"image",url:u.referenceStripThumbnailUrl}:u,d=new e.Viewer({id:c.id,tileSources:[f],element:c,navigatorSizeRatio:n.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0}),d.displayRegion=e.makeNeutralElement("div"),d.displayRegion.id=c.id+"-displayregion",d.displayRegion.className="displayregion",l=d.displayRegion.style,l.position="relative",l.top="0px",l.left="0px",l.fontSize="0px",l.overflow="hidden",l.float="left",l.cssFloat="left",l.styleFloat="left",l.zIndex=999999999,l.cursor="default",l.width=n.panelWidth-4+"px",l.height=n.panelHeight-4+"px",d.displayRegion.innerTracker=new e.MouseTracker({element:d.displayRegion,startDisabled:!0}),c.getElementsByTagName("div")[0].appendChild(d.displayRegion),n.miniViewers[c.id]=d,c.activePanel=!0}}function o(e){var n=e.eventSource.element;return"horizontal"==this.scroll?n.style.marginBottom="0px":n.style.marginLeft="0px",!1}function i(n){var t=n.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="-"+e.getElementSize(t).y/2+"px":t.style.marginLeft="-"+e.getElementSize(t).x/2+"px",!1}function r(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return t.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return t.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return t.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function d(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 61:return t.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return t.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return t.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return t.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return t.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}var l={};e.ReferenceStrip=function(s){var c,f,u,g=this,h=s.viewer,A=e.getElementSize(h.element);for(s.id||(s.id="referencestrip-"+e.now(),this.element=e.makeNeutralElement("div"),this.element.id=s.id,this.element.className="referencestrip"),s=e.extend(!0,{sizeRatio:e.DEFAULT_SETTINGS.referenceStripSizeRatio,position:e.DEFAULT_SETTINGS.referenceStripPosition,scroll:e.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:e.DEFAULT_SETTINGS.clickTimeThreshold},s,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),e.extend(this,s),l[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,f=this.element.style,f.marginTop="0px",f.marginRight="0px",f.marginBottom="0px",f.marginLeft="0px",f.left="0px",f.bottom="0px",f.border="0px",f.background="#000",f.position="relative",e.setElementTouchActionNone(this.element),e.setElementOpacity(this.element,.8),this.viewer=h,this.innerTracker=new e.MouseTracker({element:this.element,dragHandler:e.delegate(this,n),scrollHandler:e.delegate(this,t),enterHandler:e.delegate(this,o),exitHandler:e.delegate(this,i),keyDownHandler:e.delegate(this,r),keyHandler:e.delegate(this,d)}),s.width&&s.height?(this.element.style.width=s.width+"px",this.element.style.height=s.height+"px",h.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):"horizontal"==s.scroll?(this.element.style.width=A.x*s.sizeRatio*h.tileSources.length+12*h.tileSources.length+"px",this.element.style.height=A.y*s.sizeRatio+"px",h.addControl(this.element,{anchor:e.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=A.y*s.sizeRatio*h.tileSources.length+12*h.tileSources.length+"px",this.element.style.width=A.x*s.sizeRatio+"px",h.addControl(this.element,{anchor:e.ControlAnchor.TOP_LEFT})),this.panelWidth=A.x*this.sizeRatio+8,this.panelHeight=A.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},u=0;u<h.tileSources.length;u++)c=e.makeNeutralElement("div"),c.id=this.element.id+"-"+u,c.style.width=g.panelWidth+"px",c.style.height=g.panelHeight+"px",c.style.display="inline",c.style.float="left",c.style.cssFloat="left",c.style.styleFloat="left",c.style.padding="2px",e.setElementTouchActionNone(c),c.innerTracker=new e.MouseTracker({element:c,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(n){n.eventSource.dragging=e.now()},releaseHandler:function(n){var t=n.eventSource,a=t.element.id,o=Number(a.split("-")[2]),i=e.now();n.insideElementPressed&&n.insideElementReleased&&t.dragging&&i-t.dragging<t.clickTimeThreshold&&(t.dragging=null,h.goToPage(o))}}),this.element.appendChild(c),c.activePanel=!1,this.panels.push(c);a(this,"vertical"==this.scroll?A.y:A.x,0),this.setFocus(0)},e.extend(e.ReferenceStrip.prototype,e.EventSource.prototype,e.Viewer.prototype,{setFocus:function(n){var t,i=e.getElement(this.element.id+"-"+n),r=e.getElementSize(this.viewer.canvas),d=Number(this.element.style.width.replace("px","")),l=Number(this.element.style.height.replace("px","")),s=-Number(this.element.style.marginLeft.replace("px","")),c=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==i&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=i,this.currentSelected.style.background="#999","horizontal"==this.scroll?(t=Number(n)*(this.panelWidth+3),t>s+r.x-this.panelWidth?(t=Math.min(t,d-r.x),this.element.style.marginLeft=-t+"px",a(this,r.x,-t)):t<s&&(t=Math.max(0,t-r.x/2),this.element.style.marginLeft=-t+"px",a(this,r.x,-t))):(t=Number(n)*(this.panelHeight+3),t>c+r.y-this.panelHeight?(t=Math.min(t,l-r.y),this.element.style.marginTop=-t+"px",a(this,r.y,-t)):t<c&&(t=Math.max(0,t-r.y/2),this.element.style.marginTop=-t+"px",a(this,r.y,-t))),this.currentPage=n,o.call(this,{eventSource:this.innerTracker}))},update:function(){return!!l[this.id].animating&&(e.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(e){e.DisplayRect=function(n,t,a,o,i,r){e.Rect.apply(this,[n,t,a,o]),this.minLevel=i,this.maxLevel=r},e.extend(e.DisplayRect.prototype,e.Rect.prototype)}(OpenSeadragon),function(e){function n(e,n){return(1-Math.exp(e*-n))/(1-Math.exp(-e))}e.Spring=function(n){var t=arguments;"object"!=typeof n&&(n={initial:t.length&&"number"==typeof t[0]?t[0]:void 0,springStiffness:t.length>1?t[1].springStiffness:5,animationTime:t.length>1?t[1].animationTime:1.5}),e.console.assert("number"==typeof n.springStiffness&&0!==n.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),e.console.assert("number"==typeof n.animationTime&&n.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),n.exponential&&(this._exponential=!0,delete n.exponential),e.extend(!0,this,n),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:e.now()},e.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={
value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},e.Spring.prototype={resetTo:function(n){e.console.assert(!this._exponential||0!==n,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=n,this.start.time=this.target.time=this.current.time=e.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(n){e.console.assert(!this._exponential||0!==n,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=n,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(n){this.start.value+=n,this.target.value+=n,this._exponential&&(e.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(n){this._exponential=n,this._exponential&&(e.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=e.now();var t,a;this._exponential?(t=this.start._logValue,a=this.target._logValue):(t=this.start.value,a=this.target.value);var o=this.current.time>=this.target.time?a:t+(a-t)*n(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),i=this.current.value;return this._exponential?this.current.value=Math.exp(o):this.current.value=o,i!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(e){function n(n){e.extend(!0,this,{timeout:e.DEFAULT_SETTINGS.timeout,jobId:null},n),this.image=null}function t(e,n,t){var a;e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&e.jobQueue.length>0&&(a=e.jobQueue.shift(),a.start(),e.jobsInProgress++),t(n.image,n.errorMsg,n.request)}n.prototype={errorMsg:null,start:function(){var n=this,t=this.abort;this.image=new Image,this.image.onload=function(){n.finish(!0)},this.image.onabort=this.image.onerror=function(){n.errorMsg="Image load aborted",n.finish(!1)},this.jobId=window.setTimeout(function(){n.errorMsg="Image load exceeded timeout ("+n.timeout+" ms)",n.finish(!1)},this.timeout),this.loadWithAjax?(this.request=e.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(e){var t;try{t=new window.Blob([e.response])}catch(r){var a=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===r.name&&a){var o=new a;o.append(e.response),t=o.getBlob()}}0===t.size&&(n.errorMsg="Empty image response.",n.finish(!1));var i=(window.URL||window.webkitURL).createObjectURL(t);n.image.src=i},error:function(e){n.errorMsg="Image load aborted - XHR error",n.finish(!1)}}),this.abort=function(){n.request.abort(),"function"==typeof t&&t()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},e.ImageLoader=function(n){e.extend(!0,this,{jobLimit:e.DEFAULT_SETTINGS.imageLoaderLimit,timeout:e.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},n)},e.ImageLoader.prototype={addJob:function(e){var a=this,o=function(n){t(a,n,e.callback)},i={src:e.src,loadWithAjax:e.loadWithAjax,ajaxHeaders:e.loadWithAjax?e.ajaxHeaders:null,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:o,abort:e.abort,timeout:this.timeout},r=new n(i);!this.jobLimit||this.jobsInProgress<this.jobLimit?(r.start(),this.jobsInProgress++):this.jobQueue.push(r)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var n=this.jobQueue[e];"function"==typeof n.abort&&n.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(e){e.Tile=function(e,n,t,a,o,i,r,d,l,s){this.level=e,this.x=n,this.y=t,this.bounds=a,this.sourceBounds=s,this.exists=o,this.url=i,this.context2D=r,this.loadWithAjax=d,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},e.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(n){return this.cacheImageRecord?this.loaded?(this.element||(this.element=e.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=n&&n.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",void e.setElementOpacity(this.element,this.opacity)):void e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):void e.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(n,t,a,o){var i,r=this.position.times(e.pixelDensityRatio),d=this.size.times(e.pixelDensityRatio);if(!this.context2D&&!this.cacheImageRecord)return void e.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());if(i=this.context2D||this.cacheImageRecord.getRenderedContext(),!this.loaded||!i)return void e.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());n.save(),n.globalAlpha=this.opacity,"number"==typeof a&&1!==a&&(r=r.times(a),d=d.times(a)),o instanceof e.Point&&(r=r.plus(o)),1===n.globalAlpha&&this._hasTransparencyChannel()&&n.clearRect(r.x,r.y,d.x,d.y),t({context:n,tile:this,rendered:i});var l,s;this.sourceBounds?(l=Math.min(this.sourceBounds.width,i.canvas.width),s=Math.min(this.sourceBounds.height,i.canvas.height)):(l=i.canvas.width,s=i.canvas.height),n.drawImage(i.canvas,0,0,l,s,r.x,r.y,d.x,d.y),n.restore()},getScaleForEdgeSmoothing:function(){var n;if(this.cacheImageRecord)n=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return e.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;n=this.context2D}return n.canvas.width/(this.size.x*e.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(n,t,a){var o=Math.max(1,Math.ceil((a.x-t.x)/2)),i=Math.max(1,Math.ceil((a.y-t.y)/2));return new e.Point(o,i).minus(this.position.times(e.pixelDensityRatio).times(n||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(e){e.OverlayPlacement=e.Placement,e.OverlayRotationMode=e.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),e.Overlay=function(n,t,a){var o;o=e.isPlainObject(n)?n:{element:n,location:t,placement:a},this.element=o.element,this.style=o.element.style,this._init(o)},e.Overlay.prototype={_init:function(n){this.location=n.location,this.placement=void 0===n.placement?e.Placement.TOP_LEFT:n.placement,this.onDraw=n.onDraw,this.checkResize=void 0===n.checkResize||n.checkResize,this.width=void 0===n.width?null:n.width,this.height=void 0===n.height?null:n.height,this.rotationMode=n.rotationMode||e.OverlayRotationMode.EXACT,this.location instanceof e.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=e.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new e.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(n,t){var a=e.Placement.properties[this.placement];a&&(a.isHorizontallyCentered?n.x-=t.x/2:a.isRight&&(n.x-=t.x),a.isVerticallyCentered?n.y-=t.y/2:a.isBottom&&(n.y-=t.y))},destroy:function(){var n=this.element,t=this.style;n.parentNode&&(n.parentNode.removeChild(n),n.prevElementParent&&(t.display="none",document.body.appendChild(n))),this.onDraw=null,t.top="",t.left="",t.position="",null!==this.width&&(t.width=""),null!==this.height&&(t.height="");var a=e.getCssPropertyWithVendorPrefix("transformOrigin"),o=e.getCssPropertyWithVendorPrefix("transform");a&&o&&(t[a]="",t[o]="")},drawHTML:function(n,t){var a=this.element;a.parentNode!==n&&(a.prevElementParent=a.parentNode,a.prevNextSibling=a.nextSibling,n.appendChild(a),this.style.position="absolute",this.size=e.getElementSize(a));var o=this._getOverlayPositionAndSize(t),i=o.position,r=this.size=o.size,d=o.rotate;if(this.onDraw)this.onDraw(i,r,this.element);else{var l=this.style;l.left=i.x+"px",l.top=i.y+"px",null!==this.width&&(l.width=r.x+"px"),null!==this.height&&(l.height=r.y+"px");var s=e.getCssPropertyWithVendorPrefix("transformOrigin"),c=e.getCssPropertyWithVendorPrefix("transform");s&&c&&(d?(l[s]=this._getTransformOrigin(),l[c]="rotate("+d+"deg)"):(l[s]="",l[c]="")),"none"!==l.display&&(l.display="block")}},_getOverlayPositionAndSize:function(n){var t=n.pixelFromPoint(this.location,!0),a=this._getSizeInPixels(n);this.adjust(t,a);var o=0;if(n.degrees&&this.rotationMode!==e.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var i=new e.Rect(t.x,t.y,a.x,a.y),r=this._getBoundingBox(i,n.degrees);t=r.getTopLeft(),a=r.getSize()}else o=n.degrees;return{position:t,size:a,rotate:o}},_getSizeInPixels:function(n){var t=this.size.x,a=this.size.y;if(null!==this.width||null!==this.height){var o=n.deltaPixelsFromPointsNoRotate(new e.Point(this.width||0,this.height||0),!0);null!==this.width&&(t=o.x),null!==this.height&&(a=o.y)}if(this.checkResize&&(null===this.width||null===this.height)){var i=this.size=e.getElementSize(this.element);null===this.width&&(t=i.x),null===this.height&&(a=i.y)}return new e.Point(t,a)},_getBoundingBox:function(e,n){var t=this._getPlacementPoint(e);return e.rotate(n,t).getBoundingBox()},_getPlacementPoint:function(n){var t=new e.Point(n.x,n.y),a=e.Placement.properties[this.placement];return a&&(a.isHorizontallyCentered?t.x+=n.width/2:a.isRight&&(t.x+=n.width),a.isVerticallyCentered?t.y+=n.height/2:a.isBottom&&(t.y+=n.height)),t},_getTransformOrigin:function(){var n="",t=e.Placement.properties[this.placement];return t?(t.isLeft?n="left":t.isRight&&(n="right"),t.isTop?n+=" top":t.isBottom&&(n+=" bottom"),n):n},update:function(n,t){var a=e.isPlainObject(n)?n:{location:n,placement:t};this._init({location:a.location||this.location,placement:void 0!==a.placement?a.placement:this.placement,onDraw:a.onDraw||this.onDraw,checkResize:a.checkResize||this.checkResize,width:void 0!==a.width?a.width:this.width,height:void 0!==a.height?a.height:this.height,rotationMode:a.rotationMode||this.rotationMode})},getBounds:function(n){e.console.assert(n,"A viewport must now be passed to Overlay.getBounds.");var t=this.width,a=this.height;if(null===t||null===a){var o=n.deltaPointsFromPixelsNoRotate(this.size,!0);null===t&&(t=o.x),null===a&&(a=o.y)}var i=this.location.clone();return this.adjust(i,new e.Point(t,a)),this._adjustBoundsForRotation(n,new e.Rect(i.x,i.y,t,a))},_adjustBoundsForRotation:function(n,t){if(!n||0===n.degrees||this.rotationMode===e.OverlayRotationMode.EXACT)return t;if(this.rotationMode===e.OverlayRotationMode.BOUNDING_BOX){if(null===this.width||null===this.height)return t;var a=this._getOverlayPositionAndSize(n);return n.viewerElementToViewportRectangle(new e.Rect(a.position.x,a.position.y,a.size.x,a.size.y))}return t.rotate(-n.degrees,this._getPlacementPoint(t))}}}(OpenSeadragon),function(e){e.Drawer=function(n){e.console.assert(n.viewer,"[Drawer] options.viewer is required");var t=arguments;if(e.isPlainObject(n)||(n={source:t[0],viewport:t[1],element:t[2]}),e.console.assert(n.viewport,"[Drawer] options.viewport is required"),e.console.assert(n.element,"[Drawer] options.element is required"),n.source&&e.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=n.viewer,this.viewport=n.viewport,this.debugGridColor="string"==typeof n.debugGridColor?[n.debugGridColor]:n.debugGridColor||e.DEFAULT_SETTINGS.debugGridColor,n.opacity&&e.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=e.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=e.getElement(n.element),this.canvas=e.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var a=this._calculateCanvasSize();this.canvas.width=a.x,this.canvas.height=a.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",e.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},e.Drawer.prototype={addOverlay:function(n,t,a,o){return e.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(n,t,a,o),this},updateOverlay:function(n,t,a){return e.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(n,t,a),this},removeOverlay:function(n){return e.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(n),this},clearOverlays:function(){return e.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(n){e.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var t=this.viewer.world,a=0;a<t.getItemCount();a++)t.getItemAt(a).setOpacity(n);return this},getOpacity:function(){e.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var n=this.viewer.world,t=0,a=0;a<n.getItemCount();a++){var o=n.getItemAt(a).getOpacity();o>t&&(t=o)}return t},needsUpdate:function(){return e.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return e.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return e.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return e.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var e=this._calculateCanvasSize();if((this.canvas.width!=e.x||this.canvas.height!=e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas)){var n=this._calculateSketchCanvasSize();this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(e,n){if(this.useCanvas){var t=this._getContext(e);if(n)t.clearRect(n.x,n.y,n.width,n.height);else{var a=t.canvas;t.clearRect(0,0,a.width,a.height)}}},viewportToDrawerRectangle:function(n){var t=this.viewport.pixelFromPointNoRotate(n.getTopLeft(),!0),a=this.viewport.deltaPixelsFromPointsNoRotate(n.getSize(),!0);return new e.Rect(t.x*e.pixelDensityRatio,t.y*e.pixelDensityRatio,a.x*e.pixelDensityRatio,a.y*e.pixelDensityRatio)},drawTile:function(n,t,a,o,i){if(e.console.assert(n,"[Drawer.drawTile] tile is required"),e.console.assert(t,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var r=this._getContext(a);o=o||1,n.drawCanvas(r,t,o,i)}else n.drawHTML(this.canvas)},_getContext:function(e){var n=this.context;if(e){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var t=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var a=this;this.viewer.addHandler("rotate",function e(){if(0!==a.viewport.getRotation()){a.viewer.removeHandler("rotate",e);var n=a._calculateSketchCanvasSize();a.sketchCanvas.width=n.x,a.sketchCanvas.height=n.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}n=this.sketchContext}return n},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,n){if(this.useCanvas){var t=this._getContext(n);t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip()}},drawRectangle:function(e,n,t){if(this.useCanvas){var a=this._getContext(t);a.save(),a.fillStyle=n,a.fillRect(e.x,e.y,e.width,e.height),a.restore()}},blendSketch:function(n,t,a,o){var i=n;if(e.isPlainObject(i)||(i={opacity:n,scale:t,translate:a,compositeOperation:o}),this.useCanvas&&this.sketchCanvas){n=i.opacity,o=i.compositeOperation;var r=i.bounds;if(this.context.save(),this.context.globalAlpha=n,o&&(this.context.globalCompositeOperation=o),r)r.x<0&&(r.width+=r.x,r.x=0),r.x+r.width>this.canvas.width&&(r.width=this.canvas.width-r.x),r.y<0&&(r.height+=r.y,r.y=0),r.y+r.height>this.canvas.height&&(r.height=this.canvas.height-r.y),this.context.drawImage(this.sketchCanvas,r.x,r.y,r.width,r.height,r.x,r.y,r.width,r.height);else{t=i.scale||1,a=i.translate;var d=a instanceof e.Point?a:new e.Point(0,0),l=0,s=0;if(a){var c=this.sketchCanvas.width-this.canvas.width,f=this.sketchCanvas.height-this.canvas.height;l=Math.round(c/2),s=Math.round(f/2)}this.context.drawImage(this.sketchCanvas,d.x-l*t,d.y-s*t,(this.canvas.width+2*l)*t,(this.canvas.height+2*s)*t,-l,-s,this.canvas.width+2*l,this.canvas.height+2*s)}this.context.restore()}},drawDebugInfo:function(n,t,a,o){if(this.useCanvas){var i=this.viewer.world.getIndexOfItem(o)%this.debugGridColor.length,r=this.context;r.save(),r.lineWidth=2*e.pixelDensityRatio,r.font="small-caps bold "+13*e.pixelDensityRatio+"px arial",r.strokeStyle=this.debugGridColor[i],r.fillStyle=this.debugGridColor[i],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),o.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:o.getRotation(!0),point:o.viewport.pixelFromPointNoRotate(o._getRotationPoint(!0),!0)}),0===o.viewport.degrees&&o.getRotation(!0)%360==0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),r.strokeRect(n.position.x*e.pixelDensityRatio,n.position.y*e.pixelDensityRatio,n.size.x*e.pixelDensityRatio,n.size.y*e.pixelDensityRatio);var d=(n.position.x+n.size.x/2)*e.pixelDensityRatio,l=(n.position.y+n.size.y/2)*e.pixelDensityRatio;r.translate(d,l),r.rotate(Math.PI/180*-this.viewport.degrees),r.translate(-d,-l),0===n.x&&0===n.y&&(r.fillText("Zoom: "+this.viewport.getZoom(),n.position.x*e.pixelDensityRatio,(n.position.y-30)*e.pixelDensityRatio),r.fillText("Pan: "+this.viewport.getBounds().toString(),n.position.x*e.pixelDensityRatio,(n.position.y-20)*e.pixelDensityRatio)),r.fillText("Level: "+n.level,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+20)*e.pixelDensityRatio),r.fillText("Column: "+n.x,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+30)*e.pixelDensityRatio),r.fillText("Row: "+n.y,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+40)*e.pixelDensityRatio),r.fillText("Order: "+a+" of "+t,(n.position.x+10)*e.pixelDensityRatio,(n.position.y+50)*e.pixelDensityRatio),r.fillText("Size: "+n.size.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+60)*e.pixelDensityRatio),r.fillText("Position: "+n.position.toString(),(n.position.x+10)*e.pixelDensityRatio,(n.position.y+70)*e.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),o.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===o.viewport.degrees&&o.getRotation(!0)%360==0&&o._drawer.viewer.viewport.getFlip()&&o._drawer._flip(),r.restore()}},debugRect:function(n){if(this.useCanvas){var t=this.context;t.save(),t.lineWidth=2*e.pixelDensityRatio,t.strokeStyle=this.debugGridColor[0],t.fillStyle=this.debugGridColor[0],t.strokeRect(n.x*e.pixelDensityRatio,n.y*e.pixelDensityRatio,n.width*e.pixelDensityRatio,n.height*e.pixelDensityRatio),t.restore()}},setImageSmoothingEnabled:function(e){this.useCanvas&&(this._imageSmoothingEnabled=e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(e){e.mozImageSmoothingEnabled=this._imageSmoothingEnabled,e.webkitImageSmoothingEnabled=this._imageSmoothingEnabled,e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(n){var t=this._getContext(n).canvas;return new e.Point(t.width,t.height)},getCanvasCenter:function(){return new e.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(n){var t=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),a=this._getContext(n.useSketch);a.save(),a.translate(t.x,t.y),this.viewer.viewport.flipped?(a.rotate(Math.PI/180*-n.degrees),a.scale(-1,1)):a.rotate(Math.PI/180*n.degrees),a.translate(-t.x,-t.y)},_flip:function(n){n=n||{};var t=n.point?n.point.times(e.pixelDensityRatio):this.getCanvasCenter(),a=this._getContext(n.useSketch);a.translate(t.x,0),a.scale(-1,1),a.translate(-t.x,0)},_restoreRotationChanges:function(e){this._getContext(e).restore()},_calculateCanvasSize:function(){var n=e.pixelDensityRatio,t=this.viewport.getContainerSize();return{x:Math.round(t.x*n),y:Math.round(t.y*n)}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();if(0===this.viewport.getRotation())return e;var n=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y));return{x:n,y:n}}}}(OpenSeadragon),function(e){e.Viewport=function(n){var t=arguments;t.length&&t[0]instanceof e.Point&&(n={containerSize:t[0],contentSize:t[1],config:t[2]}),n.config&&(e.extend(!0,n,n.config),delete n.config),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n.margins||{}),delete n.margins,e.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:e.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:e.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:e.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:e.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:e.DEFAULT_SETTINGS.maxZoomLevel,degrees:e.DEFAULT_SETTINGS.degrees,flipped:e.DEFAULT_SETTINGS.flipped,homeFillsViewer:e.DEFAULT_SETTINGS.homeFillsViewer},n),this._updateContainerInnerSize(),this.centerSpringX=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new e.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new e.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new e.Rect(0,0,1,1),1),this.goHome(!0),this.update()},e.Viewport.prototype={resetContentSize:function(n){return e.console.assert(n,"[Viewport.resetContentSize] contentSize is required"),e.console.assert(n instanceof e.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),e.console.assert(n.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),e.console.assert(n.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new e.Rect(0,0,1,n.y/n.x),n.x),this},setHomeBounds:function(n,t){e.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(n,t)},_setContentBounds:function(n,t){e.console.assert(n,"[Viewport._setContentBounds] bounds is required"),e.console.assert(n instanceof e.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),e.console.assert(n.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),e.console.assert(n.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=n.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(t),this._contentBounds=n.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(t),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:t,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var e=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?e>=1?e:1:e>=1?1:e)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var n=this._contentBounds.getCenter(),t=1/this.getHomeZoom(),a=t/this.getAspectRatio();return new e.Rect(n.x-t/2,n.y-a/2,t,a)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new e.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return e.extend({},this._margins)},setMargins:function(n){e.console.assert("object"===e.type(n),"[Viewport.setMargins] margins must be an object"),this._margins=e.extend({left:0,top:0,right:0,bottom:0},n),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(n){var t=this.getCenter(n),a=1/this.getZoom(n),o=a/this.getAspectRatio();return new e.Rect(t.x-a/2,t.y-o/2,a,o)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var n=this.getBoundsNoRotate(e),t=this._containerInnerSize.x*this.getZoom(e);return n.x-=this._margins.left/t,n.y-=this._margins.top/t,n.width+=(this._margins.left+this._margins.right)/t,n.height+=(this._margins.top+this._margins.bottom)/t,n},getCenter:function(n){var t,a,o,i,r,d,l,s,c=new e.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),f=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return n?c:this.zoomPoint?(t=this.pixelFromPoint(this.zoomPoint,!0),a=this.getZoom(),o=1/a,i=o/this.getAspectRatio(),r=new e.Rect(c.x-o/2,c.y-i/2,o,i),d=this._pixelFromPoint(this.zoomPoint,r),l=d.minus(t),s=l.divide(this._containerInnerSize.x*a),f.plus(s)):f},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(n){var t=new e.Rect(n.x,n.y,n.width,n.height);if(this.wrapHorizontal);else{var a=this.visibilityRatio*t.width,o=t.x+t.width,i=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,r=this._contentBoundsNoRotate.x-o+a,d=i-t.x-a;a>this._contentBoundsNoRotate.width?t.x+=(r+d)/2:d<0?t.x+=d:r>0&&(t.x+=r)}if(this.wrapVertical);else{var l=this.visibilityRatio*t.height,s=t.y+t.height,c=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,f=this._contentBoundsNoRotate.y-s+l,u=c-t.y-l;l>this._contentBoundsNoRotate.height?t.y+=(f+u)/2:u<0?t.y+=u:f>0&&(t.y+=f)}return t},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var n=this.getZoom(),t=this._applyZoomConstraints(n);n!==t&&this.zoomTo(t,this.zoomPoint,e);var a=this.getBoundsNoRotate(),o=this._applyBoundaryConstraints(a);return this._raiseConstraintsEvent(e),(a.x!==o.x||a.y!==o.y||e)&&this.fitBounds(o.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(n,t){t=t||{};var a=t.immediately||!1,o=t.constraints||!1,i=this.getAspectRatio(),r=n.getCenter(),d=new e.Rect(n.x,n.y,n.width,n.height,n.degrees+this.getRotation()).getBoundingBox();d.getAspectRatio()>=i?d.height=d.width/i:d.width=d.height*i,d.x=r.x-d.width/2,d.y=r.y-d.height/2;var l=1/d.width;if(o){var s=d.getAspectRatio(),c=this._applyZoomConstraints(l);l!==c&&(l=c,d.width=1/l,d.x=r.x-d.width/2,d.height=d.width/s,d.y=r.y-d.height/2),d=this._applyBoundaryConstraints(d),r=d.getCenter(),this._raiseConstraintsEvent(a)}if(a)return this.panTo(r,!0),this.zoomTo(l,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var f=this.getBounds(),u=this.getZoom();if(0===u||Math.abs(l/u-1)<1e-8)return this.zoomTo(l,!0),this.panTo(r,a);d=d.rotate(-this.getRotation());var g=d.getTopLeft().times(l).minus(f.getTopLeft().times(u)).divide(l-u);return this.zoomTo(l,g,a)},fitBounds:function(e,n){return this._fitBounds(e,{immediately:n,constraints:!1})},fitBoundsWithConstraints:function(e,n){return this._fitBounds(e,{immediately:n,constraints:!0})},fitVertically:function(n){var t=new e.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(t,n)},fitHorizontally:function(n){var t=new e.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(t,n)},getConstrainedBounds:function(e){var n;return n=this.getBounds(e),this._applyBoundaryConstraints(n)},panBy:function(n,t){var a=new e.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(a.plus(n),t)},
panTo:function(e,n){return n?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:n}),this},zoomBy:function(e,n,t){return this.zoomTo(this.zoomSpring.target.value*e,n,t)},zoomTo:function(n,t,a){var o=this;return this.zoomPoint=t instanceof e.Point&&!isNaN(t.x)&&!isNaN(t.y)?t:null,a?this._adjustCenterSpringsForZoomPoint(function(){o.zoomSpring.resetTo(n)}):this.zoomSpring.springTo(n),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:n,refPoint:t,immediately:a}),this},setRotation:function(n){return this.viewer&&this.viewer.drawer.canRotate()?(this.degrees=e.positiveModulo(n,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:n}),this):this},getRotation:function(){return this.degrees},resize:function(e,n){var t,a=this.getBoundsNoRotate(),o=a;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),n&&(t=e.x/this.containerSize.x,o.width=a.width*t,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:n}),this.fitBounds(o,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new e.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this;this._adjustCenterSpringsForZoomPoint(function(){e.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var n=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,n},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){var n=this.pixelFromPoint(this.zoomPoint,!0);e();var t=this.pixelFromPoint(this.zoomPoint,!0),a=t.minus(n),o=this.deltaPointsFromPixels(a,!0);this.centerSpringX.shiftBy(o.x),this.centerSpringY.shiftBy(o.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,n){return e.times(this._containerInnerSize.x*this.getZoom(n))},deltaPixelsFromPoints:function(e,n){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),n)},deltaPointsFromPixelsNoRotate:function(e,n){return e.divide(this._containerInnerSize.x*this.getZoom(n))},deltaPointsFromPixels:function(e,n){return this.deltaPointsFromPixelsNoRotate(e,n).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,n){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(n))},pixelFromPoint:function(e,n){return this._pixelFromPoint(e,this.getBoundsNoRotate(n))},_pixelFromPointNoRotate:function(n,t){return n.minus(t.getTopLeft()).times(this._containerInnerSize.x/t.width).plus(new e.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,n){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),n)},pointFromPixelNoRotate:function(n,t){var a=this.getBoundsNoRotate(t);return n.minus(new e.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/a.width).plus(a.getTopLeft())},pointFromPixel:function(e,n){return this.pointFromPixelNoRotate(e,n).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(n,t){var a=this._contentBoundsNoRotate.width;return new e.Point(n*this._contentSizeNoRotate.x/a,t*this._contentSizeNoRotate.x/a)},viewportToImageCoordinates:function(n,t){if(n instanceof e.Point)return this.viewportToImageCoordinates(n.x,n.y);if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)e.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===a){var o=this.viewer.world.getItemAt(0);return o.viewportToImageCoordinates(n,t,!0)}}return this._viewportToImageDelta(n-this._contentBoundsNoRotate.x,t-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(n,t){var a=this._contentBoundsNoRotate.width;return new e.Point(n/this._contentSizeNoRotate.x*a,t/this._contentSizeNoRotate.x*a)},imageToViewportCoordinates:function(n,t){if(n instanceof e.Point)return this.imageToViewportCoordinates(n.x,n.y);if(this.viewer){var a=this.viewer.world.getItemCount();if(a>1)e.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===a){var o=this.viewer.world.getItemAt(0);return o.imageToViewportCoordinates(n,t,!0)}}var i=this._imageToViewportDelta(n,t);return i.x+=this._contentBoundsNoRotate.x,i.y+=this._contentBoundsNoRotate.y,i},imageToViewportRectangle:function(n,t,a,o){var i=n;if(i instanceof e.Rect||(i=new e.Rect(n,t,a,o)),this.viewer){var r=this.viewer.world.getItemCount();if(r>1)e.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===r){var d=this.viewer.world.getItemAt(0);return d.imageToViewportRectangle(n,t,a,o,!0)}}var l=this.imageToViewportCoordinates(i.x,i.y),s=this._imageToViewportDelta(i.width,i.height);return new e.Rect(l.x,l.y,s.x,s.y,i.degrees)},viewportToImageRectangle:function(n,t,a,o){var i=n;if(i instanceof e.Rect||(i=new e.Rect(n,t,a,o)),this.viewer){var r=this.viewer.world.getItemCount();if(r>1)e.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===r){var d=this.viewer.world.getItemAt(0);return d.viewportToImageRectangle(n,t,a,o,!0)}}var l=this.viewportToImageCoordinates(i.x,i.y),s=this._viewportToImageDelta(i.width,i.height);return new e.Rect(l.x,l.y,s.x,s.y,i.degrees)},viewerElementToImageCoordinates:function(e){var n=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(n)},imageToViewerElementCoordinates:function(e){var n=this.imageToViewportCoordinates(e);return this.pixelFromPoint(n,!0)},windowToImageCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var t=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(n){return e.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(n).plus(e.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(n){return e.Rect.fromSummits(this.pointFromPixel(n.getTopLeft(),!0),this.pointFromPixel(n.getTopRight(),!0),this.pointFromPixel(n.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(n){return e.Rect.fromSummits(this.pixelFromPoint(n.getTopLeft(),!0),this.pixelFromPoint(n.getTopRight(),!0),this.pixelFromPoint(n.getBottomLeft(),!0))},windowToViewportCoordinates:function(n){e.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var t=n.minus(e.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(t)},viewportToWindowCoordinates:function(n){return e.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(n).plus(e.getElementPosition(this.viewer.element))},viewportToImageZoom:function(n){if(this.viewer){var t=this.viewer.world.getItemCount();if(t>1)e.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===t){var a=this.viewer.world.getItemAt(0);return a.viewportToImageZoom(n)}}var o=this._contentSizeNoRotate.x;return n*(this._containerInnerSize.x/o*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(n){if(this.viewer){var t=this.viewer.world.getItemCount();if(t>1)e.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===t){var a=this.viewer.world.getItemAt(0);return a.imageToViewportZoom(n)}}return n*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e?this:(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e}),this)}}}(OpenSeadragon),function(e){function n(e,n,a,o,i,r,d,l,s){var c=d.getBoundingBox().getTopLeft(),f=d.getBoundingBox().getBottomRight();e.viewer&&e.viewer.raiseEvent("update-level",{tiledImage:e,havedrawn:n,level:o,opacity:i,visibility:r,drawArea:d,topleft:c,bottomright:f,currenttime:l,best:s}),u(e.coverage,o),u(e.loadingCoverage,o);for(var g=e._getCornerTiles(o,c,f),h=g.topLeft,A=g.bottomRight,v=e.source.getNumTiles(o),m=e.viewport.pixelFromPoint(e.viewport.getCenter()),S=h.x;S<=A.x;S++)for(var p=h.y;p<=A.y;p++){if(!e.wrapHorizontal&&!e.wrapVertical){var w=e.source.getTileBounds(o,S,p);if(null===d.intersection(w))continue}s=t(e,a,n,S,p,o,i,r,m,v,l,s)}return s}function t(e,n,t,o,i,s,u,h,A,v,m,S){var p=a(o,i,s,e,e.source,e.tilesMatrix,m,v,e._worldWidthCurrent,e._worldHeightCurrent),w=t;e.viewer&&e.viewer.raiseEvent("update-tile",{tiledImage:e,tile:p}),f(e.coverage,s,o,i,!1);var E=p.loaded||p.loading||c(e.loadingCoverage,s,o,i);if(f(e.loadingCoverage,s,o,i,E),!p.exists)return S;if(n&&!w&&(c(e.coverage,s,o,i)?f(e.coverage,s,o,i,!0):w=!0),!w)return S;if(d(p,e.source.tileOverlap,e.viewport,A,h,e),!p.loaded)if(p.context2D)r(e,p);else{var y=e._tileCache.getImageRecord(p.cacheKey);if(y){var C=y.getImage();r(e,p,C)}}if(p.loaded){l(e,p,o,i,s,u,m)&&(e._needsDraw=!0)}else p.loading?e._tilesLoading++:E||(S=g(S,p));return S}function a(n,t,a,o,i,r,d,l,s,c){var f,u,g,h,A,v,m,S,p;return r[a]||(r[a]={}),r[a][n]||(r[a][n]={}),r[a][n][t]||(f=(l.x+n%l.x)%l.x,u=(l.y+t%l.y)%l.y,g=i.getTileBounds(a,f,u),h=i.getTileBounds(a,f,u,!0),A=i.tileExists(a,f,u),v=i.getTileUrl(a,f,u),o.loadTilesWithAjax?(m=i.getTileAjaxHeaders(a,f,u),e.isPlainObject(o.ajaxHeaders)&&(m=e.extend({},o.ajaxHeaders,m))):m=null,S=i.getContext2D?i.getContext2D(a,f,u):void 0,g.x+=(n-f)/l.x,g.y+=c/s*((t-u)/l.y),p=new e.Tile(a,n,t,g,A,v,S,o.loadTilesWithAjax,m,h),f===l.x-1&&(p.isRightMost=!0),u===l.y-1&&(p.isBottomMost=!0),r[a][n][t]=p),p=r[a][n][t],p.lastTouchTime=d,p}function o(e,n,t){n.loading=!0,e._imageLoader.addJob({src:n.url,loadWithAjax:n.loadWithAjax,ajaxHeaders:n.ajaxHeaders,crossOriginPolicy:e.crossOriginPolicy,ajaxWithCredentials:e.ajaxWithCredentials,callback:function(a,o,r){i(e,n,t,a,o,r)},abort:function(){n.loading=!1}})}function i(n,t,a,o,i,d){if(!o)return e.console.log("Tile %s failed to load: %s - error: %s",t,t.url,i),n.viewer.raiseEvent("tile-load-failed",{tile:t,tiledImage:n,time:a,message:i,tileRequest:d}),t.loading=!1,void(t.exists=!1);if(a<n.lastResetTime)return e.console.log("Ignoring tile %s loaded before reset: %s",t,t.url),void(t.loading=!1);var l=function(){var e=n.source.getClosestLevel();r(n,t,o,e,d)};n._midDraw?window.setTimeout(l,1):l()}function r(e,n,t,a,o){function i(){return d++,r}function r(){0===--d&&(n.loading=!1,n.loaded=!0,n.context2D||e._tileCache.cacheTile({image:t,tile:n,cutoff:a,tiledImage:e}),e._needsDraw=!0)}var d=0;e.viewer.raiseEvent("tile-loaded",{tile:n,tiledImage:e,tileRequest:o,image:t,getCompletionCallback:i}),i()()}function d(n,t,a,o,i,r){var d=n.bounds.getTopLeft();d.x*=r._scaleSpring.current.value,d.y*=r._scaleSpring.current.value,d.x+=r._xSpring.current.value,d.y+=r._ySpring.current.value;var l=n.bounds.getSize();l.x*=r._scaleSpring.current.value,l.y*=r._scaleSpring.current.value;var s=a.pixelFromPointNoRotate(d,!0),c=a.pixelFromPointNoRotate(d,!1),f=a.deltaPixelsFromPointsNoRotate(l,!0),u=a.deltaPixelsFromPointsNoRotate(l,!1),g=c.plus(u.divide(2)),h=o.squaredDistanceTo(g);t||(f=f.plus(new e.Point(1,1))),n.isRightMost&&r.wrapHorizontal&&(f.x+=.75),n.isBottomMost&&r.wrapVertical&&(f.y+=.75),n.position=s,n.size=f,n.squaredDistance=h,n.visibility=i}function l(e,n,t,a,o,i,r){var d,l,s=1e3*e.blendTime;if(n.blendStart||(n.blendStart=r),d=r-n.blendStart,l=s?Math.min(1,d/s):1,e.alwaysBlend&&(l*=i),n.opacity=l,e.lastDrawn.push(n),1===l)f(e.coverage,o,t,a,!0),e._hasOpaqueTile=!0;else if(d<s)return!0;return!1}function s(e,n,t,a){var o,i,r,d;if(!e[n])return!1;if(void 0===t||void 0===a){o=e[n];for(r in o)if(o.hasOwnProperty(r)){i=o[r];for(d in i)if(i.hasOwnProperty(d)&&!i[d])return!1}return!0}return void 0===e[n][t]||void 0===e[n][t][a]||!0===e[n][t][a]}function c(e,n,t,a){return void 0===t||void 0===a?s(e,n+1):s(e,n+1,2*t,2*a)&&s(e,n+1,2*t,2*a+1)&&s(e,n+1,2*t+1,2*a)&&s(e,n+1,2*t+1,2*a+1)}function f(n,t,a,o,i){if(!n[t])return void e.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",t);n[t][a]||(n[t][a]={}),n[t][a][o]=i}function u(e,n){e[n]={}}function g(e,n){return e?n.visibility>e.visibility?n:n.visibility==e.visibility&&n.squaredDistance<e.squaredDistance?n:e:n}function h(n,t){if(0!==n.opacity&&(0!==t.length||n.placeholderFillStyle)){var a,o=t[0];o&&(a=n.opacity<1||n.compositeOperation&&"source-over"!==n.compositeOperation||!n._isBottomItem()&&o._hasTransparencyChannel());var i,r,d=n.viewport.getZoom(!0),l=n.viewportToImageZoom(d);t.length>1&&l>n.smoothTileEdgesMinZoom&&!n.iOSDevice&&n.getRotation(!0)%360==0&&e.supportsCanvas&&(a=!0,i=o.getScaleForEdgeSmoothing(),r=o.getTranslationForEdgeSmoothing(i,n._drawer.getCanvasSize(!1),n._drawer.getCanvasSize(!0)));var s;a&&(i||(s=n.viewport.viewportToViewerElementRectangle(n.getClippedBounds(!0)).getIntegerBoundingBox().times(e.pixelDensityRatio),n._drawer.viewer.viewport.getFlip()&&(0===n.viewport.degrees&&n.getRotation(!0)%360==0||(s.x=n._drawer.viewer.container.clientWidth-(s.x+s.width)))),n._drawer._clear(!0,s)),i||(0!==n.viewport.degrees&&n._drawer._offsetForRotation({degrees:n.viewport.degrees,useSketch:a}),n.getRotation(!0)%360!=0&&n._drawer._offsetForRotation({degrees:n.getRotation(!0),point:n.viewport.pixelFromPointNoRotate(n._getRotationPoint(!0),!0),useSketch:a}),0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip());var c=!1;if(n._clip){n._drawer.saveContext(a);var f=n.imageToViewportRectangle(n._clip,!0);f=f.rotate(-n.getRotation(!0),n._getRotationPoint(!0));var u=n._drawer.viewportToDrawerRectangle(f);i&&(u=u.times(i)),r&&(u=u.translate(r)),n._drawer.setClip(u,a),c=!0}if(n.placeholderFillStyle&&!1===n._hasOpaqueTile){var g=n._drawer.viewportToDrawerRectangle(n.getBounds(!0));i&&(g=g.times(i)),r&&(g=g.translate(r));var h=null;h="function"==typeof n.placeholderFillStyle?n.placeholderFillStyle(n,n._drawer.context):n.placeholderFillStyle,n._drawer.drawRectangle(g,h,a)}for(var v=t.length-1;v>=0;v--)o=t[v],n._drawer.drawTile(o,n._drawingHandler,a,i,r),o.beingDrawn=!0,n.viewer&&n.viewer.raiseEvent("tile-drawn",{tiledImage:n,tile:o});c&&n._drawer.restoreContext(a),i||(n.getRotation(!0)%360!=0&&n._drawer._restoreRotationChanges(a),0!==n.viewport.degrees&&n._drawer._restoreRotationChanges(a)),a&&(i&&(0!==n.viewport.degrees&&n._drawer._offsetForRotation({degrees:n.viewport.degrees,useSketch:!1}),n.getRotation(!0)%360!=0&&n._drawer._offsetForRotation({degrees:n.getRotation(!0),point:n.viewport.pixelFromPointNoRotate(n._getRotationPoint(!0),!0),useSketch:!1})),n._drawer.blendSketch({opacity:n.opacity,scale:i,translate:r,compositeOperation:n.compositeOperation,bounds:s}),i&&(n.getRotation(!0)%360!=0&&n._drawer._restoreRotationChanges(!1),0!==n.viewport.degrees&&n._drawer._restoreRotationChanges(!1))),i||0===n.viewport.degrees&&n.getRotation(!0)%360==0&&n._drawer.viewer.viewport.getFlip()&&n._drawer._flip(),A(n,t)}}function A(n,t){if(n.debugMode)for(var a=t.length-1;a>=0;a--){var o=t[a];try{n._drawer.drawDebugInfo(o,t.length,a,n)}catch(i){e.console.error(i)}}}e.TiledImage=function(n){var t=this;e.console.assert(n.tileCache,"[TiledImage] options.tileCache is required"),e.console.assert(n.drawer,"[TiledImage] options.drawer is required"),e.console.assert(n.viewer,"[TiledImage] options.viewer is required"),e.console.assert(n.imageLoader,"[TiledImage] options.imageLoader is required"),e.console.assert(n.source,"[TiledImage] options.source is required"),e.console.assert(!n.clip||n.clip instanceof e.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),e.EventSource.call(this),this._tileCache=n.tileCache,delete n.tileCache,this._drawer=n.drawer,delete n.drawer,this._imageLoader=n.imageLoader,delete n.imageLoader,n.clip instanceof e.Rect&&(this._clip=n.clip.clone()),delete n.clip;var a=n.x||0;delete n.x;var o=n.y||0;delete n.y,this.normHeight=n.source.dimensions.y/n.source.dimensions.x,this.contentAspectX=n.source.dimensions.x/n.source.dimensions.y;var i=1;n.width?(i=n.width,delete n.width,n.height&&(e.console.error("specifying both width and height to a tiledImage is not supported"),delete n.height)):n.height&&(i=n.height/this.normHeight,delete n.height);var r=n.fitBounds;delete n.fitBounds;var d=n.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete n.fitBoundsPlacement;var l=n.degrees||0;delete n.degrees,e.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:e.DEFAULT_SETTINGS.springStiffness,animationTime:e.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:e.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:e.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:e.DEFAULT_SETTINGS.wrapVertical,immediateRender:e.DEFAULT_SETTINGS.immediateRender,blendTime:e.DEFAULT_SETTINGS.blendTime,alwaysBlend:e.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:e.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:e.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:e.DEFAULT_SETTINGS.iOSDevice,debugMode:e.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:e.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:e.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:e.DEFAULT_SETTINGS.placeholderFillStyle,opacity:e.DEFAULT_SETTINGS.opacity,preload:e.DEFAULT_SETTINGS.preload,compositeOperation:e.DEFAULT_SETTINGS.compositeOperation},n),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new e.Spring({initial:a,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new e.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new e.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new e.Spring({initial:l,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),r&&this.fitBounds(r,d,!0),this._drawingHandler=function(n){t.viewer.raiseEvent("tile-drawing",e.extend({tiledImage:t},n))}},e.extend(e.TiledImage.prototype,e.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=e.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),n=this._ySpring.update(),t=this._scaleSpring.update(),a=this._degreesSpring.update();return!!(e||n||t||a)&&(this._updateForScale(),this._needsDraw=!0,!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(n){return n?new e.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new e.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return e.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(n){var t=this.getBoundsNoRotate(n);if(this._clip){var a=n?this._worldWidthCurrent:this._worldWidthTarget,o=a/this.source.dimensions.x,i=this._clip.times(o);t=new e.Rect(t.x+i.x,t.y+i.y,i.width,i.height)}return t.rotate(this.getRotation(n),this._getRotationPoint(n))},getContentSize:function(){return new e.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(n,t,a){var o=a?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(n*(this.source.dimensions.x/o),t*(this.source.dimensions.y*this.contentAspectX/o))},viewportToImageCoordinates:function(n,t,a){var o;return n instanceof e.Point?(a=t,o=n):o=new e.Point(n,t),o=o.rotate(-this.getRotation(a),this._getRotationPoint(a)),a?this._viewportToImageDelta(o.x-this._xSpring.current.value,o.y-this._ySpring.current.value):this._viewportToImageDelta(o.x-this._xSpring.target.value,o.y-this._ySpring.target.value)},_imageToViewportDelta:function(n,t,a){var o=a?this._scaleSpring.current.value:this._scaleSpring.target.value;return new e.Point(n/this.source.dimensions.x*o,t/this.source.dimensions.y/this.contentAspectX*o)},imageToViewportCoordinates:function(n,t,a){n instanceof e.Point&&(a=t,t=n.y,n=n.x);var o=this._imageToViewportDelta(n,t);return a?(o.x+=this._xSpring.current.value,o.y+=this._ySpring.current.value):(o.x+=this._xSpring.target.value,o.y+=this._ySpring.target.value),o.rotate(this.getRotation(a),this._getRotationPoint(a))},imageToViewportRectangle:function(n,t,a,o,i){var r=n;r instanceof e.Rect?i=t:r=new e.Rect(n,t,a,o);var d=this.imageToViewportCoordinates(r.getTopLeft(),i),l=this._imageToViewportDelta(r.width,r.height,i);return new e.Rect(d.x,d.y,l.x,l.y,r.degrees+this.getRotation(i))},viewportToImageRectangle:function(n,t,a,o,i){var r=n;n instanceof e.Rect?i=t:r=new e.Rect(n,t,a,o);var d=this.viewportToImageCoordinates(r.getTopLeft(),i),l=this._viewportToImageDelta(r.width,r.height,i);return new e.Rect(d.x,d.y,l.x,l.y,r.degrees-this.getRotation(i))},viewerElementToImageCoordinates:function(e){var n=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(n)},imageToViewerElementCoordinates:function(e){var n=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(n,!0)},windowToImageCoordinates:function(e){var n=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(n)},imageToWindowCoordinates:function(e){return this.imageToViewerElementCoordinates(e).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(n){var t=this._scaleSpring.current.value;return n=n.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new e.Rect((n.x-this._xSpring.current.value)/t,(n.y-this._ySpring.current.value)/t,n.width/t,n.height/t,n.degrees)},viewportToImageZoom:function(e){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*e},imageToViewportZoom:function(e){return e/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(e,n){var t=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(n){if(t&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0}else{if(t)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0}t||this._raiseBoundsChange()},setWidth:function(e,n){this._setScale(e,n)},setHeight:function(e,n){this._setScale(e/this.normHeight,n)},fitBounds:function(n,t,a){t=t||e.Placement.CENTER;var o=e.Placement.properties[t],i=this.contentAspectX,r=0,d=0,l=1,s=1;if(this._clip&&(i=this._clip.getAspectRatio(),l=this._clip.width/this.source.dimensions.x,s=this._clip.height/this.source.dimensions.y,n.getAspectRatio()>i?(r=this._clip.x/this._clip.height*n.height,d=this._clip.y/this._clip.height*n.height):(r=this._clip.x/this._clip.width*n.width,d=this._clip.y/this._clip.width*n.width)),n.getAspectRatio()>i){var c=n.height/s,f=0;o.isHorizontallyCentered?f=(n.width-n.height*i)/2:o.isRight&&(f=n.width-n.height*i),this.setPosition(new e.Point(n.x-r+f,n.y-d),a),this.setHeight(c,a)}else{var u=n.width/l,g=0;o.isVerticallyCentered?g=(n.height-n.width/i)/2:o.isBottom&&(g=n.height-n.width/i),this.setPosition(new e.Point(n.x-r,n.y-d+g),a),this.setWidth(u,a)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(n){e.console.assert(!n||n instanceof e.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),n instanceof e.Rect?this._clip=n.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,n){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(n?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,n){var t=this._scaleSpring.target.value===e;if(n){if(t&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0}else{if(t)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0}t||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),n=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,t=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(n/this.minPixelRatio)/Math.log(2))));return t=Math.max(t,this.source.minLevel||0),e=Math.min(e,t),{lowestLevel:e,highestLevel:t}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){this.lastDrawn.pop().beingDrawn=!1}var t=this.viewport,a=this._viewportToTiledImageRectangle(t.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var i=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(a=a.intersection(i)))return}for(var r=this._getLevelsInterval(),d=r.lowestLevel,l=r.highestLevel,c=null,f=!1,u=e.now(),g=l;g>=d;g--){var A=!1,v=t.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(g),!0).x*this._scaleSpring.current.value;if(g===d||!f&&v>=this.minPixelRatio)A=!0,f=!0;else if(!f)continue;var m=t.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(g),!1).x*this._scaleSpring.current.value,S=t.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,p=this.immediateRender?1:S;if(c=n(this,f,A,g,Math.min(1,(v-.5)/.5),p/Math.abs(p-m),a,u,c),s(this.coverage,g))break}h(this,this.lastDrawn),c&&!c.context2D?(o(this,c,u),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(n,t,a){var o,i;this.wrapHorizontal?(o=e.positiveModulo(t.x,1),i=e.positiveModulo(a.x,1)):(o=Math.max(0,t.x),i=Math.min(1,a.x));var r,d,l=1/this.source.aspectRatio;this.wrapVertical?(r=e.positiveModulo(t.y,l),d=e.positiveModulo(a.y,l)):(r=Math.max(0,t.y),d=Math.min(l,a.y));var s=this.source.getTileAtPoint(n,new e.Point(o,r)),c=this.source.getTileAtPoint(n,new e.Point(i,d)),f=this.source.getNumTiles(n);return this.wrapHorizontal&&(s.x+=f.x*Math.floor(t.x),c.x+=f.x*Math.floor(a.x)),this.wrapVertical&&(s.y+=f.y*Math.floor(t.y/l),c.y+=f.y*Math.floor(a.y/l)),{topLeft:s,bottomRight:c}}})}(OpenSeadragon),function(e){var n=function(n){e.console.assert(n,"[TileCache.cacheTile] options is required"),e.console.assert(n.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(n.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=n.tile,this.tiledImage=n.tiledImage},t=function(n){e.console.assert(n,"[ImageRecord] options is required"),e.console.assert(n.image,"[ImageRecord] options.image is required"),this._image=n.image,this._tiles=[]};t.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var e=document.createElement("canvas");e.width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(n){e.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=n},addTile:function(n){e.console.assert(n,"[ImageRecord.addTile] tile is required"),this._tiles.push(n)},removeTile:function(n){for(var t=0;t<this._tiles.length;t++)if(this._tiles[t]===n)return void this._tiles.splice(t,1);e.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",n)},getTileCount:function(){return this._tiles.length}},e.TileCache=function(n){n=n||{},this._maxImageCacheCount=n.maxImageCacheCount||e.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},e.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(a){e.console.assert(a,"[TileCache.cacheTile] options is required"),e.console.assert(a.tile,"[TileCache.cacheTile] options.tile is required"),e.console.assert(a.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),e.console.assert(a.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var o=a.cutoff||0,i=this._tilesLoaded.length,r=this._imagesLoaded[a.tile.cacheKey];if(r||(e.console.assert(a.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),r=this._imagesLoaded[a.tile.cacheKey]=new t({image:a.image}),this._imagesLoadedCount++),r.addTile(a.tile),a.tile.cacheImageRecord=r,this._imagesLoadedCount>this._maxImageCacheCount){for(var d,l,s,c,f,u,g=null,h=-1,A=null,v=this._tilesLoaded.length-1;v>=0;v--)u=this._tilesLoaded[v],d=u.tile,d.level<=o||d.beingDrawn||(g?(c=d.lastTouchTime,l=g.lastTouchTime,f=d.level,s=g.level,(c<l||c==l&&f>s)&&(g=d,h=v,A=u)):(g=d,h=v,A=u));g&&h>=0&&(this._unloadTile(A),i=h)}this._tilesLoaded[i]=new n({tile:a.tile,tiledImage:a.tiledImage})},clearTilesFor:function(n){
e.console.assert(n,"[TileCache.clearTilesFor] tiledImage is required");for(var t,a=0;a<this._tilesLoaded.length;++a)t=this._tilesLoaded[a],t.tiledImage===n&&(this._unloadTile(t),this._tilesLoaded.splice(a,1),a--)},getImageRecord:function(n){return e.console.assert(n,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[n]},_unloadTile:function(n){e.console.assert(n,"[TileCache._unloadTile] tileRecord is required");var t=n.tile,a=n.tiledImage;t.unload(),t.cacheImageRecord=null;var o=this._imagesLoaded[t.cacheKey];o.removeTile(t),o.getTileCount()||(o.destroy(),delete this._imagesLoaded[t.cacheKey],this._imagesLoadedCount--),a.viewer.raiseEvent("tile-unloaded",{tile:t,tiledImage:a})}}}(OpenSeadragon),function(e){e.World=function(n){var t=this;e.console.assert(n.viewer,"[World] options.viewer is required"),e.EventSource.call(this),this.viewer=n.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){t._autoRefigureSizes?t._figureSizes():t._needsSizesFigured=!0},this._figureSizes()},e.extend(e.World.prototype,e.EventSource.prototype,{addItem:function(n,t){if(e.console.assert(n,"[World.addItem] item is required"),e.console.assert(n instanceof e.TiledImage,"[World.addItem] only TiledImages supported at this time"),t=t||{},void 0!==t.index){var a=Math.max(0,Math.min(this._items.length,t.index));this._items.splice(a,0,n)}else this._items.push(n);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,n.addHandler("bounds-change",this._delegatedFigureSizes),n.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:n})},getItemAt:function(n){return e.console.assert(void 0!==n,"[World.getItemAt] index is required"),this._items[n]},getIndexOfItem:function(n){return e.console.assert(n,"[World.getIndexOfItem] item is required"),e.indexOf(this._items,n)},getItemCount:function(){return this._items.length},setItemIndex:function(n,t){e.console.assert(n,"[World.setItemIndex] item is required"),e.console.assert(void 0!==t,"[World.setItemIndex] index is required");var a=this.getIndexOfItem(n);if(t>=this._items.length)throw new Error("Index bigger than number of layers.");t!==a&&-1!==a&&(this._items.splice(a,1),this._items.splice(t,0,n),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:n,previousIndex:a,newIndex:t}))},removeItem:function(n){e.console.assert(n,"[World.removeItem] item is required");var t=e.indexOf(this._items,n);-1!==t&&(n.removeHandler("bounds-change",this._delegatedFigureSizes),n.removeHandler("clip-change",this._delegatedFigureSizes),n.destroy(),this._items.splice(t,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(n))},removeAll:function(){this.viewer._cancelPendingImages();var e,n;for(n=0;n<this._items.length;n++)e=this._items[n],e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var t=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,n=0;n<t.length;n++)e=t[n],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,n=0;n<this._items.length;n++)e=this._items[n].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){this._autoRefigureSizes=e,e&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(n){n=n||{};var t,a=n.immediately||!1,o=n.layout||e.DEFAULT_SETTINGS.collectionLayout,i=n.rows||e.DEFAULT_SETTINGS.collectionRows,r=n.columns||e.DEFAULT_SETTINGS.collectionColumns,d=n.tileSize||e.DEFAULT_SETTINGS.collectionTileSize,l=n.tileMargin||e.DEFAULT_SETTINGS.collectionTileMargin,s=d+l;t=!n.rows&&r?r:Math.ceil(this._items.length/i);var c,f,u,g,h,A=0,v=0;this.setAutoRefigureSizes(!1);for(var m=0;m<this._items.length;m++)m&&m%t==0&&("horizontal"===o?(v+=s,A=0):(A+=s,v=0)),c=this._items[m],f=c.getBounds(),u=f.width>f.height?d:d*(f.width/f.height),g=u*(f.height/f.width),h=new e.Point(A+(d-u)/2,v+(d-g)/2),c.setPosition(h,a),c.setWidth(u,a),"horizontal"===o?A+=s:v+=s;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var n=this._homeBounds?this._homeBounds.clone():null,t=this._contentSize?this._contentSize.clone():null,a=this._contentFactor||0;if(this._items.length){var o=this._items[0],i=o.getBounds();this._contentFactor=o.getContentSize().x/i.width;for(var r=o.getClippedBounds().getBoundingBox(),d=r.x,l=r.y,s=r.x+r.width,c=r.y+r.height,f=1;f<this._items.length;f++)o=this._items[f],i=o.getBounds(),this._contentFactor=Math.max(this._contentFactor,o.getContentSize().x/i.width),r=o.getClippedBounds().getBoundingBox(),d=Math.min(d,r.x),l=Math.min(l,r.y),s=Math.max(s,r.x+r.width),c=Math.max(c,r.y+r.height);this._homeBounds=new e.Rect(d,l,s-d,c-l),this._contentSize=new e.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new e.Rect(0,0,1,1),this._contentSize=new e.Point(1,1),this._contentFactor=1;this._contentFactor===a&&this._homeBounds.equals(n)&&this._contentSize.equals(t)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(OpenSeadragon);