function OpenSeadragon(e){return new OpenSeadragon.Viewer(e)}!function(i){i.version={versionStr:"2.4.1",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("1",10)};var e,t={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},n=Object.prototype.toString,o=Object.prototype.hasOwnProperty;i.isFunction=function(e){return"function"===i.type(e)},i.isArray=Array.isArray||function(e){return"array"===i.type(e)},i.isWindow=function(e){return e&&"object"==typeof e&&"setInterval"in e},i.type=function(e){return null==e?String(e):t[n.call(e)]||"object"},i.isPlainObject=function(e){if(!e||"object"!==OpenSeadragon.type(e)||e.nodeType||i.isWindow(e))return!1;if(e.constructor&&!o.call(e,"constructor")&&!o.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(var n in e)t=n;return void 0===t||o.call(e,t)},i.isEmptyObject=function(e){for(var t in e)return!1;return!0},i.freezeObject=function(e){return Object.freeze?i.freezeObject=Object.freeze:i.freezeObject=function(e){return e},i.freezeObject(e)},i.supportsCanvas=(e=document.createElement("canvas"),!(!i.isFunction(e.getContext)||!e.getContext("2d"))),i.isCanvasTainted=function(e){var t=!1;try{e.getContext("2d").getImageData(0,0,1,1)}catch(e){t=!0}return t},i.pixelDensityRatio=function(){if(i.supportsCanvas){var e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return Math.max(t,1)/n}return 1}()}(OpenSeadragon),function($){$.extend=function(){var e,t,n,i,o,r,s=arguments[0]||{},a=arguments.length,l=!1,c=1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},c=2),"object"==typeof s||OpenSeadragon.isFunction(s)||(s={}),a===c&&(s=this,--c);c<a;c++)if(null!==(e=arguments[c])||void 0!==e)for(t in e)n=s[t],s!==(i=e[t])&&(l&&i&&(OpenSeadragon.isPlainObject(i)||(o=OpenSeadragon.isArray(i)))?(r=o?(o=!1,n&&OpenSeadragon.isArray(n)?n:[]):n&&OpenSeadragon.isPlainObject(n)?n:{},s[t]=OpenSeadragon.extend(l,r,i)):void 0!==i&&(s[t]=i));return s};var isIOSDevice=function(){if("object"!=typeof navigator)return!1;var e=navigator.userAgent;return"string"==typeof e&&(-1!==e.indexOf("iPhone")||-1!==e.indexOf("iPad")||-1!==e.indexOf("iPod"))};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(t,n){return function(){var e=arguments;return void 0===e&&(e=[]),n.apply(t,e)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(e){return"string"==typeof e&&(e=document.getElementById(e)),e},getElementPosition:function(e){var t,n,i=new $.Point;for(n=getOffsetParent(e=$.getElement(e),t="fixed"==$.getElementStyle(e).position);n;)i.x+=e.offsetLeft,i.y+=e.offsetTop,t&&(i=i.plus($.getPageScroll())),n=getOffsetParent(e=n,t="fixed"==$.getElementStyle(e).position);return i},getElementOffset:function(e){var t,n,i=(e=$.getElement(e))&&e.ownerDocument,o={top:0,left:0};return i?(t=i.documentElement,void 0!==e.getBoundingClientRect&&(o=e.getBoundingClientRect()),n=i==i.window?i:9===i.nodeType&&(i.defaultView||i.parentWindow),new $.Point(o.left+(n.pageXOffset||t.scrollLeft)-(t.clientLeft||0),o.top+(n.pageYOffset||t.scrollTop)-(t.clientTop||0))):new $.Point},getElementSize:function(e){return e=$.getElement(e),new $.Point(e.clientWidth,e.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(e){return(e=$.getElement(e)).currentStyle}:function(e){return e=$.getElement(e),window.getComputedStyle(e,"")},getCssPropertyWithVendorPrefix:function(e){var a={};return $.getCssPropertyWithVendorPrefix=function(e){if(void 0!==a[e])return a[e];var t=document.createElement("div").style,n=null;if(void 0!==t[e])n=e;else for(var i=["Webkit","Moz","MS","O","webkit","moz","ms","o"],o=$.capitalizeFirstLetter(e),r=0;r<i.length;r++){var s=i[r]+o;if(void 0!==t[s]){n=s;break}}return a[e]=n},$.getCssPropertyWithVendorPrefix(e)},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},positiveModulo:function(e,t){var n=e%t;return n<0&&(n+=t),n},pointInElement:function(e,t){e=$.getElement(e);var n=$.getElementOffset(e),i=$.getElementSize(e);return t.x>=n.x&&t.x<n.x+i.x&&t.y<n.y+i.y&&t.y>=n.y},getEvent:function(e){return $.getEvent=e?function(e){return e}:function(){return window.event},$.getEvent(e)},getMousePosition:function(e){if("number"==typeof e.pageX)$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.pageX,t.y=e.pageY,t};else{if("number"!=typeof e.clientX)throw new Error("Unknown event mouse position, no known technique.");$.getMousePosition=function(e){var t=new $.Point;return e=$.getEvent(e),t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,t}}return $.getMousePosition(e)},getPageScroll:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.pageXOffset)$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(t.scrollLeft||t.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else{if(!e.scrollLeft&&!e.scrollTop)return new $.Point(0,0);$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)}}return $.getPageScroll()},setPageScroll:function(e){if(void 0!==window.scrollTo)$.setPageScroll=function(e){window.scrollTo(e.x,e.y)};else{var t=$.getPageScroll();if(t.x===e.x&&t.y===e.y)return;document.body.scrollLeft=e.x,document.body.scrollTop=e.y;var n=$.getPageScroll();if(n.x!==t.x&&n.y!==t.y)return void($.setPageScroll=function(e){document.body.scrollLeft=e.x,document.body.scrollTop=e.y});if(document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y,(n=$.getPageScroll()).x!==t.x&&n.y!==t.y)return void($.setPageScroll=function(e){document.documentElement.scrollLeft=e.x,document.documentElement.scrollTop=e.y});$.setPageScroll=function(e){}}return $.setPageScroll(e)},getWindowSize:function(){var e=document.documentElement||{},t=document.body||{};if("number"==typeof window.innerWidth)$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(e.clientWidth||e.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else{if(!t.clientWidth&&!t.clientHeight)throw new Error("Unknown window size, no known technique.");$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)}}return $.getWindowSize()},makeCenteredNode:function(e){e=$.getElement(e);var t=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(t[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(t[1].style,{display:"table-row"}),$.extend(t[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),t[0].appendChild(t[1]),t[1].appendChild(t[2]),t[2].appendChild(e),t[0]},makeNeutralElement:function(e){var t=document.createElement(e),n=t.style;return n.background="transparent none",n.border="none",n.margin="0px",n.padding="0px",n.position="static",t},now:function(){return Date.now?$.now=Date.now:$.now=function(){return(new Date).getTime()},$.now()},makeTransparentImage:function(e){return $.makeTransparentImage=function(e){var t=$.makeNeutralElement("img");return t.src=e,t},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(e){var t=$.makeNeutralElement("img"),n=null;return(n=$.makeNeutralElement("span")).style.display="inline-block",t.onload=function(){n.style.width=n.style.width||t.width+"px",n.style.height=n.style.height||t.height+"px",t.onload=null,t=null},t.src=e,n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale')",n}),$.makeTransparentImage(e)},setElementOpacity:function(e,t,n){var i;e=$.getElement(e),n&&!$.Browser.alpha&&(t=Math.round(t)),$.Browser.opacity?e.style.opacity=t<1?t:"":t<1?(i="alpha(opacity="+Math.round(100*t)+")",e.style.filter=i):e.style.filter=""},setElementTouchActionNone:function(e){void 0!==(e=$.getElement(e)).style.touchAction?e.style.touchAction="none":void 0!==e.style.msTouchAction&&(e.style.msTouchAction="none")},addClass:function(e,t){(e=$.getElement(e)).className?-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=" "+t):e.className=t},indexOf:function(e,t,n){return Array.prototype.indexOf?this.indexOf=function(e,t,n){return e.indexOf(t,n)}:this.indexOf=function(e,t,n){var i,o,r=n||0;if(!e)throw new TypeError;if(0===(o=e.length)||o<=r)return-1;for(r<0&&(r=o-Math.abs(r)),i=r;i<o;i++)if(e[i]===t)return i;return-1},this.indexOf(e,t,n)},removeClass:function(e,t){var n,i,o=[];for(n=(e=$.getElement(e)).className.split(/\s+/),i=0;i<n.length;i++)n[i]&&n[i]!==t&&o.push(n[i]);e.className=o.join(" ")},addEvent:function(){if(window.addEventListener)return function(e,t,n,i){(e=$.getElement(e)).addEventListener(t,n,i)};if(window.attachEvent)return function(e,t,n,i){(e=$.getElement(e)).attachEvent("on"+t,n)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(e,t,n,i){(e=$.getElement(e)).removeEventListener(t,n,i)};if(window.detachEvent)return function(e,t,n,i){(e=$.getElement(e)).detachEvent("on"+t,n)};throw new Error("No known event model.")}(),cancelEvent:function(e){(e=$.getEvent(e)).preventDefault?$.cancelEvent=function(e){e.preventDefault()}:$.cancelEvent=function(e){(e=$.getEvent(e)).cancel=!0,e.returnValue=!1},$.cancelEvent(e)},stopEvent:function(e){(e=$.getEvent(e)).stopPropagation?$.stopEvent=function(e){e.stopPropagation()}:$.stopEvent=function(e){(e=$.getEvent(e)).cancelBubble=!0},$.stopEvent(e)},createCallback:function(n,i){var e,o=[];for(e=2;e<arguments.length;e++)o.push(arguments[e]);return function(){var e,t=o.concat([]);for(e=0;e<arguments.length;e++)t.push(arguments[e]);return i.apply(n,t)}},getUrlParameter:function(e){var t=URLPARAMS[e];return t||null},getUrlProtocol:function(e){var t=e.match(/^([a-z]+:)\/\//i);return null===t?window.location.protocol:t[1].toLowerCase()},createAjaxRequest:function(e){var t;try{t=!!new ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}if(t)window.XMLHttpRequest?$.createAjaxRequest=function(e){return e?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else{if(!window.XMLHttpRequest)throw new Error("Browser doesn't support XMLHttpRequest.");$.createAjaxRequest=function(){return new XMLHttpRequest}}return $.createAjaxRequest(e)},makeAjaxRequest:function(e,n,i){var t,o,r;$.isPlainObject(e)&&(n=e.success,i=e.error,t=e.withCredentials,o=e.headers,r=e.responseType||null,e=e.url);var s=$.getUrlProtocol(e),a=$.createAjaxRequest("file:"===s);if(!$.isFunction(n))throw new Error("makeAjaxRequest requires a success callback");a.onreadystatechange=function(){4==a.readyState&&(a.onreadystatechange=function(){},200<=a.status&&a.status<300||0===a.status&&"http:"!==s&&"https:"!==s?n(a):($.console.log("AJAX request returned %d: %s",a.status,e),$.isFunction(i)&&i(a)))};try{if(a.open("GET",e,!0),r&&(a.responseType=r),o)for(var l in o)o.hasOwnProperty(l)&&o[l]&&a.setRequestHeader(l,o[l]);t&&(a.withCredentials=!0),a.send(null)}catch(t){var c=t.message;if($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10&&void 0!==t.number&&-2147024891==t.number&&(c+="\nSee http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain"),$.console.log("%s while making AJAX request: %s",t.name,c),a.onreadystatechange=function(){},window.XDomainRequest){var u=new XDomainRequest;if(u){u.onload=function(e){$.isFunction(n)&&n({responseText:u.responseText,status:200,statusText:"OK"})},u.onerror=function(e){$.isFunction(i)&&i({responseText:u.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{u.open("GET",e),u.send()}catch(e){$.isFunction(i)&&i(a,t)}}}else $.isFunction(i)&&i(a,t)}return a},jsonp:function(e){var n,t=e.url,i=document.head||document.getElementsByTagName("head")[0]||document.documentElement,o=e.callbackName||"openseadragon"+$.now(),r=window[o],s="$1"+o+"$2",a=e.param||"callback",l=e.callback;t=t.replace(/(\=)\?(&|$)|\?\?/i,s),t+=(/\?/.test(t)?"&":"?")+a+"="+o,window[o]=function(e){if(r)window[o]=r;else try{delete window[o]}catch(e){}l&&$.isFunction(l)&&l(e)},n=document.createElement("script"),void 0===e.async&&!1===e.async||(n.async="async"),e.scriptCharset&&(n.charset=e.scriptCharset),n.src=t,n.onload=n.onreadystatechange=function(e,t){!t&&n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=void 0)},i.insertBefore(n,i.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(e){if(window.DOMParser)$.parseXml=function(e){return(new DOMParser).parseFromString(e,"text/xml")};else{if(!window.ActiveXObject)throw new Error("Browser doesn't support XML DOM.");$.parseXml=function(e){var t=null;return(t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t}}return $.parseXml(e)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(e){return!!FILEFORMATS[(e=e||"").toLowerCase()]}}),$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};!function(){var e=navigator.appVersion,t=navigator.userAgent;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(t.substring(t.indexOf("MSIE")+5,t.indexOf(";",t.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(0<=t.indexOf("Firefox")?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(t.substring(t.indexOf("Firefox")+8))):0<=t.indexOf("Safari")?($.Browser.vendor=0<=t.indexOf("Chrome")?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(t.substring(t.substring(0,t.indexOf("Safari")).lastIndexOf("/")+1,t.indexOf("Safari")))):null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(t)&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1)));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(e)}var n,i,o,r=window.location.search.substring(1).split("&");for(o=0;o<r.length;o++)0<(i=(n=r[o]).indexOf("="))&&(URLPARAMS[n.substring(0,i)]=decodeURIComponent(n.substring(i+1)));$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)}();var nullfunction=function(e){};function getOffsetParent(e,t){return t&&e!=document.body?document.body:e.offsetParent}$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},function(e){var t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame,n=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.msCancelAnimationFrame;if(t&&n)$.requestAnimationFrame=function(){return t.apply(e,arguments)},$.cancelAnimationFrame=function(){return n.apply(e,arguments)};else{var i,o=[],r=[],s=0;$.requestAnimationFrame=function(e){return o.push([++s,e]),i=i||setInterval(function(){if(o.length){var e=$.now(),t=r;for(r=o,o=t;r.length;)r.shift()[1](e)}else clearInterval(i),i=void 0},20),s},$.cancelAnimationFrame=function(e){var t,n;for(t=0,n=o.length;t<n;t+=1)if(o[t][0]===e)return void o.splice(t,1);for(t=0,n=r.length;t<n;t+=1)if(r[t][0]===e)return void r.splice(t,1)}}}(window)}(OpenSeadragon),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&module.exports?module.exports=t():e.OpenSeadragon=t()}(this,function(){return OpenSeadragon}),function(e){var t={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.fullscreenElement},t.requestFullScreen=function(e){return e.requestFullscreen()},t.exitFullScreen=function(){document.exitFullscreen()},t.fullScreenEventName="fullscreenchange",t.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.msFullscreenElement},t.requestFullScreen=function(e){return e.msRequestFullscreen()},t.exitFullScreen=function(){document.msExitFullscreen()},t.fullScreenEventName="MSFullscreenChange",t.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitFullscreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullscreen()},t.exitFullScreen=function(){document.webkitExitFullscreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},t.requestFullScreen=function(e){return e.webkitRequestFullScreen()},t.exitFullScreen=function(){document.webkitCancelFullScreen()},t.fullScreenEventName="webkitfullscreenchange",t.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(t.supportsFullScreen=!0,t.getFullScreenElement=function(){return document.mozFullScreenElement},t.requestFullScreen=function(e){return e.mozRequestFullScreen()},t.exitFullScreen=function(){document.mozCancelFullScreen()},t.fullScreenEventName="mozfullscreenchange",t.fullScreenErrorEventName="mozfullscreenerror"),t.isFullScreen=function(){return null!==t.getFullScreenElement()},t.cancelFullScreen=function(){e.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),t.exitFullScreen()},e.extend(e,t)}(OpenSeadragon),function(r){r.EventSource=function(){this.events={}},r.EventSource.prototype={addOnceHandler:function(t,n,e,i){var o=this;i=i||1;var r=0,s=function(e){++r===i&&o.removeHandler(t,s),n(e)};this.addHandler(t,s,e)},addHandler:function(e,t,n){var i=this.events[e];i||(this.events[e]=i=[]),t&&r.isFunction(t)&&(i[i.length]={handler:t,userData:n||null})},removeHandler:function(e,t){var n,i=this.events[e],o=[];if(i&&r.isArray(i)){for(n=0;n<i.length;n++)i[n].handler!==t&&o.push(i[n]);this.events[e]=o}},removeAllHandlers:function(e){if(e)this.events[e]=[];else for(var t in this.events)this.events[t]=[]},getHandler:function(e){var o=this.events[e];return o&&o.length?(o=1===o.length?[o[0]]:Array.apply(null,o),function(e,t){var n,i=o.length;for(n=0;n<i;n++)o[n]&&(t.eventSource=e,t.userData=o[n].userData,o[n].handler(t))}):null},raiseEvent:function(e,t){var n=this.getHandler(e);n&&n(this,t=t||{})}}}(OpenSeadragon),function(m){var l,r,c,e,u=[],v={};function s(e,t){return e.hash.toString()+t.type+t.id.toString()}function i(){var e,t,n,i,o,r,s=l.length,a=m.now();for(i=a-c,c=a,e=0;e<s;e++)(n=(t=l[e]).gPoint).direction=Math.atan2(n.currentPos.y-t.lastPos.y,n.currentPos.x-t.lastPos.x),o=t.lastPos.distanceTo(n.currentPos),t.lastPos=n.currentPos,r=1e3*o/(1+i),n.speed=.75*r+.25*n.speed}function o(e){var t,n=v[e.hash],i=n.activePointersLists.length;for(t=0;t<i;t++)0<n.activePointersLists[t].captureCount&&(m.removeEvent(m.MouseTracker.captureElement,"mousemove",n.mousemovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"mouseup",n.mouseupcaptured,!0),m.removeEvent(m.MouseTracker.captureElement,m.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",n.pointermovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,m.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",n.pointerupcaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"touchmove",n.touchmovecaptured,!0),m.removeEvent(m.MouseTracker.captureElement,"touchend",n.touchendcaptured,!0),n.activePointersLists[t].captureCount=0);for(t=0;t<i;t++)n.activePointersLists.pop()}function t(e){var t,n,i=v[e.hash];if(i.tracking){for(n=0;n<m.MouseTracker.subscribeEvents.length;n++)t=m.MouseTracker.subscribeEvents[n],m.removeEvent(e.element,t,i[t],!1);o(e),i.tracking=!1}}function a(e,t){var n=v[e.hash];if("pointerevent"===t)return{upName:m.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:n.pointerupcaptured,moveName:m.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:n.pointermovecaptured};if("mouse"===t)return{upName:"mouseup",upHandler:n.mouseupcaptured,moveName:"mousemove",moveHandler:n.mousemovecaptured};if("touch"===t)return{upName:"touchend",upHandler:n.touchendcaptured,moveName:"touchmove",moveHandler:n.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function d(e,t,n){var i,o=e.getActivePointersListByType(t);o.captureCount+=n||1,1===o.captureCount&&(m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?e.element.setCapture(!0):(i=a(e,m.MouseTracker.havePointerEvents?"pointerevent":t),W&&$(window.top)&&m.addEvent(window.top,i.upName,i.upHandler,!0),m.addEvent(m.MouseTracker.captureElement,i.upName,i.upHandler,!0),m.addEvent(m.MouseTracker.captureElement,i.moveName,i.moveHandler,!0)))}function h(e,t,n){var i,o=e.getActivePointersListByType(t);o.captureCount-=n||1,0===o.captureCount&&(m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?e.element.releaseCapture():(i=a(e,m.MouseTracker.havePointerEvents?"pointerevent":t),W&&$(window.top)&&m.removeEvent(window.top,i.upName,i.upHandler,!0),m.removeEvent(m.MouseTracker.captureElement,i.moveName,i.moveHandler,!0),m.removeEvent(m.MouseTracker.captureElement,i.upName,i.upHandler,!0)))}function f(e){var t;if(m.MouseTracker.unprefixedPointerEvents)t=e.pointerType;else switch(e.pointerType){case 2:t="touch";break;case 3:t="pen";break;case 4:t="mouse";break;default:t=""}return t}function p(e){return m.getMousePosition(e)}function g(e,t){return b(p(e),t)}function b(e,t){var n=m.getElementOffset(t);return e.minus(n)}function y(e,t){return new m.Point((e.x+t.x)/2,(e.y+t.y)/2)}function w(e,t){var n={target:(t=m.getEvent(t)).target||t.srcElement,type:"wheel",shiftKey:t.shiftKey||!1,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX?t.pageX:t.clientX,pageY:t.pageY?t.pageY:t.clientY,deltaMode:"MozMousePixelScroll"==t.type?0:1,deltaX:0,deltaZ:0};"mousewheel"==m.MouseTracker.wheelEventName?n.deltaY=-t.wheelDelta/m.DEFAULT_SETTINGS.pixelsPerWheelLine:n.deltaY=t.detail,T(e,n,t)}function T(e,t,n){var i;i=t.deltaY<0?1:-1,e.scrollHandler&&!1===e.scrollHandler({eventSource:e,pointerType:"mouse",position:g(t,e.element),scroll:i,shift:t.shiftKey,isTouchEvent:!1,originalEvent:n,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(n)}function x(e,t){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e}function S(e,t){j(e,t,[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:p(t),currentTime:m.now()}])}function C(e,t){U(e,t,[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:p(t),currentTime:m.now()}])}function E(e){return m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?1===e?0:2===e?2:4===e?1:-1:e}function P(e,t){q(e,t=m.getEvent(t),[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:p(t),currentTime:m.now()}],E(t.button))&&h(e,"mouse")}function R(e,t){G(e,t=m.getEvent(t),[{id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:p(t),currentTime:m.now()}])}function I(e,t,n){var i,o=n.getLength(),r=[];if("touch"===n.type||0<n.contacts){for(i=0;i<o;i++)r.push(n.getByIndex(i));0<r.length&&(q(e,t,r,0),n.captureCount=1,h(e,n.type),U(e,t,r))}}function _(e,t){var n,i,o,r,s=t.changedTouches.length,a=[];for(n=m.now(),i=0;i<s;i++)a.push({id:t.changedTouches[i].identifier,type:"touch",currentPos:p(t.changedTouches[i]),currentTime:n});for(q(e,t,a,0)&&h(e,"touch",s),U(e,t,a),i=0;i<u.length;i++)if(u[i]!==e&&u[i].isTracking()&&x(u[i].element,e.element)){for(r=[],o=0;o<s;o++)r.push({id:t.changedTouches[o].identifier,type:"touch",currentPos:p(t.changedTouches[o]),currentTime:n});U(u[i],t,r)}m.cancelEvent(t)}function A(e,t){var n,i=t.changedTouches.length,o=[];for(n=0;n<i;n++)o.push({id:t.changedTouches[n].identifier,type:"touch",currentPos:p(t.changedTouches[n]),currentTime:m.now()});G(e,t,o),m.cancelEvent(t)}function O(e,t){t.currentTarget===t.relatedTarget||x(t.currentTarget,t.relatedTarget)||j(e,t,[{id:t.pointerId,type:f(t),isPrimary:t.isPrimary,currentPos:p(t),currentTime:m.now()}])}function k(e,t){t.currentTarget===t.relatedTarget||x(t.currentTarget,t.relatedTarget)||U(e,t,[{id:t.pointerId,type:f(t),isPrimary:t.isPrimary,currentPos:p(t),currentTime:m.now()}])}function D(e,t){var n;V(e,t,[n={id:t.pointerId,type:f(t),isPrimary:t.isPrimary,currentPos:p(t),currentTime:m.now()}],t.button)&&(m.stopEvent(t),d(e,n.type)),(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.cancelEvent(t)}function M(e,t){F(e,t)}function F(e,t){var n;q(e,t,[n={id:t.pointerId,type:f(t),isPrimary:t.isPrimary,currentPos:p(t),currentTime:m.now()}],t.button)&&h(e,n.type)}function L(e,t){N(e,t)}function N(e,t){G(e,t,[{id:t.pointerId,type:f(t),isPrimary:t.isPrimary,currentPos:p(t),currentTime:m.now()}])}function H(e,t){!function(e,t,n){q(e,t,n,0),U(e,t,n)}(e,t,[{id:t.pointerId,type:f(t)}])}function B(e,t){return t.hasOwnProperty("isPrimary")||(0===e.getLength()?t.isPrimary=!0:t.isPrimary=!1),t.speed=0,t.direction=0,t.contactPos=t.currentPos,t.contactTime=t.currentTime,t.lastPos=t.currentPos,t.lastTime=t.currentTime,e.add(t)}function z(e,t){var n,i;return e.getById(t.id)?(n=e.removeById(t.id),t.hasOwnProperty("isPrimary")||(i=e.getPrimary())||(i=e.getByIndex(0))&&(i.isPrimary=!0)):n=e.getLength(),n}function j(e,t,n){var i,o,r,s=e.getActivePointersListByType(n[0].type),a=n.length;for(i=0;i<a;i++)o=n[i],(r=s.getById(o.id))?(r.insideElement=!0,r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=o.currentPos,r.currentTime=o.currentTime,o=r):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,B(s,o)),e.enterHandler&&!1===e.enterHandler({eventSource:e,pointerType:o.type,position:b(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:o.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)}function U(e,t,n){var i,o,r,s=e.getActivePointersListByType(n[0].type),a=n.length;for(i=0;i<a;i++)o=n[i],(r=s.getById(o.id))&&(r.captured?(r.insideElement=!1,r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=o.currentPos,r.currentTime=o.currentTime):z(s,r),o=r),e.exitHandler&&!1===e.exitHandler({eventSource:e,pointerType:o.type,position:b(o.currentPos,e.element),buttons:s.buttons,pointers:e.getActivePointerCount(),insideElementPressed:!!r&&r.insideElementPressed,buttonDownAny:0!==s.buttons,isTouchEvent:"touch"===o.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)}function V(e,t,n,i){var o,r,s,a=v[e.hash],l=e.getActivePointersListByType(n[0].type),c=n.length;void 0!==t.buttons?l.buttons=t.buttons:m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?0===i?l.buttons+=1:1===i?l.buttons+=4:2===i?l.buttons+=2:3===i?l.buttons+=8:4===i?l.buttons+=16:5===i&&(l.buttons+=32):0===i?l.buttons|=1:1===i?l.buttons|=4:2===i?l.buttons|=2:3===i?l.buttons|=8:4===i?l.buttons|=16:5===i&&(l.buttons|=32);var u=e.getActivePointersListsExceptType(n[0].type);for(o=0;o<u.length;o++)I(e,t,u[o]);if(0!==i)return e.nonPrimaryPressHandler&&!1===e.nonPrimaryPressHandler({eventSource:e,pointerType:n[0].type,position:b(n[0].currentPos,e.element),button:i,buttons:l.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),!1;for(o=0;o<c;o++)r=n[o],(s=l.getById(r.id))?(s.captured=!0,s.insideElementPressed=!0,s.insideElement=!0,s.contactPos=r.currentPos,s.contactTime=r.currentTime,s.lastPos=s.currentPos,s.lastTime=s.currentTime,s.currentPos=r.currentPos,s.currentTime=r.currentTime,r=s):(r.captured=!0,r.insideElementPressed=!0,r.insideElement=!0,B(l,r)),l.addContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.MouseTracker.gesturePointVelocityTracker.addPoint(e,r),1===l.contacts?e.pressHandler&&!1===e.pressHandler({eventSource:e,pointerType:r.type,position:b(r.contactPos,e.element),buttons:l.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t):2===l.contacts&&e.pinchHandler&&"touch"===r.type&&(a.pinchGPoints=l.asArray(),a.lastPinchDist=a.currentPinchDist=a.pinchGPoints[0].currentPos.distanceTo(a.pinchGPoints[1].currentPos),a.lastPinchCenter=a.currentPinchCenter=y(a.pinchGPoints[0].currentPos,a.pinchGPoints[1].currentPos));return!0}function q(e,t,n,i){var o,r,s,a,l,c,u=v[e.hash],d=e.getActivePointersListByType(n[0].type),h=n.length,f=!1,p=!1;if(void 0!==t.buttons?d.buttons=t.buttons:m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?0===i?d.buttons-=1:1===i?d.buttons-=4:2===i?d.buttons-=2:3===i?d.buttons-=8:4===i?d.buttons-=16:5===i&&(d.buttons-=32):0===i?d.buttons^=-2:1===i?d.buttons^=-5:2===i?d.buttons^=-3:3===i?d.buttons^=-9:4===i?d.buttons^=-17:5===i&&(d.buttons^=-33),0!==i){e.nonPrimaryReleaseHandler&&!1===e.nonPrimaryReleaseHandler({eventSource:e,pointerType:n[0].type,position:b(n[0].currentPos,e.element),button:i,buttons:d.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t);var g=e.getActivePointersListByType("mouse");return I(e,t,g),!1}for(s=0;s<h;s++)a=n[s],(l=d.getById(a.id))&&(l.captured&&(p=f=!(l.captured=!1)),l.lastPos=l.currentPos,l.lastTime=l.currentTime,l.currentPos=a.currentPos,l.currentTime=a.currentTime,l.insideElement||z(d,l),o=l.currentPos,r=l.currentTime,p?(d.removeContact(),(e.dragHandler||e.dragEndHandler||e.pinchHandler)&&m.MouseTracker.gesturePointVelocityTracker.removePoint(e,l),0===d.contacts?(e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:l.type,position:b(o,e.element),buttons:d.buttons,insideElementPressed:l.insideElementPressed,insideElementReleased:l.insideElement,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),e.dragEndHandler&&!l.currentPos.equals(l.contactPos)&&!1===e.dragEndHandler({eventSource:e,pointerType:l.type,position:b(l.currentPos,e.element),speed:l.speed,direction:l.direction,shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),(e.clickHandler||e.dblClickHandler)&&l.insideElement&&(c=r-l.contactTime<=e.clickTimeThreshold&&l.contactPos.distanceTo(o)<=e.clickDistThreshold,e.clickHandler&&!1===e.clickHandler({eventSource:e,pointerType:l.type,position:b(l.currentPos,e.element),quick:c,shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),e.dblClickHandler&&c&&(d.clicks++,1===d.clicks?(u.lastClickPos=o,u.dblClickTimeOut=setTimeout(function(){d.clicks=0},e.dblClickTimeThreshold)):2===d.clicks&&(clearTimeout(u.dblClickTimeOut),d.clicks=0,u.lastClickPos.distanceTo(o)<=e.dblClickDistThreshold&&!1===e.dblClickHandler({eventSource:e,pointerType:l.type,position:b(l.currentPos,e.element),shift:t.shiftKey,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t),u.lastClickPos=null)))):2===d.contacts&&e.pinchHandler&&"touch"===l.type&&(u.pinchGPoints=d.asArray(),u.lastPinchDist=u.currentPinchDist=u.pinchGPoints[0].currentPos.distanceTo(u.pinchGPoints[1].currentPos),u.lastPinchCenter=u.currentPinchCenter=y(u.pinchGPoints[0].currentPos,u.pinchGPoints[1].currentPos))):e.releaseHandler&&!1===e.releaseHandler({eventSource:e,pointerType:l.type,position:b(o,e.element),buttons:d.buttons,insideElementPressed:l.insideElementPressed,insideElementReleased:l.insideElement,isTouchEvent:"touch"===l.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t));return f}function G(e,t,n){var i,o,r,s,a,l=v[e.hash],c=e.getActivePointersListByType(n[0].type),u=n.length;for(void 0!==t.buttons&&(c.buttons=t.buttons),i=0;i<u;i++)o=n[i],(r=c.getById(o.id))?(o.hasOwnProperty("isPrimary")&&(r.isPrimary=o.isPrimary),r.lastPos=r.currentPos,r.lastTime=r.currentTime,r.currentPos=o.currentPos,r.currentTime=o.currentTime):(o.captured=!1,o.insideElementPressed=!1,o.insideElement=!0,B(c,o));e.stopHandler&&"mouse"===n[0].type&&(clearTimeout(e.stopTimeOut),e.stopTimeOut=setTimeout(function(){!function(e,t,n){e.stopHandler&&e.stopHandler({eventSource:e,pointerType:n,position:g(t,e.element),buttons:e.getActivePointersListByType(n).buttons,isTouchEvent:"touch"===n,originalEvent:t,preventDefaultAction:!1,userData:e.userData})}(e,t,n[0].type)},e.stopDelay)),0===c.contacts?e.moveHandler&&!1===e.moveHandler({eventSource:e,pointerType:n[0].type,position:b(n[0].currentPos,e.element),buttons:c.buttons,isTouchEvent:"touch"===n[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t):1===c.contacts?(e.moveHandler&&(r=c.asArray()[0],!1===e.moveHandler({eventSource:e,pointerType:r.type,position:b(r.currentPos,e.element),buttons:c.buttons,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)),e.dragHandler&&(a=(r=c.asArray()[0]).currentPos.minus(r.lastPos),!1===e.dragHandler({eventSource:e,pointerType:r.type,position:b(r.currentPos,e.element),buttons:c.buttons,delta:a,speed:r.speed,direction:r.direction,shift:t.shiftKey,isTouchEvent:"touch"===r.type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))):2===c.contacts&&(e.moveHandler&&(s=c.asArray(),!1===e.moveHandler({eventSource:e,pointerType:s[0].type,position:b(y(s[0].currentPos,s[1].currentPos),e.element),buttons:c.buttons,isTouchEvent:"touch"===s[0].type,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)),e.pinchHandler&&"touch"===n[0].type&&(a=l.pinchGPoints[0].currentPos.distanceTo(l.pinchGPoints[1].currentPos))!=l.currentPinchDist&&(l.lastPinchDist=l.currentPinchDist,l.currentPinchDist=a,l.lastPinchCenter=l.currentPinchCenter,l.currentPinchCenter=y(l.pinchGPoints[0].currentPos,l.pinchGPoints[1].currentPos),!1===e.pinchHandler({eventSource:e,pointerType:"touch",gesturePoints:l.pinchGPoints,lastCenter:b(l.lastPinchCenter,e.element),center:b(l.currentPinchCenter,e.element),lastDistance:l.lastPinchDist,distance:l.currentPinchDist,shift:t.shiftKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t)))}m.MouseTracker=function(e){u.push(this);var t=arguments;m.isPlainObject(e)||(e={element:t[0],clickTimeThreshold:t[1],clickDistThreshold:t[2]}),this.hash=Math.random(),this.element=m.getElement(e.element),this.clickTimeThreshold=e.clickTimeThreshold||m.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=e.clickDistThreshold||m.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=e.dblClickTimeThreshold||m.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=e.dblClickDistThreshold||m.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=e.userData||null,this.stopDelay=e.stopDelay||50,this.enterHandler=e.enterHandler||null,this.exitHandler=e.exitHandler||null,this.pressHandler=e.pressHandler||null,this.nonPrimaryPressHandler=e.nonPrimaryPressHandler||null,this.releaseHandler=e.releaseHandler||null,this.nonPrimaryReleaseHandler=e.nonPrimaryReleaseHandler||null,this.moveHandler=e.moveHandler||null,this.scrollHandler=e.scrollHandler||null,this.clickHandler=e.clickHandler||null,this.dblClickHandler=e.dblClickHandler||null,this.dragHandler=e.dragHandler||null,this.dragEndHandler=e.dragEndHandler||null,this.pinchHandler=e.pinchHandler||null,this.stopHandler=e.stopHandler||null,this.keyDownHandler=e.keyDownHandler||null,this.keyUpHandler=e.keyUpHandler||null,this.keyHandler=e.keyHandler||null,this.focusHandler=e.focusHandler||null,this.blurHandler=e.blurHandler||null;var n=this;v[this.hash]={click:function(e){!function(e,t){e.clickHandler&&m.cancelEvent(t)}(n,e)},dblclick:function(e){!function(e,t){e.dblClickHandler&&m.cancelEvent(t)}(n,e)},keydown:function(e){!function(e,t){e.keyDownHandler&&(t=m.getEvent(t),e.keyDownHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(n,e)},keyup:function(e){!function(e,t){e.keyUpHandler&&(t=m.getEvent(t),e.keyUpHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(n,e)},keypress:function(e){!function(e,t){e.keyHandler&&(t=m.getEvent(t),e.keyHandler({eventSource:e,keyCode:t.keyCode?t.keyCode:t.charCode,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey,originalEvent:t,preventDefaultAction:!1,userData:e.userData})||m.cancelEvent(t))}(n,e)},focus:function(e){!function(e,t){e.focusHandler&&(t=m.getEvent(t),!1===e.focusHandler({eventSource:e,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))}(n,e)},blur:function(e){!function(e,t){e.blurHandler&&(t=m.getEvent(t),!1===e.blurHandler({eventSource:e,originalEvent:t,preventDefaultAction:!1,userData:e.userData})&&m.cancelEvent(t))}(n,e)},wheel:function(e){!function(e,t){T(e,t,t)}(n,e)},mousewheel:function(e){w(n,e)},DOMMouseScroll:function(e){w(n,e)},MozMousePixelScroll:function(e){w(n,e)},mouseenter:function(e){!function(e,t){t=m.getEvent(t),S(e,t)}(n,e)},mouseleave:function(e){!function(e,t){t=m.getEvent(t),C(e,t)}(n,e)},mouseover:function(e){!function(e,t){if((t=m.getEvent(t)).currentTarget===t.relatedTarget||x(t.currentTarget,t.relatedTarget))return;S(e,t)}(n,e)},mouseout:function(e){!function(e,t){if((t=m.getEvent(t)).currentTarget===t.relatedTarget||x(t.currentTarget,t.relatedTarget))return;C(e,t)}(n,e)},mousedown:function(e){!function(e,t){var n;t=m.getEvent(t),n={id:m.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:p(t),currentTime:m.now()},V(e,t,[n],E(t.button))&&(m.stopEvent(t),d(e,"mouse"));(e.clickHandler||e.dblClickHandler||e.pressHandler||e.dragHandler||e.dragEndHandler)&&m.cancelEvent(t)}(n,e)},mouseup:function(e){!function(e,t){P(e,t)}(n,e)},mouseupcaptured:function(e){!function(e,t){P(e,t),m.stopEvent(t)}(n,e)},mousemove:function(e){!function(e,t){R(e,t)}(n,e)},mousemovecaptured:function(e){!function(e,t){R(e,t),m.stopEvent(t)}(n,e)},touchstart:function(e){!function(e,t){var n,i,o,r,s=t.changedTouches.length,a=[],l=e.getActivePointersListByType("touch");n=m.now(),l.getLength()>t.touches.length-s&&(m.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),I(e,t,l));for(i=0;i<s;i++)a.push({id:t.changedTouches[i].identifier,type:"touch",currentPos:p(t.changedTouches[i]),currentTime:n});for(j(e,t,a),i=0;i<u.length;i++)if(u[i]!==e&&u[i].isTracking()&&x(u[i].element,e.element)){for(r=[],o=0;o<s;o++)r.push({id:t.changedTouches[o].identifier,type:"touch",currentPos:p(t.changedTouches[o]),currentTime:n});j(u[i],t,r)}V(e,t,a,0)&&(m.stopEvent(t),d(e,"touch",s));m.cancelEvent(t)}(n,e)},touchend:function(e){!function(e,t){_(e,t)}(n,e)},touchendcaptured:function(e){!function(e,t){_(e,t),m.stopEvent(t)}(n,e)},touchmove:function(e){!function(e,t){A(e,t)}(n,e)},touchmovecaptured:function(e){!function(e,t){A(e,t),m.stopEvent(t)}(n,e)},touchcancel:function(e){!function(e,t){var n=e.getActivePointersListByType("touch");I(e,t,n)}(n,e)},gesturestart:function(e){!function(e,t){t.stopPropagation(),t.preventDefault()}(0,e)},gesturechange:function(e){!function(e,t){t.stopPropagation(),t.preventDefault()}(0,e)},pointerover:function(e){O(n,e)},MSPointerOver:function(e){O(n,e)},pointerout:function(e){k(n,e)},MSPointerOut:function(e){k(n,e)},pointerdown:function(e){D(n,e)},MSPointerDown:function(e){D(n,e)},pointerup:function(e){M(n,e)},MSPointerUp:function(e){M(n,e)},pointermove:function(e){L(n,e)},MSPointerMove:function(e){L(n,e)},pointercancel:function(e){H(n,e)},MSPointerCancel:function(e){H(n,e)},pointerupcaptured:function(e){!function(e,t){e.getActivePointersListByType(f(t)).getById(t.pointerId)&&F(e,t);m.stopEvent(t)}(n,e)},pointermovecaptured:function(e){!function(e,t){e.getActivePointersListByType(f(t)).getById(t.pointerId)&&N(e,t);m.stopEvent(t)}(n,e)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},e.startDisabled||this.setTracking(!0)},m.MouseTracker.prototype={destroy:function(){var e;for(t(this),this.element=null,e=0;e<u.length;e++)if(u[e]===this){u.splice(e,1);break}v[this.hash]=null,delete v[this.hash]},isTracking:function(){return v[this.hash].tracking},setTracking:function(e){return e?function(e){var t,n,i=v[e.hash];if(!i.tracking){for(n=0;n<m.MouseTracker.subscribeEvents.length;n++)t=m.MouseTracker.subscribeEvents[n],m.addEvent(e.element,t,i[t],!1);o(e),i.tracking=!0}}(this):t(this),this},getActivePointersListsExceptType:function(e){for(var t=v[this.hash],n=[],i=0;i<t.activePointersLists.length;++i)t.activePointersLists[i].type!==e&&n.push(t.activePointersLists[i]);return n},getActivePointersListByType:function(e){var t,n,i=v[this.hash],o=i.activePointersLists.length;for(t=0;t<o;t++)if(i.activePointersLists[t].type===e)return i.activePointersLists[t];return n=new m.MouseTracker.GesturePointList(e),i.activePointersLists.push(n),n},getActivePointerCount:function(){var e,t=v[this.hash],n=t.activePointersLists.length,i=0;for(e=0;e<n;e++)i+=t.activePointersLists[e].getLength();return i},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},m.MouseTracker.resetAllMouseTrackers=function(){for(var e=0;e<u.length;e++)u[e].isTracking()&&(u[e].setTracking(!1),u[e].setTracking(!0))},m.MouseTracker.gesturePointVelocityTracker=(l=[],c=r=0,{addPoint:function(e,t){var n=s(e,t);l.push({guid:n,gPoint:t,lastPos:t.currentPos}),1===l.length&&(c=m.now(),r=window.setInterval(i,50))},removePoint:function(e,t){var n,i=s(e,t),o=l.length;for(n=0;n<o;n++)if(l[n].guid===i){l.splice(n,1),0==--o&&window.clearInterval(r);break}}}),m.MouseTracker.captureElement=document,m.MouseTracker.wheelEventName=m.Browser.vendor==m.BROWSERS.IE&&8<m.Browser.version||"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",m.MouseTracker.supportsMouseCapture=(e=document.createElement("div"),m.isFunction(e.setCapture)&&m.isFunction(e.releaseCapture)),m.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",m.MouseTracker.wheelEventName],"DOMMouseScroll"==m.MouseTracker.wheelEventName&&m.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||m.Browser.vendor!==m.BROWSERS.IE)?(m.MouseTracker.havePointerEvents=!0,m.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),m.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?m.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:m.MouseTracker.maxTouchPoints=0,m.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(m.MouseTracker.havePointerEvents=!0,m.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),m.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?m.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:m.MouseTracker.maxTouchPoints=0,m.MouseTracker.haveMouseEnter=!1):(m.MouseTracker.havePointerEvents=!1,m.Browser.vendor===m.BROWSERS.IE&&m.Browser.version<9?(m.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),m.MouseTracker.haveMouseEnter=!0):(m.MouseTracker.subscribeEvents.push("mouseover","mouseout"),m.MouseTracker.haveMouseEnter=!1),m.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&m.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&m.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),m.MouseTracker.mousePointerId="legacy-mouse",m.MouseTracker.maxTouchPoints=10),m.MouseTracker.GesturePointList=function(e){this._gPoints=[],this.type=e,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},m.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(e){return this._gPoints.push(e)},removeById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e){this._gPoints.splice(t,1);break}return this._gPoints.length},getByIndex:function(e){return e<this._gPoints.length?this._gPoints[e]:null},getById:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].id===e)return this._gPoints[t];return null},getPrimary:function(e){var t,n=this._gPoints.length;for(t=0;t<n;t++)if(this._gPoints[t].isPrimary)return this._gPoints[t];return null},addContact:function(){++this.contacts,1<this.contacts&&("mouse"===this.type||"pen"===this.type)&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};var W=function(){try{return window.self!==window.top}catch(e){return!0}}();function $(e){try{return e.addEventListener&&e.removeEventListener}catch(e){return!1}}}(OpenSeadragon),function(o){o.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},o.Control=function(e,t,n){var i=e.parentNode;"number"==typeof t&&(o.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),t={anchor:t}),t.attachToViewer=void 0===t.attachToViewer||t.attachToViewer,this.autoFade=void 0===t.autoFade||t.autoFade,this.element=e,this.anchor=t.anchor,this.container=n,this.anchor==o.ControlAnchor.ABSOLUTE?(this.wrapper=o.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top="number"==typeof t.top?t.top+"px":t.top,this.wrapper.style.left="number"==typeof t.left?t.left+"px":t.left,this.wrapper.style.height="number"==typeof t.height?t.height+"px":t.height,this.wrapper.style.width="number"==typeof t.width?t.width+"px":t.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=o.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==o.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),t.attachToViewer?this.anchor==o.ControlAnchor.TOP_RIGHT||this.anchor==o.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):i.appendChild(this.wrapper)},o.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return"none"!=this.wrapper.style.display},setVisible:function(e){this.wrapper.style.display=e?this.anchor==o.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(e){this.element[o.SIGNAL]&&o.Browser.vendor==o.BROWSERS.IE?o.setElementOpacity(this.element,e,!0):o.setElementOpacity(this.wrapper,e,!0)}}}(OpenSeadragon),function(o){function i(e,t){var n,i=e.controls;for(n=i.length-1;0<=n;n--)if(i[n].element==t)return n;return-1}o.ControlDock=function(e){var t,n,i=["topleft","topright","bottomright","bottomleft"];for(o.extend(!0,this,{id:"controldock-"+o.now()+"-"+Math.floor(1e6*Math.random()),container:o.makeNeutralElement("div"),controls:[]},e),this.container.onsubmit=function(){return!1},this.element&&(this.element=o.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),n=0;n<i.length;n++)t=i[n],this.controls[t]=o.makeNeutralElement("div"),this.controls[t].style.position="absolute",t.match("left")&&(this.controls[t].style.left="0px"),t.match("right")&&(this.controls[t].style.right="0px"),t.match("top")&&(this.controls[t].style.top="0px"),t.match("bottom")&&(this.controls[t].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},o.ControlDock.prototype={addControl:function(e,t){var n=null;if(!(0<=i(this,e=o.getElement(e)))){switch(t.anchor){case o.ControlAnchor.TOP_RIGHT:n=this.controls.topright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingTop="0px";break;case o.ControlAnchor.BOTTOM_RIGHT:n=this.controls.bottomright,e.style.position="relative",e.style.paddingRight="0px",e.style.paddingBottom="0px";break;case o.ControlAnchor.BOTTOM_LEFT:n=this.controls.bottomleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingBottom="0px";break;case o.ControlAnchor.TOP_LEFT:n=this.controls.topleft,e.style.position="relative",e.style.paddingLeft="0px",e.style.paddingTop="0px";break;case o.ControlAnchor.ABSOLUTE:n=this.container,e.style.margin="0px",e.style.padding="0px";break;default:case o.ControlAnchor.NONE:n=this.container,e.style.margin="0px",e.style.padding="0px"}this.controls.push(new o.Control(e,t,n)),e.style.display="inline-block"}},removeControl:function(e){var t=i(this,e=o.getElement(e));return 0<=t&&(this.controls[t].destroy(),this.controls.splice(t,1)),this},clearControls:function(){for(;0<this.controls.length;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var e;for(e=this.controls.length-1;0<=e;e--)if(this.controls[e].isVisible())return!0;return!1},setControlsEnabled:function(e){var t;for(t=this.controls.length-1;0<=t;t--)this.controls[t].setVisible(e);return this}}}(OpenSeadragon),function(e){e.Placement=e.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(g){var u={},s=1;function d(e){return e=g.getElement(e),new g.Point(0===e.clientWidth?1:e.clientWidth,0===e.clientHeight?1:e.clientHeight)}function h(e,t){if(t instanceof g.Overlay)return t;var n=null;if(t.element)n=g.getElement(t.element);else{var i=t.id?t.id:"openseadragon-overlay-"+Math.floor(1e7*Math.random());(n=g.getElement(t.id))||((n=document.createElement("a")).href="#/overlay/"+i),n.id=i,g.addClass(n,t.className?t.className:"openseadragon-overlay")}var o=t.location,r=t.width,s=t.height;if(!o){var a=t.x,l=t.y;if(void 0!==t.px){var c=e.viewport.imageToViewportRectangle(new g.Rect(t.px,t.py,r||0,s||0));a=c.x,l=c.y,r=void 0!==r?c.width:void 0,s=void 0!==s?c.height:void 0}o=new g.Point(a,l)}var u=t.placement;return u&&"string"===g.type(u)&&(u=g.Placement[t.placement.toUpperCase()]),new g.Overlay({element:n,location:o,placement:u,onDraw:t.onDraw,checkResize:t.checkResize,width:r,height:s,rotationMode:t.rotationMode})}function a(e,t){var n;for(n=e.length-1;0<=n;n--)if(e[n].element===t)return n;return-1}function l(e,t){return g.requestAnimationFrame(function(){t(e)})}function r(e){g.requestAnimationFrame(function(){!function(e){var t,n,i,o;if(e.controlsShouldFade){for(t=g.now(),n=t-e.controlsFadeBeginTime,i=1-n/e.controlsFadeLength,i=Math.min(1,i),i=Math.max(0,i),o=e.controls.length-1;0<=o;o--)e.controls[o].autoFade&&e.controls[o].setOpacity(i);0<i&&r(e)}}(e)})}function f(e){e.autoHideControls&&(e.controlsShouldFade=!0,e.controlsFadeBeginTime=g.now()+e.controlsFadeDelay,window.setTimeout(function(){r(e)},e.controlsFadeDelay))}function p(e){var t;for(e.controlsShouldFade=!1,t=e.controls.length-1;0<=t;t--)e.controls[t].setOpacity(1)}function m(){p(this)}function v(){f(this)}function c(e){var t={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}}function b(e){var t={originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction,preventVerticalPan:e.preventVerticalPan,preventHorizontalPan:e.preventHorizontalPan};if(this.raiseEvent("canvas-key",t),t.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return t.preventVerticalPan||(e.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return t.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new g.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(g.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(g.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(g.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(g.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}}function y(e){var t;document.activeElement==this.canvas||this.canvas.focus(),this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var n={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-click",n),!n.preventDefaultAction&&this.viewport&&e.quick&&(t=this.gestureSettingsByDeviceType(e.pointerType)).clickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function w(e){var t,n={tracker:e.eventSource,position:e.position,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.raiseEvent("canvas-double-click",n),!n.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).dblClickToZoom&&(this.viewport.zoomBy(e.shift?1/this.zoomPerClick:this.zoomPerClick,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints())}function T(e){var t,n={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.raiseEvent("canvas-drag",n),!n.preventDefaultAction&&this.viewport){if(t=this.gestureSettingsByDeviceType(e.pointerType),this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewport.flipped&&(e.delta.x=-e.delta.x),this.constrainDuringPan){var i=this.viewport.deltaPointsFromPixels(e.delta.negate());this.viewport.centerSpringX.target.value+=i.x,this.viewport.centerSpringY.target.value+=i.y;var o=this.viewport.getBounds(),r=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=i.x,this.viewport.centerSpringY.target.value-=i.y,o.x!=r.x&&(e.delta.x=0),o.y!=r.y&&(e.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta.negate()),t.flickEnabled&&!this.constrainDuringPan)}}function x(e){if(!e.preventDefaultAction&&this.viewport){var t=this.gestureSettingsByDeviceType(e.pointerType);if(t.flickEnabled&&e.speed>=t.flickMinSpeed){var n=0;this.panHorizontal&&(n=t.flickMomentum*e.speed*Math.cos(e.direction));var i=0;this.panVertical&&(i=t.flickMomentum*e.speed*Math.sin(e.direction));var o=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),r=this.viewport.pointFromPixel(new g.Point(o.x-n,o.y-i));this.viewport.panTo(r,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:e.eventSource,position:e.position,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent})}function S(e){this.raiseEvent("canvas-enter",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function C(e){window.location!=window.parent.location&&g.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function E(e){this.raiseEvent("canvas-press",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function P(e){this.raiseEvent("canvas-release",{tracker:e.eventSource,pointerType:e.pointerType,position:e.position,insideElementPressed:e.insideElementPressed,insideElementReleased:e.insideElementReleased,originalEvent:e.originalEvent})}function R(e){this.raiseEvent("canvas-nonprimary-press",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function I(e){this.raiseEvent("canvas-nonprimary-release",{tracker:e.eventSource,position:e.position,pointerType:e.pointerType,button:e.button,buttons:e.buttons,originalEvent:e.originalEvent})}function _(e){var t,n,i;if(!e.preventDefaultAction&&this.viewport&&((t=this.gestureSettingsByDeviceType(e.pointerType)).pinchToZoom&&(n=this.viewport.pointFromPixel(e.center,!0),i=this.viewport.pointFromPixel(e.lastCenter,!0).minus(n),this.panHorizontal||(i.x=0),this.panVertical||(i.y=0),this.viewport.zoomBy(e.distance/e.lastDistance,n,!0),t.zoomToRefPoint&&this.viewport.panBy(i,!0),this.viewport.applyConstraints()),t.pinchRotate)){var o=Math.atan2(e.gesturePoints[0].currentPos.y-e.gesturePoints[1].currentPos.y,e.gesturePoints[0].currentPos.x-e.gesturePoints[1].currentPos.x),r=Math.atan2(e.gesturePoints[0].lastPos.y-e.gesturePoints[1].lastPos.y,e.gesturePoints[0].lastPos.x-e.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(o-r)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:e.eventSource,gesturePoints:e.gesturePoints,lastCenter:e.lastCenter,center:e.center,lastDistance:e.lastDistance,distance:e.distance,shift:e.shift,originalEvent:e.originalEvent}),!1}function A(e){var t,n,i;if((i=g.now())-this._lastScrollTime>this.minScrollDeltaTime){if(this._lastScrollTime=i,this.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x),!e.preventDefaultAction&&this.viewport&&(t=this.gestureSettingsByDeviceType(e.pointerType)).scrollToZoom&&(n=Math.pow(this.zoomPerScroll,e.scroll),this.viewport.zoomBy(n,t.zoomToRefPoint?this.viewport.pointFromPixel(e.position,!0):null),this.viewport.applyConstraints()),this.raiseEvent("canvas-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),t&&t.scrollToZoom)return!1}else if((t=this.gestureSettingsByDeviceType(e.pointerType))&&t.scrollToZoom)return!1}function O(e){u[this.hash].mouseInside=!0,p(this),this.raiseEvent("container-enter",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function k(e){e.pointers<1&&(u[this.hash].mouseInside=!1,u[this.hash].animating||f(this)),this.raiseEvent("container-exit",{tracker:e.eventSource,position:e.position,buttons:e.buttons,pointers:e.pointers,insideElementPressed:e.insideElementPressed,buttonDownAny:e.buttonDownAny,originalEvent:e.originalEvent})}function D(e){!function(e){if(e._opening)return;if(e.autoResize){var t=d(e.container),n=u[e.hash].prevContainerSize;if(!t.equals(n)){var i=e.viewport;if(e.preserveImageSizeOnResize){var o=n.x/t.x,r=i.getZoom()*o,s=i.getCenter();i.resize(t,!1),i.zoomTo(r,null,!0),i.panTo(s,!0)}else{var a=i.getBounds();i.resize(t,!0),i.fitBoundsWithConstraints(a,!0)}u[e.hash].prevContainerSize=t,u[e.hash].forceRedraw=!0}}var l=e.viewport.update(),c=e.world.update()||l;l&&e.raiseEvent("viewport-change");e.referenceStrip&&(c=e.referenceStrip.update(e.viewport)||c);!u[e.hash].animating&&c&&(e.raiseEvent("animation-start"),p(e));(c||u[e.hash].forceRedraw||e.world.needsDraw())&&(function(e){e.imageLoader.clear(),e.drawer.clear(),e.world.draw(),e.raiseEvent("update-viewport",{})}(e),e._drawOverlays(),e.navigator&&e.navigator.update(e.viewport),u[e.hash].forceRedraw=!1,c&&e.raiseEvent("animation"));u[e.hash].animating&&!c&&(e.raiseEvent("animation-finish"),u[e.hash].mouseInside||f(e));u[e.hash].animating=c}(e),e.isOpen()?e._updateRequestId=l(e,D):e._updateRequestId=!1}function M(e,t){return e?e+t:t}function F(){u[this.hash].lastZoomTime=g.now(),u[this.hash].zoomFactor=this.zoomPerSecond,u[this.hash].zooming=!0,i(this)}function L(){u[this.hash].lastZoomTime=g.now(),u[this.hash].zoomFactor=1/this.zoomPerSecond,u[this.hash].zooming=!0,i(this)}function N(){u[this.hash].zooming=!1}function i(e){g.requestAnimationFrame(g.delegate(e,t))}function t(){var e,t,n;u[this.hash].zooming&&this.viewport&&(t=(e=g.now())-u[this.hash].lastZoomTime,n=Math.pow(u[this.hash].zoomFactor,t/1e3),this.viewport.zoomBy(n),this.viewport.applyConstraints(),u[this.hash].lastZoomTime=e,i(this))}function H(){this.viewport&&(u[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function B(){this.viewport&&(u[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function z(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function j(){this.viewport&&this.viewport.goHome()}function U(){this.isFullPage()&&!g.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function V(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?g.positiveModulo(e+this.rotationIncrement,360):g.positiveModulo(e-this.rotationIncrement,360),this.viewport.setRotation(e)}}function q(){if(this.viewport){var e=this.viewport.getRotation();e=this.viewport.flipped?g.positiveModulo(e-this.rotationIncrement,360):g.positiveModulo(e+this.rotationIncrement,360),this.viewport.setRotation(e)}}function G(){this.viewport.toggleFlip()}function W(){var e=this._sequenceIndex-1;this.navPrevNextWrap&&e<0&&(e+=this.tileSources.length),this.goToPage(e)}function $(){var e=this._sequenceIndex+1;this.navPrevNextWrap&&e>=this.tileSources.length&&(e=0),this.goToPage(e)}g.Viewer=function(e){var t,n,i,o=arguments,r=this;if(g.isPlainObject(e)||(e={id:o[0],xmlPath:1<o.length?o[1]:void 0,prefixUrl:2<o.length?o[2]:void 0,controls:3<o.length?o[3]:void 0,overlays:4<o.length?o[4]:void 0}),e.config&&(g.extend(!0,e,e.config),delete e.config),g.extend(!0,this,{id:e.id,hash:e.hash||s++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},g.DEFAULT_SETTINGS,e),void 0===this.hash)throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(void 0!==u[this.hash]&&g.console.warn("Hash "+this.hash+" has already been used."),u[this.hash]={fsBoundsDelta:new g.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=g.now(),g.EventSource.call(this),this.addHandler("open-failed",function(e){var t=g.getString("Errors.OpenFailed",e.eventSource,e.message);r._showMessage(t)}),g.ControlDock.call(this,e),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=g.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",(n=this.canvas.style).width="100%",n.height="100%",n.overflow="hidden",n.position="absolute",n.top="0px",n.left="0px",g.setElementTouchActionNone(this.canvas),""!==e.tabIndex&&(this.canvas.tabIndex=void 0===e.tabIndex?0:e.tabIndex),this.container.className="openseadragon-container",(i=this.container.style).width="100%",i.height="100%",i.position="relative",i.overflow="hidden",i.left="0px",i.top="0px",i.textAlign="left",this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new g.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:g.delegate(this,c),keyHandler:g.delegate(this,b),clickHandler:g.delegate(this,y),dblClickHandler:g.delegate(this,w),dragHandler:g.delegate(this,T),dragEndHandler:g.delegate(this,x),enterHandler:g.delegate(this,S),exitHandler:g.delegate(this,C),pressHandler:g.delegate(this,E),releaseHandler:g.delegate(this,P),nonPrimaryPressHandler:g.delegate(this,R),nonPrimaryReleaseHandler:g.delegate(this,I),scrollHandler:g.delegate(this,A),pinchHandler:g.delegate(this,_)}),this.outerTracker=new g.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:g.delegate(this,O),exitHandler:g.delegate(this,k)}),this.toolbar&&(this.toolbar=new g.ControlDock({element:this.toolbar})),this.bindStandardControls(),u[this.hash].prevContainerSize=d(this.container),this.world=new g.World({viewer:this}),this.world.addHandler("add-item",function(e){r.source=r.world.getItemAt(0).source,u[r.hash].forceRedraw=!0,r._updateRequestId||(r._updateRequestId=l(r,D))}),this.world.addHandler("remove-item",function(e){r.world.getItemCount()?r.source=r.world.getItemAt(0).source:r.source=null,u[r.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(e){r.viewport&&r.viewport._setContentBounds(r.world.getHomeBounds(),r.world.getContentFactor())}),this.world.addHandler("item-index-change",function(e){r.source=r.world.getItemAt(0).source}),this.viewport=new g.Viewport({containerSize:u[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new g.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:e.timeout}),this.tileCache=new g.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new g.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=g.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(t=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(t,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(t=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(t,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new g.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),t=0;t<this.customControls.length;t++)this.addControl(this.customControls[t].id,{anchor:this.customControls[t].anchor});g.requestAnimationFrame(function(){f(r)}),void 0===this.imageSmoothingEnabled||this.imageSmoothingEnabled||this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},g.extend(g.Viewer.prototype,g.EventSource.prototype,g.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(e){return g.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(e)},openTileSource:function(e){return g.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(e)},open:function(n,e){var o=this;if(this.close(),n){if(this.sequenceMode&&g.isArray(n))return this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),void 0===e||isNaN(e)||(this.initialPage=e),this.tileSources=n,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),void this._updateSequenceButtons(this._sequenceIndex);if(g.isArray(n)||(n=[n]),n.length){this._opening=!0;function r(){if(a+l===i)if(a){!o._firstOpen&&o.preserveViewport||(o.viewport.goHome(!0),o.viewport.update()),o._firstOpen=!1;var e=n[0];if(e.tileSource&&(e=e.tileSource),o.overlays&&!o.preserveOverlays)for(var t=0;t<o.overlays.length;t++)o.currentOverlays[t]=h(o,o.overlays[t]);o._drawOverlays(),o._opening=!1,o.raiseEvent("open",{source:e})}else o._opening=!1,o.raiseEvent("open-failed",s)}function t(n){g.isPlainObject(n)&&n.tileSource||(n={tileSource:n}),void 0!==n.index&&(g.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete n.index),void 0===n.collectionImmediately&&(n.collectionImmediately=!0);var i=n.success;n.success=function(e){if(a++,n.tileSource.overlays)for(var t=0;t<n.tileSource.overlays.length;t++)o.addOverlay(n.tileSource.overlays[t]);i&&i(e),r()};var t=n.error;n.error=function(e){l++,s=s||e,t&&t(e),r()},o.addTiledImage(n)}for(var s,i=n.length,a=0,l=0,c=0;c<n.length;c++)t(n[c]);return this}}},close:function(){return u[this.hash]&&(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),u[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close")),this},destroy:function(){if(u[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),null!==this._updateRequestId&&(g.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),u[this.hash]=null,delete u[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(e){return this.innerTracker.setTracking(e),this.outerTracker.setTracking(e),this.raiseEvent("mouse-enabled",{enabled:e}),this},areControlsEnabled:function(){var e,t=this.controls.length;for(e=0;e<this.controls.length;e++)t=t&&this.controls[e].isVisible();return t},setControlsEnabled:function(e){return e?p(this):f(this),this.raiseEvent("controls-enabled",{enabled:e}),this},setDebugMode:function(e){for(var t=0;t<this.world.getItemCount();t++)this.world.getItemAt(t).debugMode=e;this.debugMode=e,this.forceRedraw()},isFullPage:function(){return u[this.hash].fullPage},setFullPage:function(e){var t,n,i=document.body,o=i.style,r=document.documentElement.style,s=this;if(e==this.isFullPage())return this;var a={fullPage:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",a),a.preventDefaultAction)return this;if(e){for(this.elementSize=g.getElementSize(this.element),this.pageScroll=g.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=o.margin,this.docMargin=r.margin,o.margin="0",r.margin="0",this.bodyPadding=o.padding,this.docPadding=r.padding,o.padding="0",r.padding="0",this.bodyWidth=o.width,this.docWidth=r.width,o.width="100%",r.width="100%",this.bodyHeight=o.height,this.docHeight=r.height,o.height="100%",r.height="100%",this.previousBody=[],u[this.hash].prevElementParent=this.element.parentNode,u[this.hash].prevNextSibling=this.element.nextSibling,u[this.hash].prevElementWidth=this.element.style.width,u[this.hash].prevElementHeight=this.element.style.height,t=i.childNodes.length,n=0;n<t;n++)this.previousBody.push(i.childNodes[0]),i.removeChild(i.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,i.appendChild(this.toolbar.element),g.addClass(this.toolbar.element,"fullpage")),g.addClass(this.element,"fullpage"),i.appendChild(this.element),this.element.style.height=g.getWindowSize().y+"px",this.element.style.width=g.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=g.getElementSize(this.element).y-g.getElementSize(this.toolbar.element).y+"px"),u[this.hash].fullPage=!0,g.delegate(this,O)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,o.margin=this.bodyMargin,r.margin=this.docMargin,o.padding=this.bodyPadding,r.padding=this.docPadding,o.width=this.bodyWidth,r.width=this.docWidth,o.height=this.bodyHeight,r.height=this.docHeight,i.removeChild(this.element),t=this.previousBody.length,n=0;n<t;n++)i.appendChild(this.previousBody.shift());g.removeClass(this.element,"fullpage"),u[this.hash].prevElementParent.insertBefore(this.element,u[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(i.removeChild(this.toolbar.element),g.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=u[this.hash].prevElementWidth,this.element.style.height=u[this.hash].prevElementHeight;var l=0,c=function(){g.setPageScroll(s.pageScroll);var e=g.getPageScroll();++l<10&&(e.x!==s.pageScroll.x||e.y!==s.pageScroll.y)&&g.requestAnimationFrame(c)};g.requestAnimationFrame(c),u[this.hash].fullPage=!1,g.delegate(this,k)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:e}),this},setFullScreen:function(e){var t=this;if(!g.supportsFullScreen)return this.setFullPage(e);if(g.isFullScreen()===e)return this;var n={fullScreen:e,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",n),n.preventDefaultAction)return this;if(e){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var i=function(){var e=g.isFullScreen();e||(g.removeEvent(document,g.fullScreenEventName,i),g.removeEvent(document,g.fullScreenErrorEventName,i),t.setFullPage(!1),t.isFullPage()&&(t.element.style.width=t.fullPageStyleWidth,t.element.style.height=t.fullPageStyleHeight)),t.navigator&&t.viewport&&setTimeout(function(){t.navigator.update(t.viewport)}),t.raiseEvent("full-screen",{fullScreen:e})};g.addEvent(document,g.fullScreenEventName,i),g.addEvent(document,g.fullScreenErrorEventName,i),g.requestFullScreen(document.body)}else g.exitFullScreen();return this},isVisible:function(){return"hidden"!=this.container.style.visibility},setVisible:function(e){return this.container.style.visibility=e?"":"hidden",this.raiseEvent("visible",{visible:e}),this},addTiledImage:function(n){g.console.assert(n,"[Viewer.addTiledImage] options is required"),g.console.assert(n.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),g.console.assert(!n.replace||-1<n.index&&n.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var o=this;n.replace&&(n.replaceItem=o.world.getItemAt(n.index)),this._hideMessage(),void 0===n.placeholderFillStyle&&(n.placeholderFillStyle=this.placeholderFillStyle),void 0===n.opacity&&(n.opacity=this.opacity),void 0===n.preload&&(n.preload=this.preload),void 0===n.compositeOperation&&(n.compositeOperation=this.compositeOperation),void 0===n.crossOriginPolicy&&(n.crossOriginPolicy=void 0!==n.tileSource.crossOriginPolicy?n.tileSource.crossOriginPolicy:this.crossOriginPolicy),void 0===n.ajaxWithCredentials&&(n.ajaxWithCredentials=this.ajaxWithCredentials),void 0===n.loadTilesWithAjax&&(n.loadTilesWithAjax=this.loadTilesWithAjax),void 0===n.ajaxHeaders||null===n.ajaxHeaders?n.ajaxHeaders=this.ajaxHeaders:g.isPlainObject(n.ajaxHeaders)&&g.isPlainObject(this.ajaxHeaders)&&(n.ajaxHeaders=g.extend({},this.ajaxHeaders,n.ajaxHeaders));var i={options:n};function t(e){for(var t=0;t<o._loadQueue.length;t++)if(o._loadQueue[t]===i){o._loadQueue.splice(t,1);break}0===o._loadQueue.length&&r(i),o.raiseEvent("add-item-failed",e),n.error&&n.error(e)}function r(e){o.collectionMode&&(o.world.arrange({immediately:e.options.collectionImmediately,rows:o.collectionRows,columns:o.collectionColumns,layout:o.collectionLayout,tileSize:o.collectionTileSize,tileMargin:o.collectionTileMargin}),o.world.setAutoRefigureSizes(!0))}function s(){for(var e,t,n;o._loadQueue.length&&(e=o._loadQueue[0]).tileSource;){if(o._loadQueue.splice(0,1),e.options.replace){var i=o.world.getIndexOfItem(e.options.replaceItem);-1!=i&&(e.options.index=i),o.world.removeItem(e.options.replaceItem)}t=new g.TiledImage({viewer:o,source:e.tileSource,viewport:o.viewport,drawer:o.drawer,tileCache:o.tileCache,imageLoader:o.imageLoader,x:e.options.x,y:e.options.y,width:e.options.width,height:e.options.height,fitBounds:e.options.fitBounds,fitBoundsPlacement:e.options.fitBoundsPlacement,clip:e.options.clip,placeholderFillStyle:e.options.placeholderFillStyle,opacity:e.options.opacity,preload:e.options.preload,degrees:e.options.degrees,compositeOperation:e.options.compositeOperation,springStiffness:o.springStiffness,animationTime:o.animationTime,minZoomImageRatio:o.minZoomImageRatio,wrapHorizontal:o.wrapHorizontal,wrapVertical:o.wrapVertical,immediateRender:o.immediateRender,blendTime:o.blendTime,alwaysBlend:o.alwaysBlend,minPixelRatio:o.minPixelRatio,smoothTileEdgesMinZoom:o.smoothTileEdgesMinZoom,iOSDevice:o.iOSDevice,crossOriginPolicy:e.options.crossOriginPolicy,ajaxWithCredentials:e.options.ajaxWithCredentials,loadTilesWithAjax:e.options.loadTilesWithAjax,ajaxHeaders:e.options.ajaxHeaders,debugMode:o.debugMode}),o.collectionMode&&o.world.setAutoRefigureSizes(!1),o.world.addItem(t,{index:e.options.index}),0===o._loadQueue.length&&r(e),1!==o.world.getItemCount()||o.preserveViewport||o.viewport.goHome(!0),o.navigator&&(n=g.extend({},e.options,{replace:!1,originalTiledImage:t,tileSource:e.tileSource}),o.navigator.addTiledImage(n)),e.options.success&&e.options.success({item:t})}}g.isArray(n.tileSource)?setTimeout(function(){t({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:n.tileSource,options:n})}):(this._loadQueue.push(i),function(n,i,o,r,s){var a=n;if("string"==g.type(i))if(i.match(/^\s*<.*>\s*$/))i=g.parseXml(i);else if(i.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var e=g.parseJSON(i);i=e}catch(e){}function l(e,t){e.ready?r(e):(e.addHandler("ready",function(){r(e)}),e.addHandler("open-failed",function(e){s({message:e.message,source:t})}))}setTimeout(function(){if("string"==g.type(i))(i=new g.TileSource({url:i,crossOriginPolicy:void 0!==o.crossOriginPolicy?o.crossOriginPolicy:n.crossOriginPolicy,ajaxWithCredentials:n.ajaxWithCredentials,ajaxHeaders:n.ajaxHeaders,useCanvas:n.useCanvas,success:function(e){r(e.tileSource)}})).addHandler("open-failed",function(e){s(e)});else if(g.isPlainObject(i)||i.nodeType)if(void 0!==i.crossOriginPolicy||void 0===o.crossOriginPolicy&&void 0===n.crossOriginPolicy||(i.crossOriginPolicy=void 0!==o.crossOriginPolicy?o.crossOriginPolicy:n.crossOriginPolicy),void 0===i.ajaxWithCredentials&&(i.ajaxWithCredentials=n.ajaxWithCredentials),void 0===i.useCanvas&&(i.useCanvas=n.useCanvas),g.isFunction(i.getTileUrl)){var e=new g.TileSource(i);e.getTileUrl=i.getTileUrl,r(e)}else{var t=g.TileSource.determineType(a,i);if(!t)return void s({message:"Unable to load TileSource",source:i});l(new t(t.prototype.configure.apply(a,[i])),i)}else l(i,i)})}(this,n.tileSource,n,function(e){i.tileSource=e,s()},function(e){e.options=n,t(e),s()}))},addSimpleImage:function(e){g.console.assert(e,"[Viewer.addSimpleImage] options is required"),g.console.assert(e.url,"[Viewer.addSimpleImage] options.url is required");var t=g.extend({},e,{tileSource:{type:"image",url:e.url}});delete t.url,this.addTiledImage(t)},addLayer:function(t){var n=this;g.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var e=g.extend({},t,{success:function(e){n.raiseEvent("add-layer",{options:t,drawer:e.item})},error:function(e){n.raiseEvent("add-layer-failed",e)}});return this.addTiledImage(e),this},getLayerAtLevel:function(e){return g.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(e)},getLevelOfLayer:function(e){return g.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(e)},getLayersCount:function(){return g.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(e,t){return g.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(e,t)},removeLayer:function(e){return g.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(e)},forceRedraw:function(){return u[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var e=g.delegate(this,m),t=g.delegate(this,v),n=g.delegate(this,$),i=g.delegate(this,W),o=this.navImages,r=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(r=!1),this.previousButton=new g.Button({element:this.previousButton?g.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.PreviousPage"),srcRest:M(this.prefixUrl,o.previous.REST),srcGroup:M(this.prefixUrl,o.previous.GROUP),srcHover:M(this.prefixUrl,o.previous.HOVER),srcDown:M(this.prefixUrl,o.previous.DOWN),onRelease:i,onFocus:e,onBlur:t}),this.nextButton=new g.Button({element:this.nextButton?g.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.NextPage"),srcRest:M(this.prefixUrl,o.next.REST),srcGroup:M(this.prefixUrl,o.next.GROUP),srcHover:M(this.prefixUrl,o.next.HOVER),srcDown:M(this.prefixUrl,o.next.DOWN),onRelease:n,onFocus:e,onBlur:t}),this.navPrevNextWrap||this.previousButton.disable(),this.tileSources&&this.tileSources.length||this.nextButton.disable(),r&&(this.paging=new g.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:g.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||g.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var e=g.delegate(this,F),t=g.delegate(this,N),n=g.delegate(this,H),i=g.delegate(this,L),o=g.delegate(this,B),r=g.delegate(this,j),s=g.delegate(this,U),a=g.delegate(this,V),l=g.delegate(this,q),c=g.delegate(this,G),u=g.delegate(this,m),d=g.delegate(this,v),h=this.navImages,f=[],p=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(p=!1),this.showZoomControl&&(f.push(this.zoomInButton=new g.Button({element:this.zoomInButton?g.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.ZoomIn"),srcRest:M(this.prefixUrl,h.zoomIn.REST),srcGroup:M(this.prefixUrl,h.zoomIn.GROUP),srcHover:M(this.prefixUrl,h.zoomIn.HOVER),srcDown:M(this.prefixUrl,h.zoomIn.DOWN),onPress:e,onRelease:t,onClick:n,onEnter:e,onExit:t,onFocus:u,onBlur:d})),f.push(this.zoomOutButton=new g.Button({element:this.zoomOutButton?g.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.ZoomOut"),srcRest:M(this.prefixUrl,h.zoomOut.REST),srcGroup:M(this.prefixUrl,h.zoomOut.GROUP),srcHover:M(this.prefixUrl,h.zoomOut.HOVER),srcDown:M(this.prefixUrl,h.zoomOut.DOWN),onPress:i,onRelease:t,onClick:o,onEnter:i,onExit:t,onFocus:u,onBlur:d}))),this.showHomeControl&&f.push(this.homeButton=new g.Button({element:this.homeButton?g.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.Home"),srcRest:M(this.prefixUrl,h.home.REST),srcGroup:M(this.prefixUrl,h.home.GROUP),srcHover:M(this.prefixUrl,h.home.HOVER),srcDown:M(this.prefixUrl,h.home.DOWN),onRelease:r,onFocus:u,onBlur:d})),this.showFullPageControl&&f.push(this.fullPageButton=new g.Button({element:this.fullPageButton?g.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.FullPage"),srcRest:M(this.prefixUrl,h.fullpage.REST),srcGroup:M(this.prefixUrl,h.fullpage.GROUP),srcHover:M(this.prefixUrl,h.fullpage.HOVER),srcDown:M(this.prefixUrl,h.fullpage.DOWN),onRelease:s,onFocus:u,onBlur:d})),this.showRotationControl&&(f.push(this.rotateLeftButton=new g.Button({element:this.rotateLeftButton?g.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.RotateLeft"),srcRest:M(this.prefixUrl,h.rotateleft.REST),srcGroup:M(this.prefixUrl,h.rotateleft.GROUP),srcHover:M(this.prefixUrl,h.rotateleft.HOVER),srcDown:M(this.prefixUrl,h.rotateleft.DOWN),onRelease:a,onFocus:u,onBlur:d})),f.push(this.rotateRightButton=new g.Button({element:this.rotateRightButton?g.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.RotateRight"),srcRest:M(this.prefixUrl,h.rotateright.REST),srcGroup:M(this.prefixUrl,h.rotateright.GROUP),srcHover:M(this.prefixUrl,h.rotateright.HOVER),srcDown:M(this.prefixUrl,h.rotateright.DOWN),onRelease:l,onFocus:u,onBlur:d}))),this.showFlipControl&&f.push(this.flipButton=new g.Button({element:this.flipButton?g.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:g.getString("Tooltips.Flip"),srcRest:M(this.prefixUrl,h.flip.REST),srcGroup:M(this.prefixUrl,h.flip.GROUP),srcHover:M(this.prefixUrl,h.flip.HOVER),srcDown:M(this.prefixUrl,h.flip.DOWN),onRelease:c,onFocus:u,onBlur:d})),p&&(this.buttons=new g.ButtonGroup({buttons:f,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",g.delegate(this,z)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||g.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||g.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(e){return this.tileSources&&0<=e&&e<this.tileSources.length&&(this._sequenceIndex=e,this._updateSequenceButtons(e),this.open(this.tileSources[e]),this.referenceStrip&&this.referenceStrip.setFocus(e),this.raiseEvent("page",{page:e})),this},addOverlay:function(e,t,n,i){var o;if(o=g.isPlainObject(e)?e:{element:e,location:t,placement:n,onDraw:i},e=g.getElement(o.element),0<=a(this.currentOverlays,e))return this;var r=h(this,o);return this.currentOverlays.push(r),r.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:e,location:o.location,placement:o.placement}),this},updateOverlay:function(e,t,n){var i;return e=g.getElement(e),0<=(i=a(this.currentOverlays,e))&&(this.currentOverlays[i].update(t,n),u[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:e,location:t,placement:n})),this},removeOverlay:function(e){var t;return e=g.getElement(e),0<=(t=a(this.currentOverlays,e))&&(this.currentOverlays[t].destroy(),this.currentOverlays.splice(t,1),u[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:e})),this},clearOverlays:function(){for(;0<this.currentOverlays.length;)this.currentOverlays.pop().destroy();return u[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(e){var t;return e=g.getElement(e),0<=(t=a(this.currentOverlays,e))?this.currentOverlays[t]:null},_updateSequenceButtons:function(e){this.nextButton&&(this.tileSources&&this.tileSources.length-1!==e?this.nextButton.enable():this.navPrevNextWrap||this.nextButton.disable()),this.previousButton&&(0<e?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(e){this._hideMessage();var t=g.makeNeutralElement("div");t.appendChild(document.createTextNode(e)),this.messageDiv=g.makeCenteredNode(t),g.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var e=this.messageDiv;e&&(e.parentNode.removeChild(e),delete this.messageDiv)},gestureSettingsByDeviceType:function(e){switch(e){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var e,t=this.currentOverlays.length;for(e=0;e<t;e++)this.currentOverlays[e].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&1<this.tileSources.length&&(this.referenceStrip=new g.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else g.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}})}(OpenSeadragon),function(u){function d(e){var t={tracker:e.eventSource,position:e.position,quick:e.quick,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",t),!t.preventDefaultAction&&e.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(e.position.x=this.viewport.getContainerSize().x-e.position.x);var n=this.viewport.pointFromPixel(e.position);this.panVertical?this.panHorizontal||(n.x=this.viewer.viewport.getCenter(!0).x):n.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(n),this.viewer.viewport.applyConstraints()}}function h(e){var t={tracker:e.eventSource,position:e.position,delta:e.delta,speed:e.speed,direction:e.direction,shift:e.shift,originalEvent:e.originalEvent,preventDefaultAction:e.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",t),!t.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(e.delta.x=0),this.panVertical||(e.delta.y=0),this.viewer.viewport.flipped&&(e.delta.x=-e.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(e.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function f(e){e.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function p(e){return this.viewer.raiseEvent("navigator-scroll",{tracker:e.eventSource,position:e.position,scroll:e.scroll,shift:e.shift,originalEvent:e.originalEvent}),!1}function g(e,t){n(e,"rotate("+t+"deg)")}function n(e,t){e.style.webkitTransform=t,e.style.mozTransform=t,e.style.msTransform=t,e.style.oTransform=t,e.style.transform=t}u.Navigator=function(e){var t,n,i,o,r,s,a=e.viewer,l=this;function c(e){g(l.displayRegionContainer,e),g(l.displayRegion,-e),l.viewport.setRotation(e)}e.id?(this.element=document.getElementById(e.id),e.controlOptions={anchor:u.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(e.id="navigator-"+u.now(),this.element=u.makeNeutralElement("div"),e.controlOptions={anchor:u.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:e.autoFade},e.position&&("BOTTOM_RIGHT"==e.position?e.controlOptions.anchor=u.ControlAnchor.BOTTOM_RIGHT:"BOTTOM_LEFT"==e.position?e.controlOptions.anchor=u.ControlAnchor.BOTTOM_LEFT:"TOP_RIGHT"==e.position?e.controlOptions.anchor=u.ControlAnchor.TOP_RIGHT:"TOP_LEFT"==e.position?e.controlOptions.anchor=u.ControlAnchor.TOP_LEFT:"ABSOLUTE"==e.position&&(e.controlOptions.anchor=u.ControlAnchor.ABSOLUTE,e.controlOptions.top=e.top,e.controlOptions.left=e.left,e.controlOptions.height=e.height,e.controlOptions.width=e.width))),this.element.id=e.id,this.element.className+=" navigator",(e=u.extend(!0,{sizeRatio:u.DEFAULT_SETTINGS.navigatorSizeRatio},e,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:e.autoResize,minZoomImageRatio:1,background:e.background,opacity:e.opacity,borderColor:e.borderColor,displayRegionColor:e.displayRegionColor})).minPixelRatio=this.minPixelRatio=a.minPixelRatio,u.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new u.Point(1,1),this.totalBorderWidths=new u.Point(2*this.borderWidth,2*this.borderWidth).minus(this.fudge),e.controlOptions.anchor!=u.ControlAnchor.NONE&&(i=this.element.style,o=this.borderWidth,i.margin="0px",i.border=o+"px solid "+e.borderColor,i.padding="0px",i.background=e.background,i.opacity=e.opacity,i.overflow="hidden"),this.displayRegion=u.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",r=this.displayRegion.style,s=this.borderWidth,r.position="relative",r.top="0px",r.left="0px",r.fontSize="0px",r.overflow="hidden",r.border=s+"px solid "+e.displayRegionColor,r.margin="0px",r.padding="0px",r.background="transparent",r.float="left",r.cssFloat="left",r.styleFloat="left",r.zIndex=999999999,r.cursor="default",this.displayRegionContainer=u.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",a.addControl(this.element,e.controlOptions),this._resizeWithViewer=e.controlOptions.anchor!=u.ControlAnchor.ABSOLUTE&&e.controlOptions.anchor!=u.ControlAnchor.NONE,this._resizeWithViewer&&(e.width&&e.height?(this.element.style.height="number"==typeof e.height?e.height+"px":e.height,this.element.style.width="number"==typeof e.width?e.width+"px":e.width):(t=u.getElementSize(a.element),this.element.style.height=Math.round(t.y*e.sizeRatio)+"px",this.element.style.width=Math.round(t.x*e.sizeRatio)+"px",this.oldViewerSize=t),n=u.getElementSize(this.element),this.elementArea=n.x*n.y),this.oldContainerSize=new u.Point(0,0),u.Viewer.apply(this,[e]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer),e.navigatorRotate&&(c(e.viewer.viewport?e.viewer.viewport.getRotation():e.viewer.degrees||0),e.viewer.addHandler("rotate",function(e){c(e.degrees)}));this.innerTracker.destroy(),this.innerTracker=new u.MouseTracker({element:this.element,dragHandler:u.delegate(this,h),clickHandler:u.delegate(this,d),releaseHandler:u.delegate(this,f),scrollHandler:u.delegate(this,p)}),this.addHandler("reset-size",function(){l.viewport&&l.viewport.goHome(!0)}),a.world.addHandler("item-index-change",function(t){window.setTimeout(function(){var e=l.world.getItemAt(t.previousIndex);l.world.setItemIndex(e,t.newIndex)},1)}),a.world.addHandler("remove-item",function(e){var t=e.item,n=l._getMatchingItem(t);n&&l.world.removeItem(n)}),this.update(a.viewport)},u.extend(u.Navigator.prototype,u.EventSource.prototype,u.Viewer.prototype,{updateSize:function(){if(this.viewport){var e=new u.Point(0===this.container.clientWidth?1:this.container.clientWidth,0===this.container.clientHeight?1:this.container.clientHeight);e.equals(this.oldContainerSize)||(this.viewport.resize(e,!0),this.viewport.goHome(!0),this.oldContainerSize=e,this.drawer.clear(),this.world.draw())}},setFlip:function(e){return this.viewport.setFlip(e),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(e){n(this.displayRegion,e),n(this.canvas,e),n(this.element,e)},update:function(e){var t,n,i,o,r,s;if(t=u.getElementSize(this.viewer.element),this._resizeWithViewer&&t.x&&t.y&&!t.equals(this.oldViewerSize)&&(this.oldViewerSize=t,i=this.maintainSizeRatio||!this.elementArea?(n=t.x*this.sizeRatio,t.y*this.sizeRatio):(n=Math.sqrt(this.elementArea*(t.x/t.y)),this.elementArea/n),this.element.style.width=Math.round(n)+"px",this.element.style.height=Math.round(i)+"px",this.elementArea||(this.elementArea=n*i),this.updateSize()),e&&this.viewport){o=e.getBoundsNoRotate(!0),r=this.viewport.pixelFromPointNoRotate(o.getTopLeft(),!1),s=this.viewport.pixelFromPointNoRotate(o.getBottomRight(),!1).minus(this.totalBorderWidths);var a=this.displayRegion.style;a.display=this.world.getItemCount()?"block":"none",a.top=Math.round(r.y)+"px",a.left=Math.round(r.x)+"px";var l=Math.abs(r.x-s.x),c=Math.abs(r.y-s.y);a.width=Math.round(Math.max(l,0))+"px",a.height=Math.round(Math.max(c,0))+"px"}},addTiledImage:function(e){var i=this,o=e.originalTiledImage;delete e.original;var t=u.extend({},e,{success:function(e){var t=e.item;function n(){i._matchBounds(t,o)}t._originalForNavigator=o,i._matchBounds(t,o,!0),o.addHandler("bounds-change",n),o.addHandler("clip-change",n),o.addHandler("opacity-change",function(){i._matchOpacity(t,o)}),o.addHandler("composite-operation-change",function(){i._matchCompositeOperation(t,o)})}});return u.Viewer.prototype.addTiledImage.apply(this,[t])},_getMatchingItem:function(e){for(var t,n=this.world.getItemCount(),i=0;i<n;i++)if((t=this.world.getItemAt(i))._originalForNavigator===e)return t;return null},_matchBounds:function(e,t,n){var i=t.getBoundsNoRotate();e.setPosition(i.getTopLeft(),n),e.setWidth(i.width,n),e.setRotation(t.getRotation(),n),e.setClip(t.getClip())},_matchOpacity:function(e,t){e.setOpacity(t.opacity)},_matchCompositeOperation:function(e,t){e.setCompositeOperation(t.compositeOperation)}})}(OpenSeadragon),function(s){var a={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};s.extend(s,{getString:function(e){var t,n=e.split("."),i=null,o=arguments,r=a;for(t=0;t<n.length-1;t++)r=r[n[t]]||{};return"string"!=typeof(i=r[n[t]])&&(s.console.log("Untranslated source string:",e),i=""),i.replace(/\{\d+\}/g,function(e){var t=parseInt(e.match(/\d+/),10)+1;return t<o.length?o[t]:""})},setString:function(e,t){var n,i=e.split("."),o=a;for(n=0;n<i.length-1;n++)o[i[n]]||(o[i[n]]={}),o=o[i[n]];o[i[n]]=t}})}(OpenSeadragon),function(a){a.Point=function(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0},a.Point.prototype={clone:function(){return new a.Point(this.x,this.y)},plus:function(e){return new a.Point(this.x+e.x,this.y+e.y)},minus:function(e){return new a.Point(this.x-e.x,this.y-e.y)},times:function(e){return new a.Point(this.x*e,this.y*e)},divide:function(e){return new a.Point(this.x/e,this.y/e)},negate:function(){return new a.Point(-this.x,-this.y)},distanceTo:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},squaredDistanceTo:function(e){return Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)},apply:function(e){return new a.Point(e(this.x),e(this.y))},equals:function(e){return e instanceof a.Point&&this.x===e.x&&this.y===e.y},rotate:function(e,t){var n,i;if(t=t||new a.Point(0,0),e%90==0){switch(a.positiveModulo(e,360)){case 0:n=1,i=0;break;case 90:n=0,i=1;break;case 180:n=-1,i=0;break;case 270:n=0,i=-1}}else{var o=e*Math.PI/180;n=Math.cos(o),i=Math.sin(o)}var r=n*(this.x-t.x)-i*(this.y-t.y)+t.x,s=i*(this.x-t.x)+n*(this.y-t.y)+t.y;return new a.Point(r,s)},toString:function(){return"("+Math.round(100*this.x)/100+","+Math.round(100*this.y)/100+")"}}}(OpenSeadragon),function(h){h.TileSource=function(e,t,n,i,o,r){var s,a,l=this,c=arguments;if(s=h.isPlainObject(e)?e:{width:c[0],height:c[1],tileSize:c[2],tileOverlap:c[3],minLevel:c[4],maxLevel:c[5]},h.EventSource.call(this),h.extend(!0,this,s),!this.success)for(a=0;a<arguments.length;a++)if(h.isFunction(arguments[a])){this.success=arguments[a];break}this.success&&this.addHandler("ready",function(e){l.success(e)}),"string"==h.type(e)&&(this.url=e),this.url?(this.aspectRatio=1,this.dimensions=new h.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=s.width&&s.height?s.width/s.height:1,this.dimensions=new h.Point(s.width,s.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=s.tileOverlap?s.tileOverlap:0,this.minLevel=s.minLevel?s.minLevel:0,this.maxLevel=void 0!==s.maxLevel&&null!==s.maxLevel?s.maxLevel:s.width&&s.height?Math.ceil(Math.log(Math.max(s.width,s.height))/Math.log(2)):0,this.success&&h.isFunction(this.success)&&this.success(this))},h.TileSource.prototype={getTileSize:function(e){return h.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(e){return this._tileWidth?this._tileWidth:this.getTileSize(e)},getTileHeight:function(e){return this._tileHeight?this._tileHeight:this.getTileSize(e)},getLevelScale:function(e){var t,n={};for(t=0;t<=this.maxLevel;t++)n[t]=1/Math.pow(2,this.maxLevel-t);return this.getLevelScale=function(e){return n[e]},this.getLevelScale(e)},getNumTiles:function(e){var t=this.getLevelScale(e),n=Math.ceil(t*this.dimensions.x/this.getTileWidth(e)),i=Math.ceil(t*this.dimensions.y/this.getTileHeight(e));return new h.Point(n,i)},getPixelRatio:function(e){var t=this.dimensions.times(this.getLevelScale(e)),n=1/t.x,i=1/t.y;return new h.Point(n,i)},getClosestLevel:function(){var e,t;for(e=this.minLevel+1;e<=this.maxLevel&&!(1<(t=this.getNumTiles(e)).x||1<t.y);e++);return e-1},getTileAtPoint:function(e,t){var n=0<=t.x&&t.x<=1&&0<=t.y&&t.y<=1/this.aspectRatio;h.console.assert(n,"[TileSource.getTileAtPoint] must be called with a valid point.");var i=this.dimensions.x*this.getLevelScale(e),o=t.x*i,r=t.y*i,s=Math.floor(o/this.getTileWidth(e)),a=Math.floor(r/this.getTileHeight(e));1<=t.x&&(s=this.getNumTiles(e).x-1);return t.y>=1/this.aspectRatio-1e-15&&(a=this.getNumTiles(e).y-1),new h.Point(s,a)},getTileBounds:function(e,t,n,i){var o=this.dimensions.times(this.getLevelScale(e)),r=this.getTileWidth(e),s=this.getTileHeight(e),a=0===t?0:r*t-this.tileOverlap,l=0===n?0:s*n-this.tileOverlap,c=r+(0===t?1:2)*this.tileOverlap,u=s+(0===n?1:2)*this.tileOverlap,d=1/o.x;return c=Math.min(c,o.x-a),u=Math.min(u,o.y-l),i?new h.Rect(0,0,c,u):new h.Rect(a*d,l*d,c*d,u*d)},getImageInfo:function(i){var e,n,o,r,t,s,a,l=this;i&&-1<(a=(s=(t=i.split("/"))[t.length-1]).lastIndexOf("."))&&(t[t.length-1]=s.slice(0,a)),n=function(e){"string"==typeof e&&(e=h.parseXml(e));var t=h.TileSource.determineType(l,e,i);t?(void 0===(r=t.prototype.configure.apply(l,[e,i])).ajaxWithCredentials&&(r.ajaxWithCredentials=l.ajaxWithCredentials),o=new t(r),l.ready=!0,l.raiseEvent("ready",{tileSource:o})):l.raiseEvent("open-failed",{message:"Unable to load TileSource",source:i})},i.match(/\.js$/)?(e=i.split("/").pop().replace(".js",""),h.jsonp({url:i,async:!1,callbackName:e,callback:n})):h.makeAjaxRequest({url:i,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(e){var t=function(t){var e,n,i=t.responseText,o=t.status;{if(!t)throw new Error(h.getString("Errors.Security"));if(200!==t.status&&0!==t.status)throw o=t.status,e=404==o?"Not Found":t.statusText,new Error(h.getString("Errors.Status",o,e))}if(i.match(/\s*<.*/))try{n=t.responseXML&&t.responseXML.documentElement?t.responseXML:h.parseXml(i)}catch(e){n=t.responseText}else if(i.match(/\s*[\{\[].*/))try{n=h.parseJSON(i)}catch(e){n=i}else n=i;return n}(e);n(t)},error:function(e,t){var n;try{n="HTTP "+e.status+" attempting to load TileSource"}catch(e){n=(void 0!==t&&t.toString?t.toString():"Unknown error")+" attempting to load TileSource"}l.raiseEvent("open-failed",{message:n,source:i})}})},supports:function(e,t){return!1},configure:function(e,t){throw new Error("Method not implemented.")},getTileUrl:function(e,t,n){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(e,t,n){return{}},tileExists:function(e,t,n){var i=this.getNumTiles(e);return e>=this.minLevel&&e<=this.maxLevel&&0<=t&&0<=n&&t<i.x&&n<i.y}},h.extend(!0,h.TileSource.prototype,h.EventSource.prototype),h.TileSource.determineType=function(e,t,n){var i;for(i in OpenSeadragon)if(i.match(/.+TileSource$/)&&h.isFunction(OpenSeadragon[i])&&h.isFunction(OpenSeadragon[i].prototype.supports)&&OpenSeadragon[i].prototype.supports.call(e,t,n))return OpenSeadragon[i];h.console.error("No TileSource was able to open %s %s",n,t)}}(OpenSeadragon),function(p){function f(e,t){var n,i,o=t.Image,r=o.Url,s=o.Format,a=o.Size,l=o.DisplayRect||[],c=parseInt(a.Width,10),u=parseInt(a.Height,10),d=parseInt(o.TileSize,10),h=parseInt(o.Overlap,10),f=[];for(i=0;i<l.length;i++)n=l[i].Rect,f.push(new p.DisplayRect(parseInt(n.X,10),parseInt(n.Y,10),parseInt(n.Width,10),parseInt(n.Height,10),parseInt(n.MinLevel,10),parseInt(n.MaxLevel,10)));return p.extend(!0,{width:c,height:u,tileSize:d,tileOverlap:h,minLevel:null,maxLevel:null,tilesUrl:r,fileFormat:s,displayRects:f},t)}p.DziTileSource=function(e,t,n,i,o,r,s,a,l){var c,u,d,h;if(h=p.isPlainObject(e)?e:{width:e,height:t,tileSize:n,tileOverlap:i,tilesUrl:o,fileFormat:r,displayRects:s,minLevel:a,maxLevel:l},this._levelRects={},this.tilesUrl=h.tilesUrl,this.fileFormat=h.fileFormat,this.displayRects=h.displayRects,this.displayRects)for(c=this.displayRects.length-1;0<=c;c--)for(d=(u=this.displayRects[c]).minLevel;d<=u.maxLevel;d++)this._levelRects[d]||(this._levelRects[d]=[]),this._levelRects[d].push(u);p.TileSource.apply(this,[h])},p.extend(p.DziTileSource.prototype,p.TileSource.prototype,{supports:function(e,t){var n;return e.Image?n=e.Image.xmlns:e.documentElement&&("Image"!=e.documentElement.localName&&"Image"!=e.documentElement.tagName||(n=e.documentElement.namespaceURI)),-1!==(n=(n||"").toLowerCase()).indexOf("schemas.microsoft.com/deepzoom/2008")||-1!==n.indexOf("schemas.microsoft.com/deepzoom/2009")},configure:function(e,t){var n;return n=p.isPlainObject(e)?f(this,e):function(e,t){if(!t||!t.documentElement)throw new Error(p.getString("Errors.Xml"));var n,i,o,r,s,a=t.documentElement,l=a.localName||a.tagName,c=t.documentElement.namespaceURI,u=null,d=[];if("Image"==l)try{if(void 0===(r=a.getElementsByTagName("Size")[0])&&(r=a.getElementsByTagNameNS(c,"Size")[0]),u={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:a.getAttribute("Url"),Format:a.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(a.getAttribute("Overlap"),10),TileSize:parseInt(a.getAttribute("TileSize"),10),Size:{Height:parseInt(r.getAttribute("Height"),10),Width:parseInt(r.getAttribute("Width"),10)}}},!p.imageFormatSupported(u.Image.Format))throw new Error(p.getString("Errors.ImageFormat",u.Image.Format.toUpperCase()));for(void 0===(n=a.getElementsByTagName("DisplayRect"))&&(n=a.getElementsByTagNameNS(c,"DisplayRect")[0]),s=0;s<n.length;s++)i=n[s],void 0===(o=i.getElementsByTagName("Rect")[0])&&(o=i.getElementsByTagNameNS(c,"Rect")[0]),d.push({Rect:{X:parseInt(o.getAttribute("X"),10),Y:parseInt(o.getAttribute("Y"),10),Width:parseInt(o.getAttribute("Width"),10),Height:parseInt(o.getAttribute("Height"),10),MinLevel:parseInt(i.getAttribute("MinLevel"),10),MaxLevel:parseInt(i.getAttribute("MaxLevel"),10)}});return d.length&&(u.Image.DisplayRect=d),f(e,u)}catch(e){throw e instanceof Error?e:new Error(p.getString("Errors.Dzi"))}else{if("Collection"==l)throw new Error(p.getString("Errors.Dzc"));if("Error"==l){var h=a.getElementsByTagName("Message")[0].firstChild.nodeValue;throw new Error(h)}}throw new Error(p.getString("Errors.Dzi"))}(this,e),t&&!n.tilesUrl&&(n.tilesUrl=t.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),-1!=t.search(/\.(dzi|xml|js)\?/)?n.queryParams=t.match(/\?.*/):n.queryParams=""),n},getTileUrl:function(e,t,n){return[this.tilesUrl,e,"/",t,"_",n,".",this.fileFormat,this.queryParams].join("")},tileExists:function(e,t,n){var i,o,r,s,a,l,c,u=this._levelRects[e];if(this.minLevel&&e<this.minLevel||this.maxLevel&&e>this.maxLevel)return!1;if(!u||!u.length)return!0;for(c=u.length-1;0<=c;c--)if(!(e<(i=u[c]).minLevel||e>i.maxLevel)&&(o=this.getLevelScale(e),r=i.x*o,s=i.y*o,a=r+i.width*o,l=s+i.height*o,r=Math.floor(r/this._tileWidth),s=Math.floor(s/this._tileWidth),a=Math.ceil(a/this._tileWidth),l=Math.ceil(l/this._tileWidth),r<=t&&t<a&&s<=n&&n<l))return!0;return!1}})}(OpenSeadragon),function(c){c.IIIFTileSource=function(e){if(c.extend(!0,this,e),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(e.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.tile_width&&this.tile_height)e.tileWidth=this.tile_width,e.tileHeight=this.tile_height;else if(this.tile_width)e.tileSize=this.tile_width;else if(this.tile_height)e.tileSize=this.tile_height;else if(this.tiles)if(1==this.tiles.length)e.tileWidth=this.tiles[0].width,e.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var t=0;t<this.tiles.length;t++)for(var n=0;n<this.tiles[t].scaleFactors.length;n++){var i=this.tiles[t].scaleFactors[n];this.scale_factors.push(i),e.tileSizePerScaleFactor[i]={width:this.tiles[t].width,height:this.tiles[t].height||this.tiles[t].width}}}else if(function(e){var t=-1!==["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json"].indexOf(e[0]),n=!1;1<e.length&&e[1].supports&&(n=-1!==e[1].supports.indexOf("sizeByW"));return!t||n}(e.profile)){for(var o=Math.min(this.height,this.width),r=[256,512,1024],s=[],a=0;a<r.length;a++)r[a]<=o&&s.push(r[a]);0<s.length?e.tileSize=Math.max.apply(null,s):e.tileSize=o}else this.sizes&&0<this.sizes.length?(this.emulateLegacyImagePyramid=!0,e.levels=function(e){for(var t=[],n=0;n<e.sizes.length;n++)t.push({url:e["@id"]+"/full/"+e.sizes[n].width+",/0/default."+e.tileFormat,width:e.sizes[n].width,height:e.sizes[n].height});return t.sort(function(e,t){return e.width-t.width})}(this),c.extend(!0,e,{width:e.levels[e.levels.length-1].width,height:e.levels[e.levels.length-1].height,tileSize:Math.max(e.height,e.width),tileOverlap:0,minLevel:0,maxLevel:e.levels.length-1}),this.levels=e.levels):c.console.error("Nothing in the info.json to construct image pyramids from");if(!e.maxLevel&&!this.emulateLegacyImagePyramid)if(this.scale_factors){var l=Math.max.apply(null,this.scale_factors);e.maxLevel=Math.round(Math.log(l)*Math.LOG2E)}else e.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));c.TileSource.apply(this,[e])},c.extend(c.IIIFTileSource.prototype,c.TileSource.prototype,{supports:function(e,t){return!(!e.protocol||"http://iiif.io/api/image"!=e.protocol)||(!(!e["@context"]||"http://library.stanford.edu/iiif/image-api/1.1/context.json"!=e["@context"]&&"http://iiif.io/api/image/1/context.json"!=e["@context"])||(!(!e.profile||0!==e.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html"))||(!!(e.identifier&&e.width&&e.height)||!(!e.documentElement||"info"!=e.documentElement.tagName||"http://library.stanford.edu/iiif/image-api/ns/"!=e.documentElement.namespaceURI))))},configure:function(e,t){if(c.isPlainObject(e)){if(e["@context"]||(e["@context"]="http://iiif.io/api/image/1.0/context.json",e["@id"]=t.replace("/info.json","")),e.preferredFormats)for(var n=0;n<e.preferredFormats.length;n++)if(OpenSeadragon.imageFormatSupported(e.preferredFormats[n])){e.tileFormat=e.preferredFormats[n];break}return e}var i=function(e){if(!e||!e.documentElement)throw new Error(c.getString("Errors.Xml"));var t=e.documentElement,n=t.tagName,i=null;if("info"==n)try{return function e(t,n,i){var o,r;if(3==t.nodeType&&i)(r=t.nodeValue.trim()).match(/^\d*$/)&&(r=Number(r)),n[i]?(c.isArray(n[i])||(n[i]=[n[i]]),n[i].push(r)):n[i]=r;else if(1==t.nodeType)for(o=0;o<t.childNodes.length;o++)e(t.childNodes[o],n,t.nodeName)}(t,i={}),i}catch(e){throw e instanceof Error?e:new Error(c.getString("Errors.IIIF"))}throw new Error(c.getString("Errors.IIIF"))}(e);return i["@context"]="http://iiif.io/api/image/1.0/context.json",i["@id"]=t.replace("/info.xml",""),i},getTileWidth:function(e){if(this.emulateLegacyImagePyramid)return c.TileSource.prototype.getTileWidth.call(this,e);var t=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].width:this._tileWidth},getTileHeight:function(e){if(this.emulateLegacyImagePyramid)return c.TileSource.prototype.getTileHeight.call(this,e);var t=Math.pow(2,this.maxLevel-e);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[t]?this.tileSizePerScaleFactor[t].height:this._tileHeight},getLevelScale:function(e){if(this.emulateLegacyImagePyramid){var t=NaN;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t}return c.TileSource.prototype.getLevelScale.call(this,e)},getNumTiles:function(e){return this.emulateLegacyImagePyramid?this.getLevelScale(e)?new c.Point(1,1):new c.Point(0,0):c.TileSource.prototype.getNumTiles.call(this,e)},getTileAtPoint:function(e,t){return this.emulateLegacyImagePyramid?new c.Point(0,0):c.TileSource.prototype.getTileAtPoint.call(this,e,t)},getTileUrl:function(e,t,n){if(this.emulateLegacyImagePyramid){var i=null;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i}var o,r,s,a,l,c,u,d,h,f,p,g,m,v=Math.pow(.5,this.maxLevel-e),b=Math.ceil(this.width*v),y=Math.ceil(this.height*v);return o=this.getTileWidth(e),r=this.getTileHeight(e),s=Math.ceil(o/v),a=Math.ceil(r/v),g=(m=-1<this["@context"].indexOf("/1.0/context.json")||-1<this["@context"].indexOf("/1.1/context.json")||-1<this["@context"].indexOf("/1/context.json"))?"native."+this.tileFormat:"default."+this.tileFormat,b<o&&y<r?(f=m||b!==this.width?b+",":"max",l="full"):(c=t*s,u=n*a,d=Math.min(s,this.width-c),h=Math.min(a,this.height-u),l=0===t&&0===n&&d===this.width&&h===this.height?"full":[c,u,d,h].join(","),p=Math.ceil(d*v),f=m||p!==this.width?p+",":"max"),[this["@id"],l,f,"0",g].join("/")}})}(OpenSeadragon),function(s){s.OsmTileSource=function(e,t,n,i,o){var r;(r=s.isPlainObject(e)?e:{width:e,height:t,tileSize:n,tileOverlap:i,tilesUrl:o}).width&&r.height||(r.width=65572864,r.height=65572864),r.tileSize||(r.tileSize=256,r.tileOverlap=0),r.tilesUrl||(r.tilesUrl="http://tile.openstreetmap.org/"),r.minLevel=8,s.TileSource.apply(this,[r])},s.extend(s.OsmTileSource.prototype,s.TileSource.prototype,{supports:function(e,t){return e.type&&"openstreetmaps"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){return this.tilesUrl+(e-8)+"/"+t+"/"+n+".png"}})}(OpenSeadragon),function(c){c.TmsTileSource=function(e,t,n,i,o){var r;r=c.isPlainObject(e)?e:{width:e,height:t,tileSize:n,tileOverlap:i,tilesUrl:o};var s,a=256*Math.ceil(r.width/256),l=256*Math.ceil(r.height/256);s=l<a?a/256:l/256,r.maxLevel=Math.ceil(Math.log(s)/Math.log(2))-1,r.tileSize=256,r.width=a,r.height=l,c.TileSource.apply(this,[r])},c.extend(c.TmsTileSource.prototype,c.TileSource.prototype,{supports:function(e,t){return e.type&&"tiledmapservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){var i=this.getNumTiles(e).y-1;return this.tilesUrl+e+"/"+t+"/"+(i-n)+".png"}})}(OpenSeadragon),function(e){e.ZoomifyTileSource=function(e){e.tileSize=256;var t={x:e.width,y:e.height};for(e.imageSizes=[{x:e.width,y:e.height}],e.gridSize=[this._getGridSize(e.width,e.height,e.tileSize)];parseInt(t.x,10)>e.tileSize||parseInt(t.y,10)>e.tileSize;)t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e.imageSizes.push({x:t.x,y:t.y}),e.gridSize.push(this._getGridSize(t.x,t.y,e.tileSize));e.imageSizes.reverse(),e.gridSize.reverse(),e.minLevel=0,e.maxLevel=e.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[e])},e.extend(e.ZoomifyTileSource.prototype,e.TileSource.prototype,{_getGridSize:function(e,t,n){return{x:Math.ceil(e/n),y:Math.ceil(t/n)}},_calculateAbsoluteTileNumber:function(e,t,n){for(var i=0,o={},r=0;r<e;r++)i+=(o=this.gridSize[r]).x*o.y;return i+=(o=this.gridSize[e]).x*n+t},supports:function(e,t){return e.type&&"zoomifytileservice"==e.type},configure:function(e,t){return e},getTileUrl:function(e,t,n){var i,o=this._calculateAbsoluteTileNumber(e,t,n);return i=Math.floor(o/256),this.tilesUrl+"TileGroup"+i+"/"+e+"-"+t+"-"+n+".jpg"}})}(OpenSeadragon),function(l){function c(e,t){return t.levels}l.LegacyTileSource=function(e){var t,n,i;l.isArray(e)&&(t={type:"legacy-image-pyramid",levels:e}),t.levels=function(e){var t,n,i=[];for(n=0;n<e.length;n++)(t=e[n]).height&&t.width&&t.url?i.push({url:t.url,width:Number(t.width),height:Number(t.height)}):l.console.error("Unsupported image format: %s",t.url?t.url:"<no URL>");return i.sort(function(e,t){return e.height-t.height})}(t.levels),0<t.levels.length?(n=t.levels[t.levels.length-1].width,i=t.levels[t.levels.length-1].height):(i=n=0,l.console.error("No supported image formats found")),l.extend(!0,t,{width:n,height:i,tileSize:Math.max(i,n),tileOverlap:0,minLevel:0,maxLevel:0<t.levels.length?t.levels.length-1:0}),l.TileSource.apply(this,[t]),this.levels=t.levels},l.extend(l.LegacyTileSource.prototype,l.TileSource.prototype,{supports:function(e,t){return e.type&&"legacy-image-pyramid"==e.type||e.documentElement&&"legacy-image-pyramid"==e.documentElement.getAttribute("type")},configure:function(e,t){return l.isPlainObject(e)?c(this,e):function(e,t){if(!t||!t.documentElement)throw new Error(l.getString("Errors.Xml"));var n,i,o=t.documentElement,r=o.tagName,s=null,a=[];if("image"==r)try{for(s={type:o.getAttribute("type"),levels:[]},a=o.getElementsByTagName("level"),i=0;i<a.length;i++)n=a[i],s.levels.push({url:n.getAttribute("url"),width:parseInt(n.getAttribute("width"),10),height:parseInt(n.getAttribute("height"),10)});return c(e,s)}catch(e){throw e instanceof Error?e:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if("collection"==r)throw new Error("Legacy Image Pyramid Collections not yet supported.");if("error"==r)throw new Error("Error: "+t)}throw new Error("Unknown element "+r)}(this,e)},getLevelScale:function(e){var t=NaN;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(e){return this.getLevelScale(e)?new l.Point(1,1):new l.Point(0,0)},getTileUrl:function(e,t,n){var i=null;return 0<this.levels.length&&e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i}})}(OpenSeadragon),function(a){a.ImageTileSource=function(e){e=a.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},e),a.TileSource.apply(this,[e])},a.extend(a.ImageTileSource.prototype,a.TileSource.prototype,{supports:function(e,t){return e.type&&"image"===e.type},configure:function(e,t){return e},getImageInfo:function(e){var t=this._image=new Image,n=this;this.crossOriginPolicy&&(t.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(t.useCredentials=this.ajaxWithCredentials),a.addEvent(t,"load",function(){n.width=Object.prototype.hasOwnProperty.call(t,"naturalWidth")?t.naturalWidth:t.width,n.height=Object.prototype.hasOwnProperty.call(t,"naturalHeight")?t.naturalHeight:t.height,n.aspectRatio=n.width/n.height,n.dimensions=new a.Point(n.width,n.height),n._tileWidth=n.width,n._tileHeight=n.height,n.tileOverlap=0,n.minLevel=0,n.levels=n._buildLevels(),n.maxLevel=n.levels.length-1,n.ready=!0,n.raiseEvent("ready",{tileSource:n})}),a.addEvent(t,"error",function(){n.raiseEvent("open-failed",{message:"Error loading image at "+e,source:e})}),t.src=e},getLevelScale:function(e){var t=NaN;return e>=this.minLevel&&e<=this.maxLevel&&(t=this.levels[e].width/this.levels[this.maxLevel].width),t},getNumTiles:function(e){return this.getLevelScale(e)?new a.Point(1,1):new a.Point(0,0)},getTileUrl:function(e,t,n){var i=null;return e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].url),i},getContext2D:function(e,t,n){var i=null;return e>=this.minLevel&&e<=this.maxLevel&&(i=this.levels[e].context2D),i},_buildLevels:function(){var e=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!a.supportsCanvas||!this.useCanvas)return delete this._image,e;var t=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,n=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,i=document.createElement("canvas"),o=i.getContext("2d");if(i.width=t,i.height=n,o.drawImage(this._image,0,0,t,n),e[0].context2D=o,delete this._image,a.isCanvasTainted(i))return e;for(;2<=t&&2<=n;){t=Math.floor(t/2),n=Math.floor(n/2);var r=document.createElement("canvas"),s=r.getContext("2d");r.width=t,r.height=n,s.drawImage(i,0,0,t,n),e.splice(0,0,{context2D:s,width:t,height:n}),i=r,o=s}return e}})}(OpenSeadragon),function(o){o.TileSourceCollection=function(e,t,n,i){o.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(o){function r(e){o.requestAnimationFrame(function(){!function(e){var t,n,i;e.shouldFade&&(t=o.now(),n=t-e.fadeBeginTime,i=1-n/e.fadeLength,i=Math.min(1,i),i=Math.max(0,i),e.imgGroup&&o.setElementOpacity(e.imgGroup,i,!0),0<i&&r(e))}(e)})}function n(e,t){e.element.disabled||(t>=o.ButtonState.GROUP&&e.currentState==o.ButtonState.REST&&(function(e){e.shouldFade=!1,e.imgGroup&&o.setElementOpacity(e.imgGroup,1,!0)}(e),e.currentState=o.ButtonState.GROUP),t>=o.ButtonState.HOVER&&e.currentState==o.ButtonState.GROUP&&(e.imgHover&&(e.imgHover.style.visibility=""),e.currentState=o.ButtonState.HOVER),t>=o.ButtonState.DOWN&&e.currentState==o.ButtonState.HOVER&&(e.imgDown&&(e.imgDown.style.visibility=""),e.currentState=o.ButtonState.DOWN))}function i(e,t){e.element.disabled||(t<=o.ButtonState.HOVER&&e.currentState==o.ButtonState.DOWN&&(e.imgDown&&(e.imgDown.style.visibility="hidden"),e.currentState=o.ButtonState.HOVER),t<=o.ButtonState.GROUP&&e.currentState==o.ButtonState.HOVER&&(e.imgHover&&(e.imgHover.style.visibility="hidden"),e.currentState=o.ButtonState.GROUP),t<=o.ButtonState.REST&&e.currentState==o.ButtonState.GROUP&&(function(e){e.shouldFade=!0,e.fadeBeginTime=o.now()+e.fadeDelay,window.setTimeout(function(){r(e)},e.fadeDelay)}(e),e.currentState=o.ButtonState.REST))}o.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},o.Button=function(e){var t=this;o.EventSource.call(this),o.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:o.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:o.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},e),this.element=e.element||o.makeNeutralElement("div"),e.element||(this.imgRest=o.makeTransparentImage(this.srcRest),this.imgGroup=o.makeTransparentImage(this.srcGroup),this.imgHover=o.makeTransparentImage(this.srcHover),this.imgDown=o.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",o.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",o.Browser.vendor==o.BROWSERS.FIREFOX&&o.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=o.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new o.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){e.insideElementPressed?(n(t,o.ButtonState.DOWN),t.raiseEvent("enter",{originalEvent:e.originalEvent})):e.buttonDownAny||n(t,o.ButtonState.HOVER)},focusHandler:function(e){this.enterHandler(e),t.raiseEvent("focus",{originalEvent:e.originalEvent})},exitHandler:function(e){i(t,o.ButtonState.GROUP),e.insideElementPressed&&t.raiseEvent("exit",{originalEvent:e.originalEvent})},blurHandler:function(e){this.exitHandler(e),t.raiseEvent("blur",{originalEvent:e.originalEvent})},pressHandler:function(e){n(t,o.ButtonState.DOWN),t.raiseEvent("press",{originalEvent:e.originalEvent})},releaseHandler:function(e){e.insideElementPressed&&e.insideElementReleased?(i(t,o.ButtonState.HOVER),t.raiseEvent("release",{originalEvent:e.originalEvent})):e.insideElementPressed?i(t,o.ButtonState.GROUP):n(t,o.ButtonState.HOVER)},clickHandler:function(e){e.quick&&t.raiseEvent("click",{originalEvent:e.originalEvent})},keyHandler:function(e){return 13!==e.keyCode||(t.raiseEvent("click",{originalEvent:e.originalEvent}),t.raiseEvent("release",{originalEvent:e.originalEvent}),!1)}}),i(this,o.ButtonState.REST)},o.extend(o.Button.prototype,o.EventSource.prototype,{notifyGroupEnter:function(){n(this,o.ButtonState.GROUP)},notifyGroupExit:function(){i(this,o.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,o.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,o.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}})}(OpenSeadragon),function(o){o.ButtonGroup=function(e){o.extend(!0,this,{buttons:[],clickTimeThreshold:o.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:o.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},e);var t,n=this.buttons.concat([]),i=this;if(this.element=e.element||o.makeNeutralElement("div"),!e.group)for(this.element.style.display="inline-block",t=0;t<n.length;t++)this.element.appendChild(n[t].element);o.setElementTouchActionNone(this.element),this.tracker=new o.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(e){var t;for(t=0;t<i.buttons.length;t++)i.buttons[t].notifyGroupEnter()},exitHandler:function(e){var t;if(!e.insideElementPressed)for(t=0;t<i.buttons.length;t++)i.buttons[t].notifyGroupExit()}})},o.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(E){E.Rect=function(e,t,n,i,o){var r,s;this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.width="number"==typeof n?n:0,this.height="number"==typeof i?i:0,this.degrees="number"==typeof o?o:0,this.degrees=E.positiveModulo(this.degrees,360),270<=this.degrees?(r=this.getTopRight(),this.x=r.x,this.y=r.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=270):180<=this.degrees?(r=this.getBottomRight(),this.x=r.x,this.y=r.y,this.degrees-=180):90<=this.degrees&&(r=this.getBottomLeft(),this.x=r.x,this.y=r.y,s=this.height,this.height=this.width,this.width=s,this.degrees-=90)},E.Rect.fromSummits=function(e,t,n){var i=e.distanceTo(t),o=e.distanceTo(n),r=t.minus(e),s=Math.atan(r.y/r.x);return r.x<0?s+=Math.PI:r.y<0&&(s+=2*Math.PI),new E.Rect(e.x,e.y,i,o,s/Math.PI*180)},E.Rect.prototype={clone:function(){return new E.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new E.Point(this.x,this.y)},getBottomRight:function(){return new E.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new E.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new E.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new E.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new E.Point(this.width,this.height)},equals:function(e){return e instanceof E.Rect&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height&&this.degrees===e.degrees},times:function(e){return new E.Rect(this.x*e,this.y*e,this.width*e,this.height*e,this.degrees)},translate:function(e){return new E.Rect(this.x+e.x,this.y+e.y,this.width,this.height,this.degrees)},union:function(e){var t=this.getBoundingBox(),n=e.getBoundingBox(),i=Math.min(t.x,n.x),o=Math.min(t.y,n.y),r=Math.max(t.x+t.width,n.x+n.width),s=Math.max(t.y+t.height,n.y+n.height);return new E.Rect(i,o,r-i,s-o)},intersection:function(e){var c=1e-10,t=[],n=this.getTopLeft();e.containsPoint(n,c)&&t.push(n);var i=this.getTopRight();e.containsPoint(i,c)&&t.push(i);var o=this.getBottomLeft();e.containsPoint(o,c)&&t.push(o);var r=this.getBottomRight();e.containsPoint(r,c)&&t.push(r);var s=e.getTopLeft();this.containsPoint(s,c)&&t.push(s);var a=e.getTopRight();this.containsPoint(a,c)&&t.push(a);var l=e.getBottomLeft();this.containsPoint(l,c)&&t.push(l);var u=e.getBottomRight();this.containsPoint(u,c)&&t.push(u);for(var d=this._getSegments(),h=e._getSegments(),f=0;f<d.length;f++)for(var p=d[f],g=0;g<h.length;g++){var m=h[g],v=b(p[0],p[1],m[0],m[1]);v&&t.push(v)}function b(e,t,n,i){var o=t.minus(e),r=i.minus(n),s=-r.x*o.y+o.x*r.y;if(0==s)return null;var a=(o.x*(e.y-n.y)-o.y*(e.x-n.x))/s,l=(r.x*(e.y-n.y)-r.y*(e.x-n.x))/s;return-c<=a&&a<=1-c&&-c<=l&&l<=1-c?new E.Point(e.x+l*o.x,e.y+l*o.y):null}if(0===t.length)return null;for(var y=t[0].x,w=t[0].x,T=t[0].y,x=t[0].y,S=1;S<t.length;S++){var C=t[S];C.x<y&&(y=C.x),C.x>w&&(w=C.x),C.y<T&&(T=C.y),C.y>x&&(x=C.y)}return new E.Rect(y,T,w-y,x-T)},_getSegments:function(){var e=this.getTopLeft(),t=this.getTopRight(),n=this.getBottomLeft(),i=this.getBottomRight();return[[e,t],[t,i],[i,n],[n,e]]},rotate:function(e,t){if(0===(e=E.positiveModulo(e,360)))return this.clone();t=t||this.getCenter();var n=this.getTopLeft().rotate(e,t),i=this.getTopRight().rotate(e,t).minus(n);i=i.apply(function(e){return Math.abs(e)<1e-15?0:e});var o=Math.atan(i.y/i.x);return i.x<0?o+=Math.PI:i.y<0&&(o+=2*Math.PI),new E.Rect(n.x,n.y,this.width,this.height,o/Math.PI*180)},getBoundingBox:function(){if(0===this.degrees)return this.clone();var e=this.getTopLeft(),t=this.getTopRight(),n=this.getBottomLeft(),i=this.getBottomRight(),o=Math.min(e.x,t.x,n.x,i.x),r=Math.max(e.x,t.x,n.x,i.x),s=Math.min(e.y,t.y,n.y,i.y),a=Math.max(e.y,t.y,n.y,i.y);return new E.Rect(o,s,r-o,a-s)},getIntegerBoundingBox:function(){var e=this.getBoundingBox(),t=Math.floor(e.x),n=Math.floor(e.y),i=Math.ceil(e.width+e.x-t),o=Math.ceil(e.height+e.y-n);return new E.Rect(t,n,i,o)},containsPoint:function(e,t){t=t||0;var n=this.getTopLeft(),i=this.getTopRight(),o=this.getBottomLeft(),r=i.minus(n),s=o.minus(n);return(e.x-n.x)*r.x+(e.y-n.y)*r.y>=-t&&(e.x-i.x)*r.x+(e.y-i.y)*r.y<=t&&(e.x-n.x)*s.x+(e.y-n.y)*s.y>=-t&&(e.x-o.x)*s.x+(e.y-o.y)*s.y<=t},toString:function(){return"["+Math.round(100*this.x)/100+", "+Math.round(100*this.y)/100+", "+Math.round(100*this.width)/100+"x"+Math.round(100*this.height)/100+", "+Math.round(100*this.degrees)/100+"deg]"}}}(OpenSeadragon),function(h){var s={};function a(e){var t=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),i=Number(this.element.style.width.replace("px","")),o=Number(this.element.style.height.replace("px","")),r=h.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&("horizontal"==this.scroll?0<-e.delta.x?t>-(i-r.x)&&(this.element.style.marginLeft=t+2*e.delta.x+"px",c(this,r.x,t+2*e.delta.x)):-e.delta.x<0&&t<0&&(this.element.style.marginLeft=t+2*e.delta.x+"px",c(this,r.x,t+2*e.delta.x)):0<-e.delta.y?n>-(o-r.y)&&(this.element.style.marginTop=n+2*e.delta.y+"px",c(this,r.y,n+2*e.delta.y)):-e.delta.y<0&&n<0&&(this.element.style.marginTop=n+2*e.delta.y+"px",c(this,r.y,n+2*e.delta.y))),!1}function l(e){var t=Number(this.element.style.marginLeft.replace("px","")),n=Number(this.element.style.marginTop.replace("px","")),i=Number(this.element.style.width.replace("px","")),o=Number(this.element.style.height.replace("px","")),r=h.getElementSize(this.viewer.canvas);return this.element&&("horizontal"==this.scroll?0<e.scroll?t>-(i-r.x)&&(this.element.style.marginLeft=t-60*e.scroll+"px",c(this,r.x,t-60*e.scroll)):e.scroll<0&&t<0&&(this.element.style.marginLeft=t-60*e.scroll+"px",c(this,r.x,t-60*e.scroll)):e.scroll<0?n>r.y-o&&(this.element.style.marginTop=n+60*e.scroll+"px",c(this,r.y,n+60*e.scroll)):0<e.scroll&&n<0&&(this.element.style.marginTop=n+60*e.scroll+"px",c(this,r.y,n+60*e.scroll))),!1}function c(e,t,n){var i,o,r,s,a,l,c;for(i="horizontal"==e.scroll?e.panelWidth:e.panelHeight,o=Math.ceil(t/i)+5,l=o=(o=(r=Math.ceil((Math.abs(n)+t)/i)+1)-o)<0?0:o;l<r&&l<e.panels.length;l++)if(!(c=e.panels[l]).activePanel){var u,d=e.viewer.tileSources[l];u=d.referenceStripThumbnailUrl?{type:"image",url:d.referenceStripThumbnailUrl}:d,(s=new h.Viewer({id:c.id,tileSources:[u],element:c,navigatorSizeRatio:e.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0})).displayRegion=h.makeNeutralElement("div"),s.displayRegion.id=c.id+"-displayregion",s.displayRegion.className="displayregion",(a=s.displayRegion.style).position="relative",a.top="0px",a.left="0px",a.fontSize="0px",a.overflow="hidden",a.float="left",a.cssFloat="left",a.styleFloat="left",a.zIndex=999999999,a.cursor="default",a.width=e.panelWidth-4+"px",a.height=e.panelHeight-4+"px",s.displayRegion.innerTracker=new h.MouseTracker({element:s.displayRegion,startDisabled:!0}),c.getElementsByTagName("div")[0].appendChild(s.displayRegion),e.miniViewers[c.id]=s,c.activePanel=!0}}function u(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="0px":t.style.marginLeft="0px",!1}function d(e){var t=e.eventSource.element;return"horizontal"==this.scroll?t.style.marginBottom="-"+h.getElementSize(t).y/2+"px":t.style.marginLeft="-"+h.getElementSize(t).x/2+"px",!1}function f(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 38:return l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:case 37:return l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}function p(e){if(e.preventDefaultAction||e.ctrl||e.alt||e.meta)return!0;switch(e.keyCode){case 61:return l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:case 97:return l.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return l.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}}h.ReferenceStrip=function(e){var t,n,i,r=e.viewer,o=h.getElementSize(r.element);for(e.id||(e.id="referencestrip-"+h.now(),this.element=h.makeNeutralElement("div"),this.element.id=e.id,this.element.className="referencestrip"),e=h.extend(!0,{sizeRatio:h.DEFAULT_SETTINGS.referenceStripSizeRatio,position:h.DEFAULT_SETTINGS.referenceStripPosition,scroll:h.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:h.DEFAULT_SETTINGS.clickTimeThreshold},e,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),h.extend(this,e),s[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,(n=this.element.style).marginTop="0px",n.marginRight="0px",n.marginBottom="0px",n.marginLeft="0px",n.left="0px",n.bottom="0px",n.border="0px",n.background="#000",n.position="relative",h.setElementTouchActionNone(this.element),h.setElementOpacity(this.element,.8),this.viewer=r,this.innerTracker=new h.MouseTracker({element:this.element,dragHandler:h.delegate(this,a),scrollHandler:h.delegate(this,l),enterHandler:h.delegate(this,u),exitHandler:h.delegate(this,d),keyDownHandler:h.delegate(this,f),keyHandler:h.delegate(this,p)}),e.width&&e.height?(this.element.style.width=e.width+"px",this.element.style.height=e.height+"px",r.addControl(this.element,{anchor:h.ControlAnchor.BOTTOM_LEFT})):"horizontal"==e.scroll?(this.element.style.width=o.x*e.sizeRatio*r.tileSources.length+12*r.tileSources.length+"px",this.element.style.height=o.y*e.sizeRatio+"px",r.addControl(this.element,{anchor:h.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=o.y*e.sizeRatio*r.tileSources.length+12*r.tileSources.length+"px",this.element.style.width=o.x*e.sizeRatio+"px",r.addControl(this.element,{anchor:h.ControlAnchor.TOP_LEFT})),this.panelWidth=o.x*this.sizeRatio+8,this.panelHeight=o.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},i=0;i<r.tileSources.length;i++)(t=h.makeNeutralElement("div")).id=this.element.id+"-"+i,t.style.width=this.panelWidth+"px",t.style.height=this.panelHeight+"px",t.style.display="inline",t.style.float="left",t.style.cssFloat="left",t.style.styleFloat="left",t.style.padding="2px",h.setElementTouchActionNone(t),t.innerTracker=new h.MouseTracker({element:t,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(e){e.eventSource.dragging=h.now()},releaseHandler:function(e){var t=e.eventSource,n=t.element.id,i=Number(n.split("-")[2]),o=h.now();e.insideElementPressed&&e.insideElementReleased&&t.dragging&&o-t.dragging<t.clickTimeThreshold&&(t.dragging=null,r.goToPage(i))}}),this.element.appendChild(t),t.activePanel=!1,this.panels.push(t);c(this,"vertical"==this.scroll?o.y:o.x,0),this.setFocus(0)},h.extend(h.ReferenceStrip.prototype,h.EventSource.prototype,h.Viewer.prototype,{setFocus:function(e){var t,n=h.getElement(this.element.id+"-"+e),i=h.getElementSize(this.viewer.canvas),o=Number(this.element.style.width.replace("px","")),r=Number(this.element.style.height.replace("px","")),s=-Number(this.element.style.marginLeft.replace("px","")),a=-Number(this.element.style.marginTop.replace("px",""));this.currentSelected!==n&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=n,this.currentSelected.style.background="#999","horizontal"==this.scroll?(t=Number(e)*(this.panelWidth+3))>s+i.x-this.panelWidth?(t=Math.min(t,o-i.x),this.element.style.marginLeft=-t+"px",c(this,i.x,-t)):t<s&&(t=Math.max(0,t-i.x/2),this.element.style.marginLeft=-t+"px",c(this,i.x,-t)):(t=Number(e)*(this.panelHeight+3))>a+i.y-this.panelHeight?(t=Math.min(t,r-i.y),this.element.style.marginTop=-t+"px",c(this,i.y,-t)):t<a&&(t=Math.max(0,t-i.y/2),this.element.style.marginTop=-t+"px",c(this,i.y,-t)),this.currentPage=e,u.call(this,{eventSource:this.innerTracker}))},update:function(){return!!s[this.id].animating&&(h.console.log("image reference strip update"),!0)},destroy:function(){if(this.miniViewers)for(var e in this.miniViewers)this.miniViewers[e].destroy();this.element&&this.element.parentNode.removeChild(this.element)}})}(OpenSeadragon),function(s){s.DisplayRect=function(e,t,n,i,o,r){s.Rect.apply(this,[e,t,n,i]),this.minLevel=o,this.maxLevel=r},s.extend(s.DisplayRect.prototype,s.Rect.prototype)}(OpenSeadragon),function(o){o.Spring=function(e){var t=arguments;"object"!=typeof e&&(e={initial:t.length&&"number"==typeof t[0]?t[0]:void 0,springStiffness:1<t.length?t[1].springStiffness:5,animationTime:1<t.length?t[1].animationTime:1.5}),o.console.assert("number"==typeof e.springStiffness&&0!==e.springStiffness,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),o.console.assert("number"==typeof e.animationTime&&0<=e.animationTime,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),e.exponential&&(this._exponential=!0,delete e.exponential),o.extend(!0,this,e),this.current={value:"number"==typeof this.initial?this.initial:this._exponential?0:1,time:o.now()},o.console.assert(!this._exponential||0!==this.current.value,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},o.Spring.prototype={resetTo:function(e){o.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=e,this.start.time=this.target.time=this.current.time=o.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(e){o.console.assert(!this._exponential||0!==e,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=e,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(e){this.start.value+=e,this.target.value+=e,this._exponential&&(o.console.assert(0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(e){this._exponential=e,this._exponential&&(o.console.assert(0!==this.current.value&&0!==this.target.value&&0!==this.start.value,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){var e,t;this.current.time=o.now(),t=this._exponential?(e=this.start._logValue,this.target._logValue):(e=this.start.value,this.target.value);var n=this.current.time>=this.target.time?t:e+(t-e)*function(e,t){return(1-Math.exp(e*-t))/(1-Math.exp(-e))}(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),i=this.current.value;return this._exponential?this.current.value=Math.exp(n):this.current.value=n,i!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}}}(OpenSeadragon),function(t){function i(e){t.extend(!0,this,{timeout:t.DEFAULT_SETTINGS.timeout,jobId:null},e),this.image=null}i.prototype={errorMsg:null,start:function(){var r=this,e=this.abort;this.image=new Image,this.image.onload=function(){r.finish(!0)},this.image.onabort=this.image.onerror=function(){r.errorMsg="Image load aborted",r.finish(!1)},this.jobId=window.setTimeout(function(){r.errorMsg="Image load exceeded timeout ("+r.timeout+" ms)",r.finish(!1)},this.timeout),this.loadWithAjax?(this.request=t.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(t){var n;try{n=new window.Blob([t.response])}catch(e){var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if("TypeError"===e.name&&i){var o=new i;o.append(t.response),n=o.getBlob()}}0===n.size&&(r.errorMsg="Empty image response.",r.finish(!1));var e=(window.URL||window.webkitURL).createObjectURL(n);r.image.src=e},error:function(e){r.errorMsg="Image load aborted - XHR error",r.finish(!1)}}),this.abort=function(){r.request.abort(),"function"==typeof e&&e()}):(!1!==this.crossOriginPolicy&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(e){this.image.onload=this.image.onerror=this.image.onabort=null,e||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},t.ImageLoader=function(e){t.extend(!0,this,{jobLimit:t.DEFAULT_SETTINGS.imageLoaderLimit,timeout:t.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},e)},t.ImageLoader.prototype={addJob:function(t){var n=this,e=new i({src:t.src,loadWithAjax:t.loadWithAjax,ajaxHeaders:t.loadWithAjax?t.ajaxHeaders:null,crossOriginPolicy:t.crossOriginPolicy,ajaxWithCredentials:t.ajaxWithCredentials,callback:function(e){!function(e,t,n){e.jobsInProgress--,(!e.jobLimit||e.jobsInProgress<e.jobLimit)&&0<e.jobQueue.length&&(e.jobQueue.shift().start(),e.jobsInProgress++);n(t.image,t.errorMsg,t.request)}(n,e,t.callback)},abort:t.abort,timeout:this.timeout});!this.jobLimit||this.jobsInProgress<this.jobLimit?(e.start(),this.jobsInProgress++):this.jobQueue.push(e)},clear:function(){for(var e=0;e<this.jobQueue.length;e++){var t=this.jobQueue[e];"function"==typeof t.abort&&t.abort()}this.jobQueue=[]}}}(OpenSeadragon),function(c){c.Tile=function(e,t,n,i,o,r,s,a,l,c){this.level=e,this.x=t,this.y=n,this.bounds=i,this.sourceBounds=c,this.exists=o,this.url=r,this.context2D=s,this.loadWithAjax=a,this.ajaxHeaders=l,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},c.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(e){this.cacheImageRecord?this.loaded?(this.element||(this.element=c.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=e&&e.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",c.setElementOpacity(this.element,this.opacity)):c.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString()):c.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString())},drawCanvas:function(e,t,n,i){var o,r,s,a=this.position.times(c.pixelDensityRatio),l=this.size.times(c.pixelDensityRatio);this.context2D||this.cacheImageRecord?(o=this.context2D||this.cacheImageRecord.getRenderedContext(),this.loaded&&o?(e.save(),e.globalAlpha=this.opacity,"number"==typeof n&&1!==n&&(a=a.times(n),l=l.times(n)),i instanceof c.Point&&(a=a.plus(i)),1===e.globalAlpha&&this._hasTransparencyChannel()&&e.clearRect(a.x,a.y,l.x,l.y),t({context:e,tile:this,rendered:o}),s=this.sourceBounds?(r=Math.min(this.sourceBounds.width,o.canvas.width),Math.min(this.sourceBounds.height,o.canvas.height)):(r=o.canvas.width,o.canvas.height),e.drawImage(o.canvas,0,0,r,s,a.x,a.y,l.x,l.y),e.restore()):c.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString())):c.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString())},getScaleForEdgeSmoothing:function(){var e;if(this.cacheImageRecord)e=this.cacheImageRecord.getRenderedContext();else{if(!this.context2D)return c.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;e=this.context2D}return e.canvas.width/(this.size.x*c.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(e,t,n){var i=Math.max(1,Math.ceil((n.x-t.x)/2)),o=Math.max(1,Math.ceil((n.y-t.y)/2));return new c.Point(i,o).minus(this.position.times(c.pixelDensityRatio).times(e||1).apply(function(e){return e%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(u){u.OverlayPlacement=u.Placement,u.OverlayRotationMode=u.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),u.Overlay=function(e,t,n){var i;i=u.isPlainObject(e)?e:{element:e,location:t,placement:n},this.element=i.element,this.style=i.element.style,this._init(i)},u.Overlay.prototype={_init:function(e){this.location=e.location,this.placement=void 0===e.placement?u.Placement.TOP_LEFT:e.placement,this.onDraw=e.onDraw,this.checkResize=void 0===e.checkResize||e.checkResize,this.width=void 0===e.width?null:e.width,this.height=void 0===e.height?null:e.height,this.rotationMode=e.rotationMode||u.OverlayRotationMode.EXACT,this.location instanceof u.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=u.Placement.TOP_LEFT),this.scales=null!==this.width&&null!==this.height,this.bounds=new u.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(e,t){var n=u.Placement.properties[this.placement];n&&(n.isHorizontallyCentered?e.x-=t.x/2:n.isRight&&(e.x-=t.x),n.isVerticallyCentered?e.y-=t.y/2:n.isBottom&&(e.y-=t.y))},destroy:function(){var e=this.element,t=this.style;e.parentNode&&(e.parentNode.removeChild(e),e.prevElementParent&&(t.display="none",document.body.appendChild(e))),this.onDraw=null,t.top="",t.left="",t.position="",null!==this.width&&(t.width=""),null!==this.height&&(t.height="");var n=u.getCssPropertyWithVendorPrefix("transformOrigin"),i=u.getCssPropertyWithVendorPrefix("transform");n&&i&&(t[n]="",t[i]="")},drawHTML:function(e,t){var n=this.element;n.parentNode!==e&&(n.prevElementParent=n.parentNode,n.prevNextSibling=n.nextSibling,e.appendChild(n),this.style.position="absolute",this.size=u.getElementSize(n));var i=this._getOverlayPositionAndSize(t),o=i.position,r=this.size=i.size,s=i.rotate;if(this.onDraw)this.onDraw(o,r,this.element);else{var a=this.style;a.left=o.x+"px",a.top=o.y+"px",null!==this.width&&(a.width=r.x+"px"),null!==this.height&&(a.height=r.y+"px");var l=u.getCssPropertyWithVendorPrefix("transformOrigin"),c=u.getCssPropertyWithVendorPrefix("transform");l&&c&&(s?(a[l]=this._getTransformOrigin(),a[c]="rotate("+s+"deg)"):(a[l]="",a[c]="")),"none"!==a.display&&(a.display="block")}},_getOverlayPositionAndSize:function(e){var t=e.pixelFromPoint(this.location,!0),n=this._getSizeInPixels(e);this.adjust(t,n);var i=0;if(e.degrees&&this.rotationMode!==u.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===u.OverlayRotationMode.BOUNDING_BOX&&null!==this.width&&null!==this.height){var o=new u.Rect(t.x,t.y,n.x,n.y),r=this._getBoundingBox(o,e.degrees);t=r.getTopLeft(),n=r.getSize()}else i=e.degrees;return{position:t,size:n,rotate:i}},_getSizeInPixels:function(e){var t=this.size.x,n=this.size.y;if(null!==this.width||null!==this.height){var i=e.deltaPixelsFromPointsNoRotate(new u.Point(this.width||0,this.height||0),!0);null!==this.width&&(t=i.x),null!==this.height&&(n=i.y)}if(this.checkResize&&(null===this.width||null===this.height)){var o=this.size=u.getElementSize(this.element);null===this.width&&(t=o.x),null===this.height&&(n=o.y)}return new u.Point(t,n)},_getBoundingBox:function(e,t){var n=this._getPlacementPoint(e);return e.rotate(t,n).getBoundingBox()},_getPlacementPoint:function(e){var t=new u.Point(e.x,e.y),n=u.Placement.properties[this.placement];return n&&(n.isHorizontallyCentered?t.x+=e.width/2:n.isRight&&(t.x+=e.width),n.isVerticallyCentered?t.y+=e.height/2:n.isBottom&&(t.y+=e.height)),t},_getTransformOrigin:function(){var e="",t=u.Placement.properties[this.placement];return t&&(t.isLeft?e="left":t.isRight&&(e="right"),t.isTop?e+=" top":t.isBottom&&(e+=" bottom")),e},update:function(e,t){var n=u.isPlainObject(e)?e:{location:e,placement:t};this._init({location:n.location||this.location,placement:void 0!==n.placement?n.placement:this.placement,onDraw:n.onDraw||this.onDraw,checkResize:n.checkResize||this.checkResize,width:void 0!==n.width?n.width:this.width,height:void 0!==n.height?n.height:this.height,rotationMode:n.rotationMode||this.rotationMode})},getBounds:function(e){u.console.assert(e,"A viewport must now be passed to Overlay.getBounds.");var t=this.width,n=this.height;if(null===t||null===n){var i=e.deltaPointsFromPixelsNoRotate(this.size,!0);null===t&&(t=i.x),null===n&&(n=i.y)}var o=this.location.clone();return this.adjust(o,new u.Point(t,n)),this._adjustBoundsForRotation(e,new u.Rect(o.x,o.y,t,n))},_adjustBoundsForRotation:function(e,t){if(!e||0===e.degrees||this.rotationMode===u.OverlayRotationMode.EXACT)return t;if(this.rotationMode!==u.OverlayRotationMode.BOUNDING_BOX)return t.rotate(-e.degrees,this._getPlacementPoint(t));if(null===this.width||null===this.height)return t;var n=this._getOverlayPositionAndSize(e);return e.viewerElementToViewportRectangle(new u.Rect(n.position.x,n.position.y,n.size.x,n.size.y))}}}(OpenSeadragon),function(d){d.Drawer=function(e){d.console.assert(e.viewer,"[Drawer] options.viewer is required");var t=arguments;if(d.isPlainObject(e)||(e={source:t[0],viewport:t[1],element:t[2]}),d.console.assert(e.viewport,"[Drawer] options.viewport is required"),d.console.assert(e.element,"[Drawer] options.element is required"),e.source&&d.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=e.viewer,this.viewport=e.viewport,this.debugGridColor="string"==typeof e.debugGridColor?[e.debugGridColor]:e.debugGridColor||d.DEFAULT_SETTINGS.debugGridColor,e.opacity&&d.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=d.supportsCanvas&&(!this.viewer||this.viewer.useCanvas),this.container=d.getElement(e.element),this.canvas=d.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var n=this._calculateCanvasSize();this.canvas.width=n.x,this.canvas.height=n.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",d.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},d.Drawer.prototype={addOverlay:function(e,t,n,i){return d.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(e,t,n,i),this},updateOverlay:function(e,t,n){return d.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(e,t,n),this},removeOverlay:function(e){return d.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(e),this},clearOverlays:function(){return d.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},setOpacity:function(e){d.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var t=this.viewer.world,n=0;n<t.getItemCount();n++)t.getItemAt(n).setOpacity(e);return this},getOpacity:function(){d.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var e=this.viewer.world,t=0,n=0;n<e.getItemCount();n++){var i=e.getItemAt(n).getOpacity();t<i&&(t=i)}return t},needsUpdate:function(){return d.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return d.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return d.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return d.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var e=this._calculateCanvasSize();if((this.canvas.width!=e.x||this.canvas.height!=e.y)&&(this.canvas.width=e.x,this.canvas.height=e.y,this._updateImageSmoothingEnabled(this.context),null!==this.sketchCanvas)){var t=this._calculateSketchCanvasSize();this.sketchCanvas.width=t.x,this.sketchCanvas.height=t.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(e,t){if(this.useCanvas){var n=this._getContext(e);if(t)n.clearRect(t.x,t.y,t.width,t.height);else{var i=n.canvas;n.clearRect(0,0,i.width,i.height)}}},viewportToDrawerRectangle:function(e){var t=this.viewport.pixelFromPointNoRotate(e.getTopLeft(),!0),n=this.viewport.deltaPixelsFromPointsNoRotate(e.getSize(),!0);return new d.Rect(t.x*d.pixelDensityRatio,t.y*d.pixelDensityRatio,n.x*d.pixelDensityRatio,n.y*d.pixelDensityRatio)},drawTile:function(e,t,n,i,o){if(d.console.assert(e,"[Drawer.drawTile] tile is required"),d.console.assert(t,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var r=this._getContext(n);i=i||1,e.drawCanvas(r,t,i,o)}else e.drawHTML(this.canvas)},_getContext:function(e){var t=this.context;if(e){if(null===this.sketchCanvas){this.sketchCanvas=document.createElement("canvas");var n=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=n.x,this.sketchCanvas.height=n.y,this.sketchContext=this.sketchCanvas.getContext("2d"),0===this.viewport.getRotation()){var i=this;this.viewer.addHandler("rotate",function e(){if(0!==i.viewport.getRotation()){i.viewer.removeHandler("rotate",e);var t=i._calculateSketchCanvasSize();i.sketchCanvas.width=t.x,i.sketchCanvas.height=t.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}t=this.sketchContext}return t},saveContext:function(e){this.useCanvas&&this._getContext(e).save()},restoreContext:function(e){this.useCanvas&&this._getContext(e).restore()},setClip:function(e,t){if(this.useCanvas){var n=this._getContext(t);n.beginPath(),n.rect(e.x,e.y,e.width,e.height),n.clip()}},drawRectangle:function(e,t,n){if(this.useCanvas){var i=this._getContext(n);i.save(),i.fillStyle=t,i.fillRect(e.x,e.y,e.width,e.height),i.restore()}},blendSketch:function(e,t,n,i){var o=e;if(d.isPlainObject(o)||(o={opacity:e,scale:t,translate:n,compositeOperation:i}),this.useCanvas&&this.sketchCanvas){e=o.opacity,i=o.compositeOperation;var r=o.bounds;if(this.context.save(),this.context.globalAlpha=e,i&&(this.context.globalCompositeOperation=i),r)r.x<0&&(r.width+=r.x,r.x=0),r.x+r.width>this.canvas.width&&(r.width=this.canvas.width-r.x),r.y<0&&(r.height+=r.y,r.y=0),r.y+r.height>this.canvas.height&&(r.height=this.canvas.height-r.y),this.context.drawImage(this.sketchCanvas,r.x,r.y,r.width,r.height,r.x,r.y,r.width,r.height);else{t=o.scale||1;var s=(n=o.translate)instanceof d.Point?n:new d.Point(0,0),a=0,l=0;if(n){var c=this.sketchCanvas.width-this.canvas.width,u=this.sketchCanvas.height-this.canvas.height;a=Math.round(c/2),l=Math.round(u/2)}this.context.drawImage(this.sketchCanvas,s.x-a*t,s.y-l*t,(this.canvas.width+2*a)*t,(this.canvas.height+2*l)*t,-a,-l,this.canvas.width+2*a,this.canvas.height+2*l)}this.context.restore()}},drawDebugInfo:function(e,t,n,i){if(this.useCanvas){var o=this.viewer.world.getIndexOfItem(i)%this.debugGridColor.length,r=this.context;r.save(),r.lineWidth=2*d.pixelDensityRatio,r.font="small-caps bold "+13*d.pixelDensityRatio+"px arial",r.strokeStyle=this.debugGridColor[o],r.fillStyle=this.debugGridColor[o],0!==this.viewport.degrees&&this._offsetForRotation({degrees:this.viewport.degrees}),i.getRotation(!0)%360!=0&&this._offsetForRotation({degrees:i.getRotation(!0),point:i.viewport.pixelFromPointNoRotate(i._getRotationPoint(!0),!0)}),0===i.viewport.degrees&&i.getRotation(!0)%360==0&&i._drawer.viewer.viewport.getFlip()&&i._drawer._flip(),r.strokeRect(e.position.x*d.pixelDensityRatio,e.position.y*d.pixelDensityRatio,e.size.x*d.pixelDensityRatio,e.size.y*d.pixelDensityRatio);var s=(e.position.x+e.size.x/2)*d.pixelDensityRatio,a=(e.position.y+e.size.y/2)*d.pixelDensityRatio;r.translate(s,a),r.rotate(Math.PI/180*-this.viewport.degrees),r.translate(-s,-a),0===e.x&&0===e.y&&(r.fillText("Zoom: "+this.viewport.getZoom(),e.position.x*d.pixelDensityRatio,(e.position.y-30)*d.pixelDensityRatio),r.fillText("Pan: "+this.viewport.getBounds().toString(),e.position.x*d.pixelDensityRatio,(e.position.y-20)*d.pixelDensityRatio)),r.fillText("Level: "+e.level,(e.position.x+10)*d.pixelDensityRatio,(e.position.y+20)*d.pixelDensityRatio),r.fillText("Column: "+e.x,(e.position.x+10)*d.pixelDensityRatio,(e.position.y+30)*d.pixelDensityRatio),r.fillText("Row: "+e.y,(e.position.x+10)*d.pixelDensityRatio,(e.position.y+40)*d.pixelDensityRatio),r.fillText("Order: "+n+" of "+t,(e.position.x+10)*d.pixelDensityRatio,(e.position.y+50)*d.pixelDensityRatio),r.fillText("Size: "+e.size.toString(),(e.position.x+10)*d.pixelDensityRatio,(e.position.y+60)*d.pixelDensityRatio),r.fillText("Position: "+e.position.toString(),(e.position.x+10)*d.pixelDensityRatio,(e.position.y+70)*d.pixelDensityRatio),0!==this.viewport.degrees&&this._restoreRotationChanges(),i.getRotation(!0)%360!=0&&this._restoreRotationChanges(),0===i.viewport.degrees&&i.getRotation(!0)%360==0&&i._drawer.viewer.viewport.getFlip()&&i._drawer._flip(),r.restore()}},debugRect:function(e){if(this.useCanvas){var t=this.context;t.save(),t.lineWidth=2*d.pixelDensityRatio,t.strokeStyle=this.debugGridColor[0],t.fillStyle=this.debugGridColor[0],t.strokeRect(e.x*d.pixelDensityRatio,e.y*d.pixelDensityRatio,e.width*d.pixelDensityRatio,e.height*d.pixelDensityRatio),t.restore()}},setImageSmoothingEnabled:function(e){this.useCanvas&&(this._imageSmoothingEnabled=e,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(e){e.mozImageSmoothingEnabled=this._imageSmoothingEnabled,e.webkitImageSmoothingEnabled=this._imageSmoothingEnabled,e.msImageSmoothingEnabled=this._imageSmoothingEnabled,e.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(e){var t=this._getContext(e).canvas;return new d.Point(t.width,t.height)},getCanvasCenter:function(){return new d.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(e){var t=e.point?e.point.times(d.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(e.useSketch);n.save(),n.translate(t.x,t.y),this.viewer.viewport.flipped?(n.rotate(Math.PI/180*-e.degrees),n.scale(-1,1)):n.rotate(Math.PI/180*e.degrees),n.translate(-t.x,-t.y)},_flip:function(e){var t=(e=e||{}).point?e.point.times(d.pixelDensityRatio):this.getCanvasCenter(),n=this._getContext(e.useSketch);n.translate(t.x,0),n.scale(-1,1),n.translate(-t.x,0)},_restoreRotationChanges:function(e){this._getContext(e).restore()},_calculateCanvasSize:function(){var e=d.pixelDensityRatio,t=this.viewport.getContainerSize();return{x:Math.round(t.x*e),y:Math.round(t.y*e)}},_calculateSketchCanvasSize:function(){var e=this._calculateCanvasSize();if(0===this.viewport.getRotation())return e;var t=Math.ceil(Math.sqrt(e.x*e.x+e.y*e.y));return{x:t,y:t}}}}(OpenSeadragon),function(f){f.Viewport=function(e){var t=arguments;t.length&&t[0]instanceof f.Point&&(e={containerSize:t[0],contentSize:t[1],config:t[2]}),e.config&&(f.extend(!0,e,e.config),delete e.config),this._margins=f.extend({left:0,top:0,right:0,bottom:0},e.margins||{}),delete e.margins,f.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:f.DEFAULT_SETTINGS.springStiffness,animationTime:f.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:f.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:f.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:f.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:f.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:f.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:f.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:f.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:f.DEFAULT_SETTINGS.maxZoomLevel,degrees:f.DEFAULT_SETTINGS.degrees,flipped:f.DEFAULT_SETTINGS.flipped,homeFillsViewer:f.DEFAULT_SETTINGS.homeFillsViewer},e),this._updateContainerInnerSize(),this.centerSpringX=new f.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new f.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new f.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new f.Rect(0,0,1,1),1),this.goHome(!0),this.update()},f.Viewport.prototype={resetContentSize:function(e){return f.console.assert(e,"[Viewport.resetContentSize] contentSize is required"),f.console.assert(e instanceof f.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),f.console.assert(0<e.x,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),f.console.assert(0<e.y,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new f.Rect(0,0,1,e.y/e.x),e.x),this},setHomeBounds:function(e,t){f.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(e,t)},_setContentBounds:function(e,t){f.console.assert(e,"[Viewport._setContentBounds] bounds is required"),f.console.assert(e instanceof f.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),f.console.assert(0<e.width,"[Viewport._setContentBounds] bounds.width must be greater than 0"),f.console.assert(0<e.height,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=e.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(t),this._contentBounds=e.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(t),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:t,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var e=this._contentAspectRatio/this.getAspectRatio();return(this.homeFillsViewer?1<=e?e:1:1<=e?1:e)/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var e=this._contentBounds.getCenter(),t=1/this.getHomeZoom(),n=t/this.getAspectRatio();return new f.Rect(e.x-t/2,e.y-n/2,t,n)},goHome:function(e){return this.viewer&&this.viewer.raiseEvent("home",{immediately:e}),this.fitBounds(this.getHomeBounds(),e)},getMinZoom:function(){var e=this.getHomeZoom();return this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*e},getMaxZoom:function(){var e=this.maxZoomLevel;return e||(e=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,e/=this._contentBounds.width),Math.max(e,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new f.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return f.extend({},this._margins)},setMargins:function(e){f.console.assert("object"===f.type(e),"[Viewport.setMargins] margins must be an object"),this._margins=f.extend({left:0,top:0,right:0,bottom:0},e),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(-this.getRotation())},getBoundsNoRotate:function(e){var t=this.getCenter(e),n=1/this.getZoom(e),i=n/this.getAspectRatio();return new f.Rect(t.x-n/2,t.y-i/2,n,i)},getBoundsWithMargins:function(e){return this.getBoundsNoRotateWithMargins(e).rotate(-this.getRotation(),this.getCenter(e))},getBoundsNoRotateWithMargins:function(e){var t=this.getBoundsNoRotate(e),n=this._containerInnerSize.x*this.getZoom(e);return t.x-=this._margins.left/n,t.y-=this._margins.top/n,t.width+=(this._margins.left+this._margins.right)/n,t.height+=(this._margins.top+this._margins.bottom)/n,t},getCenter:function(e){var t,n,i,o,r,s,a=new f.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),l=new f.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return e?a:this.zoomPoint?(t=this.pixelFromPoint(this.zoomPoint,!0),o=(i=1/(n=this.getZoom()))/this.getAspectRatio(),r=new f.Rect(a.x-i/2,a.y-o/2,i,o),s=this._pixelFromPoint(this.zoomPoint,r).minus(t).divide(this._containerInnerSize.x*n),l.plus(s)):l},getZoom:function(e){return e?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(e){return Math.max(Math.min(e,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(e){var t=new f.Rect(e.x,e.y,e.width,e.height);if(this.wrapHorizontal);else{var n=this.visibilityRatio*t.width,i=t.x+t.width,o=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,r=this._contentBoundsNoRotate.x-i+n,s=o-t.x-n;n>this._contentBoundsNoRotate.width?t.x+=(r+s)/2:s<0?t.x+=s:0<r&&(t.x+=r)}if(this.wrapVertical);else{var a=this.visibilityRatio*t.height,l=t.y+t.height,c=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,u=this._contentBoundsNoRotate.y-l+a,d=c-t.y-a;a>this._contentBoundsNoRotate.height?t.y+=(u+d)/2:d<0?t.y+=d:0<u&&(t.y+=u)}return t},_raiseConstraintsEvent:function(e){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:e})},applyConstraints:function(e){var t=this.getZoom(),n=this._applyZoomConstraints(t);t!==n&&this.zoomTo(n,this.zoomPoint,e);var i=this.getBoundsNoRotate(),o=this._applyBoundaryConstraints(i);return this._raiseConstraintsEvent(e),i.x===o.x&&i.y===o.y&&!e||this.fitBounds(o.rotate(-this.getRotation()),e),this},ensureVisible:function(e){return this.applyConstraints(e)},_fitBounds:function(e,t){var n=(t=t||{}).immediately||!1,i=t.constraints||!1,o=this.getAspectRatio(),r=e.getCenter(),s=new f.Rect(e.x,e.y,e.width,e.height,e.degrees+this.getRotation()).getBoundingBox();s.getAspectRatio()>=o?s.height=s.width/o:s.width=s.height*o,s.x=r.x-s.width/2,s.y=r.y-s.height/2;var a=1/s.width;if(i){var l=s.getAspectRatio(),c=this._applyZoomConstraints(a);a!==c&&(a=c,s.width=1/a,s.x=r.x-s.width/2,s.height=s.width/l,s.y=r.y-s.height/2),r=(s=this._applyBoundaryConstraints(s)).getCenter(),this._raiseConstraintsEvent(n)}if(n)return this.panTo(r,!0),this.zoomTo(a,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var u=this.getBounds(),d=this.getZoom();if(0===d||Math.abs(a/d-1)<1e-8)return this.zoomTo(a,!0),this.panTo(r,n);var h=(s=s.rotate(-this.getRotation())).getTopLeft().times(a).minus(u.getTopLeft().times(d)).divide(a-d);return this.zoomTo(a,h,n)},fitBounds:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!1})},fitBoundsWithConstraints:function(e,t){return this._fitBounds(e,{immediately:t,constraints:!0})},fitVertically:function(e){var t=new f.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(t,e)},fitHorizontally:function(e){var t=new f.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(t,e)},getConstrainedBounds:function(e){var t;return t=this.getBounds(e),this._applyBoundaryConstraints(t)},panBy:function(e,t){var n=new f.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(n.plus(e),t)},panTo:function(e,t){return t?(this.centerSpringX.resetTo(e.x),this.centerSpringY.resetTo(e.y)):(this.centerSpringX.springTo(e.x),this.centerSpringY.springTo(e.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:e,immediately:t}),this},zoomBy:function(e,t,n){return this.zoomTo(this.zoomSpring.target.value*e,t,n)},zoomTo:function(e,t,n){var i=this;return this.zoomPoint=t instanceof f.Point&&!isNaN(t.x)&&!isNaN(t.y)?t:null,n?this._adjustCenterSpringsForZoomPoint(function(){i.zoomSpring.resetTo(e)}):this.zoomSpring.springTo(e),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:e,refPoint:t,immediately:n}),this},setRotation:function(e){return this.viewer&&this.viewer.drawer.canRotate()&&(this.degrees=f.positiveModulo(e,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:e})),this},getRotation:function(){return this.degrees},resize:function(e,t){var n,i=this.getBoundsNoRotate(),o=i;return this.containerSize.x=e.x,this.containerSize.y=e.y,this._updateContainerInnerSize(),t&&(n=e.x/this.containerSize.x,o.width=i.width*n,o.height=o.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:e,maintain:t}),this.fitBounds(o,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new f.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var e=this;this._adjustCenterSpringsForZoomPoint(function(){e.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var t=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,t},_adjustCenterSpringsForZoomPoint:function(e){if(this.zoomPoint){var t=this.pixelFromPoint(this.zoomPoint,!0);e();var n=this.pixelFromPoint(this.zoomPoint,!0).minus(t),i=this.deltaPointsFromPixels(n,!0);this.centerSpringX.shiftBy(i.x),this.centerSpringY.shiftBy(i.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else e()},deltaPixelsFromPointsNoRotate:function(e,t){return e.times(this._containerInnerSize.x*this.getZoom(t))},deltaPixelsFromPoints:function(e,t){return this.deltaPixelsFromPointsNoRotate(e.rotate(this.getRotation()),t)},deltaPointsFromPixelsNoRotate:function(e,t){return e.divide(this._containerInnerSize.x*this.getZoom(t))},deltaPointsFromPixels:function(e,t){return this.deltaPointsFromPixelsNoRotate(e,t).rotate(-this.getRotation())},pixelFromPointNoRotate:function(e,t){return this._pixelFromPointNoRotate(e,this.getBoundsNoRotate(t))},pixelFromPoint:function(e,t){return this._pixelFromPoint(e,this.getBoundsNoRotate(t))},_pixelFromPointNoRotate:function(e,t){return e.minus(t.getTopLeft()).times(this._containerInnerSize.x/t.width).plus(new f.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(e,t){return this._pixelFromPointNoRotate(e.rotate(this.getRotation(),this.getCenter(!0)),t)},pointFromPixelNoRotate:function(e,t){var n=this.getBoundsNoRotate(t);return e.minus(new f.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/n.width).plus(n.getTopLeft())},pointFromPixel:function(e,t){return this.pointFromPixelNoRotate(e,t).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(e,t){var n=this._contentBoundsNoRotate.width;return new f.Point(e*this._contentSizeNoRotate.x/n,t*this._contentSizeNoRotate.x/n)},viewportToImageCoordinates:function(e,t){if(e instanceof f.Point)return this.viewportToImageCoordinates(e.x,e.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(1<n)f.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(1===n){return this.viewer.world.getItemAt(0).viewportToImageCoordinates(e,t,!0)}}return this._viewportToImageDelta(e-this._contentBoundsNoRotate.x,t-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(e,t){var n=this._contentBoundsNoRotate.width;return new f.Point(e/this._contentSizeNoRotate.x*n,t/this._contentSizeNoRotate.x*n)},imageToViewportCoordinates:function(e,t){if(e instanceof f.Point)return this.imageToViewportCoordinates(e.x,e.y);if(this.viewer){var n=this.viewer.world.getItemCount();if(1<n)f.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(1===n){return this.viewer.world.getItemAt(0).imageToViewportCoordinates(e,t,!0)}}var i=this._imageToViewportDelta(e,t);return i.x+=this._contentBoundsNoRotate.x,i.y+=this._contentBoundsNoRotate.y,i},imageToViewportRectangle:function(e,t,n,i){var o=e;if(o instanceof f.Rect||(o=new f.Rect(e,t,n,i)),this.viewer){var r=this.viewer.world.getItemCount();if(1<r)f.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(1===r){return this.viewer.world.getItemAt(0).imageToViewportRectangle(e,t,n,i,!0)}}var s=this.imageToViewportCoordinates(o.x,o.y),a=this._imageToViewportDelta(o.width,o.height);return new f.Rect(s.x,s.y,a.x,a.y,o.degrees)},viewportToImageRectangle:function(e,t,n,i){var o=e;if(o instanceof f.Rect||(o=new f.Rect(e,t,n,i)),this.viewer){var r=this.viewer.world.getItemCount();if(1<r)f.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(1===r){return this.viewer.world.getItemAt(0).viewportToImageRectangle(e,t,n,i,!0)}}var s=this.viewportToImageCoordinates(o.x,o.y),a=this._viewportToImageDelta(o.width,o.height);return new f.Rect(s.x,s.y,a.x,a.y,o.degrees)},viewerElementToImageCoordinates:function(e){var t=this.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){f.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var t=e.minus(f.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){return f.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer."),this.imageToViewerElementCoordinates(e).plus(f.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(e){return this.pointFromPixel(e,!0)},viewportToViewerElementCoordinates:function(e){return this.pixelFromPoint(e,!0)},viewerElementToViewportRectangle:function(e){return f.Rect.fromSummits(this.pointFromPixel(e.getTopLeft(),!0),this.pointFromPixel(e.getTopRight(),!0),this.pointFromPixel(e.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(e){return f.Rect.fromSummits(this.pixelFromPoint(e.getTopLeft(),!0),this.pixelFromPoint(e.getTopRight(),!0),this.pixelFromPoint(e.getBottomLeft(),!0))},windowToViewportCoordinates:function(e){f.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var t=e.minus(f.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(t)},viewportToWindowCoordinates:function(e){return f.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer."),this.viewportToViewerElementCoordinates(e).plus(f.getElementPosition(this.viewer.element))},viewportToImageZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)f.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(1===t){return this.viewer.world.getItemAt(0).viewportToImageZoom(e)}}var n=this._contentSizeNoRotate.x;return e*(this._containerInnerSize.x/n*this._contentBoundsNoRotate.width)},imageToViewportZoom:function(e){if(this.viewer){var t=this.viewer.world.getItemCount();if(1<t)f.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(1===t){return this.viewer.world.getItemAt(0).imageToViewportZoom(e)}}return e*(this._contentSizeNoRotate.x/this._containerInnerSize.x/this._contentBoundsNoRotate.width)},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(e){return this.flipped===e||(this.flipped=e,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:e})),this}}}(OpenSeadragon),function(y){function g(e,t,n,i,o,r,s,a,l){var c=s.getBoundingBox().getTopLeft(),u=s.getBoundingBox().getBottomRight();e.viewer&&e.viewer.raiseEvent("update-level",{tiledImage:e,havedrawn:t,level:i,opacity:o,visibility:r,drawArea:s,topleft:c,bottomright:u,currenttime:a,best:l}),x(e.coverage,i),x(e.loadingCoverage,i);for(var d=e._getCornerTiles(i,c,u),h=d.topLeft,f=d.bottomRight,p=e.source.getNumTiles(i),g=e.viewport.pixelFromPoint(e.viewport.getCenter()),m=h.x;m<=f.x;m++)for(var v=h.y;v<=f.y;v++){if(!e.wrapHorizontal&&!e.wrapVertical){var b=e.source.getTileBounds(i,m,v);if(null===s.intersection(b))continue}l=w(e,n,t,m,v,i,o,r,g,p,a,l)}return l}function w(e,t,n,i,o,r,s,a,l,c,u,d){var h=function(e,t,n,i,o,r,s,a,l,c){var u,d,h,f,p,g,m,v,b;r[n]||(r[n]={});r[n][e]||(r[n][e]={});r[n][e][t]||(u=(a.x+e%a.x)%a.x,d=(a.y+t%a.y)%a.y,h=o.getTileBounds(n,u,d),f=o.getTileBounds(n,u,d,!0),p=o.tileExists(n,u,d),g=o.getTileUrl(n,u,d),i.loadTilesWithAjax?(m=o.getTileAjaxHeaders(n,u,d),y.isPlainObject(i.ajaxHeaders)&&(m=y.extend({},i.ajaxHeaders,m))):m=null,v=o.getContext2D?o.getContext2D(n,u,d):void 0,h.x+=(e-u)/a.x,h.y+=c/l*((t-d)/a.y),b=new y.Tile(n,e,t,h,p,g,v,i.loadTilesWithAjax,m,f),u==a.x-1&&(b.isRightMost=!0),d==a.y-1&&(b.isBottomMost=!0),r[n][e][t]=b);return(b=r[n][e][t]).lastTouchTime=s,b}(i,o,r,e,e.source,e.tilesMatrix,u,c,e._worldWidthCurrent,e._worldHeightCurrent),f=n;e.viewer&&e.viewer.raiseEvent("update-tile",{tiledImage:e,tile:h}),T(e.coverage,r,i,o,!1);var p=h.loaded||h.loading||b(e.loadingCoverage,r,i,o);if(T(e.loadingCoverage,r,i,o,p),!h.exists)return d;if(t&&!f&&(b(e.coverage,r,i,o)?T(e.coverage,r,i,o,!0):f=!0),!f)return d;if(function(e,t,n,i,o,r){var s=e.bounds.getTopLeft();s.x*=r._scaleSpring.current.value,s.y*=r._scaleSpring.current.value,s.x+=r._xSpring.current.value,s.y+=r._ySpring.current.value;var a=e.bounds.getSize();a.x*=r._scaleSpring.current.value,a.y*=r._scaleSpring.current.value;var l=n.pixelFromPointNoRotate(s,!0),c=n.pixelFromPointNoRotate(s,!1),u=n.deltaPixelsFromPointsNoRotate(a,!0),d=n.deltaPixelsFromPointsNoRotate(a,!1),h=c.plus(d.divide(2)),f=i.squaredDistanceTo(h);t||(u=u.plus(new y.Point(1,1)));e.isRightMost&&r.wrapHorizontal&&(u.x+=.75);e.isBottomMost&&r.wrapVertical&&(u.y+=.75);e.position=l,e.size=u,e.squaredDistance=f,e.visibility=o}(h,e.source.tileOverlap,e.viewport,l,a,e),!h.loaded)if(h.context2D)m(e,h);else{var g=e._tileCache.getImageRecord(h.cacheKey);if(g)m(e,h,g.getImage())}h.loaded?function(e,t,n,i,o,r,s){var a,l,c=1e3*e.blendTime;t.blendStart||(t.blendStart=s);a=s-t.blendStart,l=c?Math.min(1,a/c):1,e.alwaysBlend&&(l*=r);if(t.opacity=l,e.lastDrawn.push(t),1===l)T(e.coverage,o,n,i,!0),e._hasOpaqueTile=!0;else if(a<c)return!0;return!1}(e,h,i,o,r,s,u)&&(e._needsDraw=!0):h.loading?e._tilesLoading++:p||(d=function(e,t){if(!e)return t;{if(t.visibility>e.visibility)return t;if(t.visibility==e.visibility&&t.squaredDistance<e.squaredDistance)return t}return e}(d,h));return d}function m(e,t,n,i,o){var r=0;function s(){return r++,a}function a(){0===--r&&(t.loading=!1,t.loaded=!0,t.context2D||e._tileCache.cacheTile({image:n,tile:t,cutoff:i,tiledImage:e}),e._needsDraw=!0)}e.viewer.raiseEvent("tile-loaded",{tile:t,tiledImage:e,tileRequest:o,image:n,getCompletionCallback:s}),s()()}function v(e,t,n,i){var o,r,s,a;if(!e[t])return!1;if(void 0!==n&&void 0!==i)return void 0===e[t][n]||void 0===e[t][n][i]||!0===e[t][n][i];for(s in o=e[t])if(o.hasOwnProperty(s))for(a in r=o[s])if(r.hasOwnProperty(a)&&!r[a])return!1;return!0}function b(e,t,n,i){return void 0===n||void 0===i?v(e,t+1):v(e,t+1,2*n,2*i)&&v(e,t+1,2*n,2*i+1)&&v(e,t+1,2*n+1,2*i)&&v(e,t+1,2*n+1,2*i+1)}function T(e,t,n,i,o){e[t]?(e[t][n]||(e[t][n]={}),e[t][n][i]=o):y.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",t)}function x(e,t){e[t]={}}y.TiledImage=function(e){var t=this;y.console.assert(e.tileCache,"[TiledImage] options.tileCache is required"),y.console.assert(e.drawer,"[TiledImage] options.drawer is required"),y.console.assert(e.viewer,"[TiledImage] options.viewer is required"),y.console.assert(e.imageLoader,"[TiledImage] options.imageLoader is required"),y.console.assert(e.source,"[TiledImage] options.source is required"),y.console.assert(!e.clip||e.clip instanceof y.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),y.EventSource.call(this),this._tileCache=e.tileCache,delete e.tileCache,this._drawer=e.drawer,delete e.drawer,this._imageLoader=e.imageLoader,delete e.imageLoader,e.clip instanceof y.Rect&&(this._clip=e.clip.clone()),delete e.clip;var n=e.x||0;delete e.x;var i=e.y||0;delete e.y,this.normHeight=e.source.dimensions.y/e.source.dimensions.x,this.contentAspectX=e.source.dimensions.x/e.source.dimensions.y;var o=1;e.width?(o=e.width,delete e.width,e.height&&(y.console.error("specifying both width and height to a tiledImage is not supported"),delete e.height)):e.height&&(o=e.height/this.normHeight,delete e.height);var r=e.fitBounds;delete e.fitBounds;var s=e.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete e.fitBoundsPlacement;var a=e.degrees||0;delete e.degrees,y.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:y.DEFAULT_SETTINGS.springStiffness,animationTime:y.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:y.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:y.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:y.DEFAULT_SETTINGS.wrapVertical,immediateRender:y.DEFAULT_SETTINGS.immediateRender,blendTime:y.DEFAULT_SETTINGS.blendTime,alwaysBlend:y.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:y.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:y.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:y.DEFAULT_SETTINGS.iOSDevice,debugMode:y.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:y.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:y.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:y.DEFAULT_SETTINGS.placeholderFillStyle,opacity:y.DEFAULT_SETTINGS.opacity,preload:y.DEFAULT_SETTINGS.preload,compositeOperation:y.DEFAULT_SETTINGS.compositeOperation},e),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new y.Spring({initial:n,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new y.Spring({initial:i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new y.Spring({initial:o,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new y.Spring({initial:a,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),r&&this.fitBounds(r,s,!0),this._drawingHandler=function(e){t.viewer.raiseEvent("tile-drawing",y.extend({tiledImage:t},e))}},y.extend(y.TiledImage.prototype,y.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(e){e!==this._fullyLoaded&&(this._fullyLoaded=e,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=y.now(),this._needsDraw=!0},update:function(){var e=this._xSpring.update(),t=this._ySpring.update(),n=this._scaleSpring.update(),i=this._degreesSpring.update();return!!(e||t||n||i)&&(this._updateForScale(),this._needsDraw=!0)},draw:function(){0!==this.opacity||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(e){return this.getBoundsNoRotate(e).rotate(this.getRotation(e),this._getRotationPoint(e))},getBoundsNoRotate:function(e){return e?new y.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new y.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return y.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(e){var t=this.getBoundsNoRotate(e);if(this._clip){var n=(e?this._worldWidthCurrent:this._worldWidthTarget)/this.source.dimensions.x,i=this._clip.times(n);t=new y.Rect(t.x+i.x,t.y+i.y,i.width,i.height)}return t.rotate(this.getRotation(e),this._getRotationPoint(e))},getContentSize:function(){return new y.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(e,t,n){var i=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new y.Point(e*(this.source.dimensions.x/i),t*(this.source.dimensions.y*this.contentAspectX/i))},viewportToImageCoordinates:function(e,t,n){var i;return i=(i=e instanceof y.Point?(n=t,e):new y.Point(e,t)).rotate(-this.getRotation(n),this._getRotationPoint(n)),n?this._viewportToImageDelta(i.x-this._xSpring.current.value,i.y-this._ySpring.current.value):this._viewportToImageDelta(i.x-this._xSpring.target.value,i.y-this._ySpring.target.value)},_imageToViewportDelta:function(e,t,n){var i=n?this._scaleSpring.current.value:this._scaleSpring.target.value;return new y.Point(e/this.source.dimensions.x*i,t/this.source.dimensions.y/this.contentAspectX*i)},imageToViewportCoordinates:function(e,t,n){e instanceof y.Point&&(n=t,t=e.y,e=e.x);var i=this._imageToViewportDelta(e,t);return n?(i.x+=this._xSpring.current.value,i.y+=this._ySpring.current.value):(i.x+=this._xSpring.target.value,i.y+=this._ySpring.target.value),i.rotate(this.getRotation(n),this._getRotationPoint(n))},imageToViewportRectangle:function(e,t,n,i,o){var r=e;r instanceof y.Rect?o=t:r=new y.Rect(e,t,n,i);var s=this.imageToViewportCoordinates(r.getTopLeft(),o),a=this._imageToViewportDelta(r.width,r.height,o);return new y.Rect(s.x,s.y,a.x,a.y,r.degrees+this.getRotation(o))},viewportToImageRectangle:function(e,t,n,i,o){var r=e;e instanceof y.Rect?o=t:r=new y.Rect(e,t,n,i);var s=this.viewportToImageCoordinates(r.getTopLeft(),o),a=this._viewportToImageDelta(r.width,r.height,o);return new y.Rect(s.x,s.y,a.x,a.y,r.degrees-this.getRotation(o))},viewerElementToImageCoordinates:function(e){var t=this.viewport.pointFromPixel(e,!0);return this.viewportToImageCoordinates(t)},imageToViewerElementCoordinates:function(e){var t=this.imageToViewportCoordinates(e);return this.viewport.pixelFromPoint(t,!0)},windowToImageCoordinates:function(e){var t=e.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(t)},imageToWindowCoordinates:function(e){return this.imageToViewerElementCoordinates(e).plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(e){var t=this._scaleSpring.current.value;return e=e.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new y.Rect((e.x-this._xSpring.current.value)/t,(e.y-this._ySpring.current.value)/t,e.width/t,e.height/t,e.degrees)},viewportToImageZoom:function(e){return this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x*e},imageToViewportZoom:function(e){return e/(this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x)},setPosition:function(e,t){var n=this._xSpring.target.value===e.x&&this._ySpring.target.value===e.y;if(t){if(n&&this._xSpring.current.value===e.x&&this._ySpring.current.value===e.y)return;this._xSpring.resetTo(e.x),this._ySpring.resetTo(e.y),this._needsDraw=!0}else{if(n)return;this._xSpring.springTo(e.x),this._ySpring.springTo(e.y),this._needsDraw=!0}n||this._raiseBoundsChange()},setWidth:function(e,t){this._setScale(e,t)},setHeight:function(e,t){this._setScale(e/this.normHeight,t)},fitBounds:function(e,t,n){t=t||y.Placement.CENTER;var i=y.Placement.properties[t],o=this.contentAspectX,r=0,s=0,a=1,l=1;if(this._clip&&(o=this._clip.getAspectRatio(),a=this._clip.width/this.source.dimensions.x,l=this._clip.height/this.source.dimensions.y,s=e.getAspectRatio()>o?(r=this._clip.x/this._clip.height*e.height,this._clip.y/this._clip.height*e.height):(r=this._clip.x/this._clip.width*e.width,this._clip.y/this._clip.width*e.width)),e.getAspectRatio()>o){var c=e.height/l,u=0;i.isHorizontallyCentered?u=(e.width-e.height*o)/2:i.isRight&&(u=e.width-e.height*o),this.setPosition(new y.Point(e.x-r+u,e.y-s),n),this.setHeight(c,n)}else{var d=e.width/a,h=0;i.isVerticallyCentered?h=(e.height-e.width/o)/2:i.isBottom&&(h=e.height-e.width/o),this.setPosition(new y.Point(e.x-r,e.y-s+h),n),this.setWidth(d,n)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(e){y.console.assert(!e||e instanceof y.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),e instanceof y.Rect?this._clip=e.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(e){e!==this.opacity&&(this.opacity=e,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(e){this._preload=!!e,this._needsDraw=!0},getRotation:function(e){return e?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(e,t){this._degreesSpring.target.value===e&&this._degreesSpring.isAtTargetValue()||(t?this._degreesSpring.resetTo(e):this._degreesSpring.springTo(e),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(e){return this.getBoundsNoRotate(e).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(e){e!==this.compositeOperation&&(this.compositeOperation=e,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(e,t){var n=this._scaleSpring.target.value===e;if(t){if(n&&this._scaleSpring.current.value===e)return;this._scaleSpring.resetTo(e),this._updateForScale(),this._needsDraw=!0}else{if(n)return;this._scaleSpring.springTo(e),this._updateForScale(),this._needsDraw=!0}n||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var e=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),t=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,n=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(t/this.minPixelRatio)/Math.log(2))));return n=Math.max(n,this.source.minLevel||0),{lowestLevel:e=Math.min(e,n),highestLevel:n}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};0<this.lastDrawn.length;){this.lastDrawn.pop().beingDrawn=!1}var e=this.viewport,t=this._viewportToTiledImageRectangle(e.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var n=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(null===(t=t.intersection(n)))return}for(var i=this._getLevelsInterval(),o=i.lowestLevel,r=i.highestLevel,s=null,a=!1,l=y.now(),c=r;o<=c;c--){var u=!1,d=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(c),!0).x*this._scaleSpring.current.value;if(c===o||!a&&d>=this.minPixelRatio)a=u=!0;else if(!a)continue;var h=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(c),!1).x*this._scaleSpring.current.value,f=e.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,p=this.immediateRender?1:f;if(s=g(this,a,u,c,Math.min(1,(d-.5)/.5),p/Math.abs(p-h),t,l,s),v(this.coverage,c))break}!function(e,t){if(0===e.opacity||0===t.length&&!e.placeholderFillStyle)return;var n,i,o,r=t[0];r&&(n=e.opacity<1||e.compositeOperation&&"source-over"!==e.compositeOperation||!e._isBottomItem()&&r._hasTransparencyChannel());var s,a=e.viewport.getZoom(!0),l=e.viewportToImageZoom(a);1<t.length&&l>e.smoothTileEdgesMinZoom&&!e.iOSDevice&&e.getRotation(!0)%360==0&&y.supportsCanvas&&(n=!0,i=r.getScaleForEdgeSmoothing(),o=r.getTranslationForEdgeSmoothing(i,e._drawer.getCanvasSize(!1),e._drawer.getCanvasSize(!0)));n&&(i||(s=e.viewport.viewportToViewerElementRectangle(e.getClippedBounds(!0)).getIntegerBoundingBox().times(y.pixelDensityRatio),e._drawer.viewer.viewport.getFlip()&&(0===e.viewport.degrees&&e.getRotation(!0)%360==0||(s.x=e._drawer.viewer.container.clientWidth-(s.x+s.width)))),e._drawer._clear(!0,s));i||(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:n}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:n}),0===e.viewport.degrees&&e.getRotation(!0)%360==0&&e._drawer.viewer.viewport.getFlip()&&e._drawer._flip());var c=!1;if(e._clip){e._drawer.saveContext(n);var u=e.imageToViewportRectangle(e._clip,!0);u=u.rotate(-e.getRotation(!0),e._getRotationPoint(!0));var d=e._drawer.viewportToDrawerRectangle(u);i&&(d=d.times(i)),o&&(d=d.translate(o)),e._drawer.setClip(d,n),c=!0}if(e.placeholderFillStyle&&!1===e._hasOpaqueTile){var h=e._drawer.viewportToDrawerRectangle(e.getBounds(!0));i&&(h=h.times(i)),o&&(h=h.translate(o));var f=null;f="function"==typeof e.placeholderFillStyle?e.placeholderFillStyle(e,e._drawer.context):e.placeholderFillStyle,e._drawer.drawRectangle(h,f,n)}for(var p=t.length-1;0<=p;p--)r=t[p],e._drawer.drawTile(r,e._drawingHandler,n,i,o),r.beingDrawn=!0,e.viewer&&e.viewer.raiseEvent("tile-drawn",{tiledImage:e,tile:r});c&&e._drawer.restoreContext(n);i||(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(n),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(n));n&&(i&&(0!==e.viewport.degrees&&e._drawer._offsetForRotation({degrees:e.viewport.degrees,useSketch:!1}),e.getRotation(!0)%360!=0&&e._drawer._offsetForRotation({degrees:e.getRotation(!0),point:e.viewport.pixelFromPointNoRotate(e._getRotationPoint(!0),!0),useSketch:!1})),e._drawer.blendSketch({opacity:e.opacity,scale:i,translate:o,compositeOperation:e.compositeOperation,bounds:s}),i&&(e.getRotation(!0)%360!=0&&e._drawer._restoreRotationChanges(!1),0!==e.viewport.degrees&&e._drawer._restoreRotationChanges(!1)));i||0===e.viewport.degrees&&e.getRotation(!0)%360==0&&e._drawer.viewer.viewport.getFlip()&&e._drawer._flip();!function(e,t){if(e.debugMode)for(var n=t.length-1;0<=n;n--){var i=t[n];try{e._drawer.drawDebugInfo(i,t.length,n,e)}catch(e){y.console.error(e)}}}(e,t)}(this,this.lastDrawn),s&&!s.context2D?(function(i,o,r){o.loading=!0,i._imageLoader.addJob({src:o.url,loadWithAjax:o.loadWithAjax,ajaxHeaders:o.ajaxHeaders,crossOriginPolicy:i.crossOriginPolicy,ajaxWithCredentials:i.ajaxWithCredentials,callback:function(e,t,n){!function(t,n,e,i,o,r){if(!i)return y.console.log("Tile %s failed to load: %s - error: %s",n,n.url,o),t.viewer.raiseEvent("tile-load-failed",{tile:n,tiledImage:t,time:e,message:o,tileRequest:r}),n.loading=!1,n.exists=!1;if(e<t.lastResetTime)return y.console.log("Ignoring tile %s loaded before reset: %s",n,n.url),n.loading=!1;function s(){var e=t.source.getClosestLevel();m(t,n,i,e,r)}t._midDraw?window.setTimeout(s,1):s()}(i,o,r,e,t,n)},abort:function(){o.loading=!1}})}(this,s,l),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(0===this._tilesLoading)},_getCornerTiles:function(e,t,n){var i,o,r,s;o=this.wrapHorizontal?(i=y.positiveModulo(t.x,1),y.positiveModulo(n.x,1)):(i=Math.max(0,t.x),Math.min(1,n.x));var a=1/this.source.aspectRatio;s=this.wrapVertical?(r=y.positiveModulo(t.y,a),y.positiveModulo(n.y,a)):(r=Math.max(0,t.y),Math.min(a,n.y));var l=this.source.getTileAtPoint(e,new y.Point(i,r)),c=this.source.getTileAtPoint(e,new y.Point(o,s)),u=this.source.getNumTiles(e);return this.wrapHorizontal&&(l.x+=u.x*Math.floor(t.x),c.x+=u.x*Math.floor(n.x)),this.wrapVertical&&(l.y+=u.y*Math.floor(t.y/a),c.y+=u.y*Math.floor(n.y/a)),{topLeft:l,bottomRight:c}}})}(OpenSeadragon),function(p){function g(e){p.console.assert(e,"[TileCache.cacheTile] options is required"),p.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),p.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=e.tile,this.tiledImage=e.tiledImage}function m(e){p.console.assert(e,"[ImageRecord] options is required"),p.console.assert(e.image,"[ImageRecord] options.image is required"),this._image=e.image,this._tiles=[]}m.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var e=document.createElement("canvas");e.width=this._image.width,e.height=this._image.height,this._renderedContext=e.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(e){p.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=e},addTile:function(e){p.console.assert(e,"[ImageRecord.addTile] tile is required"),this._tiles.push(e)},removeTile:function(e){for(var t=0;t<this._tiles.length;t++)if(this._tiles[t]===e)return void this._tiles.splice(t,1);p.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",e)},getTileCount:function(){return this._tiles.length}},p.TileCache=function(e){e=e||{},this._maxImageCacheCount=e.maxImageCacheCount||p.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},p.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(e){p.console.assert(e,"[TileCache.cacheTile] options is required"),p.console.assert(e.tile,"[TileCache.cacheTile] options.tile is required"),p.console.assert(e.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),p.console.assert(e.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var t=e.cutoff||0,n=this._tilesLoaded.length,i=this._imagesLoaded[e.tile.cacheKey];if(i||(p.console.assert(e.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),i=this._imagesLoaded[e.tile.cacheKey]=new m({image:e.image}),this._imagesLoadedCount++),i.addTile(e.tile),e.tile.cacheImageRecord=i,this._imagesLoadedCount>this._maxImageCacheCount){for(var o,r,s,a,l,c,u=null,d=-1,h=null,f=this._tilesLoaded.length-1;0<=f;f--)(o=(c=this._tilesLoaded[f]).tile).level<=t||o.beingDrawn||(u?(a=o.lastTouchTime,r=u.lastTouchTime,l=o.level,s=u.level,(a<r||a==r&&s<l)&&(u=o,d=f,h=c)):(u=o,d=f,h=c));u&&0<=d&&(this._unloadTile(h),n=d)}this._tilesLoaded[n]=new g({tile:e.tile,tiledImage:e.tiledImage})},clearTilesFor:function(e){var t;p.console.assert(e,"[TileCache.clearTilesFor] tiledImage is required");for(var n=0;n<this._tilesLoaded.length;++n)(t=this._tilesLoaded[n]).tiledImage===e&&(this._unloadTile(t),this._tilesLoaded.splice(n,1),n--)},getImageRecord:function(e){return p.console.assert(e,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[e]},_unloadTile:function(e){p.console.assert(e,"[TileCache._unloadTile] tileRecord is required");var t=e.tile,n=e.tiledImage;t.unload(),t.cacheImageRecord=null;var i=this._imagesLoaded[t.cacheKey];i.removeTile(t),i.getTileCount()||(i.destroy(),delete this._imagesLoaded[t.cacheKey],this._imagesLoadedCount--),n.viewer.raiseEvent("tile-unloaded",{tile:t,tiledImage:n})}}}(OpenSeadragon),function(m){m.World=function(e){var t=this;m.console.assert(e.viewer,"[World] options.viewer is required"),m.EventSource.call(this),this.viewer=e.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(e){t._autoRefigureSizes?t._figureSizes():t._needsSizesFigured=!0},this._figureSizes()},m.extend(m.World.prototype,m.EventSource.prototype,{addItem:function(e,t){if(m.console.assert(e,"[World.addItem] item is required"),m.console.assert(e instanceof m.TiledImage,"[World.addItem] only TiledImages supported at this time"),void 0!==(t=t||{}).index){var n=Math.max(0,Math.min(this._items.length,t.index));this._items.splice(n,0,e)}else this._items.push(e);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,e.addHandler("bounds-change",this._delegatedFigureSizes),e.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:e})},getItemAt:function(e){return m.console.assert(void 0!==e,"[World.getItemAt] index is required"),this._items[e]},getIndexOfItem:function(e){return m.console.assert(e,"[World.getIndexOfItem] item is required"),m.indexOf(this._items,e)},getItemCount:function(){return this._items.length},setItemIndex:function(e,t){m.console.assert(e,"[World.setItemIndex] item is required"),m.console.assert(void 0!==t,"[World.setItemIndex] index is required");var n=this.getIndexOfItem(e);if(t>=this._items.length)throw new Error("Index bigger than number of layers.");t!==n&&-1!==n&&(this._items.splice(n,1),this._items.splice(t,0,e),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:e,previousIndex:n,newIndex:t}))},removeItem:function(e){m.console.assert(e,"[World.removeItem] item is required");var t=m.indexOf(this._items,e);-1!==t&&(e.removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy(),this._items.splice(t,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(e))},removeAll:function(){var e,t;for(this.viewer._cancelPendingImages(),t=0;t<this._items.length;t++)(e=this._items[t]).removeHandler("bounds-change",this._delegatedFigureSizes),e.removeHandler("clip-change",this._delegatedFigureSizes),e.destroy();var n=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,t=0;t<n.length;t++)e=n[t],this._raiseRemoveItem(e)},resetItems:function(){for(var e=0;e<this._items.length;e++)this._items[e].reset()},update:function(){for(var e=!1,t=0;t<this._items.length;t++)e=this._items[t].update()||e;return e},draw:function(){for(var e=0;e<this._items.length;e++)this._items[e].draw();this._needsDraw=!1},needsDraw:function(){for(var e=0;e<this._items.length;e++)if(this._items[e].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(e){(this._autoRefigureSizes=e)&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(e){var t,n=(e=e||{}).immediately||!1,i=e.layout||m.DEFAULT_SETTINGS.collectionLayout,o=e.rows||m.DEFAULT_SETTINGS.collectionRows,r=e.columns||m.DEFAULT_SETTINGS.collectionColumns,s=e.tileSize||m.DEFAULT_SETTINGS.collectionTileSize,a=s+(e.tileMargin||m.DEFAULT_SETTINGS.collectionTileMargin);t=!e.rows&&r?r:Math.ceil(this._items.length/o);var l,c,u,d,h,f=0,p=0;this.setAutoRefigureSizes(!1);for(var g=0;g<this._items.length;g++)g&&g%t==0&&("horizontal"===i?(p+=a,f=0):(f+=a,p=0)),d=(u=(c=(l=this._items[g]).getBounds()).width>c.height?s:s*(c.width/c.height))*(c.height/c.width),h=new m.Point(f+(s-u)/2,p+(s-d)/2),l.setPosition(h,n),l.setWidth(u,n),"horizontal"===i?f+=a:p+=a;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var e=this._homeBounds?this._homeBounds.clone():null,t=this._contentSize?this._contentSize.clone():null,n=this._contentFactor||0;if(this._items.length){var i=this._items[0],o=i.getBounds();this._contentFactor=i.getContentSize().x/o.width;for(var r=i.getClippedBounds().getBoundingBox(),s=r.x,a=r.y,l=r.x+r.width,c=r.y+r.height,u=1;u<this._items.length;u++)o=(i=this._items[u]).getBounds(),this._contentFactor=Math.max(this._contentFactor,i.getContentSize().x/o.width),r=i.getClippedBounds().getBoundingBox(),s=Math.min(s,r.x),a=Math.min(a,r.y),l=Math.max(l,r.x+r.width),c=Math.max(c,r.y+r.height);this._homeBounds=new m.Rect(s,a,l-s,c-a),this._contentSize=new m.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}else this._homeBounds=new m.Rect(0,0,1,1),this._contentSize=new m.Point(1,1),this._contentFactor=1;this._contentFactor===n&&this._homeBounds.equals(e)&&this._contentSize.equals(t)||this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(e){this.raiseEvent("remove-item",{item:e})}})}(OpenSeadragon),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).httpStatusCodes=e()}}(function(){return function r(s,a,l){function c(n,e){if(!a[n]){if(!s[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[n]={exports:{}};s[n][0].call(o.exports,function(e){var t=s[n][1][e];return c(t||e)},o,o.exports,r,s,a,l)}return a[n].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,n){(function(e){var t,n,i;(n=t=t||{}).CONTINUE=100,n.SWITCHING_PROTOCOLS=101,n.PROCESSING=102,n.OK=200,n.CREATED=201,n.ACCEPTED=202,n.NON_AUTHORITATIVE_INFORMATION=203,n.NO_CONTENT=204,n.RESET_CONTENT=205,n.PARTIAL_CONTENT=206,n.MULTI_STATUS=207,n.MULTIPLE_CHOICES=300,n.MOVED_PERMANENTLY=301,n.MOVED_TEMPORARILY=302,n.SEE_OTHER=303,n.NOT_MODIFIED=304,n.USE_PROXY=305,n.TEMPORARY_REDIRECT=307,n.BAD_REQUEST=400,n.UNAUTHORIZED=401,n.PAYMENT_REQUIRED=402,n.FORBIDDEN=403,n.NOT_FOUND=404,n.METHOD_NOT_ALLOWED=405,n.NOT_ACCEPTABLE=406,n.PROXY_AUTHENTICATION_REQUIRED=407,n.REQUEST_TIME_OUT=408,n.CONFLICT=409,n.GONE=410,n.LENGTH_REQUIRED=411,n.PRECONDITION_FAILED=412,n.REQUEST_ENTITY_TOO_LARGE=413,n.REQUEST_URI_TOO_LARGE=414,n.UNSUPPORTED_MEDIA_TYPE=415,n.REQUESTED_RANGE_NOT_SATISFIABLE=416,n.EXPECTATION_FAILED=417,n.IM_A_TEAPOT=418,n.UNPROCESSABLE_ENTITY=422,n.LOCKED=423,n.FAILED_DEPENDENCY=424,n.UNORDERED_COLLECTION=425,n.UPGRADE_REQUIRED=426,n.PRECONDITION_REQUIRED=428,n.TOO_MANY_REQUESTS=429,n.REQUEST_HEADER_FIELDS_TOO_LARGE=431,n.INTERNAL_SERVER_ERROR=500,n.NOT_IMPLEMENTED=501,n.BAD_GATEWAY=502,n.SERVICE_UNAVAILABLE=503,n.GATEWAY_TIME_OUT=504,n.HTTP_VERSION_NOT_SUPPORTED=505,n.VARIANT_ALSO_NEGOTIATES=506,n.INSUFFICIENT_STORAGE=507,n.BANDWIDTH_LIMIT_EXCEEDED=509,n.NOT_EXTENDED=510,n.NETWORK_AUTHENTICATION_REQUIRED=511,(i=e).HTTPStatusCode||(i.HTTPStatusCode=t)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).manifesto=e()}}(function(){return function r(s,a,l){function c(t,e){if(!a[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(u)return u(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[t]={exports:{}};s[t][0].call(o.exports,function(e){return c(s[t][1][e]||e)},o,o.exports,r,s,a,l)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(on,rn,e){(function(e){var t,n,i,o;function r(e){this.value="",e&&(this.value=e.toLowerCase())}function s(e,t){this.start=e,this.end=t}t=Qt=Qt||{},r.prototype.toString=function(){return this.value},n=r,t.StringValue=n,i=Qt=Qt||{},s.prototype.getLength=function(){return this.end-this.start},o=s,i.Duration=o;var a,l,c,u,d=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function h(){return null!==c&&c.apply(this,arguments)||this}l=Qt=Qt||{},c=l.StringValue,d(h,c),h.prototype.bookmarking=function(){return new h(h.BOOKMARKING.toString())},h.prototype.classifying=function(){return new h(h.CLASSIFYING.toString())},h.prototype.commenting=function(){return new h(h.COMMENTING.toString())},h.prototype.describing=function(){return new h(h.DESCRIBING.toString())},h.prototype.editing=function(){return new h(h.EDITING.toString())},h.prototype.highlighting=function(){return new h(h.HIGHLIGHTING.toString())},h.prototype.identifying=function(){return new h(h.IDENTIFYING.toString())},h.prototype.linking=function(){return new h(h.LINKING.toString())},h.prototype.moderating=function(){return new h(h.MODERATING.toString())},h.prototype.painting=function(){return new h(h.PAINTING.toString())},h.prototype.questioning=function(){return new h(h.QUESTIONING.toString())},h.prototype.replying=function(){return new h(h.REPLYING.toString())},h.prototype.tagging=function(){return new h(h.TAGGING.toString())},h.prototype.transcribing=function(){return new h(h.TRANSCRIBING.toString())},h.BOOKMARKING=new h("oa:bookmarking"),h.CLASSIFYING=new h("oa:classifying"),h.COMMENTING=new h("oa:commenting"),h.DESCRIBING=new h("oa:describing"),h.EDITING=new h("oa:editing"),h.HIGHLIGHTING=new h("oa:highlighting"),h.IDENTIFYING=new h("oa:identifying"),h.LINKING=new h("oa:linking"),h.MODERATING=new h("oa:moderating"),h.PAINTING=new h("sc:painting"),h.QUESTIONING=new h("oa:questioning"),h.REPLYING=new h("oa:replying"),h.TAGGING=new h("oa:tagging"),h.TRANSCRIBING=new h("oad:transcribing"),u=h,l.AnnotationMotivation=u;var f,p,g,m;d=this&&this.__extends||(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function v(){return null!==g&&g.apply(this,arguments)||this}p=Qt=Qt||{},g=p.StringValue,d(v,g),v.prototype.autoadvance=function(){return new v(v.AUTOADVANCE.toString())},v.prototype.nonav=function(){return new v(v.NONAV.toString())},v.prototype.paged=function(){return new v(v.PAGED.toString())},v.AUTOADVANCE=new v("auto-advance"),v.NONAV=new v("no-nav"),v.PAGED=new v("paged"),m=v,p.Behavior=m;var b,y,w,T;d=this&&this.__extends||(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function x(){return null!==w&&w.apply(this,arguments)||this}y=Qt=Qt||{},w=y.StringValue,d(x,w),x.prototype.annotation=function(){return new x(x.ANNOTATION.toString())},x.prototype.canvas=function(){return new x(x.CANVAS.toString())},x.prototype.collection=function(){return new x(x.COLLECTION.toString())},x.prototype.manifest=function(){return new x(x.MANIFEST.toString())},x.prototype.range=function(){return new x(x.RANGE.toString())},x.prototype.sequence=function(){return new x(x.SEQUENCE.toString())},x.ANNOTATION=new x("annotation"),x.CANVAS=new x("canvas"),x.COLLECTION=new x("collection"),x.MANIFEST=new x("manifest"),x.RANGE=new x("range"),x.SEQUENCE=new x("sequence"),T=x,y.IIIFResourceType=T;var S,C,E,P;d=this&&this.__extends||(S=function(e,t){return(S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}S(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function R(){return null!==E&&E.apply(this,arguments)||this}C=Qt=Qt||{},E=C.StringValue,d(R,E),R.prototype.empty=function(){return new R(R.EMPTY.toString())},R.prototype.manuscript=function(){return new R(R.MANUSCRIPT.toString())},R.prototype.monograph=function(){return new R(R.MONOGRAPH.toString())},R.EMPTY=new R(""),R.MANUSCRIPT=new R("manuscript"),R.MONOGRAPH=new R("monograph"),P=R,C.ManifestType=P;var I,_,A,O;d=this&&this.__extends||(I=function(e,t){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}I(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function k(){return null!==A&&A.apply(this,arguments)||this}_=Qt=Qt||{},A=_.StringValue,d(k,A),k.prototype.pdf=function(){return new k(k.PDF.toString())},k.prototype.doc=function(){return new k(k.DOC.toString())},k.prototype.docx=function(){return new k(k.DOCX.toString())},k.PDF=new k("application/pdf"),k.DOC=new k("application/msword"),k.DOCX=new k("application/vnd.openxmlformats-officedocument.wordprocessingml.document"),O=k,_.RenderingFormat=O;var D,M,F,L;d=this&&this.__extends||(D=function(e,t){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}D(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function N(){return null!==F&&F.apply(this,arguments)||this}M=Qt=Qt||{},F=M.StringValue,d(N,F),N.prototype.jpg=function(){return new N(N.JPG.toString())},N.prototype.mp4=function(){return new N(N.MP4.toString())},N.prototype.pdf=function(){return new N(N.PDF.toString())},N.prototype.threejs=function(){return new N(N.THREEJS.toString())},N.prototype.webm=function(){return new N(N.WEBM.toString())},N.JPG=new N("image/jpeg"),N.MP4=new N("video/mp4"),N.PDF=new N("application/pdf"),N.THREEJS=new N("application/vnd.threejs+json"),N.WEBM=new N("video/webm"),L=N,M.MediaType=L;var H,B,z,j;d=this&&this.__extends||(H=function(e,t){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}H(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function U(){return null!==z&&z.apply(this,arguments)||this}B=Qt=Qt||{},z=B.StringValue,d(U,z),U.prototype.canvas=function(){return new U(U.CANVAS.toString())},U.prototype.choice=function(){return new U(U.CHOICE.toString())},U.prototype.document=function(){return new U(U.DOCUMENT.toString())},U.prototype.image=function(){return new U(U.IMAGE.toString())},U.prototype.movingimage=function(){return new U(U.MOVINGIMAGE.toString())},U.prototype.physicalobject=function(){return new U(U.PHYSICALOBJECT.toString())},U.prototype.sound=function(){return new U(U.SOUND.toString())},U.prototype.text=function(){return new U(U.TEXT.toString())},U.CANVAS=new U("canvas"),U.CHOICE=new U("choice"),U.DOCUMENT=new U("document"),U.IMAGE=new U("image"),U.MOVINGIMAGE=new U("movingimage"),U.PHYSICALOBJECT=new U("physicalobject"),U.SOUND=new U("sound"),U.TEXT=new U("textualbody"),j=U,B.ResourceType=j;var V,q,G,W;d=this&&this.__extends||(V=function(e,t){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function $(){return null!==G&&G.apply(this,arguments)||this}q=Qt=Qt||{},G=q.StringValue,d($,G),$.prototype.auth1Clickthrough=function(){return new $($.AUTH1CLICKTHROUGH.toString())},$.prototype.auth1External=function(){return new $($.AUTH1EXTERNAL.toString())},$.prototype.auth1Kiosk=function(){return new $($.AUTH1KIOSK.toString())},$.prototype.auth1Login=function(){return new $($.AUTH1LOGIN.toString())},$.prototype.auth1Logout=function(){return new $($.AUTH1LOGOUT.toString())},$.prototype.auth1Probe=function(){return new $($.AUTH1PROBE.toString())},$.prototype.auth1Token=function(){return new $($.AUTH1TOKEN.toString())},$.prototype.autoComplete=function(){return new $($.AUTOCOMPLETE.toString())},$.prototype.iiif1ImageLevel1=function(){return new $($.IIIF1IMAGELEVEL1.toString())},$.prototype.iiif1ImageLevel2=function(){return new $($.IIIF1IMAGELEVEL2.toString())},$.prototype.iiif2ImageLevel1=function(){return new $($.IIIF2IMAGELEVEL1.toString())},$.prototype.iiif2ImageLevel2=function(){return new $($.IIIF2IMAGELEVEL2.toString())},$.prototype.ixif=function(){return new $($.IXIF.toString())},$.prototype.login=function(){return new $($.AUTHLOGIN.toString())},$.prototype.clickThrough=function(){return new $($.AUTHCLICKTHROUGH.toString())},$.prototype.restricted=function(){return new $($.AUTHRESTRICTED.toString())},$.prototype.logout=function(){return new $($.AUTHLOGOUT.toString())},$.prototype.otherManifestations=function(){return new $($.OTHERMANIFESTATIONS.toString())},$.prototype.search=function(){return new $($.SEARCH.toString())},$.prototype.stanfordIIIFImageCompliance1=function(){return new $($.STANFORDIIIFIMAGECOMPLIANCE1.toString())},$.prototype.stanfordIIIFImageCompliance2=function(){return new $($.STANFORDIIIFIMAGECOMPLIANCE2.toString())},$.prototype.stanfordIIIFImageConformance1=function(){return new $($.STANFORDIIIFIMAGECONFORMANCE1.toString())},$.prototype.stanfordIIIFImageConformance2=function(){return new $($.STANFORDIIIFIMAGECONFORMANCE2.toString())},$.prototype.stanfordIIIF1ImageCompliance1=function(){return new $($.STANFORDIIIF1IMAGECOMPLIANCE1.toString())},$.prototype.stanfordIIIF1ImageCompliance2=function(){return new $($.STANFORDIIIF1IMAGECOMPLIANCE2.toString())},$.prototype.stanfordIIIF1ImageConformance1=function(){return new $($.STANFORDIIIF1IMAGECONFORMANCE1.toString())},$.prototype.stanfordIIIF1ImageConformance2=function(){return new $($.STANFORDIIIF1IMAGECONFORMANCE2.toString())},$.prototype.token=function(){return new $($.AUTHTOKEN.toString())},$.prototype.trackingExtensions=function(){return new $($.TRACKINGEXTENSIONS.toString())},$.prototype.uiExtensions=function(){return new $($.UIEXTENSIONS.toString())},$.prototype.printExtensions=function(){return new $($.PRINTEXTENSIONS.toString())},$.prototype.shareExtensions=function(){return new $($.SHAREEXTENSIONS.toString())},$.STANFORDIIIFIMAGECOMPLIANCE0=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level0"),$.STANFORDIIIFIMAGECOMPLIANCE1=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level1"),$.STANFORDIIIFIMAGECOMPLIANCE2=new $("http://library.stanford.edu/iiif/image-api/compliance.html#level2"),$.STANFORDIIIFIMAGECONFORMANCE0=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level0"),$.STANFORDIIIFIMAGECONFORMANCE1=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level1"),$.STANFORDIIIFIMAGECONFORMANCE2=new $("http://library.stanford.edu/iiif/image-api/conformance.html#level2"),$.STANFORDIIIF1IMAGECOMPLIANCE0=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0"),$.STANFORDIIIF1IMAGECOMPLIANCE1=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1"),$.STANFORDIIIF1IMAGECOMPLIANCE2=new $("http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2"),$.STANFORDIIIF1IMAGECONFORMANCE0=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0"),$.STANFORDIIIF1IMAGECONFORMANCE1=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1"),$.STANFORDIIIF1IMAGECONFORMANCE2=new $("http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2"),$.IIIF1IMAGELEVEL0=new $("http://iiif.io/api/image/1/level0.json"),$.IIIF1IMAGELEVEL0PROFILE=new $("http://iiif.io/api/image/1/profiles/level0.json"),$.IIIF1IMAGELEVEL1=new $("http://iiif.io/api/image/1/level1.json"),$.IIIF1IMAGELEVEL1PROFILE=new $("http://iiif.io/api/image/1/profiles/level1.json"),$.IIIF1IMAGELEVEL2=new $("http://iiif.io/api/image/1/level2.json"),$.IIIF1IMAGELEVEL2PROFILE=new $("http://iiif.io/api/image/1/profiles/level2.json"),$.IIIF2IMAGELEVEL0=new $("http://iiif.io/api/image/2/level0.json"),$.IIIF2IMAGELEVEL0PROFILE=new $("http://iiif.io/api/image/2/profiles/level0.json"),$.IIIF2IMAGELEVEL1=new $("http://iiif.io/api/image/2/level1.json"),$.IIIF2IMAGELEVEL1PROFILE=new $("http://iiif.io/api/image/2/profiles/level1.json"),$.IIIF2IMAGELEVEL2=new $("http://iiif.io/api/image/2/level2.json"),$.IIIF2IMAGELEVEL2PROFILE=new $("http://iiif.io/api/image/2/profiles/level2.json"),$.AUTHCLICKTHROUGH=new $("http://iiif.io/api/auth/0/login/clickthrough"),$.AUTHLOGIN=new $("http://iiif.io/api/auth/0/login"),$.AUTHLOGOUT=new $("http://iiif.io/api/auth/0/logout"),$.AUTHRESTRICTED=new $("http://iiif.io/api/auth/0/login/restricted"),$.AUTHTOKEN=new $("http://iiif.io/api/auth/0/token"),$.AUTH1CLICKTHROUGH=new $("http://iiif.io/api/auth/1/clickthrough"),$.AUTH1EXTERNAL=new $("http://iiif.io/api/auth/1/external"),$.AUTH1KIOSK=new $("http://iiif.io/api/auth/1/kiosk"),$.AUTH1LOGIN=new $("http://iiif.io/api/auth/1/login"),$.AUTH1LOGOUT=new $("http://iiif.io/api/auth/1/logout"),$.AUTH1PROBE=new $("http://iiif.io/api/auth/1/probe"),$.AUTH1TOKEN=new $("http://iiif.io/api/auth/1/token"),$.AUTOCOMPLETE=new $("http://iiif.io/api/search/0/autocomplete"),$.SEARCH=new $("http://iiif.io/api/search/0/search"),$.TRACKINGEXTENSIONS=new $("http://universalviewer.io/tracking-extensions-profile"),$.UIEXTENSIONS=new $("http://universalviewer.io/ui-extensions-profile"),$.PRINTEXTENSIONS=new $("http://universalviewer.io/print-extensions-profile"),$.SHAREEXTENSIONS=new $("http://universalviewer.io/share-extensions-profile"),$.OTHERMANIFESTATIONS=new $("http://iiif.io/api/otherManifestations.json"),$.IXIF=new $("http://wellcomelibrary.org/ld/ixif/0/alpha.json"),W=$,q.ServiceProfile=W;var X,Y,Z,K;d=this&&this.__extends||(X=function(e,t){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}X(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Q(){return null!==Z&&Z.apply(this,arguments)||this}Y=Qt=Qt||{},Z=Y.StringValue,d(Q,Z),Q.prototype.leftToRight=function(){return new Q(Q.LEFTTORIGHT.toString())},Q.prototype.rightToLeft=function(){return new Q(Q.RIGHTTOLEFT.toString())},Q.prototype.topToBottom=function(){return new Q(Q.TOPTOBOTTOM.toString())},Q.prototype.bottomToTop=function(){return new Q(Q.BOTTOMTOTOP.toString())},Q.LEFTTORIGHT=new Q("left-to-right"),Q.RIGHTTOLEFT=new Q("right-to-left"),Q.TOPTOBOTTOM=new Q("top-to-bottom"),Q.BOTTOMTOTOP=new Q("bottom-to-top"),K=Q,Y.ViewingDirection=K;var J,ee,te,ne,ie,oe;d=this&&this.__extends||(J=function(e,t){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}J(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function re(){return null!==te&&te.apply(this,arguments)||this}function se(e){this.__jsonld=e,this.context=this.getProperty("context"),this.id=this.getProperty("id")}ee=Qt=Qt||{},te=ee.StringValue,d(re,te),re.prototype.continuous=function(){return new re(re.CONTINUOUS.toString())},re.prototype.empty=function(){return new re(re.EMPTY.toString())},re.prototype.individuals=function(){return new re(re.INDIVIDUALS.toString())},re.prototype.nonPaged=function(){return new re(re.NONPAGED.toString())},re.prototype.paged=function(){return new re(re.PAGED.toString())},re.prototype.top=function(){return new re(re.TOP.toString())},re.CONTINUOUS=new re("continuous"),re.EMPTY=new re(""),re.INDIVIDUALS=new re("individuals"),re.NONPAGED=new re("non-paged"),re.PAGED=new re("paged"),re.TOP=new re("top"),ne=re,ee.ViewingHint=ne,ie=Qt=Qt||{},se.prototype.getProperty=function(e){var t=null;return this.__jsonld&&(t=(t=this.__jsonld[e])||this.__jsonld["@"+e]),t},oe=se,ie.JSONLDResource=oe;var ae,le,ce,ue;d=this&&this.__extends||(ae=function(e,t){return(ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ae(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function de(e,t){var n=ce.call(this,e)||this;return n.options=t,n}le=Qt=Qt||{},ce=le.JSONLDResource,d(de,ce),de.prototype.getIIIFResourceType=function(){return new le.IIIFResourceType(le.Utils.normaliseType(this.getProperty("type")))},de.prototype.getLabel=function(){var e=this.getProperty("label");return e?le.LanguageMap.parse(e,this.options.locale):[]},de.prototype.getDefaultLabel=function(){return le.LanguageMap.getValue(this.getLabel())},de.prototype.getMetadata=function(){var e=this.getProperty("metadata"),t=[];if(!e)return t;for(var n=0;n<e.length;n++){var i=e[n],o=new le.LabelValuePair(this.options.locale);o.parse(i),t.push(o)}return t},de.prototype.getRendering=function(e){var t=this.getRenderings();"string"!=typeof e&&(e=e.toString());for(var n=0;n<t.length;n++){var i=t[n];if(i.getFormat().toString()===e)return i}return null},de.prototype.getRenderings=function(){var e,t=[];if(!(e=this.__jsonld?this.__jsonld.rendering:this.rendering))return t;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=e[n];t.push(new le.Rendering(i,this.options))}return t},de.prototype.getService=function(e){return le.Utils.getService(this,e)},de.prototype.getServices=function(){return le.Utils.getServices(this)},de.prototype.getThumbnail=function(){var e=this.getProperty("thumbnail");return Array.isArray(e)&&(e=e[0]),e?new le.Thumbnail(e,this.options):null},de.prototype.isAnnotation=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.ANNOTATION.toString()},de.prototype.isCanvas=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.CANVAS.toString()},de.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.COLLECTION.toString()},de.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.MANIFEST.toString()},de.prototype.isRange=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.RANGE.toString()},de.prototype.isSequence=function(){return this.getIIIFResourceType().toString()===le.IIIFResourceType.SEQUENCE.toString()},ue=de,le.ManifestResource=ue;var he,fe,pe,ge;d=this&&this.__extends||(he=function(e,t){return(he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}he(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function me(e,t){return pe.call(this,e,t)||this}fe=Qt=Qt||{},pe=fe.ManifestResource,d(me,pe),me.prototype.getFormat=function(){var e=this.getProperty("format");return e?new fe.MediaType(e.toLowerCase()):null},me.prototype.getResources=function(){var e=[];if(!this.__jsonld.resources)return e;for(var t=0;t<this.__jsonld.resources.length;t++){var n=this.__jsonld.resources[t],i=new fe.Annotation(n,this.options);e.push(i)}return e},me.prototype.getType=function(){var e=this.getProperty("type");return e?new fe.ResourceType(fe.Utils.normaliseType(e)):null},me.prototype.getWidth=function(){return this.getProperty("width")},me.prototype.getHeight=function(){return this.getProperty("height")},me.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},me.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},ge=me,fe.Resource=ge;var ve,be,ye,we;d=this&&this.__extends||(ve=function(e,t){return(ve=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ve(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Te(e,t){return ye.call(this,e,t)||this}be=Qt=Qt||{},ye=be.Resource,d(Te,ye),Te.prototype.getCanonicalImageUri=function(e){var t,n=null,i="default",o=e;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])n=this.externalResource.data["@id"],o=o||this.externalResource.data.width,this.externalResource.data["@context"]&&(-1<this.externalResource.data["@context"].indexOf("/1.0/context.json")||-1<this.externalResource.data["@context"].indexOf("/1.1/context.json")||-1<this.externalResource.data["@context"].indexOf("/1/context.json"))&&(i="native");else{var r=this.getImages();if(r&&r.length){var s=r[0].getResource(),a=s.getServices();if(o=o||s.getWidth(),a.length){var l=a[0];n=l.id,i=be.Utils.getImageQuality(l.getProfile())}else if(o===s.getWidth())return s.id}if(!n){var c=this.getProperty("thumbnail");if(c){if("string"==typeof c)return c;if(c["@id"])return c["@id"];if(c.length)return c[0].id}}}return t=o+",",n&&n.endsWith("/")&&(n=n.substr(0,n.length-1)),[n,"full",t,0,i+".jpg"].join("/")},Te.prototype.getMaxDimensions=function(){var e,t=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(e=this.externalResource.data.profile,Array.isArray(e)&&(e=e.filter(function(e){return e.maxWidth})[0])&&(t=new be.Size(e.maxWidth,e.maxHeight?e.maxHeight:e.maxWidth))),t},Te.prototype.getContent=function(){var e=[],t=this.__jsonld.items||this.__jsonld.content;if(!t)return e;var n=null;if(t.length&&(n=new be.AnnotationPage(t[0],this.options)),!n)return e;for(var i=n.getItems(),o=0;o<i.length;o++){var r=i[o],s=new be.Annotation(r,this.options);e.push(s)}return e},Te.prototype.getDuration=function(){return this.getProperty("duration")},Te.prototype.getImages=function(){var e=[];if(!this.__jsonld.images)return e;for(var t=0;t<this.__jsonld.images.length;t++){var n=this.__jsonld.images[t],i=new be.Annotation(n,this.options);e.push(i)}return e},Te.prototype.getIndex=function(){return this.getProperty("index")},Te.prototype.getOtherContent=function(){var n=this,e=Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")],t=e.filter(function(e){return e&&function(e,t){return"string"==typeof e&&"string"==typeof t&&e.toLowerCase()==e.toLowerCase()}(e["@type"],"sc:AnnotationList")}).map(function(e,t){return new be.AnnotationList(e.label||"Annotation list "+t,e,n.options)}).map(function(e){return e.load()});return Promise.all(t)},Te.prototype.getWidth=function(){return this.getProperty("width")},Te.prototype.getHeight=function(){return this.getProperty("height")},we=Te,be.Canvas=we;var xe,Se,Ce,Ee;d=this&&this.__extends||(xe=function(e,t){return(xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}xe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Pe(e,t){var n=Ce.call(this,e,t)||this;n.index=-1,n.isLoaded=!1;var i={defaultLabel:"-",locale:"en-GB",resource:n,pessimisticAccessControl:!1};return n.options=Object.assign(i,t),n}Se=Qt=Qt||{},Ce=Se.ManifestResource,d(Pe,Ce),Pe.prototype.getAttribution=function(){console.warn("getAttribution will be deprecated, use getRequiredStatement instead.");var e=this.getProperty("attribution");return e?Se.LanguageMap.parse(e,this.options.locale):[]},Pe.prototype.getDescription=function(){var e=this.getProperty("description");return e?Se.LanguageMap.parse(e,this.options.locale):[]},Pe.prototype.getIIIFResourceType=function(){return new Se.IIIFResourceType(Se.Utils.normaliseType(this.getProperty("type")))},Pe.prototype.getLogo=function(){var e=this.getProperty("logo");return e?"string"==typeof e?e:(Array.isArray(e)&&e.length&&(e=e[0]),e["@id"]||e.id):null},Pe.prototype.getLicense=function(){return Se.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},Pe.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},Pe.prototype.getRelated=function(){return this.getProperty("related")},Pe.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},Pe.prototype.getTrackingLabel=function(){var e=this.getService(Se.ServiceProfile.TRACKINGEXTENSIONS);return e?e.getProperty("trackingLabel"):""},Pe.prototype.getDefaultTree=function(){return this.defaultTree=new Se.TreeNode("root"),(this.defaultTree.data=this).defaultTree},Pe.prototype.getRequiredStatement=function(){var e=null,t=this.getProperty("requiredStatement");if(t)(e=new Se.LabelValuePair(this.options.locale)).parse(t);else{var n=this.getAttribution();n&&((e=new Se.LabelValuePair(this.options.locale)).value=n)}return e},Pe.prototype.isCollection=function(){return this.getIIIFResourceType().toString()===Se.IIIFResourceType.COLLECTION.toString()},Pe.prototype.isManifest=function(){return this.getIIIFResourceType().toString()===Se.IIIFResourceType.MANIFEST.toString()},Pe.prototype.load=function(){var o=this;return new Promise(function(n,e){if(o.isLoaded)n(o);else{var i=o.options;i.navDate=o.getNavDate();var t=o.__jsonld.id;t=t||o.__jsonld["@id"],Se.Utils.loadResource(t).then(function(e){o.parentLabel=Se.LanguageMap.getValue(o.getLabel(),i.locale);var t=Se.Deserialiser.parse(e,i);(o=Object.assign(o,t)).index=i.index,n(o)})}})},Ee=Pe,Se.IIIFResource=Ee;var Re,Ie,_e,Ae;d=this&&this.__extends||(Re=function(e,t){return(Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Re(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Oe(e,t){var n=_e.call(this,e,t)||this;if(n.index=0,n._allRanges=null,n.items=[],n._topRanges=[],n.__jsonld.structures&&n.__jsonld.structures.length)for(var i=n._getTopRanges(),o=0;o<i.length;o++){var r=i[o];n._parseRanges(r,String(o))}return n}Ie=Qt=Qt||{},_e=Ie.IIIFResource,d(Oe,_e),Oe.prototype.getPosterCanvas=function(){var e=this.getProperty("posterCanvas");return e=e&&new Ie.Canvas(e,this.options)},Oe.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e?new Ie.Behavior(e):null},Oe.prototype.getDefaultTree=function(){if(_e.prototype.getDefaultTree.call(this),this.defaultTree.data.type=Ie.Utils.normaliseType(Ie.TreeNodeType.MANIFEST.toString()),!this.isLoaded)return this.defaultTree;var e=this.getTopRanges();return e.length&&e[0].getTree(this.defaultTree),Ie.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},Oe.prototype._getTopRanges=function(){var e=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var t=0;t<this.__jsonld.structures.length;t++){var n=this.__jsonld.structures[t];n.viewingHint===Ie.ViewingHint.TOP.toString()&&e.push(n)}if(!e.length){var i={};i.ranges=this.__jsonld.structures,e.push(i)}}return e},Oe.prototype.getTopRanges=function(){return this._topRanges},Oe.prototype._getRangeById=function(e){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var t=0;t<this.__jsonld.structures.length;t++){var n=this.__jsonld.structures[t];if(n["@id"]===e||n.id===e)return n}return null},Oe.prototype._parseRanges=function(e,t,n){var i,o=null;if("string"==typeof e&&(o=e,e=this._getRangeById(o)),e){(i=new Ie.Range(e,this.options)).parentRange=n,i.path=t,n?n.items.push(i):this._topRanges.push(i);var r=e.items||e.members;if(r)for(var s=0;s<r.length;s++){var a=r[s];if(a["@type"]&&"sc:range"===a["@type"].toLowerCase()||a.type&&"range"===a.type.toLowerCase())this._parseRanges(a,t+"/"+s,i);else if(a["@type"]&&"sc:canvas"===a["@type"].toLowerCase()||a.type&&"canvas"===a.type.toLowerCase()){i.canvases||(i.canvases=[]);var l=a.id||a["@id"];i.canvases.push(l)}}else if(e.ranges)for(s=0;s<e.ranges.length;s++)this._parseRanges(e.ranges[s],t+"/"+s,i)}else console.warn("Range:",o,"does not exist")},Oe.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;function e(e){var t=o[e];t.id&&r._allRanges.push(t);var i=function(e,t){e.add(t);var n=t.getRanges();return n.length?n.reduce(i,e):e},n=Array.from(t.getRanges().reduce(i,new Set));r._allRanges=r._allRanges.concat(n)}this._allRanges=[];for(var o=this.getTopRanges(),r=this,t=0;t<o.length;t++)e(t);return this._allRanges},Oe.prototype.getRangeById=function(e){for(var t=this.getAllRanges(),n=0;n<t.length;n++){var i=t[n];if(i.id===e)return i}return null},Oe.prototype.getRangeByPath=function(e){for(var t=this.getAllRanges(),n=0;n<t.length;n++){var i=t[n];if(i.path===e)return i}return null},Oe.prototype.getSequences=function(){if(this.items.length)return this.items;var e=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(e)for(var t=0;t<e.length;t++){var n=e[t],i=new Ie.Sequence(n,this.options);this.items.push(i)}else this.__jsonld.items&&(i=new Ie.Sequence(this.__jsonld.items,this.options),this.items.push(i));return this.items},Oe.prototype.getSequenceByIndex=function(e){return this.getSequences()[e]},Oe.prototype.getTotalSequences=function(){return this.getSequences().length},Oe.prototype.getManifestType=function(){var e=this.getService(Ie.ServiceProfile.UIEXTENSIONS);return e?new Ie.ManifestType(e.getProperty("manifestType")):new Ie.ManifestType("")},Oe.prototype.isMultiSequence=function(){return 1<this.getTotalSequences()},Oe.prototype.isPagingEnabled=function(){var e=this.getViewingHint();if(e)return e.toString()===Ie.ViewingHint.PAGED.toString();var t=this.getBehavior();return!!t&&t.toString()===Ie.Behavior.PAGED.toString()},Oe.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new Ie.ViewingDirection(this.getProperty("viewingDirection")):null},Oe.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new Ie.ViewingHint(this.getProperty("viewingHint")):null},Ae=Oe,Ie.Manifest=Ae;var ke,De,Me,Fe;d=this&&this.__extends||(ke=function(e,t){return(ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ke(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Le(e,t){var n=Me.call(this,e,t)||this;return n.items=[],n._collections=null,n._manifests=null,e.__collection=n}De=Qt=Qt||{},Me=De.IIIFResource,d(Le,Me),Le.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter(function(e){return e.isCollection()})},Le.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter(function(e){return e.isManifest()})},Le.prototype.getCollectionByIndex=function(e){for(var t,n=this.getCollections(),i=0;i<n.length;i++){var o=n[i];o.index===e&&(t=o)}if(t)return t.options.index=e,t.load();throw new Error("Collection index not found")},Le.prototype.getManifestByIndex=function(e){for(var t,n=this.getManifests(),i=0;i<n.length;i++){var o=n[i];o.index===e&&(t=o)}if(t)return t.options.index=e,t.load();throw new Error("Manifest index not found")},Le.prototype.getTotalCollections=function(){return this.getCollections().length},Le.prototype.getTotalManifests=function(){return this.getManifests().length},Le.prototype.getTotalItems=function(){return this.items.length},Le.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new De.ViewingDirection(this.getProperty("viewingDirection")):De.ViewingDirection.LEFTTORIGHT},Le.prototype.getDefaultTree=function(){return Me.prototype.getDefaultTree.call(this),this.defaultTree.data.type=De.Utils.normaliseType(De.TreeNodeType.COLLECTION.toString()),this._parseManifests(this),this._parseCollections(this),De.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},Le.prototype._parseManifests=function(e){if(e.getManifests()&&e.getManifests().length)for(var t=0;t<e.getManifests().length;t++){var n=e.getManifests()[t],i=n.getDefaultTree();i.label=n.parentLabel||De.LanguageMap.getValue(n.getLabel(),this.options.locale)||"manifest "+(t+1),i.navDate=n.getNavDate(),i.data.id=n.id,i.data.type=De.Utils.normaliseType(De.TreeNodeType.MANIFEST.toString()),e.defaultTree.addNode(i)}},Le.prototype._parseCollections=function(e){if(e.getCollections()&&e.getCollections().length)for(var t=0;t<e.getCollections().length;t++){var n=e.getCollections()[t],i=n.getDefaultTree();i.label=n.parentLabel||De.LanguageMap.getValue(n.getLabel(),this.options.locale)||"collection "+(t+1),i.navDate=n.getNavDate(),i.data.id=n.id,i.data.type=De.Utils.normaliseType(De.TreeNodeType.COLLECTION.toString()),e.defaultTree.addNode(i)}},Fe=Le,De.Collection=Fe;var Ne,He,Be,ze;d=this&&this.__extends||(Ne=function(e,t){return(Ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Ne(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function je(e,t){var n=Be.call(this,e,t)||this;return n._ranges=null,n.canvases=null,n.items=[],n}He=Qt=Qt||{},Be=He.ManifestResource,d(je,Be),je.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},je.prototype.getDuration=function(){var e,t;if(this.canvases&&this.canvases.length)for(var n=0;n<this.canvases.length;n++){var i=this.canvases[n],o=He.Utils.getTemporalComponent(i);o&&1<o.length&&(0===n&&(e=Number(o[0])),n===this.canvases.length-1&&(t=Number(o[1])))}else{var r=this.getRanges();for(n=0;n<r.length;n++){var s=r[n].getDuration();s&&(0===n&&(e=s.start),n===r.length-1&&(t=s.end))}}if(void 0!==e&&void 0!==t)return new He.Duration(e,t)},je.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter(function(e){return e.isRange()})},je.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e?new He.Behavior(e):null},je.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new He.ViewingDirection(this.getProperty("viewingDirection")):null},je.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new He.ViewingHint(this.getProperty("viewingHint")):null},je.prototype.getTree=function(e){(e.data=this).treeNode=e;var t=this.getRanges();if(t&&t.length)for(var n=0;n<t.length;n++){var i=t[n],o=new He.TreeNode;e.addNode(o),this._parseTreeNode(o,i)}return He.Utils.generateTreeNodeIds(e),e},je.prototype.spansTime=function(e){var t=this.getDuration();return!!(t&&e>=t.start&&e<=t.end)},je.prototype._parseTreeNode=function(e,t){e.label=He.LanguageMap.getValue(t.getLabel(),this.options.locale),e.data=t,e.data.type=He.Utils.normaliseType(He.TreeNodeType.RANGE.toString()),t.treeNode=e;var n=t.getRanges();if(n&&n.length)for(var i=0;i<n.length;i++){var o=n[i],r=o.getBehavior();if(!r||r.toString()!==He.Behavior.NONAV.toString()){var s=new He.TreeNode;e.addNode(s),this._parseTreeNode(s,o)}}},ze=je,He.Range=ze;var Ue,Ve,qe,Ge;d=this&&this.__extends||(Ue=function(e,t){return(Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Ue(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function We(e,t){return qe.call(this,e,t)||this}Ve=Qt=Qt||{},qe=Ve.ManifestResource,d(We,qe),We.prototype.getFormat=function(){return new Ve.RenderingFormat(this.getProperty("format"))},Ge=We,Ve.Rendering=Ge;var $e,Xe,Ye,Ze;d=this&&this.__extends||($e=function(e,t){return($e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}$e(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Ke(e,t){var n=Ye.call(this,e,t)||this;return n.items=[],n._thumbnails=null,n}Xe=Qt=Qt||{},Ye=Xe.ManifestResource,d(Ke,Ye),Ke.prototype.getCanvases=function(){if(this.items.length)return this.items;var e=this.__jsonld.canvases||this.__jsonld.elements;if(e)for(var t=0;t<e.length;t++){var n=e[t];(i=new Xe.Canvas(n,this.options)).index=t,this.items.push(i)}else if(this.__jsonld)for(t=0;t<this.__jsonld.length;t++){var i;n=this.__jsonld[t],(i=new Xe.Canvas(n,this.options)).index=t,this.items.push(i)}return this.items},Ke.prototype.getCanvasById=function(e){for(var t=0;t<this.getTotalCanvases();t++){var n=this.getCanvasByIndex(t),i=Xe.Utils.normaliseUrl(n.id);if(Xe.Utils.normaliseUrl(e)===i)return n}return null},Ke.prototype.getCanvasByIndex=function(e){return this.getCanvases()[e]},Ke.prototype.getCanvasIndexById=function(e){for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return null},Ke.prototype.getCanvasIndexByLabel=function(e,t){e=e.trim(),isNaN(e)||(e=parseInt(e,10).toString(),t&&(e+="r"));for(var n,i,o,r=/(\d*)\D+(\d*)/,s=0;s<this.getTotalCanvases();s++){var a=this.getCanvasByIndex(s);if(Xe.LanguageMap.getValue(a.getLabel(),this.options.locale)===e)return s;if((n=r.exec(e))&&(i=n[1],(o=n[2])&&new RegExp("^"+i+"\\D+"+o+"$").test(a.getLabel().toString())))return s}return-1},Ke.prototype.getLastCanvasLabel=function(e){for(var t=this.getTotalCanvases()-1;0<=t;t--){var n=this.getCanvasByIndex(t),i=Xe.LanguageMap.getValue(n.getLabel(),this.options.locale);if(e){if(/^[a-zA-Z0-9]*$/.test(i))return i}else if(i)return i}return this.options.defaultLabel},Ke.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},Ke.prototype.getNextPageIndex=function(e,t){var n;if(t){var i=this.getPagedIndices(e),o=this.getViewingDirection();n=o&&o.toString()===Xe.ViewingDirection.RIGHTTOLEFT.toString()?i[0]+1:i[i.length-1]+1}else n=e+1;return n>this.getLastPageIndex()?-1:n},Ke.prototype.getPagedIndices=function(e,t){var n=[];if(t){n=this.isFirstCanvas(e)||this.isLastCanvas(e)?[e]:e%2?[e,e+1]:[e-1,e];var i=this.getViewingDirection();i&&i.toString()===Xe.ViewingDirection.RIGHTTOLEFT.toString()&&(n=n.reverse())}else n.push(e);return n},Ke.prototype.getPrevPageIndex=function(e,t){var n;if(t){var i=this.getPagedIndices(e),o=this.getViewingDirection();n=o&&o.toString()===Xe.ViewingDirection.RIGHTTOLEFT.toString()?i[i.length-1]-1:i[0]-1}else n=e-1;return n},Ke.prototype.getStartCanvasIndex=function(){var e=this.getStartCanvas();if(e)for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return 0},Ke.prototype.getThumbs=function(e,t){console.warn("getThumbs will be deprecated, use getThumbnails instead");for(var n=[],i=this.getTotalCanvases(),o=0;o<i;o++){var r=this.getCanvasByIndex(o),s=new Xe.Thumb(e,r);n.push(s)}return n},Ke.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var e=this.getCanvases(),t=0;t<e.length;t++){var n=e[t].getThumbnail();n&&this._thumbnails.push(n)}return this._thumbnails},Ke.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},Ke.prototype.getTotalCanvases=function(){return this.getCanvases().length},Ke.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?new Xe.ViewingDirection(this.getProperty("viewingDirection")):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},Ke.prototype.getViewingHint=function(){return this.getProperty("viewingHint")?new Xe.ViewingHint(this.getProperty("viewingHint")):null},Ke.prototype.isCanvasIndexOutOfRange=function(e){return e>this.getTotalCanvases()-1},Ke.prototype.isFirstCanvas=function(e){return 0===e},Ke.prototype.isLastCanvas=function(e){return e===this.getTotalCanvases()-1},Ke.prototype.isMultiCanvas=function(){return 1<this.getTotalCanvases()},Ke.prototype.isPagingEnabled=function(){var e=this.getViewingHint();return!!e&&e.toString()===Xe.ViewingHint.PAGED.toString()},Ke.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},Ze=Ke,Xe.Sequence=Ze,function(i){var e=(t.parse=function(e,t){return"string"==typeof e&&(e=JSON.parse(e)),this.parseJson(e,t)},t.parseJson=function(e,t){var n;if(t&&t.navDate&&!isNaN(t.navDate.getTime())&&(e.navDate=t.navDate.toString()),e["@type"])switch(e["@type"]){case"sc:Collection":n=this.parseCollection(e,t);break;case"sc:Manifest":n=this.parseManifest(e,t);break;default:return null}else switch(e.type){case"Collection":n=this.parseCollection(e,t);break;case"Manifest":n=this.parseManifest(e,t);break;default:return null}return n.isLoaded=!0,n},t.parseCollection=function(e,t){var n=new i.Collection(e,t);return t?(n.index=t.index||0,t.resource&&(n.parentCollection=t.resource.parentCollection)):n.index=0,this.parseCollections(n,t),this.parseManifests(n,t),this.parseItems(n,t),n},t.parseCollections=function(e,t){var n;if(e.__jsonld.collections?n=e.__jsonld.collections:e.__jsonld.items&&(n=e.__jsonld.items.filter(function(e){return"collection"===e.type.toLowerCase()})),n)for(var i=0;i<n.length;i++){t&&(t.index=i);var o=this.parseCollection(n[i],t);o.index=i,(o.parentCollection=e).items.push(o)}},t.parseManifest=function(e,t){return new i.Manifest(e,t)},t.parseManifests=function(e,t){var n;if(e.__jsonld.manifests?n=e.__jsonld.manifests:e.__jsonld.items&&(n=e.__jsonld.items.filter(function(e){return"manifest"===e.type.toLowerCase()})),n)for(var i=0;i<n.length;i++){var o=this.parseManifest(n[i],t);o.index=i,(o.parentCollection=e).items.push(o)}},t.parseItem=function(e,t){if(e["@type"]){if("sc:manifest"===e["@type"].toLowerCase())return this.parseManifest(e,t);if("sc:collection"===e["@type"].toLowerCase())return this.parseCollection(e,t)}else if(e.type){if("manifest"===e.type.toLowerCase())return this.parseManifest(e,t);if("collection"===e.type.toLowerCase())return this.parseCollection(e,t)}return null},t.parseItems=function(n,i){var o=n.__jsonld.members||n.__jsonld.items;if(o){function e(e){i&&(i.index=e);var t=r.parseItem(o[e],i);return t?n.items.filter(function(e){return e.id===t.id})[0]?"continue":(t.index=e,void(t.parentCollection=n).items.push(t)):{value:void 0}}for(var r=this,t=0;t<o.length;t++){var s=e(t);if("object"==typeof s)return s.value}}},t);function t(){}i.Deserialiser=e;var n=(o.serialise=function(e){return""},o);function o(){}i.Serialiser=n}(Qt=Qt||{});var Qe,Je,et,tt,nt,it,ot;d=this&&this.__extends||(Qe=function(e,t){return(Qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Qe(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function rt(e,t){return et.call(this,e,t)||this}function st(e,t){this.data=t,this.index=t.index,this.width=e;var n=t.getHeight()/t.getWidth();this.height=n?Math.floor(this.width*n):e,this.uri=t.getCanonicalImageUri(e),this.label=nt.LanguageMap.getValue(t.getLabel())}function at(e,t){this.label=e,this.data=t||{},this.nodes=[]}Je=Qt=Qt||{},et=Je.ManifestResource,d(rt,et),rt.prototype.getProfile=function(){var e=this.getProperty("profile");return e=e||this.getProperty("dcterms:conformsTo"),Array.isArray(e)?new Je.ServiceProfile(e[0]):new Je.ServiceProfile(e)},rt.prototype.getConfirmLabel=function(){return Je.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},rt.prototype.getDescription=function(){return Je.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},rt.prototype.getFailureDescription=function(){return Je.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},rt.prototype.getFailureHeader=function(){return Je.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},rt.prototype.getHeader=function(){return Je.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},rt.prototype.getServiceLabel=function(){return Je.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},rt.prototype.getInfoUri=function(){var e=this.id;return e.endsWith("/")||(e+="/"),e+="info.json"},tt=rt,Je.Service=tt,(nt=Qt=Qt||{}).Thumb=st,it=Qt=Qt||{},at.prototype.addNode=function(e){this.nodes.push(e),e.parentNode=this},at.prototype.isCollection=function(){return this.data.type===it.Utils.normaliseType(it.TreeNodeType.COLLECTION.toString())},at.prototype.isManifest=function(){return this.data.type===it.Utils.normaliseType(it.TreeNodeType.MANIFEST.toString())},at.prototype.isRange=function(){return this.data.type===it.Utils.normaliseType(it.TreeNodeType.RANGE.toString())},ot=at,it.TreeNode=ot;var lt,ct,ut,dt;d=this&&this.__extends||(lt=function(e,t){return(lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}lt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function ht(){return null!==ut&&ut.apply(this,arguments)||this}ct=Qt=Qt||{},ut=ct.StringValue,d(ht,ut),ht.prototype.collection=function(){return new ht(ht.COLLECTION.toString())},ht.prototype.manifest=function(){return new ht(ht.MANIFEST.toString())},ht.prototype.range=function(){return new ht(ht.RANGE.toString())},ht.COLLECTION=new ht("collection"),ht.MANIFEST=new ht("manifest"),ht.RANGE=new ht("range"),dt=ht,ct.TreeNodeType=dt;var ft,pt,gt=this&&this.__awaiter||function(r,s,a,l){return new(a=a||Promise)(function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,i)}o((l=l.apply(r,s||[])).next())})},mt=this&&this.__generator||function(n,i){var o,r,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,r&&(s=2&t[0]?r.return:t[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,r=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=i.call(n,a)}catch(e){t=[6,e],r=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},vt=on("http"),bt=on("https"),yt=on("url");function wt(){}function Tt(e,t){Array.isArray(e)?1===e.length?this.value=e[0]:this.value=e.join("<br/>"):this.value=e,this.locale=t}ft=Qt=Qt||{},wt.getMediaType=function(e){return(e=(e=e.toLowerCase()).split(";")[0]).trim()},wt.getImageQuality=function(e){var t=e.toString();return t===ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString()||t===ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString()||t===ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString()||t===ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString()||t===ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString()||t===ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString()||t===ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString()||t===ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString()||t===ft.ServiceProfile.IIIF1IMAGELEVEL1.toString()||t===ft.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString()||t===ft.ServiceProfile.IIIF1IMAGELEVEL2.toString()||t===ft.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString()?"native":"default"},wt.getInexactLocale=function(e){return-1!==e.indexOf("-")?e.substr(0,e.indexOf("-")):e},wt.getLocalisedValue=function(e,t){if(!Array.isArray(e))return e;for(var n=0;n<e.length;n++){var i=e[n];if(t===i["@language"])return i["@value"]}var o=t.substr(0,t.indexOf("-"));for(n=0;n<e.length;n++){var r=e[n];if(r["@language"]===o)return r["@value"]}return null},wt.generateTreeNodeIds=function(e,t){var n;void 0===t&&(t=0),n=e.parentNode?e.parentNode.id+"-"+t:"0",e.id=n;for(var i=0;i<e.nodes.length;i++){var o=e.nodes[i];wt.generateTreeNodeIds(o,i)}},wt.normaliseType=function(e){return-1===(e=e.toLowerCase()).indexOf(":")?e:e.split(":")[1]},wt.normaliseUrl=function(e){return-1!==(e=e.substr(e.indexOf("://"))).indexOf("#")&&(e=e.split("#")[0]),e},wt.normalisedUrlsMatch=function(e,t){return wt.normaliseUrl(e)===wt.normaliseUrl(t)},wt.isImageProfile=function(e){return"string"==typeof e&&(e=new ft.ServiceProfile(e)),!!(wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},wt.isLevel0ImageProfile=function(e){return"string"==typeof e&&(e=new ft.ServiceProfile(e)),!!(wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL0PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL0.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL0PROFILE.toString()))},wt.isLevel1ImageProfile=function(e){return"string"==typeof e&&(e=new ft.ServiceProfile(e)),!!(wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL1PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL1.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL1PROFILE.toString()))},wt.isLevel2ImageProfile=function(e){return"string"==typeof e&&(e=new ft.ServiceProfile(e)),!!(wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECOMPLIANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECOMPLIANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIFIMAGECONFORMANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.STANFORDIIIF1IMAGECONFORMANCE2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF1IMAGELEVEL2PROFILE.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL2.toString())||wt.normalisedUrlsMatch(e.toString(),ft.ServiceProfile.IIIF2IMAGELEVEL2PROFILE.toString()))},wt.loadResource=function(s){return new Promise(function(n,t){var e,i=yt.parse(s),o={host:i.hostname,port:i.port,path:i.path,method:"GET",withCredentials:!1};switch(i.protocol){case"https:":(e=bt.request(o,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){n(t)})})).on("error",function(e){t(e)}),e.end();break;case"dat:":var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&n(r.response)},r.open("GET",s,!0),r.send();break;default:(e=vt.request(o,function(e){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){n(t)})})).on("error",function(e){t(e)}),e.end()}})},wt.loadExternalResourcesAuth1=function(i,o,r,s,a,l,c,u){return new Promise(function(e,t){var n=i.map(function(e){return wt.loadExternalResourceAuth1(e,o,r,s,a,l,c,u)});Promise.all(n).then(function(){e(i)}).catch(function(e){t(e)})})},wt.loadExternalResourceAuth1=function(n,i,o,r,s,a,l,c){return gt(this,void 0,void 0,function(){var t;return mt(this,function(e){switch(e.label){case 0:return[4,r(n)];case 1:return(t=e.sent())?[4,n.getData(t)]:[3,6];case 2:return e.sent(),n.status!==HTTPStatusCode.OK?[3,3]:[2,n];case 3:return[4,wt.doAuthChain(n,i,o,s,a,l,c)];case 4:e.sent(),e.label=5;case 5:if(n.status===HTTPStatusCode.OK||n.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,n];throw wt.createAuthorizationFailedError();case 6:return[4,n.getData()];case 7:return e.sent(),n.status!==HTTPStatusCode.MOVED_TEMPORARILY&&n.status!==HTTPStatusCode.UNAUTHORIZED?[3,9]:[4,wt.doAuthChain(n,i,o,s,a,l,c)];case 8:e.sent(),e.label=9;case 9:if(n.status===HTTPStatusCode.OK||n.status===HTTPStatusCode.MOVED_TEMPORARILY)return[2,n];throw wt.createAuthorizationFailedError()}})})},wt.doAuthChain=function(c,u,d,h,f,p,g){return gt(this,void 0,void 0,function(){var t,n,i,o,r,s,a,l;return mt(this,function(e){switch(e.label){case 0:return c.isAccessControlled()?((t=c.externalService)&&(t.options=c.options),(n=c.kioskService)&&(n.options=c.options),(i=c.clickThroughService)&&(i.options=c.options),(o=c.loginService)&&(o.options=c.options),c.isResponseHandled||c.status!==HTTPStatusCode.MOVED_TEMPORARILY?[3,2]:[4,p(c)]):[2,c];case 1:return e.sent(),[2,c];case 2:return s=r=null,(r=t)?[4,wt.attemptResourceWithToken(c,d,s=r)]:[3,4];case 3:return e.sent(),[2,c];case 4:return(r=n)&&(a=u(s=r))?[4,h(a)]:[3,7];case 5:return e.sent(),[4,wt.attemptResourceWithToken(c,d,r)];case 6:return e.sent(),[2,c];case 7:return(r=i)?[4,f(c,s=r)]:[3,11];case 8:return(l=e.sent())?[4,h(l)]:[3,11];case 9:return e.sent(),[4,wt.attemptResourceWithToken(c,d,r)];case 10:return e.sent(),[2,c];case 11:return(r=o)?[4,f(c,s=r)]:[3,15];case 12:return(l=e.sent())?[4,h(l)]:[3,15];case 13:return e.sent(),[4,wt.attemptResourceWithToken(c,d,r)];case 14:return e.sent(),[2,c];case 15:return s&&g(c,s),[2]}})})},wt.attemptResourceWithToken=function(i,o,r){return gt(this,void 0,void 0,function(){var t,n;return mt(this,function(e){switch(e.label){case 0:return(t=r.getService(ft.ServiceProfile.AUTH1TOKEN.toString()))?[4,o(i,t)]:[3,3];case 1:return(n=e.sent())&&n.accessToken?[4,i.getData(n)]:[3,3];case 2:return e.sent(),[2,i];case 3:return[2]}})})},wt.loadExternalResourcesAuth09=function(i,o,r,s,a,l,c,u,d,h){return new Promise(function(e,t){var n=i.map(function(e){return wt.loadExternalResourceAuth09(e,o,r,s,a,l,c,u,d,h)});Promise.all(n).then(function(){e(i)}).catch(function(e){t(e)})})},wt.loadExternalResourceAuth09=function(i,o,r,s,a,l,c,u,d,e){return new Promise(function(t,n){e&&e.pessimisticAccessControl?i.getData().then(function(){i.isAccessControlled()?i.clickThroughService?(t(r(i)),t(s(i))):a(i).then(function(){l(i,!0).then(function(e){i.getData(e).then(function(){t(d(i))}).catch(function(e){n(wt.createInternalServerError(e))})}).catch(function(e){n(wt.createInternalServerError(e))})}).catch(function(e){n(wt.createInternalServerError(e))}):t(i)}).catch(function(e){n(wt.createInternalServerError(e))}):u(i,o).then(function(e){e?i.getData(e).then(function(){i.status===HTTPStatusCode.OK?t(d(i)):wt.authorize(i,o,r,s,a,l,c,u).then(function(){t(d(i))}).catch(function(e){n(wt.createAuthorizationFailedError())})}).catch(function(e){n(wt.createAuthorizationFailedError())}):wt.authorize(i,o,r,s,a,l,c,u).then(function(){t(d(i))}).catch(function(e){n(wt.createAuthorizationFailedError())})}).catch(function(e){n(wt.createAuthorizationFailedError())})})},wt.createError=function(e,t){var n=new Error;return n.message=t,n.name=e,n},wt.createAuthorizationFailedError=function(){return wt.createError(manifesto.StatusCodes.AUTHORIZATION_FAILED.toString(),"Authorization failed")},wt.createRestrictedError=function(){return wt.createError(manifesto.StatusCodes.RESTRICTED.toString(),"Restricted")},wt.createInternalServerError=function(e){return wt.createError(manifesto.StatusCodes.INTERNAL_SERVER_ERROR.toString(),e)},wt.authorize=function(i,o,r,s,a,l,c,e){return new Promise(function(t,n){i.getData().then(function(){i.isAccessControlled()?e(i,o).then(function(e){e?i.getData(e).then(function(){i.status===HTTPStatusCode.OK?t(i):wt.showAuthInteraction(i,o,r,s,a,l,c,t,n)}).catch(function(e){n(wt.createInternalServerError(e))}):l(i,!1).then(function(e){e?c(i,e,o).then(function(){i.getData(e).then(function(){i.status===HTTPStatusCode.OK?t(i):wt.showAuthInteraction(i,o,r,s,a,l,c,t,n)}).catch(function(e){n(wt.createInternalServerError(e))})}).catch(function(e){n(wt.createInternalServerError(e))}):wt.showAuthInteraction(i,o,r,s,a,l,c,t,n)})}).catch(function(e){n(wt.createInternalServerError(e))}):t(i)})})},wt.showAuthInteraction=function(t,n,e,i,o,r,s,a,l){t.status!==HTTPStatusCode.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?e(t).then(function(){r(t,!0).then(function(e){s(t,e,n).then(function(){t.getData(e).then(function(){a(t)}).catch(function(e){l(wt.createInternalServerError(e))})}).catch(function(e){l(wt.createInternalServerError(e))})}).catch(function(e){l(wt.createInternalServerError(e))})}):o(t).then(function(){r(t,!0).then(function(e){s(t,e,n).then(function(){t.getData(e).then(function(){a(t)}).catch(function(e){l(wt.createInternalServerError(e))})}).catch(function(e){l(wt.createInternalServerError(e))})}).catch(function(e){l(wt.createInternalServerError(e))})}):a(t)},wt.getService=function(e,t){var n=this.getServices(e);"string"!=typeof t&&(t=t.toString());for(var i=0;i<n.length;i++){var o=n[i];if(o.getProfile().toString()===t)return o}return null},wt.getResourceById=function(e,t){return wt.traverseAndFind(e.__jsonld,"@id",t)},wt.traverseAndFind=function(e,t,n){if(e.hasOwnProperty(t)&&e[t]===n)return e;for(var i=0;i<Object.keys(e).length;i++)if("object"==typeof e[Object.keys(e)[i]]){var o=wt.traverseAndFind(e[Object.keys(e)[i]],t,n);if(null!=o)return o}},wt.getServices=function(e){var t,n=[];if(!(t=e.__jsonld?e.__jsonld.service:e.service))return n;Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var o=t[i];if("string"==typeof o){var r=this.getResourceById(e.options.resource,o);r&&n.push(new ft.Service(r.__jsonld||r,e.options))}else n.push(new ft.Service(o,e.options))}return n},wt.getTemporalComponent=function(e){var t=/t=([^&]+)/g.exec(e),n=null;return t&&t[1]&&(n=t[1].split(",")),n},pt=wt,ft.Utils=pt,(Qt=Qt||{}).Language=Tt;var xt,St,Ct,Et,Pt,Rt;d=this&&this.__extends||(xt=function(e,t){return(xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}xt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function It(){return null!==Ct&&Ct.apply(this,arguments)||this}function _t(e){this.defaultLocale=e}function At(e,t){this.width=e,this.height=t}St=Qt=Qt||{},Ct=Array,d(It,Ct),It.parse=function(t,e){var n,i=[];if(!t)return i;if(Array.isArray(t))for(var o=0;o<t.length;o++){var r=t[o];n="string"==typeof r?new St.Language(r,e):new St.Language(r["@value"],r["@language"]||e),i.push(n)}else{if("string"==typeof t)return n=new St.Language(t,e),i.push(n),i;t["@value"]?(n=new St.Language(t["@value"],t["@language"]||e),i.push(n)):Object.keys(t).forEach(function(e){if(!t[e].length)throw new Error("language must have a value");n=new St.Language(t[e],e),i.push(n)})}return i},It.getValue=function(e,t){if(e.length){if(t){var n=e.filter(function(e){return e.locale===t||St.Utils.getInexactLocale(e.locale)===St.Utils.getInexactLocale(t)})[0];if(n)return n.value}return e[0].value}return null},Et=It,St.LanguageMap=Et,Pt=Qt=Qt||{},_t.prototype.parse=function(e){this.resource=e,this.label=Pt.LanguageMap.parse(this.resource.label,this.defaultLocale),this.value=Pt.LanguageMap.parse(this.resource.value,this.defaultLocale)},_t.prototype.getLabel=function(){return this.label?Pt.LanguageMap.getValue(this.label,this.defaultLocale):null},_t.prototype.setLabel=function(e){var t=this;if(this.label&&this.label.length){var n=this.label.filter(function(e){return e.locale===t.defaultLocale||e.locale===Pt.Utils.getInexactLocale(t.defaultLocale)})[0];n&&(n.value=e)}},_t.prototype.getValue=function(){if(this.value){var e=this.defaultLocale;return this.label&&this.label.length&&this.label[0].locale&&(e=this.label[0].locale),Pt.LanguageMap.getValue(this.value,e)}return null},_t.prototype.setValue=function(e){var t=this;if(this.value&&this.value.length){var n=this.value.filter(function(e){return e.locale===t.defaultLocale||e.locale===Pt.Utils.getInexactLocale(t.defaultLocale)})[0];n&&(n.value=e)}},Rt=_t,Pt.LabelValuePair=Rt,(Qt=Qt||{}).Size=At,e.manifesto=e.Manifesto=rn.exports={AnnotationMotivation:new Qt.AnnotationMotivation,Behavior:new Qt.Behavior,IIIFResourceType:new Qt.IIIFResourceType,LabelValuePair:Qt.LabelValuePair,Language:Qt.Language,LanguageMap:Qt.LanguageMap,ManifestType:new Qt.ManifestType,MediaType:new Qt.MediaType,RenderingFormat:new Qt.RenderingFormat,ResourceType:new Qt.ResourceType,ServiceProfile:new Qt.ServiceProfile,Size:Qt.Size,TreeNode:Qt.TreeNode,TreeNodeType:new Qt.TreeNodeType,Utils:Qt.Utils,ViewingDirection:new Qt.ViewingDirection,ViewingHint:new Qt.ViewingHint,Annotation:Qt.Annotation,AnnotationBody:Qt.AnnotationBody,AnnotationList:Qt.AnnotationList,AnnotationPage:Qt.AnnotationPage,Canvas:Qt.Canvas,Collection:Qt.Collection,Duration:Qt.Duration,Manifest:Qt.Manifest,Range:Qt.Range,Sequence:Qt.Sequence,Service:Qt.Service,Thumbnail:Qt.Thumbnail,Thumb:Qt.Thumb,StatusCodes:{AUTHORIZATION_FAILED:1,FORBIDDEN:2,INTERNAL_SERVER_ERROR:3,RESTRICTED:4},create:function(e,t){return Qt.Deserialiser.parse(e,t)},loadManifest:function(e){return Qt.Utils.loadResource(e)}};var Ot,kt,Dt,Mt;d=this&&this.__extends||(Ot=function(e,t){return(Ot=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Ot(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Ft(e,t){return Dt.call(this,e,t)||this}kt=Qt=Qt||{},Dt=kt.ManifestResource,d(Ft,Dt),Ft.prototype.getBody=function(){var e=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var n=0;n<t.length;n++)if((r=t[n]).items)for(var i=0;i<r.items.length;i++){var o=r.items[i];e.push(new kt.AnnotationBody(o,this.options))}else e.push(new kt.AnnotationBody(r,this.options));else if(t.items)for(n=0;n<t.items.length;n++){var r=t.items[n];e.push(new kt.AnnotationBody(r,this.options))}else e.push(new kt.AnnotationBody(t,this.options));return e},Ft.prototype.getMotivation=function(){var e=this.getProperty("motivation");return e?new kt.AnnotationMotivation(e.toLowerCase()):null},Ft.prototype.getOn=function(){return this.getProperty("on")},Ft.prototype.getTarget=function(){return this.getProperty("target")},Ft.prototype.getResource=function(){return new kt.Resource(this.getProperty("resource"),this.options)},Mt=Ft,kt.Annotation=Mt;var Lt,Nt,Ht,Bt;d=this&&this.__extends||(Lt=function(e,t){return(Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Lt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function zt(e,t){return Ht.call(this,e,t)||this}Nt=Qt=Qt||{},Ht=Nt.ManifestResource,d(zt,Ht),zt.prototype.getFormat=function(){var e=this.getProperty("format");return e?new Nt.MediaType(Nt.Utils.getMediaType(e)):null},zt.prototype.getType=function(){return this.getProperty("type")?new Nt.ResourceType(Nt.Utils.normaliseType(this.getProperty("type"))):null},zt.prototype.getWidth=function(){return this.getProperty("width")},zt.prototype.getHeight=function(){return this.getProperty("height")},Bt=zt,Nt.AnnotationBody=Bt;var jt,Ut,Vt,qt;d=this&&this.__extends||(jt=function(e,t){return(jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}jt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Gt(e,t,n){var i=Vt.call(this,t)||this;return i.label=e,i.options=n,i}Ut=Qt=Qt||{},Vt=Ut.JSONLDResource,d(Gt,Vt),Gt.prototype.getIIIFResourceType=function(){return new Ut.IIIFResourceType(Ut.Utils.normaliseType(this.getProperty("type")))},Gt.prototype.getLabel=function(){return this.label},Gt.prototype.getResources=function(){var t=this;return this.getProperty("resources").map(function(e){return new Ut.Annotation(e,t.options)})},Gt.prototype.load=function(){var i=this;return new Promise(function(t,e){if(i.isLoaded)t(i);else{var n=i.__jsonld.id;n=n||i.__jsonld["@id"],Ut.Utils.loadResource(n).then(function(e){i.__jsonld=JSON.parse(e),i.context=i.getProperty("context"),i.id=i.getProperty("id"),i.isLoaded=!0,t(i)}).catch(e)}})},qt=Gt,Ut.AnnotationList=qt;var Wt,$t,Xt,Yt;d=this&&this.__extends||(Wt=function(e,t){return(Wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Wt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function Zt(e,t){return Xt.call(this,e,t)||this}$t=Qt=Qt||{},Xt=$t.ManifestResource,d(Zt,Xt),Zt.prototype.getItems=function(){return this.getProperty("items")},Yt=Zt,$t.AnnotationPage=Yt;var Kt,Qt,Jt,en,tn;d=this&&this.__extends||(Kt=function(e,t){return(Kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Kt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function nn(e,t){return en.call(this,e,t)||this}Jt=Qt=Qt||{},en=Jt.Resource,d(nn,en),tn=nn,Jt.Thumbnail=tn}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{http:30,https:9,url:36}],2:[function(e,t,n){"use strict";n.byteLength=function(e){var t=d(e),n=t[0],i=t[1];return 3*(n+i)/4-i},n.toByteArray=function(e){for(var t,n=d(e),i=n[0],o=n[1],r=new u(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),s=0,a=0<o?i-4:i,l=0;l<a;l+=4)t=c[e.charCodeAt(l)]<<18|c[e.charCodeAt(l+1)]<<12|c[e.charCodeAt(l+2)]<<6|c[e.charCodeAt(l+3)],r[s++]=t>>16&255,r[s++]=t>>8&255,r[s++]=255&t;2===o&&(t=c[e.charCodeAt(l)]<<2|c[e.charCodeAt(l+1)]>>4,r[s++]=255&t);1===o&&(t=c[e.charCodeAt(l)]<<10|c[e.charCodeAt(l+1)]<<4|c[e.charCodeAt(l+2)]>>2,r[s++]=t>>8&255,r[s++]=255&t);return r},n.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],r=0,s=n-i;r<s;r+=16383)o.push(l(e,r,s<r+16383?s:r+16383));1==i?(t=e[n-1],o.push(a[t>>2]+a[t<<4&63]+"==")):2==i&&(t=(e[n-2]<<8)+e[n-1],o.push(a[t>>10]+a[t>>4&63]+a[t<<2&63]+"="));return o.join("")};for(var a=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,r=i.length;o<r;++o)a[o]=i[o],c[i.charCodeAt(o)]=o;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,r=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),r.push(a[(o=i)>>18&63]+a[o>>12&63]+a[o>>6&63]+a[63&o]);return r.join("")}c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},{}],3:[function(e,t,n){},{}],4:[function(e,k,D){(function(O){!function(e){var t="object"==typeof D&&D&&!D.nodeType&&D,n="object"==typeof k&&k&&!k.nodeType&&k,i="object"==typeof O&&O;i.global!==i&&i.window!==i&&i.self!==i||(e=i);var o,r,v=2147483647,b=36,y=1,w=26,s=38,a=700,T=72,x=128,S="-",l=/^xn--/,c=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=b-y,C=Math.floor,E=String.fromCharCode;function P(e){throw new RangeError(d[e])}function f(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function p(e,t){var n=e.split("@"),i="";return 1<n.length&&(i=n[0]+"@",e=n[1]),i+f((e=e.replace(u,".")).split("."),t).join(".")}function R(e){for(var t,n,i=[],o=0,r=e.length;o<r;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<r?56320==(64512&(n=e.charCodeAt(o++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),o--):i.push(t);return i}function I(e){return f(e,function(e){var t="";return 65535<e&&(t+=E((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=E(e)}).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function A(e,t,n){var i=0;for(e=n?C(e/a):e>>1,e+=C(e/t);h*w>>1<e;i+=b)e=C(e/h);return C(i+(h+1)*e/(e+s))}function g(e){var t,n,i,o,r,s,a,l,c,u,d,h=[],f=e.length,p=0,g=x,m=T;for((n=e.lastIndexOf(S))<0&&(n=0),i=0;i<n;++i)128<=e.charCodeAt(i)&&P("not-basic"),h.push(e.charCodeAt(i));for(o=0<n?n+1:0;o<f;){for(r=p,s=1,a=b;f<=o&&P("invalid-input"),d=e.charCodeAt(o++),(b<=(l=d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:b)||l>C((v-p)/s))&&P("overflow"),p+=l*s,!(l<(c=a<=m?y:m+w<=a?w:a-m));a+=b)s>C(v/(u=b-c))&&P("overflow"),s*=u;m=A(p-r,t=h.length+1,0==r),C(p/t)>v-g&&P("overflow"),g+=C(p/t),p%=t,h.splice(p++,0,g)}return I(h)}function m(e){var t,n,i,o,r,s,a,l,c,u,d,h,f,p,g,m=[];for(h=(e=R(e)).length,t=x,r=T,s=n=0;s<h;++s)(d=e[s])<128&&m.push(E(d));for(i=o=m.length,o&&m.push(S);i<h;){for(a=v,s=0;s<h;++s)t<=(d=e[s])&&d<a&&(a=d);for(a-t>C((v-n)/(f=i+1))&&P("overflow"),n+=(a-t)*f,t=a,s=0;s<h;++s)if((d=e[s])<t&&++n>v&&P("overflow"),d==t){for(l=n,c=b;!(l<(u=c<=r?y:r+w<=c?w:c-r));c+=b)g=l-u,p=b-u,m.push(E(_(u+g%p,0))),l=C(g/p);m.push(E(_(l,0))),r=A(n,f,i==o),n=0,++i}++n,++t}return m.join("")}if(o={version:"1.4.1",ucs2:{decode:R,encode:I},decode:g,encode:m,toASCII:function(e){return p(e,function(e){return c.test(e)?"xn--"+m(e):e})},toUnicode:function(e){return p(e,function(e){return l.test(e)?g(e.slice(4).toLowerCase()):e})}},t&&n)if(k.exports==t)n.exports=o;else for(r in o)o.hasOwnProperty(r)&&(t[r]=o[r]);else e.punycode=o}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(N,e,H){(function(e){"use strict";var i=N("base64-js"),r=N("ieee754"),s=N("isarray");function n(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,n){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,n);if("number"!=typeof e)return o(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}function o(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=u(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!d.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),o=(e=a(e,i)).write(t,n);o!==i&&(e=e.slice(0,o));return e}(e,t,n):function(e,t){if(d.isBuffer(t)){var n=0|h(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):u(e,t);if("Buffer"===t.type&&s(t.data))return u(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t){if(l(t),e=a(e,t<0?0:0|h(t)),!d.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|h(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function h(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return M(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(i)return M(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function g(e,t,n,i,o){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=d.from(t,i)),d.isBuffer(t))return 0===t.length?-1:m(e,t,n,i,o);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,i,o);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,i,o){var r,s=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a/=s=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var u=-1;for(r=n;r<a;r++)if(c(e,r)===c(t,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===l)return u*s}else-1!==u&&(r-=r-u),u=-1}else for(a<n+l&&(n=a-l),r=n;0<=r;r--){for(var d=!0,h=0;h<l;h++)if(c(e,r+h)!==c(t,h)){d=!1;break}if(d)return r}return-1}function v(e,t,n,i){n=Number(n)||0;var o=e.length-n;i?o<(i=Number(i))&&(i=o):i=o;var r=t.length;if(r%2!=0)throw new TypeError("Invalid hex string");r/2<i&&(i=r/2);for(var s=0;s<i;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function b(e,t,n,i){return L(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function y(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function w(e,t,n){n=Math.min(e.length,n);for(var i=[],o=t;o<n;){var r,s,a,l,c=e[o],u=null,d=239<c?4:223<c?3:191<c?2:1;if(o+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(r=e[o+1]))&&127<(l=(31&c)<<6|63&r)&&(u=l);break;case 3:r=e[o+1],s=e[o+2],128==(192&r)&&128==(192&s)&&2047<(l=(15&c)<<12|(63&r)<<6|63&s)&&(l<55296||57343<l)&&(u=l);break;case 4:r=e[o+1],s=e[o+2],a=e[o+3],128==(192&r)&&128==(192&s)&&128==(192&a)&&65535<(l=(15&c)<<18|(63&r)<<12|(63&s)<<6|63&a)&&l<1114112&&(u=l)}null===u?(u=65533,d=1):65535<u&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),o+=d}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=T));return n}(i)}H.Buffer=d,H.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},H.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),H.kMaxLength=n(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,n){return o(null,e,t,n)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,n){return function(e,t,n,i){return l(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},d.allocUnsafe=function(e){return c(null,e)},d.allocUnsafeSlow=function(e){return c(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,o=0,r=Math.min(n,i);o<r;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var n;if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;var i=d.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var r=e[n];if(!d.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,o),o+=r.length}return i},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?w(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return C(this,t,n);case"utf8":case"utf-8":return w(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return y(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=H.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,n,i,o){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(o<=i&&n<=t)return 0;if(o<=i)return-1;if(n<=t)return 1;if(this===e)return 0;for(var r=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(r,s),l=this.slice(i,o),c=e.slice(t,n),u=0;u<a;++u)if(l[u]!==c[u]){r=l[u],s=c[u];break}return r<s?-1:s<r?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},d.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var o=this.length-t;if((void 0===n||o<n)&&(n=o),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i=i||"utf8";for(var r,s,a,l,c,u,d,h,f,p=!1;;)switch(i){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return h=t,f=n,L(M(e,(d=this).length-h),d,h,f);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return b(this,e,t,n);case"base64":return l=this,c=t,u=n,L(F(e),l,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s=t,a=n,L(function(e,t){for(var n,i,o,r=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),i=n>>8,o=n%256,r.push(o),r.push(i);return r}(e,(r=this).length-s),r,s,a);default:if(p)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),p=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function x(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(127&e[o]);return i}function S(e,t,n){var i="";n=Math.min(e.length,n);for(var o=t;o<n;++o)i+=String.fromCharCode(e[o]);return i}function C(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||i<n)&&(n=i);for(var o="",r=t;r<n;++r)o+=D(e[r]);return o}function E(e,t,n){for(var i=e.slice(t,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,i,o,r){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<t||t<r)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function I(e,t,n,i){t<0&&(t=65535+t+1);for(var o=0,r=Math.min(e.length-n,2);o<r;++o)e[n+o]=(t&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function _(e,t,n,i){t<0&&(t=4294967295+t+1);for(var o=0,r=Math.min(e.length-n,4);o<r;++o)e[n+o]=t>>>8*(i?o:3-o)&255}function A(e,t,n,i){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(e,t,n,i,o){return o||A(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function k(e,t,n,i,o){return o||A(e,0,n,8),r.write(e,t,n,i,52,8),n+8}d.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):i<e&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):i<t&&(t=i),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=d.prototype;else{var o=t-e;n=new d(o,void 0);for(var r=0;r<o;++r)n[r]=this[r+e]}return n},d.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return i},d.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e+--t],o=1;0<t&&(o*=256);)i+=this[e+--t]*o;return i},d.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],o=1,r=0;++r<t&&(o*=256);)i+=this[e+r]*o;return(o*=128)<=i&&(i-=Math.pow(2,8*t)),i},d.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=t,o=1,r=this[e+--i];0<i&&(o*=256);)r+=this[e+--i]*o;return(o*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,r=0;for(this[t]=255&e;++r<n&&(o*=256);)this[t+r]=e/o&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||R(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,r=1;for(this[t+o]=255&e;0<=--o&&(r*=256);)this[t+o]=e/r&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):_(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var r=0,s=1,a=0;for(this[t]=255&e;++r<n&&(s*=256);)e<0&&0===a&&0!==this[t+r-1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+n},d.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var o=Math.pow(2,8*n-1);R(this,e,t,n,o-1,-o)}var r=n-1,s=1,a=0;for(this[t+r]=255&e;0<=--r&&(s*=256);)e<0&&0===a&&0!==this[t+r+1]&&(a=1),this[t+r]=(e/s>>0)-a&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):_(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):_(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,n){return O(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return O(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return k(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return k(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,i){if(n=n||0,i||0===i||(i=this.length),t>=e.length&&(t=e.length),t=t||0,0<i&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var o,r=i-n;if(this===e&&n<t&&t<i)for(o=r-1;0<=o;--o)e[o+t]=this[o+n];else if(r<1e3||!d.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+r),t);return r},d.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!d.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var r;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(r=t;r<n;++r)this[r]=e;else{var s=d.isBuffer(e)?e:M(new d(e,i).toString()),a=s.length;for(r=0;r<n-t;++r)this[r+t]=s[r%a]}return this};var t=/[^+\/0-9A-Za-z-_]/g;function D(e){return e<16?"0"+e.toString(16):e.toString(16)}function M(e,t){var n;t=t||1/0;for(var i=e.length,o=null,r=[],s=0;s<i;++s){if(55295<(n=e.charCodeAt(s))&&n<57344){if(!o){if(56319<n){-1<(t-=3)&&r.push(239,191,189);continue}if(s+1===i){-1<(t-=3)&&r.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(t-=3)&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(t-=3)&&r.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;r.push(n)}else if(n<2048){if((t-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function F(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function L(e,t,n,i){for(var o=0;o<i&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":2,ieee754:10,isarray:13}],6:[function(e,t,n){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],7:[function(e,t,n){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":12}],8:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function l(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}((t.exports=i).EventEmitter=i).prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,r,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||c(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var a=new Error('Uncaught, unspecified "error" event. ('+t+")");throw a.context=t,a}if(u(n=this._events[e]))return!1;if(l(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),n.apply(this,o)}else if(c(n))for(o=Array.prototype.slice.call(arguments,1),i=(s=n.slice()).length,r=0;r<i;r++)s[r].apply(this,o);return!0},i.prototype.on=i.prototype.addListener=function(e,t){var n;if(!l(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,l(t.listener)?t.listener:t),this._events[e]?c(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,c(this._events[e])&&!this._events[e].warned&&(n=u(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.once=function(e,t){if(!l(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},i.prototype.removeListener=function(e,t){var n,i,o,r;if(!l(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,i=-1,n===t||l(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(c(n)){for(r=o;0<r--;)if(n[r]===t||n[r].listener&&n[r].listener===t){i=r;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(l(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?l(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(l(t))return 1;if(t)return t.length}return 0},i.listenerCount=function(e,t){return e.listenerCount(t)}},{}],9:[function(e,t,n){var i=e("http"),o=t.exports;for(var r in i)i.hasOwnProperty(r)&&(o[r]=i[r]);o.request=function(e,t){return(e=e||{}).scheme="https",e.protocol="https:",i.request.call(this,e,t)}},{http:30}],10:[function(e,t,n){n.read=function(e,t,n,i,o){var r,s,a=8*o-i-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?o-1:0,h=n?-1:1,f=e[t+d];for(d+=h,r=f&(1<<-u)-1,f>>=-u,u+=a;0<u;r=256*r+e[t+d],d+=h,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=i;0<u;s=256*s+e[t+d],d+=h,u-=8);if(0===r)r=1-c;else{if(r===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),r-=c}return(f?-1:1)*s*Math.pow(2,r-i)},n.write=function(e,t,n,i,o,r){var s,a,l,c=8*r-o-1,u=(1<<c)-1,d=u>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:r-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),2<=(t+=1<=s+d?h/l:h*Math.pow(2,1-d))*l&&(s++,l/=2),u<=s+d?(a=0,s=u):1<=s+d?(a=(t*l-1)*Math.pow(2,o),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,o),s=0));8<=o;e[n+f]=255&a,f+=p,a/=256,o-=8);for(s=s<<o|a,c+=o;0<c;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*g}},{}],11:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],12:[function(e,t,n){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(i(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))}(e)||!!e._isBuffer)}},{}],13:[function(e,t,n){var i={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},{}],14:[function(e,t,n){var i,o,r=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(e){i=s}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var c,u=[],d=!1,h=-1;function f(){d&&c&&(d=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!d){var e=l(f);d=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,d=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new g(e,t)),1!==u.length||d||l(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},{}],15:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var r=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var a,l,c=e.length;0<s&&s<c&&(c=s);for(var u=0;u<c;++u){var d,h,f,p,g=e[u].replace(r,"%20"),m=g.indexOf(n);h=0<=m?(d=g.substr(0,m),g.substr(m+1)):(d=g,""),f=decodeURIComponent(d),p=decodeURIComponent(h),a=o,l=f,Object.prototype.hasOwnProperty.call(a,l)?v(o[f])?o[f].push(p):o[f]=[o[f],p]:o[f]=p}return o};var v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],16:[function(e,t,n){"use strict";function r(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}t.exports=function(n,i,o,e){return i=i||"&",o=o||"=",null===n&&(n=void 0),"object"==typeof n?a(l(n),function(e){var t=encodeURIComponent(r(e))+o;return s(n[e])?a(n[e],function(e){return t+encodeURIComponent(r(e))}).join(i):t+encodeURIComponent(r(n[e]))}).join(i):e?encodeURIComponent(r(e))+o+encodeURIComponent(r(n)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var l=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],17:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":15,"./encode":16}],18:[function(e,t,n){"use strict";var i=e("process-nextick-args"),o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=d;var r=e("core-util-is");r.inherits=e("inherits");var s=e("./_stream_readable"),a=e("./_stream_writable");r.inherits(d,s);for(var l=o(a.prototype),c=0;c<l.length;c++){var u=l[c];d.prototype[u]||(d.prototype[u]=a.prototype[u])}function d(e){if(!(this instanceof d))return new d(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||i.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},{"./_stream_readable":20,"./_stream_writable":22,"core-util-is":7,inherits:11,"process-nextick-args":26}],19:[function(e,t,n){"use strict";t.exports=r;var i=e("./_stream_transform"),o=e("core-util-is");function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}o.inherits=e("inherits"),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":21,"core-util-is":7,inherits:11}],20:[function(D,M,e){(function(g,e){"use strict";var m=D("process-nextick-args");M.exports=h;var s,v=D("isarray");h.ReadableState=r;function b(e,t){return e.listeners(t).length}D("events").EventEmitter;var o=D("./internal/streams/stream"),a=D("safe-buffer").Buffer,l=e.Uint8Array||function(){};var t=D("core-util-is");t.inherits=D("inherits");var n=D("util"),y=void 0;y=n&&n.debuglog?n.debuglog("stream"):function(){};var c,u=D("./internal/streams/BufferList"),i=D("./internal/streams/destroy");t.inherits(h,o);var d=["error","close","destroy","pause","resume"];function r(e,t){e=e||{};var n=t instanceof(s=s||D("./_stream_duplex"));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(o||0===o)?o:r,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new u,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c=c||D("string_decoder/").StringDecoder,this.decoder=new c(e.encoding),this.encoding=e.encoding)}function h(e){if(s=s||D("./_stream_duplex"),!(this instanceof h))return new h(e);this._readableState=new r(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function f(e,t,n,i,o){var r,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,x(e)}(e,s)):(o||(r=function(e,t){var n;(function(e){return a.isBuffer(e)||e instanceof l})(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(s,t)),r?e.emit("error",r):s.objectMode||t&&0<t.length?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),i?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):p(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(t=s.decoder.write(t),s.objectMode||0!==t.length?p(e,s,t,!1):C(e,s)):p(e,s,t,!1))):i||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function p(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&x(e)),C(e,t)}Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),h.prototype.destroy=i.destroy,h.prototype._undestroy=i.undestroy,h.prototype._destroy=function(e,t){this.push(null),t(e)},h.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=a.from(e,t),t=""),n=!0),f(this,e,t,!1,n)},h.prototype.unshift=function(e){return f(this,e,null,!0,!1)},h.prototype.isPaused=function(){return!1===this._readableState.flowing},h.prototype.setEncoding=function(e){return c=c||D("string_decoder/").StringDecoder,this._readableState.decoder=new c(e),this._readableState.encoding=e,this};var w=8388608;function T(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return w<=e?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function x(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(y("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?m.nextTick(S,e):S(e))}function S(e){y("emit readable"),e.emit("readable"),I(e)}function C(e,t){t.readingMore||(t.readingMore=!0,m.nextTick(E,e,t))}function E(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(y("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function P(e){y("readable nexttick read 0"),e.read(0)}function R(e,t){t.reading||(y("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),I(e),t.flowing&&!t.reading&&e.read(0)}function I(e){var t=e._readableState;for(y("flow",t.flowing);t.flowing&&null!==e.read(););}function _(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,i=1,o=n.data;e-=o.length;for(;n=n.next;){var r=n.data,s=e>r.length?r.length:e;if(s===r.length?o+=r:o+=r.slice(0,e),0===(e-=s)){s===r.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=r.slice(s);break}++i}return t.length-=i,o}(e,t):function(e,t){var n=a.allocUnsafe(e),i=t.head,o=1;i.data.copy(n),e-=i.data.length;for(;i=i.next;){var r=i.data,s=e>r.length?r.length:e;if(r.copy(n,n.length-e,0,s),0===(e-=s)){s===r.length?(++o,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i).data=r.slice(s);break}++o}return t.length-=o,n}(e,t);return i}(e,t.buffer,t.decoder),n);var n}function A(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,m.nextTick(O,t,e))}function O(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function k(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}h.prototype.read=function(e){y("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return y("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?A(this):x(this),null;if(0===(e=T(e,t))&&t.ended)return 0===t.length&&A(this),null;var i,o=t.needReadable;return y("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&y("length less than watermark",o=!0),t.ended||t.reading?y("reading or ended",o=!1):o&&(y("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=T(n,t))),null===(i=0<e?_(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&A(this)),null!==i&&this.emit("data",i),i},h.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},h.prototype.pipe=function(n,e){var i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=n;break;case 1:o.pipes=[o.pipes,n];break;default:o.pipes.push(n)}o.pipesCount+=1,y("pipe count=%d opts=%j",o.pipesCount,e);var t=(!e||!1!==e.end)&&n!==g.stdout&&n!==g.stderr?s:p;function r(e,t){y("onunpipe"),e===i&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,y("cleanup"),n.removeListener("close",h),n.removeListener("finish",f),n.removeListener("drain",a),n.removeListener("error",d),n.removeListener("unpipe",r),i.removeListener("end",s),i.removeListener("end",p),i.removeListener("data",u),l=!0,!o.awaitDrain||n._writableState&&!n._writableState.needDrain||a())}function s(){y("onend"),n.end()}o.endEmitted?m.nextTick(t):i.once("end",t),n.on("unpipe",r);var a=function(t){return function(){var e=t._readableState;y("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&b(t,"data")&&(e.flowing=!0,I(t))}}(i);n.on("drain",a);var l=!1;var c=!1;function u(e){y("ondata"),(c=!1)!==n.write(e)||c||((1===o.pipesCount&&o.pipes===n||1<o.pipesCount&&-1!==k(o.pipes,n))&&!l&&(y("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,c=!0),i.pause())}function d(e){y("onerror",e),p(),n.removeListener("error",d),0===b(n,"error")&&n.emit("error",e)}function h(){n.removeListener("finish",f),p()}function f(){y("onfinish"),n.removeListener("close",h),p()}function p(){y("unpipe"),i.unpipe(n)}return i.on("data",u),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?v(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(n,"error",d),n.once("close",h),n.once("finish",f),n.emit("pipe",i),o.flowing||(y("pipe resume"),i.resume()),n},h.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<o;r++)i[r].emit("unpipe",this,n);return this}var s=k(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},h.prototype.addListener=h.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&x(this):m.nextTick(P,this))}return n},h.prototype.resume=function(){var e=this._readableState;return e.flowing||(y("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,m.nextTick(R,e,t))}(this,e)),this},h.prototype.pause=function(){return y("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(y("pause"),this._readableState.flowing=!1,this.emit("pause")),this},h.prototype.wrap=function(t){var n=this,i=this._readableState,o=!1;for(var e in t.on("end",function(){if(y("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),t.on("data",function(e){y("wrapped data"),i.decoder&&(e=i.decoder.write(e)),i.objectMode&&null==e||(i.objectMode||e&&e.length)&&(n.push(e)||(o=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var r=0;r<d.length;r++)t.on(d[r],this.emit.bind(this,d[r]));return this._read=function(e){y("wrapped _read",e),o&&(o=!1,t.resume())},this},Object.defineProperty(h.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),h._fromList=_}).call(this,D("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":18,"./internal/streams/BufferList":23,"./internal/streams/destroy":24,"./internal/streams/stream":25,_process:14,"core-util-is":7,events:8,inherits:11,isarray:13,"process-nextick-args":26,"safe-buffer":29,"string_decoder/":27,util:3}],21:[function(e,t,n){"use strict";t.exports=r;var i=e("./_stream_duplex"),o=e("core-util-is");function r(e){if(!(this instanceof r))return new r(e);i.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=t&&this.push(t),i(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var n=this;"function"==typeof this._flush?this._flush(function(e,t){a(n,e,t)}):a(this,null,null)}function a(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}o.inherits=e("inherits"),o.inherits(r,i),r.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},r.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},r.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var o=this._readableState;(i.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},r.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},r.prototype._destroy=function(e,t){var n=this;i.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":18,"core-util-is":7,inherits:11}],22:[function(S,C,e){(function(e,t,n){"use strict";var a=S("process-nextick-args");function d(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;e.entry=null;for(;i;){var o=i.callback;t.pendingcb--,o(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}C.exports=m;var l,c=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?n:a.nextTick;m.WritableState=g;var i=S("core-util-is");i.inherits=S("inherits");var o={deprecate:S("util-deprecate")},r=S("./internal/streams/stream"),u=S("safe-buffer").Buffer,s=t.Uint8Array||function(){};var h,f=S("./internal/streams/destroy");function p(){}function g(e,t){l=l||S("./_stream_duplex"),e=e||{};var n=t instanceof l;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,o=e.writableHighWaterMark,r=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(o||0===o)?o:r,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,o){--t.pendingcb,n?(a.nextTick(o,i),a.nextTick(x,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),x(e,t))}(e,n,i,t,o);else{var r=w(n);r||n.corked||n.bufferProcessing||!n.bufferedRequest||y(e,n),i?c(b,e,n,r,o):b(e,n,r,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new d(this)}function m(e){if(l=l||S("./_stream_duplex"),!(h.call(m,this)||this instanceof l))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),r.call(this)}function v(e,t,n,i,o,r,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,r,t.onwrite),t.sync=!1}function b(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),x(e,t)}function y(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var i=t.bufferedRequestCount,o=new Array(i),r=t.corkedRequestsFree;r.entry=n;for(var s=0,a=!0;n;)(o[s]=n).isBuf||(a=!1),n=n.next,s+=1;o.allBuffers=a,v(e,t,!0,t.length,o,"",r.finish),t.pendingcb++,t.lastBufferedRequest=null,r.next?(t.corkedRequestsFree=r.next,r.next=null):t.corkedRequestsFree=new d(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,c=n.encoding,u=n.callback;if(v(e,t,!1,t.objectMode?1:l.length,l,c,u),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(t,n){t._final(function(e){n.pendingcb--,e&&t.emit("error",e),n.prefinished=!0,t.emit("prefinish"),x(t,n)})}function x(e,t){var n=w(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}i.inherits(m,r),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:o.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):h=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,n){var i=this._writableState,o=!1,r=!i.objectMode&&function(e){return u.isBuffer(e)||e instanceof s}(e);return r&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"==typeof t&&(n=t,t=null),t=r?"buffer":t||i.defaultEncoding,"function"!=typeof n&&(n=p),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),a.nextTick(t,n)}(this,n):(r||function(e,t,n,i){var o=!0,r=!1;return null===n?r=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r&&(e.emit("error",r),a.nextTick(i,r),o=!1),o}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,i,o,r){if(!n){var s=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=u.from(t,n));return t}(t,i,o);i!==s&&(n=!0,o="buffer",i=s)}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:o,isBuf:n,callback:r,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,a,i,o,r);return l}(this,i,r,e,t,n)),o},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||y(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,x(e,t),n&&(t.finished?a.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=f.destroy,m.prototype._undestroy=f.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,S("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},S("timers").setImmediate)},{"./_stream_duplex":18,"./internal/streams/destroy":24,"./internal/streams/stream":25,_process:14,"core-util-is":7,inherits:11,"process-nextick-args":26,"safe-buffer":29,timers:34,"util-deprecate":38}],23:[function(e,t,n){"use strict";var a=e("safe-buffer").Buffer,i=e("util");function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.head=null,this.tail=null,this.length=0}t.exports=(o.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},o.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},o.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},o.prototype.clear=function(){this.head=this.tail=null,this.length=0},o.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},o.prototype.concat=function(e){if(0===this.length)return a.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,o=a.allocUnsafe(e>>>0),r=this.head,s=0;r;)t=r.data,n=o,i=s,t.copy(n,i),s+=r.data.length,r=r.next;return o},o),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":29,util:3}],24:[function(e,t,n){"use strict";var r=e("process-nextick-args");function s(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var n=this,i=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return i||o?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(s,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(r.nextTick(s,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":26}],25:[function(e,t,n){t.exports=e("events").EventEmitter},{events:8}],26:[function(e,t,n){(function(a){"use strict";!a.version||0===a.version.indexOf("v0.")||0===a.version.indexOf("v1.")&&0!==a.version.indexOf("v1.8.")?t.exports={nextTick:function(e,t,n,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,r,s=arguments.length;switch(s){case 0:case 1:return a.nextTick(e);case 2:return a.nextTick(function(){e.call(null,t)});case 3:return a.nextTick(function(){e.call(null,t,n)});case 4:return a.nextTick(function(){e.call(null,t,n,i)});default:for(o=new Array(s-1),r=0;r<o.length;)o[r++]=arguments[r];return a.nextTick(function(){e.apply(null,o)})}}}:t.exports=a}).call(this,e("_process"))},{_process:14}],27:[function(e,t,n){"use strict";var i=e("safe-buffer").Buffer,o=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===o||!o(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(55296<=i&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0==n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}(n.StringDecoder=r).prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},r.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},r.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var o=s(t[i]);if(0<=o)return 0<o&&(e.lastNeed=o-1),o;if(--i<n||-2===o)return 0;if(0<=(o=s(t[i])))return 0<o&&(e.lastNeed=o-2),o;if(--i<n||-2===o)return 0;if(0<=(o=s(t[i])))return 0<o&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},r.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":29}],28:[function(e,t,n){(((n=t.exports=e("./lib/_stream_readable.js")).Stream=n).Readable=n).Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":18,"./lib/_stream_passthrough.js":19,"./lib/_stream_readable.js":20,"./lib/_stream_transform.js":21,"./lib/_stream_writable.js":22}],29:[function(e,t,n){var i=e("buffer"),o=i.Buffer;function r(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?t.exports=i:(r(i,n),n.Buffer=s),r(o,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=o(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:5}],30:[function(n,e,o){(function(l){var c=n("./lib/request"),e=n("./lib/response"),u=n("xtend"),t=n("builtin-status-codes"),d=n("url"),i=o;i.request=function(e,t){e="string"==typeof e?d.parse(e):u(e);var n=-1===l.location.protocol.search(/^https?:$/)?"http:":"",i=e.protocol||n,o=e.hostname||e.host,r=e.port,s=e.path||"/";o&&-1!==o.indexOf(":")&&(o="["+o+"]"),e.url=(o?i+"//"+o:"")+(r?":"+r:"")+s,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var a=new c(e);return t&&a.on("response",t),a},i.get=function(e,t){var n=i.request(e,t);return n.end(),n},i.ClientRequest=c,i.IncomingMessage=e.IncomingMessage,i.Agent=function(){},i.Agent.defaultMaxSockets=4,i.globalAgent=new i.Agent,i.STATUS_CODES=t,i.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":32,"./lib/response":33,"builtin-status-codes":6,url:36,xtend:39}],31:[function(e,t,a){(function(e){a.fetch=s(e.fetch)&&s(e.ReadableStream),a.writableStream=s(e.WritableStream),a.abortController=s(e.AbortController),a.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),a.blobConstructor=!0}catch(e){}var t;function n(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function i(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var o=void 0!==e.ArrayBuffer,r=o&&s(e.ArrayBuffer.prototype.slice);function s(e){return"function"==typeof e}a.arraybuffer=a.fetch||o&&i("arraybuffer"),a.msstream=!a.fetch&&r&&i("ms-stream"),a.mozchunkedarraybuffer=!a.fetch&&o&&i("moz-chunked-arraybuffer"),a.overrideMimeType=a.fetch||!!n()&&s(n().overrideMimeType),a.vbArray=s(e.VBArray),t=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(s,a,e){(function(l,c,u){var d=s("./capability"),e=s("inherits"),t=s("./response"),o=s("readable-stream"),h=s("to-arraybuffer"),n=t.IncomingMessage,f=t.readyStates;var i=a.exports=function(t){var e,n=this;o.Writable.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+new u(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){n.setHeader(e,t.headers[e])});var i=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!d.abortController)e=!(i=!1);else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!d.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=function(e,t){return d.fetch&&t?"fetch":d.mozchunkedarraybuffer?"moz-chunked-arraybuffer":d.msstream?"ms-stream":d.arraybuffer&&e?"arraybuffer":d.vbArray&&e?"text:vbarray":"text"}(e,i),n._fetchTimer=null,n.on("finish",function(){n._onFinish()})};e(i,o.Writable),i.prototype.setHeader=function(e,t){var n=e.toLowerCase();-1===r.indexOf(n)&&(this._headers[n]={name:e,value:t})},i.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},i.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},i.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts,i=t._headers,n=null;"GET"!==e.method&&"HEAD"!==e.method&&(n=d.arraybuffer?h(u.concat(t._body)):d.blobConstructor?new c.Blob(t._body.map(function(e){return h(e)}),{type:(i["content-type"]||{}).value||""}):u.concat(t._body).toString());var o=[];if(Object.keys(i).forEach(function(e){var t=i[e].name,n=i[e].value;Array.isArray(n)?n.forEach(function(e){o.push([t,e])}):o.push([t,n])}),"fetch"===t._mode){var r=null;if(d.abortController){var s=new AbortController;r=s.signal,t._fetchAbortController=s,"requestTimeout"in e&&0!==e.requestTimeout&&(t._fetchTimer=c.setTimeout(function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()},e.requestTimeout))}c.fetch(t._opts.url,{method:t._opts.method,headers:o,body:n||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:r}).then(function(e){t._fetchResponse=e,t._connect()},function(e){c.clearTimeout(t._fetchTimer),t._destroyed||t.emit("error",e)})}else{var a=t._xhr=new c.XMLHttpRequest;try{a.open(t._opts.method,t._opts.url,!0)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}"responseType"in a&&(a.responseType=t._mode.split(":")[0]),"withCredentials"in a&&(a.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in a&&a.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(a.timeout=e.requestTimeout,a.ontimeout=function(){t.emit("requestTimeout")}),o.forEach(function(e){a.setRequestHeader(e[0],e[1])}),t._response=null,a.onreadystatechange=function(){switch(a.readyState){case f.LOADING:case f.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(a.onprogress=function(){t._onXHRProgress()}),a.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{a.send(n)}catch(e){return void l.nextTick(function(){t.emit("error",e)})}}}},i.prototype._onXHRProgress=function(){!function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}}(this._xhr)||this._destroyed||(this._response||this._connect(),this._response._onXHRProgress())},i.prototype._connect=function(){var t=this;t._destroyed||(t._response=new n(t._xhr,t._fetchResponse,t._mode,t._fetchTimer),t._response.on("error",function(e){t.emit("error",e)}),t.emit("response",t._response))},i.prototype._write=function(e,t,n){this._body.push(e),n()},i.prototype.abort=i.prototype.destroy=function(){this._destroyed=!0,c.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},i.prototype.end=function(e,t,n){"function"==typeof e&&(n=e,e=void 0),o.Writable.prototype.end.call(this,e,t,n)},i.prototype.flushHeaders=function(){},i.prototype.setTimeout=function(){},i.prototype.setNoDelay=function(){},i.prototype.setSocketKeepAlive=function(){};var r=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,s("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},s("buffer").Buffer)},{"./capability":31,"./response":33,_process:14,buffer:5,inherits:11,"readable-stream":28,"to-arraybuffer":35}],33:[function(n,e,i){(function(c,u,d){var h=n("./capability"),e=n("inherits"),f=n("readable-stream"),a=i.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=i.IncomingMessage=function(e,t,n,i){var o=this;if(f.Readable.call(o),o._mode=n,o.headers={},o.rawHeaders=[],o.trailers={},o.rawTrailers=[],o.on("end",function(){c.nextTick(function(){o.emit("close")})}),"fetch"===n){if(o._fetchResponse=t,o.url=t.url,o.statusCode=t.status,o.statusMessage=t.statusText,t.headers.forEach(function(e,t){o.headers[t.toLowerCase()]=e,o.rawHeaders.push(t,e)}),h.writableStream){var r=new WritableStream({write:function(n){return new Promise(function(e,t){o._destroyed?t():o.push(new d(n))?e():o._resumeFetch=e})},close:function(){u.clearTimeout(i),o._destroyed||o.push(null)},abort:function(e){o._destroyed||o.emit("error",e)}});try{return void t.body.pipeTo(r).catch(function(e){u.clearTimeout(i),o._destroyed||o.emit("error",e)})}catch(e){}}var s=t.body.getReader();!function t(){s.read().then(function(e){if(!o._destroyed){if(e.done)return u.clearTimeout(i),void o.push(null);o.push(new d(e.value)),t()}}).catch(function(e){u.clearTimeout(i),o._destroyed||o.emit("error",e)})}()}else{if(o._xhr=e,o._pos=0,o.url=e.responseURL,o.statusCode=e.status,o.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach(function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===o.headers[n]&&(o.headers[n]=[]),o.headers[n].push(t[2])):void 0!==o.headers[n]?o.headers[n]+=", "+t[2]:o.headers[n]=t[2],o.rawHeaders.push(t[1],t[2])}}),o._charset="x-user-defined",!h.overrideMimeType){var a=o.rawHeaders["mime-type"];if(a){var l=a.match(/;\s*charset=([^;])(;|$)/);l&&(o._charset=l[1].toLowerCase())}o._charset||(o._charset="utf-8")}}};e(t,f.Readable),t.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},t.prototype._onXHRProgress=function(){var t=this,e=t._xhr,n=null;switch(t._mode){case"text:vbarray":if(e.readyState!==a.DONE)break;try{n=new u.VBArray(e.responseBody).toArray()}catch(e){}if(null!==n){t.push(new d(n));break}case"text":try{n=e.responseText}catch(e){t._mode="text:vbarray";break}if(n.length>t._pos){var i=n.substr(t._pos);if("x-user-defined"===t._charset){for(var o=new d(i.length),r=0;r<i.length;r++)o[r]=255&i.charCodeAt(r);t.push(o)}else t.push(i,t._charset);t._pos=n.length}break;case"arraybuffer":if(e.readyState!==a.DONE||!e.response)break;n=e.response,t.push(new d(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=e.response,e.readyState!==a.LOADING||!n)break;t.push(new d(new Uint8Array(n)));break;case"ms-stream":if(n=e.response,e.readyState!==a.LOADING)break;var s=new u.MSStreamReader;s.onprogress=function(){s.result.byteLength>t._pos&&(t.push(new d(new Uint8Array(s.result.slice(t._pos)))),t._pos=s.result.byteLength)},s.onload=function(){t.push(null)},s.readAsArrayBuffer(n)}t._xhr.readyState===a.DONE&&"ms-stream"!==t._mode&&t.push(null)}}).call(this,n("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n("buffer").Buffer)},{"./capability":31,_process:14,buffer:5,inherits:11,"readable-stream":28}],34:[function(l,e,c){(function(e,t){var i=l("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,r={},s=0;function a(e,t){this._id=e,this._clearFn=t}c.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},c.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},c._unrefActive=c.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},c.setImmediate="function"==typeof e?e:function(e){var t=s++,n=!(arguments.length<2)&&o.call(arguments,1);return r[t]=!0,i(function(){r[t]&&(n?e.apply(null,n):e.call(null),c.clearImmediate(t))}),t},c.clearImmediate="function"==typeof t?t:function(e){delete r[e]}}).call(this,l("timers").setImmediate,l("timers").clearImmediate)},{"process/browser.js":14,timers:34}],35:[function(e,t,n){var o=e("buffer").Buffer;t.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(o.isBuffer(e)){for(var t=new Uint8Array(e.length),n=e.length,i=0;i<n;i++)t[i]=e[i];return t.buffer}throw new Error("Argument must be a Buffer")}},{buffer:5}],36:[function(e,t,n){"use strict";var D=e("punycode"),M=e("./util");function R(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}n.parse=r,n.resolve=function(e,t){return r(e,!1,!0).resolve(t)},n.resolveObject=function(e,t){return e?r(e,!1,!0).resolveObject(t):t},n.format=function(e){M.isString(e)&&(e=r(e));return e instanceof R?e.format():R.prototype.format.call(e)},n.Url=R;var F=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,L=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,o=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),N=["'"].concat(o),H=["%","/","?",";","#"].concat(N),B=["/","?","#"],z=/^[+a-z0-9A-Z_-]{0,63}$/,j=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,U={javascript:!0,"javascript:":!0},V={javascript:!0,"javascript:":!0},q={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},G=e("querystring");function r(e,t,n){if(e&&M.isObject(e)&&e instanceof R)return e;var i=new R;return i.parse(e,t,n),i}R.prototype.parse=function(e,t,n){if(!M.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),o=-1!==i&&i<e.indexOf("#")?"?":"#",r=e.split(o);r[0]=r[0].replace(/\\/g,"/");var s=e=r.join(o);if(s=s.trim(),!n&&1===e.split("#").length){var a=L.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?G.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=F.exec(s);if(l){var c=(l=l[0]).toLowerCase();this.protocol=c,s=s.substr(l.length)}if(n||l||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var u="//"===s.substr(0,2);!u||l&&V[l]||(s=s.substr(2),this.slashes=!0)}if(!V[l]&&(u||l&&!q[l])){for(var d,h,f=-1,p=0;p<B.length;p++){-1!==(g=s.indexOf(B[p]))&&(-1===f||g<f)&&(f=g)}-1!==(h=-1===f?s.lastIndexOf("@"):s.lastIndexOf("@",f))&&(d=s.slice(0,h),s=s.slice(h+1),this.auth=decodeURIComponent(d)),f=-1;for(p=0;p<H.length;p++){var g;-1!==(g=s.indexOf(H[p]))&&(-1===f||g<f)&&(f=g)}-1===f&&(f=s.length),this.host=s.slice(0,f),s=s.slice(f),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),b=(p=0,v.length);p<b;p++){var y=v[p];if(y&&!y.match(z)){for(var w="",T=0,x=y.length;T<x;T++)127<y.charCodeAt(T)?w+="x":w+=y[T];if(!w.match(z)){var S=v.slice(0,p),C=v.slice(p+1),E=y.match(j);E&&(S.push(E[1]),C.unshift(E[2])),C.length&&(s="/"+C.join(".")+s),this.hostname=S.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),m||(this.hostname=D.toASCII(this.hostname));var P=this.port?":"+this.port:"",R=this.hostname||"";this.host=R+P,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!U[c])for(p=0,b=N.length;p<b;p++){var I=N[p];if(-1!==s.indexOf(I)){var _=encodeURIComponent(I);_===I&&(_=escape(I)),s=s.split(I).join(_)}}var A=s.indexOf("#");-1!==A&&(this.hash=s.substr(A),s=s.slice(0,A));var O=s.indexOf("?");if(-1!==O?(this.search=s.substr(O),this.query=s.substr(O+1),t&&(this.query=G.parse(this.query)),s=s.slice(0,O)):t&&(this.search="",this.query={}),s&&(this.pathname=s),q[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){P=this.pathname||"";var k=this.search||"";this.path=P+k}return this.href=this.format(),this},R.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",o=!1,r="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&M.isObject(this.query)&&Object.keys(this.query).length&&(r=G.stringify(this.query));var s=this.search||r&&"?"+r||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||q[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o=o||"",i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+i},R.prototype.resolve=function(e){return this.resolveObject(r(e,!1,!0)).format()},R.prototype.resolveObject=function(e){if(M.isString(e)){var t=new R;t.parse(e,!1,!0),e=t}for(var n=new R,i=Object.keys(this),o=0;o<i.length;o++){var r=i[o];n[r]=this[r]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),a=0;a<s.length;a++){var l=s[a];"protocol"!==l&&(n[l]=e[l])}return q[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!q[e.protocol]){for(var c=Object.keys(e),u=0;u<c.length;u++){var d=c[u];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||V[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var f=n.pathname||"",p=n.search||"";n.path=f+p}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var g=n.pathname&&"/"===n.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),v=m||g||n.host&&e.pathname,b=v,y=n.pathname&&n.pathname.split("/")||[],w=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!q[n.protocol]);if(w&&(n.hostname="",n.port=null,n.host&&(""===y[0]?y[0]=n.host:y.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),v=v&&(""===h[0]||""===y[0])),m)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,y=h;else if(h.length)(y=y||[]).pop(),y=y.concat(h),n.search=e.search,n.query=e.query;else if(!M.isNullOrUndefined(e.search)){if(w)n.hostname=n.host=y.shift(),(E=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=e.search,n.query=e.query,M.isNull(n.pathname)&&M.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!y.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=y.slice(-1)[0],x=(n.host||e.host||1<y.length)&&("."===T||".."===T)||""===T,S=0,C=y.length;0<=C;C--)"."===(T=y[C])?y.splice(C,1):".."===T?(y.splice(C,1),S++):S&&(y.splice(C,1),S--);if(!v&&!b)for(;S--;)y.unshift("..");!v||""===y[0]||y[0]&&"/"===y[0].charAt(0)||y.unshift(""),x&&"/"!==y.join("/").substr(-1)&&y.push("");var E,P=""===y[0]||y[0]&&"/"===y[0].charAt(0);w&&(n.hostname=n.host=P?"":y.length?y.shift():"",(E=!!(n.host&&0<n.host.indexOf("@"))&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(v=v||n.host&&y.length)&&!P&&y.unshift(""),y.length?n.pathname=y.join("/"):(n.pathname=null,n.path=null),M.isNull(n.pathname)&&M.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},R.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":37,punycode:4,querystring:17}],37:[function(e,t,n){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],38:[function(e,t,n){(function(n){function i(e){try{if(!n.localStorage)return!1}catch(e){return!1}var t=n.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}t.exports=function(e,t){if(i("noDeprecation"))return e;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],39:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)o.call(n,i)&&(e[i]=n[i])}return e};var o=Object.prototype.hasOwnProperty},{}]},{},[1])(1)}),function(g,m,v,b){g.isFunction=g.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},g.site=g.fn.site=function(e){var a,l,i=(new Date).getTime(),o=[],t=e,n="string"==typeof t,c=[].slice.call(arguments,1),u=g.isPlainObject(e)?g.extend(!0,{},g.site.settings,e):g.extend({},g.site.settings),r=u.namespace,d=u.error,s="module-"+r,h=g(v),f=this,p=h.data(s);return a={initialize:function(){a.instantiate()},instantiate:function(){a.verbose("Storing instance of site",a),p=a,h.data(s,a)},normalize:function(){a.fix.console(),a.fix.requestAnimationFrame()},fix:{console:function(){a.debug("Normalizing window.console"),console!==b&&console.log!==b||(a.verbose("Console not available, normalizing events"),a.disable.console()),void 0!==console.group&&void 0!==console.groupEnd&&void 0!==console.groupCollapsed||(a.verbose("Console group not available, normalizing events"),m.console.group=function(){},m.console.groupEnd=function(){},m.console.groupCollapsed=function(){}),void 0===console.markTimeline&&(a.verbose("Mark timeline not available, normalizing events"),m.console.markTimeline=function(){})},consoleClear:function(){a.debug("Disabling programmatic console clearing"),m.console.clear=function(){}},requestAnimationFrame:function(){a.debug("Normalizing requestAnimationFrame"),m.requestAnimationFrame===b&&(a.debug("RequestAnimationFrame not available, normalizing event"),m.requestAnimationFrame=m.requestAnimationFrame||m.mozRequestAnimationFrame||m.webkitRequestAnimationFrame||m.msRequestAnimationFrame||function(e){setTimeout(e,0)})}},moduleExists:function(e){return g.fn[e]!==b&&g.fn[e].settings!==b},enabled:{modules:function(e){var n=[];return e=e||u.modules,g.each(e,function(e,t){a.moduleExists(t)&&n.push(t)}),n}},disabled:{modules:function(e){var n=[];return e=e||u.modules,g.each(e,function(e,t){a.moduleExists(t)||n.push(t)}),n}},change:{setting:function(o,r,e,s){e="string"==typeof e?"all"===e?u.modules:[e]:e||u.modules,s=s===b||s,g.each(e,function(e,t){var n,i=!a.moduleExists(t)||(g.fn[t].settings.namespace||!1);a.moduleExists(t)&&(a.verbose("Changing default setting",o,r,t),g.fn[t].settings[o]=r,s&&i&&0<(n=g(":data(module-"+i+")")).length&&(a.verbose("Modifying existing settings",n),n[t]("setting",o,r)))})},settings:function(i,e,o){e="string"==typeof e?[e]:e||u.modules,o=o===b||o,g.each(e,function(e,t){var n;a.moduleExists(t)&&(a.verbose("Changing default setting",i,t),g.extend(!0,g.fn[t].settings,i),o&&r&&0<(n=g(":data(module-"+r+")")).length&&(a.verbose("Modifying existing settings",n),n[t]("setting",i)))})}},enable:{console:function(){a.console(!0)},debug:function(e,t){e=e||u.modules,a.debug("Enabling debug for modules",e),a.change.setting("debug",!0,e,t)},verbose:function(e,t){e=e||u.modules,a.debug("Enabling verbose debug for modules",e),a.change.setting("verbose",!0,e,t)}},disable:{console:function(){a.console(!1)},debug:function(e,t){e=e||u.modules,a.debug("Disabling debug for modules",e),a.change.setting("debug",!1,e,t)},verbose:function(e,t){e=e||u.modules,a.debug("Disabling verbose debug for modules",e),a.change.setting("verbose",!1,e,t)}},console:function(e){if(e){if(p.cache.console===b)return void a.error(d.console);a.debug("Restoring console function"),m.console=p.cache.console}else a.debug("Disabling console function"),p.cache.console=m.console,m.console={clear:function(){},error:function(){},group:function(){},groupCollapsed:function(){},groupEnd:function(){},info:function(){},log:function(){},markTimeline:function(){},warn:function(){}}},destroy:function(){a.verbose("Destroying previous site for",h),h.removeData(s)},cache:{},setting:function(e,t){if(g.isPlainObject(e))g.extend(!0,u,e);else{if(t===b)return u[e];u[e]=t}},internal:function(e,t){if(g.isPlainObject(e))g.extend(!0,a,e);else{if(t===b)return a[e];a[e]=t}},debug:function(){u.debug&&(u.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,u.name+":"),a.debug.apply(console,arguments)))},verbose:function(){u.verbose&&u.debug&&(u.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),a.verbose.apply(console,arguments)))},error:function(){a.error=Function.prototype.bind.call(console.error,console,u.name+":"),a.error.apply(console,arguments)},performance:{log:function(e){var t,n;u.performance&&(n=(t=(new Date).getTime())-(i||t),i=t,o.push({Element:f,Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=u.name+":",n=0;i=!1,clearTimeout(a.performance.timer),g.each(o,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",(console.group!==b||console.table!==b)&&0<o.length&&(console.groupCollapsed(e),console.table?console.table(o):g.each(o,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),o=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||c,t=f||t,"string"==typeof i&&s!==b&&(i=i.split(/[\. ]/),o=i.length-1,g.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(g.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==b)return r=s[n],!1;if(!g.isPlainObject(s[t])||e==o)return s[t]!==b?r=s[t]:a.error(d.method,i),!1;s=s[t]}})),g.isFunction(r)?n=r.apply(t,e):r!==b&&(n=r),Array.isArray(l)?l.push(n):l!==b?l=[l,n]:n!==b&&(l=n),r}},n?(p===b&&a.initialize(),a.invoke(t)):(p!==b&&a.destroy(),a.initialize()),l!==b?l:this},g.site.settings={name:"Site",namespace:"site",error:{console:"Console cannot be restored, most likely it was overwritten outside of module",method:"The method you called is not defined."},debug:!1,verbose:!1,performance:!0,modules:["accordion","api","calendar","checkbox","dimmer","dropdown","embed","form","modal","nag","popup","slider","rating","shape","sidebar","state","sticky","tab","toast","transition","visibility","visit"],siteNamespace:"site",namespaceStub:{cache:{},config:{},sections:{},section:{},utilities:{}}},g.extend(g.expr[":"],{data:g.expr.createPseudo?g.expr.createPseudo(function(t){return function(e){return!!g.data(e,t)}}):function(e,t,n){return!!g.data(e,n[3])}})}(jQuery,window,document),function(D,M,F,L){"use strict";D.isFunction=D.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},M=void 0!==M&&M.Math==Math?M:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),D.fn.form=function(S){var C,E=D(this),P=E.selector||"",R=(new Date).getTime(),I=[],_=S,A=arguments[1],O="string"==typeof _,k=[].slice.call(arguments,1);return E.each(function(){var n,h,t,e,p,c,f,g,m,i,u,o,r,a,l,v,d=D(this),b=this,y=[],w=!1,s=!1,T=!1,x=["clean","clean"];(v={initialize:function(){v.get.settings(),O?(l===L&&v.instantiate(),v.invoke(_)):(l!==L&&l.invoke("destroy"),v.verbose("Initializing form validation",d,p),v.bindEvents(),v.set.defaults(),v.instantiate())},instantiate:function(){v.verbose("Storing instance of module",v),l=v,d.data(r,v)},destroy:function(){v.verbose("Destroying previous module",l),v.removeEvents(),d.removeData(r)},refresh:function(){v.verbose("Refreshing selector cache"),n=d.find(g.field),h=d.find(g.group),t=d.find(g.message),d.find(g.prompt),e=d.find(g.submit),d.find(g.clear),d.find(g.reset)},submit:function(){v.verbose("Submitting form",d),s=!0,d.submit()},attachEvents:function(e,t){t=t||"submit",D(e).on("click"+a,function(e){v[t](),e.preventDefault()})},bindEvents:function(){v.verbose("Attaching form events"),d.on("submit"+a,v.validate.form).on("blur"+a,g.field,v.event.field.blur).on("click"+a,g.submit,v.submit).on("click"+a,g.reset,v.reset).on("click"+a,g.clear,v.clear),p.keyboardShortcuts&&d.on("keydown"+a,g.field,v.event.field.keydown),n.each(function(e,t){var n=D(t),i=n.prop("type"),o=v.get.changeEvent(i,n);n.on(o+a,v.event.field.change)}),p.preventLeaving&&D(M).on("beforeunload"+a,v.event.beforeUnload),n.on("change click keyup keydown blur",function(e){D(this).trigger(e.type+".dirty")}),n.on("change.dirty click.dirty keyup.dirty keydown.dirty blur.dirty",v.determine.isDirty),d.on("dirty"+a,function(e){p.onDirty.call()}),d.on("clean"+a,function(e){p.onClean.call()})},clear:function(){n.each(function(e,t){var n=D(t),i=n.parent(),o=n.closest(h),r=o.find(g.prompt),s=n.closest(g.uiCalendar),a=n.data(f.defaultValue)||"",l=i.is(g.uiCheckbox),c=i.is(g.uiDropdown)&&v.can.useElement("dropdown"),u=0<s.length&&v.can.useElement("calendar");o.hasClass(m.error)&&(v.verbose("Resetting error on field",o),o.removeClass(m.error),r.remove()),c?(v.verbose("Resetting dropdown value",i,a),i.dropdown("clear")):l?n.prop("checked",!1):u?s.calendar("clear"):(v.verbose("Resetting field value",n,a),n.val(""))})},reset:function(){n.each(function(e,t){var n=D(t),i=n.parent(),o=n.closest(h),r=n.closest(g.uiCalendar),s=o.find(g.prompt),a=n.data(f.defaultValue),l=i.is(g.uiCheckbox),c=i.is(g.uiDropdown)&&v.can.useElement("dropdown"),u=0<r.length&&v.can.useElement("calendar"),d=o.hasClass(m.error);a!==L&&(d&&(v.verbose("Resetting error on field",o),o.removeClass(m.error),s.remove()),c?(v.verbose("Resetting dropdown value",i,a),i.dropdown("restore defaults")):l?(v.verbose("Resetting checkbox value",i,a),n.prop("checked",a)):u?r.calendar("set date",a):(v.verbose("Resetting field value",n,a),n.val(a)))}),v.determine.isDirty()},determine:{isValid:function(){var n=!0;return D.each(c,function(e,t){v.validate.field(t,e,!0)||(n=!1)}),n},isDirty:function(e){var o=!1;n.each(function(e,t){var n,i=D(t);n=0<i.filter(g.checkbox).length?v.is.checkboxDirty(i):v.is.fieldDirty(i),i.data(p.metadata.isDirty,n),o|=n}),o?v.set.dirty():v.set.clean(),e&&"dirty"===e.namespace&&(e.stopImmediatePropagation(),e.preventDefault())}},is:{bracketedRule:function(e){return e.type&&e.type.match(p.regExp.bracket)},shorthandFields:function(e){var t=e[Object.keys(e)[0]];return v.is.shorthandRules(t)},shorthandRules:function(e){return"string"==typeof e||Array.isArray(e)},empty:function(e){return!e||0===e.length||(e.is(g.checkbox)?!e.is(":checked"):v.is.blank(e))},blank:function(e){return""===D.trim(e.val())},valid:function(e){var n=!0;return e?(v.verbose("Checking if field is valid",e),v.validate.field(c[e],e,!1)):(v.verbose("Checking if form is valid"),D.each(c,function(e,t){v.is.valid(e)||(n=!1)}),n)},dirty:function(){return T},clean:function(){return!T},fieldDirty:function(e){var t=e.data(f.defaultValue);null==t&&(t="");var n=e.val();null==n&&(n="");var i=/^(true|false)$/i;return i.test(t)&&i.test(n)?!new RegExp("^"+t+"$","i").test(n):n!==t},checkboxDirty:function(e){return e.data(f.defaultValue)!==e.is(":checked")},justDirty:function(){return"dirty"===x[0]},justClean:function(){return"clean"===x[0]}},removeEvents:function(){d.off(a),n.off(a),e.off(a),n.off(a)},event:{field:{keydown:function(e){var t=D(this),n=e.which,i=t.is(g.input),o=t.is(g.checkbox),r=0<t.closest(g.uiDropdown).length,s=13;n==27&&(v.verbose("Escape key pressed blurring field"),t.blur()),e.ctrlKey||n!=s||!i||r||o||(w||(t.one("keyup"+a,v.event.field.keyup),v.submit(),v.debug("Enter pressed on input submitting form")),w=!0)},keyup:function(){w=!1},blur:function(e){var t=D(this),n=t.closest(h),i=v.get.validation(t);n.hasClass(m.error)?(v.debug("Revalidating field",t,i),i&&v.validate.field(i)):"blur"==p.on&&i&&v.validate.field(i)},change:function(e){var t=D(this),n=t.closest(h),i=v.get.validation(t);i&&("change"==p.on||n.hasClass(m.error)&&p.revalidate)&&(clearTimeout(v.timer),v.timer=setTimeout(function(){v.debug("Revalidating field",t,v.get.validation(t)),v.validate.field(i)},p.delay))}},beforeUnload:function(e){if(v.is.dirty()&&!s)return(e=e||M.event)&&(e.returnValue=p.text.leavingMessage),p.text.leavingMessage}},get:{ancillaryValue:function(e){return!(!e.type||!e.value&&!v.is.bracketedRule(e))&&(e.value!==L?e.value:e.type.match(p.regExp.bracket)[1]+"")},ruleName:function(e){return v.is.bracketedRule(e)?e.type.replace(e.type.match(p.regExp.bracket)[0],""):e.type},changeEvent:function(e,t){return"checkbox"==e||"radio"==e||"hidden"==e||t.is("select")?"change":v.get.inputEvent()},inputEvent:function(){return F.createElement("input").oninput!==L?"input":F.createElement("input").onpropertychange!==L?"propertychange":"keyup"},fieldsFromShorthand:function(e){var i={};return D.each(e,function(n,e){"string"==typeof e&&(e=[e]),i[n]={rules:[]},D.each(e,function(e,t){i[n].rules.push({type:t})})}),i},prompt:function(e,t){var n,i,o=v.get.ruleName(e),r=v.get.ancillaryValue(e),s=v.get.field(t.identifier),a=s.val(),l=D.isFunction(e.prompt)?e.prompt(a):e.prompt||p.prompt[o]||p.text.unspecifiedRule,c=-1!==l.search("{value}"),u=-1!==l.search("{name}");return c&&(l=l.replace("{value}",s.val())),u&&(i=1==(n=s.closest(g.group).find("label").eq(0)).length?n.text():s.prop("placeholder")||p.text.unspecifiedField,l=l.replace("{name}",i)),l=(l=l.replace("{identifier}",t.identifier)).replace("{ruleValue}",r),e.prompt||v.verbose("Using default validation prompt for type",l,o),l},settings:function(){if(D.isPlainObject(S)){var e=Object.keys(S);0<e.length&&(S[e[0]].identifier!==L&&S[e[0]].rules!==L)?(p=D.extend(!0,{},D.fn.form.settings,A),c=D.extend({},D.fn.form.settings.defaults,S),v.error(p.error.oldSyntax,b),v.verbose("Extending settings from legacy parameters",c,p)):(S.fields&&v.is.shorthandFields(S.fields)&&(S.fields=v.get.fieldsFromShorthand(S.fields)),p=D.extend(!0,{},D.fn.form.settings,S),c=D.extend({},D.fn.form.settings.defaults,p.fields),v.verbose("Extending settings",c,p))}else p=D.fn.form.settings,c=D.fn.form.settings.defaults,v.verbose("Using default form validation",c,p);o=p.namespace,f=p.metadata,g=p.selector,m=p.className,i=p.regExp,u=p.error,r="module-"+o,a="."+o,l=d.data(r),v.refresh()},field:function(e){var t;return v.verbose("Finding field with identifier",e),e=v.escape.string(e),0<(t=n.filter("#"+e)).length?t:0<(t=n.filter('[name="'+e+'"]')).length?t:0<(t=n.filter('[name="'+e+'[]"]')).length?t:0<(t=n.filter("[data-"+f.validate+'="'+e+'"]')).length?t:D("<input/>")},fields:function(e){var n=D();return D.each(e,function(e,t){n=n.add(v.get.field(t))}),n},validation:function(i){var o,r;return!!c&&(D.each(c,function(e,n){r=n.identifier||e,D.each(v.get.field(r),function(e,t){if(t==i[0])return n.identifier=r,o=n,!1})}),o||!1)},value:function(e){var t=[];return t.push(e),v.get.values.call(b,t)[e]},values:function(e){var t=Array.isArray(e)?v.get.fields(e):n,f={};return t.each(function(e,t){var n=D(t),i=n.closest(g.uiCalendar),o=n.prop("name"),r=n.val(),s=n.is(g.checkbox),a=n.is(g.radio),l=-1!==o.indexOf("[]"),c=0<i.length&&v.can.useElement("calendar"),u=!!s&&n.is(":checked");if(o)if(l)o=o.replace("[]",""),f[o]||(f[o]=[]),s?u?f[o].push(r||!0):f[o].push(!1):f[o].push(r);else if(a)f[o]!==L&&0!=f[o]||(f[o]=!!u&&(r||!0));else if(s)f[o]=!!u&&(r||!0);else if(c){var d=i.calendar("get date");if(null!==d){if("date"==p.dateHandling)f[o]=d;else if("input"==p.dateHandling)f[o]=i.calendar("get input date");else if("formatter"==p.dateHandling){var h=i.calendar("setting","type");switch(h){case"date":f[o]=p.formatter.date(d);break;case"datetime":f[o]=p.formatter.datetime(d);break;case"time":f[o]=p.formatter.time(d);break;case"month":f[o]=p.formatter.month(d);break;case"year":f[o]=p.formatter.year(d);break;default:v.debug("Wrong calendar mode",i,h),f[o]=""}}}else f[o]=""}else f[o]=r}),f},dirtyFields:function(){return n.filter(function(e,t){return D(t).data(f.isDirty)})}},has:{field:function(e){return v.verbose("Checking for existence of a field with identifier",e),"string"!=typeof(e=v.escape.string(e))&&v.error(u.identifier,e),0<n.filter("#"+e).length||(0<n.filter('[name="'+e+'"]').length||0<n.filter("[data-"+f.validate+'="'+e+'"]').length)}},can:{useElement:function(e){return D.fn[e]!==L||(v.error(u.noElement.replace("{element}",e)),!1)}},escape:{string:function(e){return(e=String(e)).replace(i.escape,"\\$&")}},add:{rule:function(e,t){v.add.field(e,t)},field:function(n,e){var i={};v.is.shorthandRules(e)?(e=Array.isArray(e)?e:[e],i[n]={rules:[]},D.each(e,function(e,t){i[n].rules.push({type:t})})):i[n]=e,c=D.extend({},c,i),v.debug("Adding rules",i,c)},fields:function(e){var t;t=e&&v.is.shorthandFields(e)?v.get.fieldsFromShorthand(e):e,c=D.extend({},c,t)},prompt:function(e,t,n){var i=v.get.field(e).closest(h),o=i.children(g.prompt),r=0!==o.length;t="string"==typeof t?[t]:t,v.verbose("Adding field error state",e),n||i.addClass(m.error),p.inline&&(r||(o=p.templates.prompt(t,m.label)).appendTo(i),o.html(t[0]),r?v.verbose("Inline errors are disabled, no inline error added",e):p.transition&&v.can.useElement("transition")&&d.transition("is supported")?(v.verbose("Displaying error with css transition",p.transition),o.transition(p.transition+" in",p.duration)):(v.verbose("Displaying error with fallback javascript animation"),o.fadeIn(p.duration)))},errors:function(e){v.debug("Adding form error messages",e),v.set.error(),t.html(p.templates.error(e))}},remove:{rule:function(n,e){var i=Array.isArray(e)?e:[e];if(c[n]!==L&&Array.isArray(c[n].rules))return e===L?(v.debug("Removed all rules"),void(c[n].rules=[])):void D.each(c[n].rules,function(e,t){t&&-1!==i.indexOf(t.type)&&(v.debug("Removed rule",t.type),c[n].rules.splice(e,1))})},field:function(e){var t=Array.isArray(e)?e:[e];D.each(t,function(e,t){v.remove.rule(t)})},rules:function(e,n){Array.isArray(e)?D.each(e,function(e,t){v.remove.rule(t,n)}):v.remove.rule(e,n)},fields:function(e){v.remove.field(e)},prompt:function(e){var t=v.get.field(e).closest(h),n=t.children(g.prompt);t.removeClass(m.error),p.inline&&n.is(":visible")&&(v.verbose("Removing prompt for field",e),p.transition&&v.can.useElement("transition")&&d.transition("is supported")?n.transition(p.transition+" out",p.duration,function(){n.remove()}):n.fadeOut(p.duration,function(){n.remove()}))}},set:{success:function(){d.removeClass(m.error).addClass(m.success)},defaults:function(){n.each(function(e,t){var n=D(t),i=n.parent(),o=0<n.filter(g.checkbox).length,r=i.is(g.uiDropdown)&&v.can.useElement("dropdown"),s=o?n.is(":checked"):n.val();r&&i.dropdown("save defaults"),n.data(f.defaultValue,s),n.data(f.isDirty,!1)})},error:function(){d.removeClass(m.success).addClass(m.error)},value:function(e,t){var n={};return n[e]=t,v.set.values.call(b,n)},values:function(e){D.isEmptyObject(e)||D.each(e,function(e,t){var n,i=v.get.field(e),o=i.parent(),r=i.closest(g.uiCalendar),s=Array.isArray(t),a=o.is(g.uiCheckbox)&&v.can.useElement("checkbox"),l=o.is(g.uiDropdown)&&v.can.useElement("dropdown"),c=i.is(g.radio)&&a,u=0<r.length&&v.can.useElement("calendar");0<i.length&&(s&&a?(v.verbose("Selecting multiple",t,i),o.checkbox("uncheck"),D.each(t,function(e,t){n=i.filter('[value="'+t+'"]'),o=n.parent(),0<n.length&&o.checkbox("check")})):c?(v.verbose("Selecting radio value",t,i),i.filter('[value="'+t+'"]').parent(g.uiCheckbox).checkbox("check")):a?(v.verbose("Setting checkbox value",t,o),!0===t?o.checkbox("check"):o.checkbox("uncheck")):l?(v.verbose("Setting dropdown value",t,o),o.dropdown("set selected",t)):u?r.calendar("set date",t):(v.verbose("Setting field value",t,i),i.val(t)))})},dirty:function(){v.verbose("Setting state dirty"),T=!0,x[0]=x[1],x[1]="dirty",v.is.justClean()&&d.trigger("dirty")},clean:function(){v.verbose("Setting state clean"),T=!1,x[0]=x[1],x[1]="clean",v.is.justDirty()&&d.trigger("clean")},asClean:function(){v.set.defaults(),v.set.clean()},asDirty:function(){v.set.defaults(),v.set.dirty()}},validate:{form:function(e,t){var n=v.get.values();if(w)return!1;if(y=[],v.determine.isValid()){if(v.debug("Form has no validation errors, submitting"),v.set.success(),!0!==t)return p.onSuccess.call(b,e,n)}else if(v.debug("Form has errors"),v.set.error(),p.inline||v.add.errors(y),e&&d.data("moduleApi")!==L&&e.stopImmediatePropagation(),!0!==t)return p.onFailure.call(b,y,n)},field:function(i,e,o){o=o===L||o,"string"==typeof i&&(v.verbose("Validating field",i),i=c[e=i]);var r=i.identifier||e,t=v.get.field(r),n=!!i.depends&&v.get.field(i.depends),s=!0,a=[];i.identifier||(v.debug("Using field name as identifier",r),i.identifier=r);var l=!0;return D.each(t,function(){if(!D(this).prop("disabled"))return l=!1}),l?v.debug("Field is disabled. Skipping",r):i.optional&&v.is.blank(t)?v.debug("Field is optional and blank. Skipping",r):i.depends&&v.is.empty(n)?v.debug("Field depends on another value that is not present or empty. Skipping",n):i.rules!==L&&(t.closest(h).removeClass(m.error),D.each(i.rules,function(e,t){if(v.has.field(r)){var n=v.validate.rule(i,t,!0)||[];0<n.length&&(v.debug("Field is invalid",r,t.type),a.push(v.get.prompt(t,i)),s=!1,o&&D(n).closest(h).addClass(m.error))}})),s?(o&&(v.remove.prompt(r,a),p.onValid.call(t)),!0):(o&&(y=y.concat(a),v.add.prompt(r,a,!0),p.onInvalid.call(t,a)),!1)},rule:function(e,t,n){function i(e){var t=c?D(e).filter(":checked").val():D(e).val();return t=t===L||""===t||null===t?"":p.shouldTrim?D.trim(t+""):String(t+""),a.call(e,t,r,d)}var o=v.get.field(e.identifier),r=v.get.ancillaryValue(t),s=v.get.ruleName(t),a=p.rules[s],l=[],c=o.is(g.checkbox);if(D.isFunction(a))return c?i(o)||(l=o):D.each(o,function(e,t){i(t)||l.push(t)}),n?l:!(0<l.length);v.error(u.noRule,s)}},setting:function(e,t){if(D.isPlainObject(e))D.extend(!0,p,e);else{if(t===L)return p[e];p[e]=t}},internal:function(e,t){if(D.isPlainObject(e))D.extend(!0,v,e);else{if(t===L)return v[e];v[e]=t}},debug:function(){!p.silent&&p.debug&&(p.performance?v.performance.log(arguments):(v.debug=Function.prototype.bind.call(console.info,console,p.name+":"),v.debug.apply(console,arguments)))},verbose:function(){!p.silent&&p.verbose&&p.debug&&(p.performance?v.performance.log(arguments):(v.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),v.verbose.apply(console,arguments)))},error:function(){p.silent||(v.error=Function.prototype.bind.call(console.error,console,p.name+":"),v.error.apply(console,arguments))},performance:{log:function(e){var t,n;p.performance&&(n=(t=(new Date).getTime())-(R||t),R=t,I.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:b,"Execution Time":n})),clearTimeout(v.performance.timer),v.performance.timer=setTimeout(v.performance.display,500)},display:function(){var e=p.name+":",n=0;R=!1,clearTimeout(v.performance.timer),D.each(I,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",P&&(e+=" '"+P+"'"),1<E.length&&(e+=" ("+E.length+")"),(console.group!==L||console.table!==L)&&0<I.length&&(console.groupCollapsed(e),console.table?console.table(I):D.each(I,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),I=[]}},invoke:function(i,e,t){var o,r,n,s=l;return e=e||k,t=b||t,"string"==typeof i&&s!==L&&(i=i.split(/[\. ]/),o=i.length-1,D.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(D.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==L)return r=s[n],!1;if(!D.isPlainObject(s[t])||e==o)return s[t]!==L&&(r=s[t]),!1;s=s[t]}})),D.isFunction(r)?n=r.apply(t,e):r!==L&&(n=r),Array.isArray(C)?C.push(n):C!==L?C=[C,n]:n!==L&&(C=n),r}}).initialize()}),C!==L?C:this},D.fn.form.settings={name:"Form",namespace:"form",debug:!1,verbose:!1,performance:!0,fields:!1,keyboardShortcuts:!0,on:"submit",inline:!1,delay:200,revalidate:!0,shouldTrim:!0,transition:"scale",duration:200,preventLeaving:!1,dateHandling:"date",onValid:function(){},onInvalid:function(){},onSuccess:function(){return!0},onFailure:function(){return!1},onDirty:function(){},onClean:function(){},metadata:{defaultValue:"default",validate:"validate",isDirty:"isDirty"},regExp:{htmlID:/^[a-zA-Z][\w:.-]*$/g,bracket:/\[(.*)\]/i,decimal:/^\d+\.?\d*$/,email:/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|:,=@]/g,flags:/^\/(.*)\/(.*)?/,integer:/^\-?\d+$/,number:/^\-?\d*(\.\d+)?$/,url:/(https?:\/\/(?:www\.|(?!www))[^\s\.]+\.[^\s]{2,}|www\.[^\s]+\.[^\s]{2,})/i},text:{unspecifiedRule:"Please enter a valid value",unspecifiedField:"This field",leavingMessage:"There are unsaved changes on this page which will be discarded if you continue."},prompt:{empty:"{name} must have a value",checked:"{name} must be checked",email:"{name} must be a valid e-mail",url:"{name} must be a valid url",regExp:"{name} is not formatted correctly",integer:"{name} must be an integer",decimal:"{name} must be a decimal number",number:"{name} must be set to a number",is:'{name} must be "{ruleValue}"',isExactly:'{name} must be exactly "{ruleValue}"',not:'{name} cannot be set to "{ruleValue}"',notExactly:'{name} cannot be set to exactly "{ruleValue}"',contain:'{name} must contain "{ruleValue}"',containExactly:'{name} must contain exactly "{ruleValue}"',doesntContain:'{name} cannot contain  "{ruleValue}"',doesntContainExactly:'{name} cannot contain exactly "{ruleValue}"',minLength:"{name} must be at least {ruleValue} characters",length:"{name} must be at least {ruleValue} characters",exactLength:"{name} must be exactly {ruleValue} characters",maxLength:"{name} cannot be longer than {ruleValue} characters",match:"{name} must match {ruleValue} field",different:"{name} must have a different value than {ruleValue} field",creditCard:"{name} must be a valid credit card number",minCount:"{name} must have at least {ruleValue} choices",exactCount:"{name} must have exactly {ruleValue} choices",maxCount:"{name} must have {ruleValue} or less choices"},selector:{checkbox:'input[type="checkbox"], input[type="radio"]',clear:".clear",field:"input, textarea, select",group:".field",input:"input",message:".error.message",prompt:".prompt.label",radio:'input[type="radio"]',reset:'.reset:not([type="reset"])',submit:'.submit:not([type="submit"])',uiCheckbox:".ui.checkbox",uiDropdown:".ui.dropdown",uiCalendar:".ui.calendar"},className:{error:"error",label:"ui basic red pointing prompt label",pressed:"down",success:"success"},error:{identifier:"You must specify a string identifier for each field",method:"The method you called is not defined.",noRule:"There is no rule matching the one you specified",oldSyntax:"Starting in 2.0 forms now only take a single settings object. Validation settings converted to new syntax automatically.",noElement:"This module requires ui {element}"},templates:{error:function(e){var n='<ul class="list">';return D.each(e,function(e,t){n+="<li>"+t+"</li>"}),D(n+="</ul>")},prompt:function(e,t){return D("<div/>").addClass(t).html(e[0])}},formatter:{date:function(e){return Intl.DateTimeFormat("en-GB").format(e)},datetime:function(e){return Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e)},time:function(e){return Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(e)},month:function(e){return Intl.DateTimeFormat("en-GB",{month:"2-digit",year:"numeric"}).format(e)},year:function(e){return Intl.DateTimeFormat("en-GB",{year:"numeric"}).format(e)}},rules:{empty:function(e){return!(e===L||""===e||Array.isArray(e)&&0===e.length)},checked:function(){return 0<D(this).filter(":checked").length},email:function(e){return D.fn.form.settings.regExp.email.test(e)},url:function(e){return D.fn.form.settings.regExp.url.test(e)},regExp:function(e,t){if(t instanceof RegExp)return e.match(t);var n,i=t.match(D.fn.form.settings.regExp.flags);return i&&(t=2<=i.length?i[1]:t,n=3<=i.length?i[2]:""),e.match(new RegExp(t,n))},integer:function(e,t){var n,i,o,r=D.fn.form.settings.regExp.integer;return t&&-1===["",".."].indexOf(t)&&(-1==t.indexOf("..")?r.test(t)&&(n=i=t-0):(o=t.split("..",2),r.test(o[0])&&(n=o[0]-0),r.test(o[1])&&(i=o[1]-0))),r.test(e)&&(n===L||n<=e)&&(i===L||e<=i)},decimal:function(e){return D.fn.form.settings.regExp.decimal.test(e)},number:function(e){return D.fn.form.settings.regExp.number.test(e)},is:function(e,t){return t="string"==typeof t?t.toLowerCase():t,(e="string"==typeof e?e.toLowerCase():e)==t},isExactly:function(e,t){return e==t},not:function(e,t){return(e="string"==typeof e?e.toLowerCase():e)!=(t="string"==typeof t?t.toLowerCase():t)},notExactly:function(e,t){return e!=t},contains:function(e,t){return t=t.replace(D.fn.form.settings.regExp.escape,"\\$&"),-1!==e.search(new RegExp(t,"i"))},containsExactly:function(e,t){return t=t.replace(D.fn.form.settings.regExp.escape,"\\$&"),-1!==e.search(new RegExp(t))},doesntContain:function(e,t){return t=t.replace(D.fn.form.settings.regExp.escape,"\\$&"),-1===e.search(new RegExp(t,"i"))},doesntContainExactly:function(e,t){return t=t.replace(D.fn.form.settings.regExp.escape,"\\$&"),-1===e.search(new RegExp(t))},minLength:function(e,t){return e!==L&&e.length>=t},length:function(e,t){return e!==L&&e.length>=t},exactLength:function(e,t){return e!==L&&e.length==t},maxLength:function(e,t){return e!==L&&e.length<=t},match:function(e,t,n){var i,o;return 0<(o=n.find('[data-validate="'+t+'"]')).length?i=o.val():0<(o=n.find("#"+t)).length?i=o.val():0<(o=n.find('[name="'+t+'"]')).length?i=o.val():0<(o=n.find('[name="'+t+'[]"]')).length&&(i=o),i!==L&&e.toString()==i.toString()},different:function(e,t,n){var i,o;return 0<(o=n.find('[data-validate="'+t+'"]')).length?i=o.val():0<(o=n.find("#"+t)).length?i=o.val():0<(o=n.find('[name="'+t+'"]')).length?i=o.val():0<(o=n.find('[name="'+t+'[]"]')).length&&(i=o),i!==L&&e.toString()!==i.toString()},creditCard:function(n,e){var t,i,o={visa:{pattern:/^4/,length:[16]},amex:{pattern:/^3[47]/,length:[15]},mastercard:{pattern:/^5[1-5]/,length:[16]},discover:{pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,length:[16]},unionPay:{pattern:/^(62|88)/,length:[16,17,18,19]},jcb:{pattern:/^35(2[89]|[3-8][0-9])/,length:[16]},maestro:{pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,length:[12,13,14,15,16,17,18,19]},dinersClub:{pattern:/^(30[0-5]|^36)/,length:[14]},laser:{pattern:/^(6304|670[69]|6771)/,length:[16,17,18,19]},visaElectron:{pattern:/^(4026|417500|4508|4844|491(3|7))/,length:[16]}},r={},s=!1,a="string"==typeof e&&e.split(",");if("string"==typeof n&&0!==n.length){if(n=n.replace(/[\-]/g,""),a&&(D.each(a,function(e,t){(i=o[t])&&(r={length:-1!==D.inArray(n.length,i.length),pattern:-1!==n.search(i.pattern)}).length&&r.pattern&&(s=!0)}),!s))return!1;if((t={number:-1!==D.inArray(n.length,o.unionPay.length),pattern:-1!==n.search(o.unionPay.pattern)}).number&&t.pattern)return!0;for(var l=n.length,c=0,u=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],d=0;l--;)d+=u[c][parseInt(n.charAt(l),10)],c^=1;return d%10==0&&0<d}},minCount:function(e,t){return 0==t||(1==t?""!==e:e.split(",").length>=t)},exactCount:function(e,t){return 0==t?""===e:1==t?""!==e&&-1===e.search(","):e.split(",").length==t},maxCount:function(e,t){return 0!=t&&(1==t?-1===e.search(","):e.split(",").length<=t)}}}}(jQuery,window,document),function(S,C,e,E){"use strict";S.isFunction=S.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},C=void 0!==C&&C.Math==Math?C:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),S.fn.accordion=function(r){var v,s=S(this),b=(new Date).getTime(),y=[],w=r,T="string"==typeof w,x=[].slice.call(arguments,1);return s.each(function(){var e,c,u=S.isPlainObject(r)?S.extend(!0,{},S.fn.accordion.settings,r):S.extend({},S.fn.accordion.settings),d=u.className,t=u.namespace,h=u.selector,a=u.error,n="."+t,i="module-"+t,o=s.selector||"",f=S(this),p=f.find(h.title),g=f.find(h.content),l=this,m=f.data(i);c={initialize:function(){c.debug("Initializing",f),c.bind.events(),u.observeChanges&&c.observeChanges(),c.instantiate()},instantiate:function(){m=c,f.data(i,c)},destroy:function(){c.debug("Destroying previous instance",f),f.off(n).removeData(i)},refresh:function(){p=f.find(h.title),g=f.find(h.content)},observeChanges:function(){"MutationObserver"in C&&((e=new MutationObserver(function(e){c.debug("DOM tree modified, updating selector cache"),c.refresh()})).observe(l,{childList:!0,subtree:!0}),c.debug("Setting up mutation observer",e))},bind:{events:function(){c.debug("Binding delegated events"),f.on(u.on+n,h.trigger,c.event.click)}},event:{click:function(){c.toggle.call(this)}},toggle:function(e){var t=e!==E?"number"==typeof e?p.eq(e):S(e).closest(h.title):S(this).closest(h.title),n=t.next(g),i=n.hasClass(d.animating),o=n.hasClass(d.active),r=o&&!i,s=!o&&i;c.debug("Toggling visibility of content",t),r||s?u.collapsible?c.close.call(t):c.debug("Cannot close accordion content collapsing is disabled"):c.open.call(t)},open:function(e){var t=e!==E?"number"==typeof e?p.eq(e):S(e).closest(h.title):S(this).closest(h.title),n=t.next(g),i=n.hasClass(d.animating);n.hasClass(d.active)||i?c.debug("Accordion already open, skipping",n):(c.debug("Opening accordion content",t),u.onOpening.call(n),u.onChanging.call(n),u.exclusive&&c.closeOthers.call(t),t.addClass(d.active),n.stop(!0,!0).addClass(d.animating),u.animateChildren&&(S.fn.transition!==E&&f.transition("is supported")?n.children().transition({animation:"fade in",queue:!1,useFailSafe:!0,debug:u.debug,verbose:u.verbose,duration:u.duration,skipInlineHidden:!0,onComplete:function(){n.children().removeClass(d.transition)}}):n.children().stop(!0,!0).animate({opacity:1},u.duration,c.resetOpacity)),n.slideDown(u.duration,u.easing,function(){n.removeClass(d.animating).addClass(d.active),c.reset.display.call(this),u.onOpen.call(this),u.onChange.call(this)}))},close:function(e){var t=e!==E?"number"==typeof e?p.eq(e):S(e).closest(h.title):S(this).closest(h.title),n=t.next(g),i=n.hasClass(d.animating),o=n.hasClass(d.active);!o&&!(!o&&i)||o&&i||(c.debug("Closing accordion content",n),u.onClosing.call(n),u.onChanging.call(n),t.removeClass(d.active),n.stop(!0,!0).addClass(d.animating),u.animateChildren&&(S.fn.transition!==E&&f.transition("is supported")?n.children().transition({animation:"fade out",queue:!1,useFailSafe:!0,debug:u.debug,verbose:u.verbose,duration:u.duration,skipInlineHidden:!0}):n.children().stop(!0,!0).animate({opacity:0},u.duration,c.resetOpacity)),n.slideUp(u.duration,u.easing,function(){n.removeClass(d.animating).removeClass(d.active),c.reset.display.call(this),u.onClose.call(this),u.onChange.call(this)}))},closeOthers:function(e){var t,n,i,o=e!==E?p.eq(e):S(this).closest(h.title),r=o.parents(h.content).prev(h.title),s=o.closest(h.accordion),a=h.title+"."+d.active+":visible",l=h.content+"."+d.active+":visible";i=u.closeNested?(t=s.find(a).not(r)).next(g):(t=s.find(a).not(r),n=s.find(l).find(a).not(r),(t=t.not(n)).next(g)),0<t.length&&(c.debug("Exclusive enabled, closing other content",t),t.removeClass(d.active),i.removeClass(d.animating).stop(!0,!0),u.animateChildren&&(S.fn.transition!==E&&f.transition("is supported")?i.children().transition({animation:"fade out",useFailSafe:!0,debug:u.debug,verbose:u.verbose,duration:u.duration,skipInlineHidden:!0}):i.children().stop(!0,!0).animate({opacity:0},u.duration,c.resetOpacity)),i.slideUp(u.duration,u.easing,function(){S(this).removeClass(d.active),c.reset.display.call(this)}))},reset:{display:function(){c.verbose("Removing inline display from element",this),S(this).css("display",""),""===S(this).attr("style")&&S(this).attr("style","").removeAttr("style")},opacity:function(){c.verbose("Removing inline opacity from element",this),S(this).css("opacity",""),""===S(this).attr("style")&&S(this).attr("style","").removeAttr("style")}},setting:function(e,t){if(c.debug("Changing setting",e,t),S.isPlainObject(e))S.extend(!0,u,e);else{if(t===E)return u[e];S.isPlainObject(u[e])?S.extend(!0,u[e],t):u[e]=t}},internal:function(e,t){if(c.debug("Changing internal",e,t),t===E)return c[e];S.isPlainObject(e)?S.extend(!0,c,e):c[e]=t},debug:function(){!u.silent&&u.debug&&(u.performance?c.performance.log(arguments):(c.debug=Function.prototype.bind.call(console.info,console,u.name+":"),c.debug.apply(console,arguments)))},verbose:function(){!u.silent&&u.verbose&&u.debug&&(u.performance?c.performance.log(arguments):(c.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),c.verbose.apply(console,arguments)))},error:function(){u.silent||(c.error=Function.prototype.bind.call(console.error,console,u.name+":"),c.error.apply(console,arguments))},performance:{log:function(e){var t,n;u.performance&&(n=(t=(new Date).getTime())-(b||t),b=t,y.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:l,"Execution Time":n})),clearTimeout(c.performance.timer),c.performance.timer=setTimeout(c.performance.display,500)},display:function(){var e=u.name+":",n=0;b=!1,clearTimeout(c.performance.timer),S.each(y,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",o&&(e+=" '"+o+"'"),(console.group!==E||console.table!==E)&&0<y.length&&(console.groupCollapsed(e),console.table?console.table(y):S.each(y,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),y=[]}},invoke:function(i,e,t){var o,r,n,s=m;return e=e||x,t=l||t,"string"==typeof i&&s!==E&&(i=i.split(/[\. ]/),o=i.length-1,S.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(S.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==E)return r=s[n],!1;if(!S.isPlainObject(s[t])||e==o)return s[t]!==E?r=s[t]:c.error(a.method,i),!1;s=s[t]}})),S.isFunction(r)?n=r.apply(t,e):r!==E&&(n=r),Array.isArray(v)?v.push(n):v!==E?v=[v,n]:n!==E&&(v=n),r}},T?(m===E&&c.initialize(),c.invoke(w)):(m!==E&&m.invoke("destroy"),c.initialize())}),v!==E?v:this},S.fn.accordion.settings={name:"Accordion",namespace:"accordion",silent:!1,debug:!1,verbose:!1,performance:!0,on:"click",observeChanges:!0,exclusive:!0,collapsible:!0,closeNested:!1,animateChildren:!0,duration:350,easing:"easeOutQuad",onOpening:function(){},onClosing:function(){},onChanging:function(){},onOpen:function(){},onClose:function(){},onChange:function(){},error:{method:"The method you called is not defined"},className:{active:"active",animating:"animating",transition:"transition"},selector:{accordion:".accordion",title:".title",trigger:".title",content:".content"}},S.extend(S.easing,{easeOutQuad:function(e,t,n,i,o){return-i*(t/=o)*(t-2)+n}})}(jQuery,window,document),function(ge,e,S,C){"use strict";ge.isFunction=ge.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),ge.fn.calendar=function(o){var m,e=ge(this),r=e.selector||"",v=(new Date).getTime(),b=[],y=o,w="string"==typeof y,T=[].slice.call(arguments,1),x={5:{row:4,column:3},10:{row:3,column:2},15:{row:2,column:2},20:{row:3,column:1},30:{row:2,column:1}};return e.each(function(){var h,le,ce=ge.isPlainObject(o)?ge.extend(!0,{},ge.fn.calendar.settings,o):ge.extend({},ge.fn.calendar.settings),ue=ce.className,e=ce.namespace,s=ce.selector,de=ce.formatter,n=ce.parser,he=ce.metadata,fe=x[ce.minTimeGap],a=ce.error,t="."+e,i="module-"+e,l=ge(this),c=l.find(s.input),pe=l.find(s.popup),u=l.find(s.activator),d=this,f=l.data(i),p=!1,g=!1;le={initialize:function(){le.debug("Initializing calendar for",d,l),h=le.get.isTouch(),le.setup.config(),le.setup.popup(),le.setup.inline(),le.setup.input(),le.setup.date(),le.create.calendar(),le.bind.events(),le.instantiate()},instantiate:function(){le.verbose("Storing instance of calendar"),f=le,l.data(i,f)},destroy:function(){le.verbose("Destroying previous calendar for",d),l.removeData(i),le.unbind.events()},setup:{config:function(){null!==le.get.minDate()&&le.set.minDate(l.data(he.minDate)),null!==le.get.maxDate()&&le.set.maxDate(l.data(he.maxDate))},popup:function(){if(!ce.inline&&(u.length||(u=l.children().first()).length))if(ge.fn.popup!==C){if(!pe.length){var e=u.parent(),t=0!==e.closest(s.append).length?"appendTo":"prependTo";pe=ge("<div/>").addClass(ue.popup)[t](e)}pe.addClass(ue.calendar);var n=ce.onVisible,i=ce.onHidden;c.length||(pe.attr("tabindex","0"),n=function(){return le.focus(),ce.onVisible.apply(pe,arguments)},i=function(){return le.blur(),ce.onHidden.apply(pe,arguments)});var o=ce.on||(c.length?"focus":"click"),r=ge.extend({},ce.popupOptions,{popup:pe,on:o,hoverable:"hover"===o,onShow:function(){return le.set.focusDate(le.get.date()),le.set.mode(ce.startMode),ce.onShow.apply(pe,arguments)},onVisible:n,onHide:ce.onHide,onHidden:i});le.popup(r)}else le.error(a.popup)},inline:function(){u.length&&!ce.inline||(pe=ge("<div/>").addClass(ue.calendar).appendTo(l),c.length||pe.attr("tabindex","0"))},input:function(){ce.touchReadonly&&c.length&&h&&c.prop("readonly",!0)},date:function(){if(ce.initialDate){var e=n.date(ce.initialDate,ce);le.set.date(e,ce.formatInput,!1)}else if(l.data(he.date)!==C){e=n.date(l.data(he.date),ce);le.set.date(e,ce.formatInput,!1)}else if(c.length){var t=c.val();e=n.date(t,ce);le.set.date(e,ce.formatInput,!1)}}},create:{calendar:function(){var e,t,n,i,o,r,s,a=le.get.mode(),l=new Date,c=le.get.date(),u=le.get.focusDate(),d=u||c||ce.initialDate||l;d=le.helper.dateInRange(d),u||(u=d,le.set.focusDate(u,!1,!1));var h="year"===a,f="month"===a,p="day"===a,g="hour"===a,m="minute"===a,v="time"===ce.type,b=Math.max(ce.multiMonth,1),y=p?le.get.monthOffset():0,w=d.getMinutes(),T=d.getHours(),x=d.getDate(),S=d.getMonth()+y,C=d.getFullYear(),E=p?ce.showWeekNumbers?8:7:g?4:fe.column,P=p||g?6:fe.row,R=p?b:1,I=pe,_=I.hasClass("left")?"right center":"left center";for(I.empty(),1<R&&(s=ge("<div/>").addClass(ue.grid).appendTo(I)),i=0;i<R;i++){if(1<R)I=ge("<div/>").addClass(ue.column).appendTo(s);var A=S+i,O=(new Date(C,A,1).getDay()-ce.firstDayOfWeek%7+7)%7;if(!ce.constantHeight&&p){var k=new Date(C,A+1,0).getDate()+O;P=Math.ceil(k/7)}var D=h?10:f?1:0,M=p?1:0,F=g||m?1:0,L=g||m?x:1,N=new Date(C-D,A-M,L-F,T),H=new Date(C+D,A+M,L+F,T),B=h?new Date(10*Math.ceil(C/10)-9,0,0):f?new Date(C,0,0):p?new Date(C,A,0):new Date(C,A,x,-1),z=h?new Date(10*Math.ceil(C/10)+1,0,1):f?new Date(C+1,0,1):p?new Date(C,A+1,1):new Date(C,A,x+1),j=a;p&&ce.showWeekNumbers&&(j+=" andweek");var U=ge("<table/>").addClass(ue.table).addClass(j).appendTo(I),V=E;if(!v){var q=ge("<thead/>").appendTo(U);o=ge("<tr/>").appendTo(q),r=ge("<th/>").attr("colspan",""+E).appendTo(o);var G=h||f?new Date(C,0,1):p?new Date(C,A,1):new Date(C,A,x,T,w),W=ge("<span/>").addClass(ue.link).appendTo(r);W.text(de.header(G,a,ce));var $=f?ce.disableYear?"day":"year":p?ce.disableMonth?"year":"month":"day";if(W.data(he.mode,$),0===i){var X=ge("<span/>").addClass(ue.prev).appendTo(r);X.data(he.focusDate,N),X.toggleClass(ue.disabledCell,!le.helper.isDateInRange(B,a)),ge("<i/>").addClass(ue.prevIcon).appendTo(X)}if(i===R-1){var Y=ge("<span/>").addClass(ue.next).appendTo(r);Y.data(he.focusDate,H),Y.toggleClass(ue.disabledCell,!le.helper.isDateInRange(z,a)),ge("<i/>").addClass(ue.nextIcon).appendTo(Y)}if(p)for(o=ge("<tr/>").appendTo(q),ce.showWeekNumbers&&((r=ge("<th/>").appendTo(o)).text(ce.text.weekNo),r.addClass(ue.weekCell),V--),e=0;e<V;e++)(r=ge("<th/>").appendTo(o)).text(de.dayColumnHeader((e+ce.firstDayOfWeek)%7,ce))}var Z=ge("<tbody/>").appendTo(U);for(e=h?10*Math.ceil(C/10)-9:p?1-O:0,t=0;t<P;t++)for(o=ge("<tr/>").appendTo(Z),p&&ce.showWeekNumbers&&((r=ge("<th/>").appendTo(o)).text(le.get.weekOfYear(C,A,e+1-ce.firstDayOfWeek)),r.addClass(ue.weekCell)),n=0;n<V;n++,e++){var K=h?new Date(e,A,1,T,w):f?new Date(C,e,1,T,w):p?new Date(C,A,e,T,w):g?new Date(C,A,x,e):new Date(C,A,x,T,e*ce.minTimeGap),Q=h?e:f?ce.text.monthsShort[e]:p?K.getDate():de.time(K,ce,!0);(r=ge("<td/>").addClass(ue.cell).appendTo(o)).text(Q),r.data(he.date,K);var J=p&&K.getMonth()!==(A+12)%12,ee=!ce.selectAdjacentDays&&J||!le.helper.isDateInRange(K,a)||ce.isDisabled(K,a)||le.helper.isDisabled(K,a)||!le.helper.isEnabled(K,a);if(ee){var te=le.helper.findDayAsObject(K,a,ce.disabledDates);null!==te&&te[he.message]&&(r.attr("data-tooltip",te[he.message]),r.attr("data-position",_))}else{var ne=le.helper.findDayAsObject(K,a,ce.eventDates);null!==ne&&(r.addClass(ne[he.class]||ce.eventClass),ne[he.message]&&(r.attr("data-tooltip",ne[he.message]),r.attr("data-position",_)))}var ie=le.helper.dateEqual(K,c,a),oe=le.helper.dateEqual(K,l,a);r.toggleClass(ue.adjacentCell,J),r.toggleClass(ue.disabledCell,ee),r.toggleClass(ue.activeCell,ie&&!J),g||m||r.toggleClass(ue.todayCell,!J&&oe);var re={mode:a,adjacent:J,disabled:ee,active:ie,today:oe};de.cell(r,K,re),le.helper.dateEqual(K,u,a)&&le.set.focusDate(K,!1,!1)}if(ce.today){var se=ge("<tr/>").appendTo(Z),ae=ge("<td/>").attr("colspan",""+E).addClass(ue.today).appendTo(se);ae.text(de.today(ce)),ae.data(he.date,l)}le.update.focus(!1,U)}}},update:{focus:function(e,t){t=t||pe;var a=le.get.mode(),n=le.get.date(),l=le.get.focusDate(),c=le.get.startDate(),u=le.get.endDate(),d=(e?l:null)||n||(h?null:l);t.find("td").each(function(){var e=ge(this),t=e.data(he.date);if(t){var n=e.hasClass(ue.disabledCell),i=e.hasClass(ue.activeCell),o=e.hasClass(ue.adjacentCell),r=le.helper.dateEqual(t,l,a),s=!!d&&(!!c&&le.helper.isDateInRange(t,a,c,d)||!!u&&le.helper.isDateInRange(t,a,d,u));e.toggleClass(ue.focusCell,r&&(!h||p)&&(!o||ce.selectAdjacentDays&&o)&&!n),e.toggleClass(ue.rangeCell,s&&!i&&!n)}})}},refresh:function(){le.create.calendar()},bind:{events:function(){le.debug("Binding events"),pe.on("mousedown"+t,le.event.mousedown),pe.on("touchstart"+t,le.event.mousedown),pe.on("mouseup"+t,le.event.mouseup),pe.on("touchend"+t,le.event.mouseup),pe.on("mouseover"+t,le.event.mouseover),c.length?(c.on("input"+t,le.event.inputChange),c.on("focus"+t,le.event.inputFocus),c.on("blur"+t,le.event.inputBlur),c.on("click"+t,le.event.inputClick),c.on("keydown"+t,le.event.keydown)):pe.on("keydown"+t,le.event.keydown)}},unbind:{events:function(){le.debug("Unbinding events"),pe.off(t),c.length&&c.off(t)}},event:{mouseover:function(e){var t=ge(e.target).data(he.date),n=1===e.buttons;t&&le.set.focusDate(t,!1,!0,n)},mousedown:function(e){c.length&&e.preventDefault(),p=0<=e.type.indexOf("touch");var t=ge(e.target).data(he.date);t&&le.set.focusDate(t,!1,!0,!0)},mouseup:function(e){le.focus(),e.preventDefault(),e.stopPropagation(),p=!1;var t=ge(e.target);if(!t.hasClass("disabled")){var n=t.parent();(n.data(he.date)||n.data(he.focusDate)||n.data(he.mode))&&(t=n);var i=t.data(he.date),o=t.data(he.focusDate),r=t.data(he.mode);if(i&&!1!==ce.onSelect.call(d,i,le.get.mode())){var s=t.hasClass(ue.today);le.selectDate(i,s)}else o?le.set.focusDate(o):r&&le.set.mode(r)}},keydown:function(e){var t=e.which;if(27!==t&&9!==t||le.popup("hide"),le.popup("is visible"))if(37===t||38===t||39===t||40===t){var n="day"===(d=le.get.mode())?7:"hour"===d?4:"minute"===d?fe.column:3,i=37===t?-1:38===t?-n:39==t?1:n;i*="minute"===d?ce.minTimeGap:1;var o=le.get.focusDate()||le.get.date()||new Date,r=o.getFullYear()+("year"===d?i:0),s=o.getMonth()+("month"===d?i:0),a=o.getDate()+("day"===d?i:0),l=o.getHours()+("hour"===d?i:0),c=o.getMinutes()+("minute"===d?i:0),u=new Date(r,s,a,l,c);"time"===ce.type&&(u=le.helper.mergeDateTime(o,u)),le.helper.isDateInRange(u,d)&&le.set.focusDate(u)}else if(13===t){var d=le.get.mode(),h=le.get.focusDate();h&&!ce.isDisabled(h,d)&&!le.helper.isDisabled(h,d)&&le.helper.isEnabled(h,d)&&le.selectDate(h),e.preventDefault(),e.stopPropagation()}38!==t&&40!==t||(e.preventDefault(),le.popup("show"))},inputChange:function(){var e=c.val(),t=n.date(e,ce);le.set.date(t,!1)},inputFocus:function(){pe.addClass(ue.active)},inputBlur:function(){if(pe.removeClass(ue.active),ce.formatInput){var e=le.get.date(),t=de.datetime(e,ce);c.val(t)}},inputClick:function(){le.popup("show")}},get:{weekOfYear:function(e,t,n){var i,o,r;return i=Date.UTC(e,t,n+3)/864e5,o=Math.floor(i/7),r=new Date(6048e5*o).getUTCFullYear(),o-Math.floor(Date.UTC(r,0,7)/6048e5)+1},date:function(){return le.helper.sanitiseDate(l.data(he.date))||null},inputDate:function(){return c.val()},focusDate:function(){return l.data(he.focusDate)||null},startDate:function(){var e=le.get.calendarModule(ce.startCalendar);return(e?e.get.date():l.data(he.startDate))||null},endDate:function(){var e=le.get.calendarModule(ce.endCalendar);return(e?e.get.date():l.data(he.endDate))||null},minDate:function(){return l.data(he.minDate)||null},maxDate:function(){return l.data(he.maxDate)||null},monthOffset:function(){return l.data(he.monthOffset)||0},mode:function(){var e=l.data(he.mode)||ce.startMode,t=le.get.validModes();return 0<=ge.inArray(e,t)?e:"time"===ce.type?"hour":"month"===ce.type?"month":"year"===ce.type?"year":"day"},validModes:function(){var e=[];return"time"!==ce.type&&(ce.disableYear&&"year"!==ce.type||e.push("year"),(ce.disableMonth||"year"===ce.type)&&"month"!==ce.type||e.push("month"),0<=ce.type.indexOf("date")&&e.push("day")),0<=ce.type.indexOf("time")&&(e.push("hour"),ce.disableMinute||e.push("minute")),e},isTouch:function(){try{return S.createEvent("TouchEvent"),!0}catch(e){return!1}},calendarModule:function(e){return e?(e instanceof ge||(e=ge(e).first()),e.data(i)):null}},set:{date:function(e,t,n){t=!1!==t,n=!1!==n,e=le.helper.sanitiseDate(e),e=le.helper.dateInRange(e);var i=le.get.mode(),o=de.datetime(e,ce);if(n&&!1===ce.onChange.call(d,e,o,i))return!1;if(le.set.focusDate(e),ce.isDisabled(e,i))return!1;var r=le.get.endDate();r&&e&&r<e&&le.set.endDate(C),le.set.dataKeyValue(he.date,e),t&&c.length&&c.val(o)},startDate:function(e,t){e=le.helper.sanitiseDate(e);var n=le.get.calendarModule(ce.startCalendar);n&&n.set.date(e),le.set.dataKeyValue(he.startDate,e,t)},endDate:function(e,t){e=le.helper.sanitiseDate(e);var n=le.get.calendarModule(ce.endCalendar);n&&n.set.date(e),le.set.dataKeyValue(he.endDate,e,t)},focusDate:function(e,t,n,i){e=le.helper.sanitiseDate(e),e=le.helper.dateInRange(e);var o="day"===le.get.mode(),r=le.get.focusDate();if(o&&e&&r){var s=12*(e.getFullYear()-r.getFullYear())+e.getMonth()-r.getMonth();if(s){var a=le.get.monthOffset()-s;le.set.monthOffset(a,!1)}}var l=le.set.dataKeyValue(he.focusDate,e,t);n=!1!==n&&l&&!1===t||g!=i,g=i,n&&le.update.focus(i)},minDate:function(e){e=le.helper.sanitiseDate(e),null!==ce.maxDate&&ce.maxDate<=e?le.verbose("Unable to set minDate variable bigger that maxDate variable",e,ce.maxDate):(le.setting("minDate",e),le.set.dataKeyValue(he.minDate,e))},maxDate:function(e){e=le.helper.sanitiseDate(e),null!==ce.minDate&&ce.minDate>=e?le.verbose("Unable to set maxDate variable lower that minDate variable",e,ce.minDate):(le.setting("maxDate",e),le.set.dataKeyValue(he.maxDate,e))},monthOffset:function(e,t){var n=Math.max(ce.multiMonth,1);e=Math.max(1-n,Math.min(0,e)),le.set.dataKeyValue(he.monthOffset,e,t)},mode:function(e,t){le.set.dataKeyValue(he.mode,e,t)},dataKeyValue:function(e,t,n){var i=l.data(e),o=i===t||i<=t&&t<=i;return t?l.data(e,t):l.removeData(e),(n=!1!==n&&!o)&&le.refresh(),!o}},selectDate:function(e,t){le.verbose("New date selection",e);var n=le.get.mode();if(t||"minute"===n||ce.disableMinute&&"hour"===n||"date"===ce.type&&"day"===n||"month"===ce.type&&"month"===n||"year"===ce.type&&"year"===n){if(!(!1===le.set.date(e))&&ce.closable){le.popup("hide");var i=le.get.calendarModule(ce.endCalendar);i&&(i.popup("show"),i.focus())}}else{var o="year"===n?ce.disableMonth?"day":"month":"month"===n?"day":"day"===n?"hour":"minute";le.set.mode(o),"hour"===n||"day"===n&&le.get.date()?le.set.date(e):le.set.focusDate(e)}},changeDate:function(e){le.set.date(e)},clear:function(){le.set.date(C)},popup:function(){return u.popup.apply(u,arguments)},focus:function(){c.length?c.focus():pe.focus()},blur:function(){c.length?c.blur():pe.blur()},helper:{isDisabled:function(t,n){return"day"===n&&(-1!==ce.disabledDaysOfWeek.indexOf(t.getDay())||ce.disabledDates.some(function(e){return"string"==typeof e&&(e=le.helper.sanitiseDate(e)),e instanceof Date?le.helper.dateEqual(t,e,n):null!==e&&"object"==typeof e&&e[he.date]?le.helper.dateEqual(t,le.helper.sanitiseDate(e[he.date]),n):void 0}))},isEnabled:function(t,n){return"day"!==n||(0===ce.enabledDates.length||ce.enabledDates.some(function(e){return"string"==typeof e&&(e=le.helper.sanitiseDate(e)),e instanceof Date?le.helper.dateEqual(t,e,n):null!==e&&"object"==typeof e&&e[he.date]?le.helper.dateEqual(t,le.helper.sanitiseDate(e[he.date]),n):void 0}))},findDayAsObject:function(e,t,n){if("day"===t)for(var i,o=0,r=n.length;o<r;o++){if("string"==typeof(i=n[o])&&(i=le.helper.sanitiseDate(i)),i instanceof Date&&le.helper.dateEqual(e,i,t)){var s={};return s[he.date]=i,s}if(null!==i&&"object"==typeof i&&i[he.date]&&le.helper.dateEqual(e,le.helper.sanitiseDate(i[he.date]),t))return i}return null},sanitiseDate:function(e){return e?(e instanceof Date||(e=n.date(""+e,ce)),!e||null===e||isNaN(e.getTime())?C:e):C},dateDiff:function(e,t,n){n=n||"day";var i="time"===ce.type,o="year"===n,r=o||"month"===n,s="minute"===n,a=s||"hour"===n;return e=new Date(i?2e3:e.getFullYear(),i?0:o?0:e.getMonth(),i?1:r?1:e.getDate(),a?e.getHours():0,s?ce.minTimeGap*Math.floor(e.getMinutes()/ce.minTimeGap):0),(t=new Date(i?2e3:t.getFullYear(),i?0:o?0:t.getMonth(),i?1:r?1:t.getDate(),a?t.getHours():0,s?ce.minTimeGap*Math.floor(t.getMinutes()/ce.minTimeGap):0)).getTime()-e.getTime()},dateEqual:function(e,t,n){return!!e&&!!t&&0===le.helper.dateDiff(e,t,n)},isDateInRange:function(e,t,n,i){if(!n&&!i){var o=le.get.startDate();n=o&&ce.minDate?new Date(Math.max(o,ce.minDate)):o||ce.minDate,i=ce.maxDate}return n=n&&new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),ce.minTimeGap*Math.ceil(n.getMinutes()/ce.minTimeGap)),!(!e||n&&0<le.helper.dateDiff(e,n,t)||i&&0<le.helper.dateDiff(i,e,t))},dateInRange:function(e,t,n){if(!t&&!n){var i=le.get.startDate();t=i&&ce.minDate?new Date(Math.max(i,ce.minDate)):i||ce.minDate,n=ce.maxDate}t=t&&new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),ce.minTimeGap*Math.ceil(t.getMinutes()/ce.minTimeGap));var o="time"===ce.type;return e?t&&0<le.helper.dateDiff(e,t,"minute")?o?le.helper.mergeDateTime(e,t):t:n&&0<le.helper.dateDiff(n,e,"minute")?o?le.helper.mergeDateTime(e,n):n:e:e},mergeDateTime:function(e,t){return e&&t?new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes()):t}},setting:function(e,t){if(le.debug("Changing setting",e,t),ge.isPlainObject(e))ge.extend(!0,ce,e);else{if(t===C)return ce[e];ge.isPlainObject(ce[e])?ge.extend(!0,ce[e],t):ce[e]=t}},internal:function(e,t){if(ge.isPlainObject(e))ge.extend(!0,le,e);else{if(t===C)return le[e];le[e]=t}},debug:function(){!ce.silent&&ce.debug&&(ce.performance?le.performance.log(arguments):(le.debug=Function.prototype.bind.call(console.info,console,ce.name+":"),le.debug.apply(console,arguments)))},verbose:function(){!ce.silent&&ce.verbose&&ce.debug&&(ce.performance?le.performance.log(arguments):(le.verbose=Function.prototype.bind.call(console.info,console,ce.name+":"),le.verbose.apply(console,arguments)))},error:function(){ce.silent||(le.error=Function.prototype.bind.call(console.error,console,ce.name+":"),le.error.apply(console,arguments))},performance:{log:function(e){var t,n;ce.performance&&(n=(t=(new Date).getTime())-(v||t),v=t,b.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:d,"Execution Time":n})),clearTimeout(le.performance.timer),le.performance.timer=setTimeout(le.performance.display,500)},display:function(){var e=ce.name+":",n=0;v=!1,clearTimeout(le.performance.timer),ge.each(b,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",r&&(e+=" '"+r+"'"),(console.group!==C||console.table!==C)&&0<b.length&&(console.groupCollapsed(e),console.table?console.table(b):ge.each(b,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),b=[]}},invoke:function(i,e,t){var o,r,n,s=f;return e=e||T,t=d||t,"string"==typeof i&&s!==C&&(i=i.split(/[\. ]/),o=i.length-1,ge.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(ge.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==C)return r=s[n],!1;if(!ge.isPlainObject(s[t])||e==o)return s[t]!==C?r=s[t]:le.error(a.method,i),!1;s=s[t]}})),ge.isFunction(r)?n=r.apply(t,e):r!==C&&(n=r),Array.isArray(m)?m.push(n):m!==C?m=[m,n]:n!==C&&(m=n),r}},w?(f===C&&le.initialize(),le.invoke(y)):(f!==C&&f.invoke("destroy"),le.initialize())}),m!==C?m:this},ge.fn.calendar.settings={name:"Calendar",namespace:"calendar",silent:!1,debug:!1,verbose:!1,performance:!1,type:"datetime",firstDayOfWeek:0,constantHeight:!0,today:!1,closable:!0,monthFirst:!0,touchReadonly:!0,inline:!1,on:null,initialDate:null,startMode:!1,minDate:null,maxDate:null,ampm:!0,disableYear:!1,disableMonth:!1,disableMinute:!1,formatInput:!0,startCalendar:null,endCalendar:null,multiMonth:1,minTimeGap:5,showWeekNumbers:null,disabledDates:[],disabledDaysOfWeek:[],enabledDates:[],eventDates:[],centuryBreak:60,currentCentury:2e3,selectAdjacentDays:!1,popupOptions:{position:"bottom left",lastResort:"bottom left",prefer:"opposite",hideOnScroll:!1},text:{days:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",now:"Now",am:"AM",pm:"PM",weekNo:"Week"},formatter:{header:function(e,t,n){return"year"===t?n.formatter.yearHeader(e,n):"month"===t?n.formatter.monthHeader(e,n):"day"===t?n.formatter.dayHeader(e,n):"hour"===t?n.formatter.hourHeader(e,n):n.formatter.minuteHeader(e,n)},yearHeader:function(e,t){var n=10*Math.ceil(e.getFullYear()/10);return n-9+" - "+(2+n)},monthHeader:function(e,t){return e.getFullYear()},dayHeader:function(e,t){return t.text.months[e.getMonth()]+" "+e.getFullYear()},hourHeader:function(e,t){return t.formatter.date(e,t)},minuteHeader:function(e,t){return t.formatter.date(e,t)},dayColumnHeader:function(e,t){return t.text.days[e]},datetime:function(e,t){if(!e)return"";var n="time"===t.type?"":t.formatter.date(e,t),i=t.type.indexOf("time")<0?"":t.formatter.time(e,t,!1);return n+("datetime"===t.type?" ":"")+i},date:function(e,t){if(!e)return"";var n=e.getDate(),i=t.text.months[e.getMonth()],o=e.getFullYear();return"year"===t.type?o:"month"===t.type?i+" "+o:(t.monthFirst?i+" "+n:n+" "+i)+", "+o},time:function(e,t,n){if(!e)return"";var i=e.getHours(),o=e.getMinutes(),r="";return t.ampm&&(r=" "+(i<12?t.text.am:t.text.pm),i=0===i?12:12<i?i-12:i),i+":"+(o<10?"0":"")+o+r},today:function(e){return"date"===e.type?e.text.today:e.text.now},cell:function(e,t,n){}},parser:{date:function(e,t){if(e instanceof Date)return e;if(!e)return null;if(0===(e=(""+e).trim().toLowerCase()).length)return null;var n,i,o,r=new Date(e);if(!isNaN(r.getDate()))return r;var s=-1,a=-1,l=-1,c=-1,u=-1,d=C,h="time"===t.type,f=t.type.indexOf("time")<0,p=e.split(t.regExp.dateWords),g=e.split(t.regExp.dateNumbers);if(!f)for(d=0<=ge.inArray(t.text.am.toLowerCase(),p)||!(0<=ge.inArray(t.text.pm.toLowerCase(),p))&&C,n=0;n<g.length;n++){var m=g[n];if(0<=m.indexOf(":")){if(a<0||s<0){var v=m.split(":");for(o=0;o<Math.min(2,v.length);o++)i=parseInt(v[o]),isNaN(i)&&(i=0),0===o?a=i%24:s=i%60}g.splice(n,1)}}if(!h){for(n=0;n<p.length;n++){var b=p[n];if(!(b.length<=0)){for(b=b.substring(0,Math.min(b.length,3)),i=0;i<t.text.months.length;i++){var y=t.text.months[i];if((y=y.substring(0,Math.min(b.length,Math.min(y.length,3))).toLowerCase())===b){c=i+1;break}}if(0<=c)break}}for(n=0;n<g.length;n++)if(i=parseInt(g[n]),!isNaN(i)&&i>=t.centuryBreak&&n===g.length-1){i<=99&&(i+=t.currentCentury-100),u=i,g.splice(n,1);break}if(c<0)for(n=0;n<g.length;n++)if(o=1<n||t.monthFirst?n:1===n?0:1,i=parseInt(g[o]),!isNaN(i)&&1<=i&&i<=12){c=i,g.splice(o,1);break}for(n=0;n<g.length;n++)if(i=parseInt(g[n]),!isNaN(i)&&1<=i&&i<=31){l=i,g.splice(n,1);break}if(u<0)for(n=g.length-1;0<=n;n--)if(i=parseInt(g[n]),!isNaN(i)){i<=99&&(i+=t.currentCentury),u=i,g.splice(n,1);break}}if(!f){if(a<0)for(n=0;n<g.length;n++)if(i=parseInt(g[n]),!isNaN(i)&&0<=i&&i<=23){a=i,g.splice(n,1);break}if(s<0)for(n=0;n<g.length;n++)if(i=parseInt(g[n]),!isNaN(i)&&0<=i&&i<=59){s=i,g.splice(n,1);break}}if(s<0&&a<0&&l<0&&c<0&&u<0)return null;s<0&&(s=0),a<0&&(a=0),l<0&&(l=1),c<0&&(c=1),u<0&&(u=(new Date).getFullYear()),d!==C&&(d?12===a&&(a=0):a<12&&(a+=12));var w=new Date(u,c-1,l,a,s);return w.getMonth()===c-1&&w.getFullYear()===u||(w=new Date(u,c,0,a,s)),isNaN(w.getTime())?null:w}},onChange:function(e,t,n){return!0},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},onSelect:function(e,t){},isDisabled:function(e,t){return!1},selector:{popup:".ui.popup",input:"input",activator:"input",append:".inline.field,.inline.fields"},regExp:{dateWords:/[^A-Za-z\u00C0-\u024F]+/g,dateNumbers:/[^\d:]+/g},error:{popup:"UI Popup, a required component is not included in this page",method:"The method you called is not defined."},className:{calendar:"calendar",active:"active",popup:"ui popup",grid:"ui equal width grid",column:"column",table:"ui celled center aligned unstackable table",prev:"prev link",next:"next link",prevIcon:"chevron left icon",nextIcon:"chevron right icon",link:"link",cell:"link",disabledCell:"disabled",weekCell:"disabled",adjacentCell:"adjacent",activeCell:"active",rangeCell:"range",focusCell:"focus",todayCell:"today",today:"today link"},metadata:{date:"date",focusDate:"focusDate",startDate:"startDate",endDate:"endDate",minDate:"minDate",maxDate:"maxDate",mode:"mode",monthOffset:"monthOffset",message:"message",class:"class"},eventClass:"blue"}}(jQuery,window,document),function(E,P,R,I){"use strict";E.isFunction=E.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},P=void 0!==P&&P.Math==Math?P:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),E.fn.checkbox=function(u){var d,e=E(this),h=e.selector||"",w=(new Date).getTime(),T=[],x=u,S="string"==typeof x,C=[].slice.call(arguments,1);return e.each(function(){var e,f,p=E.extend(!0,{},E.fn.checkbox.settings,u),t=p.className,n=p.namespace,g=p.selector,a=p.error,i="."+n,o="module-"+n,m=E(this),r=E(this).children(g.label),v=E(this).children(g.input),b=v[0],s=!1,y=!1,l=m.data(o),c=this;f={initialize:function(){f.verbose("Initializing checkbox",p),f.create.label(),f.bind.events(),f.set.tabbable(),f.hide.input(),f.observeChanges(),f.instantiate(),f.setup()},instantiate:function(){f.verbose("Storing instance of module",f),l=f,m.data(o,f)},destroy:function(){f.verbose("Destroying module"),f.unbind.events(),f.show.input(),m.removeData(o)},fix:{reference:function(){m.is(g.input)&&(f.debug("Behavior called on <input> adjusting invoked element"),m=m.closest(g.checkbox),f.refresh())}},setup:function(){f.set.initialLoad(),f.is.indeterminate()?(f.debug("Initial value is indeterminate"),f.indeterminate()):f.is.checked()?(f.debug("Initial value is checked"),f.check()):(f.debug("Initial value is unchecked"),f.uncheck()),f.remove.initialLoad()},refresh:function(){r=m.children(g.label),v=m.children(g.input),b=v[0]},hide:{input:function(){f.verbose("Modifying <input> z-index to be unselectable"),v.addClass(t.hidden)}},show:{input:function(){f.verbose("Modifying <input> z-index to be selectable"),v.removeClass(t.hidden)}},observeChanges:function(){"MutationObserver"in P&&((e=new MutationObserver(function(e){f.debug("DOM tree modified, updating selector cache"),f.refresh()})).observe(c,{childList:!0,subtree:!0}),f.debug("Setting up mutation observer",e))},attachEvents:function(e,t){var n=E(e);t=E.isFunction(f[t])?f[t]:f.toggle,0<n.length?(f.debug("Attaching checkbox events to element",e,t),n.on("click"+i,t)):f.error(a.notFound)},preventDefaultOnInputTarget:function(){"undefined"!=typeof event&&E(event.target).is(g.input)&&(f.verbose("Preventing default check action after manual check action"),event.preventDefault())},event:{change:function(e){f.should.ignoreCallbacks()||p.onChange.call(b)},click:function(e){var t=E(e.target);t.is(g.input)?f.verbose("Using default check action on initialized checkbox"):t.is(g.link)?f.debug("Clicking link inside checkbox, skipping toggle"):(f.toggle(),v.focus(),e.preventDefault())},keydown:function(e){var t=e.which,n=13,i=32,o=27,r=37,s=38,a=39,l=40,c=f.get.radios(),u=c.index(m),d=c.length,h=!1;if(t==r||t==s?h=(0===u?d:u)-1:t!=a&&t!=l||(h=u===d-1?0:u+1),!f.should.ignoreCallbacks()&&!1!==h){if(!1===p.beforeUnchecked.apply(b))return f.verbose("Option not allowed to be unchecked, cancelling key navigation"),!1;if(!1===p.beforeChecked.apply(E(c[h]).children(g.input)[0]))return f.verbose("Next option should not allow check, cancelling key navigation"),!1}y=t==o?(f.verbose("Escape key pressed blurring field"),v.blur(),!0):!(e.ctrlKey||!(t==i||t==n&&p.enableEnterKey))&&(f.verbose("Enter/space key pressed, toggling checkbox"),f.toggle(),!0)},keyup:function(e){y&&e.preventDefault()}},check:function(){f.should.allowCheck()&&(f.debug("Checking checkbox",v),f.set.checked(),f.should.ignoreCallbacks()||(p.onChecked.call(b),f.trigger.change()),f.preventDefaultOnInputTarget())},uncheck:function(){f.should.allowUncheck()&&(f.debug("Unchecking checkbox"),f.set.unchecked(),f.should.ignoreCallbacks()||(p.onUnchecked.call(b),f.trigger.change()),f.preventDefaultOnInputTarget())},indeterminate:function(){f.should.allowIndeterminate()?f.debug("Checkbox is already indeterminate"):(f.debug("Making checkbox indeterminate"),f.set.indeterminate(),f.should.ignoreCallbacks()||(p.onIndeterminate.call(b),f.trigger.change()))},determinate:function(){f.should.allowDeterminate()?f.debug("Checkbox is already determinate"):(f.debug("Making checkbox determinate"),f.set.determinate(),f.should.ignoreCallbacks()||(p.onDeterminate.call(b),f.trigger.change()))},enable:function(){f.is.enabled()?f.debug("Checkbox is already enabled"):(f.debug("Enabling checkbox"),f.set.enabled(),f.should.ignoreCallbacks()||(p.onEnable.call(b),p.onEnabled.call(b),f.trigger.change()))},disable:function(){f.is.disabled()?f.debug("Checkbox is already disabled"):(f.debug("Disabling checkbox"),f.set.disabled(),f.should.ignoreCallbacks()||(p.onDisable.call(b),p.onDisabled.call(b),f.trigger.change()))},get:{radios:function(){var e=f.get.name();return E('input[name="'+e+'"]').closest(g.checkbox)},otherRadios:function(){return f.get.radios().not(m)},name:function(){return v.attr("name")}},is:{initialLoad:function(){return s},radio:function(){return v.hasClass(t.radio)||"radio"==v.attr("type")},indeterminate:function(){return v.prop("indeterminate")!==I&&v.prop("indeterminate")},checked:function(){return v.prop("checked")!==I&&v.prop("checked")},disabled:function(){return v.prop("disabled")!==I&&v.prop("disabled")},enabled:function(){return!f.is.disabled()},determinate:function(){return!f.is.indeterminate()},unchecked:function(){return!f.is.checked()}},should:{allowCheck:function(){return f.is.determinate()&&f.is.checked()&&!f.is.initialLoad()?(f.debug("Should not allow check, checkbox is already checked"),!1):!(!f.should.ignoreCallbacks()&&!1===p.beforeChecked.apply(b))||(f.debug("Should not allow check, beforeChecked cancelled"),!1)},allowUncheck:function(){return f.is.determinate()&&f.is.unchecked()&&!f.is.initialLoad()?(f.debug("Should not allow uncheck, checkbox is already unchecked"),!1):!(!f.should.ignoreCallbacks()&&!1===p.beforeUnchecked.apply(b))||(f.debug("Should not allow uncheck, beforeUnchecked cancelled"),!1)},allowIndeterminate:function(){return f.is.indeterminate()&&!f.is.initialLoad()?(f.debug("Should not allow indeterminate, checkbox is already indeterminate"),!1):!(!f.should.ignoreCallbacks()&&!1===p.beforeIndeterminate.apply(b))||(f.debug("Should not allow indeterminate, beforeIndeterminate cancelled"),!1)},allowDeterminate:function(){return f.is.determinate()&&!f.is.initialLoad()?(f.debug("Should not allow determinate, checkbox is already determinate"),!1):!(!f.should.ignoreCallbacks()&&!1===p.beforeDeterminate.apply(b))||(f.debug("Should not allow determinate, beforeDeterminate cancelled"),!1)},ignoreCallbacks:function(){return s&&!p.fireOnInit}},can:{change:function(){return!(m.hasClass(t.disabled)||m.hasClass(t.readOnly)||v.prop("disabled")||v.prop("readonly"))},uncheck:function(){return"boolean"==typeof p.uncheckable?p.uncheckable:!f.is.radio()}},set:{initialLoad:function(){s=!0},checked:function(){f.verbose("Setting class to checked"),m.removeClass(t.indeterminate).addClass(t.checked),f.is.radio()&&f.uncheckOthers(),f.is.indeterminate()||!f.is.checked()?(f.verbose("Setting state to checked",b),v.prop("indeterminate",!1).prop("checked",!0)):f.debug("Input is already checked, skipping input property change")},unchecked:function(){f.verbose("Removing checked class"),m.removeClass(t.indeterminate).removeClass(t.checked),f.is.indeterminate()||!f.is.unchecked()?(f.debug("Setting state to unchecked"),v.prop("indeterminate",!1).prop("checked",!1)):f.debug("Input is already unchecked")},indeterminate:function(){f.verbose("Setting class to indeterminate"),m.addClass(t.indeterminate),f.is.indeterminate()?f.debug("Input is already indeterminate, skipping input property change"):(f.debug("Setting state to indeterminate"),v.prop("indeterminate",!0))},determinate:function(){f.verbose("Removing indeterminate class"),m.removeClass(t.indeterminate),f.is.determinate()?f.debug("Input is already determinate, skipping input property change"):(f.debug("Setting state to determinate"),v.prop("indeterminate",!1))},disabled:function(){f.verbose("Setting class to disabled"),m.addClass(t.disabled),f.is.disabled()?f.debug("Input is already disabled, skipping input property change"):(f.debug("Setting state to disabled"),v.prop("disabled","disabled"))},enabled:function(){f.verbose("Removing disabled class"),m.removeClass(t.disabled),f.is.enabled()?f.debug("Input is already enabled, skipping input property change"):(f.debug("Setting state to enabled"),v.prop("disabled",!1))},tabbable:function(){f.verbose("Adding tabindex to checkbox"),v.attr("tabindex")===I&&v.attr("tabindex",0)}},remove:{initialLoad:function(){s=!1}},trigger:{change:function(){var e=R.createEvent("HTMLEvents"),t=v[0];t&&(f.verbose("Triggering native change event"),e.initEvent("change",!0,!1),t.dispatchEvent(e))}},create:{label:function(){0<v.prevAll(g.label).length?(v.prev(g.label).detach().insertAfter(v),f.debug("Moving existing label",r)):f.has.label()||(r=E("<label>").insertAfter(v),f.debug("Creating label",r))}},has:{label:function(){return 0<r.length}},bind:{events:function(){f.verbose("Attaching checkbox events"),m.on("click"+i,f.event.click).on("change"+i,f.event.change).on("keydown"+i,g.input,f.event.keydown).on("keyup"+i,g.input,f.event.keyup)}},unbind:{events:function(){f.debug("Removing events"),m.off(i)}},uncheckOthers:function(){var e=f.get.otherRadios();f.debug("Unchecking other radios",e),e.removeClass(t.checked)},toggle:function(){f.can.change()?f.is.indeterminate()||f.is.unchecked()?(f.debug("Currently unchecked"),f.check()):f.is.checked()&&f.can.uncheck()&&(f.debug("Currently checked"),f.uncheck()):f.is.radio()||f.debug("Checkbox is read-only or disabled, ignoring toggle")},setting:function(e,t){if(f.debug("Changing setting",e,t),E.isPlainObject(e))E.extend(!0,p,e);else{if(t===I)return p[e];E.isPlainObject(p[e])?E.extend(!0,p[e],t):p[e]=t}},internal:function(e,t){if(E.isPlainObject(e))E.extend(!0,f,e);else{if(t===I)return f[e];f[e]=t}},debug:function(){!p.silent&&p.debug&&(p.performance?f.performance.log(arguments):(f.debug=Function.prototype.bind.call(console.info,console,p.name+":"),f.debug.apply(console,arguments)))},verbose:function(){!p.silent&&p.verbose&&p.debug&&(p.performance?f.performance.log(arguments):(f.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),f.verbose.apply(console,arguments)))},error:function(){p.silent||(f.error=Function.prototype.bind.call(console.error,console,p.name+":"),f.error.apply(console,arguments))},performance:{log:function(e){var t,n;p.performance&&(n=(t=(new Date).getTime())-(w||t),w=t,T.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:c,"Execution Time":n})),clearTimeout(f.performance.timer),f.performance.timer=setTimeout(f.performance.display,500)},display:function(){var e=p.name+":",n=0;w=!1,clearTimeout(f.performance.timer),E.each(T,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",h&&(e+=" '"+h+"'"),(console.group!==I||console.table!==I)&&0<T.length&&(console.groupCollapsed(e),console.table?console.table(T):E.each(T,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),T=[]}},invoke:function(i,e,t){var o,r,n,s=l;return e=e||C,t=c||t,"string"==typeof i&&s!==I&&(i=i.split(/[\. ]/),o=i.length-1,E.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(E.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==I)return r=s[n],!1;if(!E.isPlainObject(s[t])||e==o)return s[t]!==I?r=s[t]:f.error(a.method,i),!1;s=s[t]}})),E.isFunction(r)?n=r.apply(t,e):r!==I&&(n=r),Array.isArray(d)?d.push(n):d!==I?d=[d,n]:n!==I&&(d=n),r}},S?(l===I&&f.initialize(),f.invoke(x)):(l!==I&&l.invoke("destroy"),f.initialize())}),d!==I?d:this},E.fn.checkbox.settings={name:"Checkbox",namespace:"checkbox",silent:!1,debug:!1,verbose:!0,performance:!0,uncheckable:"auto",fireOnInit:!1,enableEnterKey:!0,onChange:function(){},beforeChecked:function(){},beforeUnchecked:function(){},beforeDeterminate:function(){},beforeIndeterminate:function(){},onChecked:function(){},onUnchecked:function(){},onDeterminate:function(){},onIndeterminate:function(){},onEnable:function(){},onDisable:function(){},onEnabled:function(){},onDisabled:function(){},className:{checked:"checked",indeterminate:"indeterminate",disabled:"disabled",hidden:"hidden",radio:"radio",readOnly:"read-only"},error:{method:"The method you called is not defined"},selector:{checkbox:".ui.checkbox",label:"label, .box",input:'input[type="checkbox"], input[type="radio"]',link:"a[href]"}}}(jQuery,window,document),function(S,e,C,E){"use strict";S.isFunction=S.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),S.fn.dimmer=function(g){var m,v=S(this),b=(new Date).getTime(),y=[],w=g,T="string"==typeof w,x=[].slice.call(arguments,1);return v.each(function(){var r,t,a,s=S.isPlainObject(g)?S.extend(!0,{},S.fn.dimmer.settings,g):S.extend({},S.fn.dimmer.settings),n=s.selector,e=s.namespace,i=s.className,l=s.error,o="."+e,c="module-"+e,u=v.selector||"",d="ontouchstart"in C.documentElement?"touchstart":"click",h=S(this),f=this,p=h.data(c);(a={preinitialize:function(){r=a.is.dimmer()?(t=h.parent(),h):(t=h,a.has.dimmer()?s.dimmerName?t.find(n.dimmer).filter("."+s.dimmerName):t.find(n.dimmer):a.create())},initialize:function(){a.debug("Initializing dimmer",s),a.bind.events(),a.set.dimmable(),a.instantiate()},instantiate:function(){a.verbose("Storing instance of module",a),p=a,h.data(c,p)},destroy:function(){a.verbose("Destroying previous module",r),a.unbind.events(),a.remove.variation(),t.off(o)},bind:{events:function(){"hover"==s.on?t.on("mouseenter"+o,a.show).on("mouseleave"+o,a.hide):"click"==s.on&&t.on(d+o,a.toggle),a.is.page()&&(a.debug("Setting as a page dimmer",t),a.set.pageDimmer()),a.is.closable()&&(a.verbose("Adding dimmer close event",r),t.on(d+o,n.dimmer,a.event.click))}},unbind:{events:function(){h.removeData(c),t.off(o)}},event:{click:function(e){a.verbose("Determining if event occured on dimmer",e),0!==r.find(e.target).length&&!S(e.target).is(n.content)||(a.hide(),e.stopImmediatePropagation())}},addContent:function(e){var t=S(e);a.debug("Add content to dimmer",t),t.parent()[0]!==r[0]&&t.detach().appendTo(r)},create:function(){var e=S(s.template.dimmer(s));return s.dimmerName&&(a.debug("Creating named dimmer",s.dimmerName),e.addClass(s.dimmerName)),e.appendTo(t),e},show:function(e){e=S.isFunction(e)?e:function(){},a.debug("Showing dimmer",r,s),a.set.variation(),a.is.dimmed()&&!a.is.animating()||!a.is.enabled()?a.debug("Dimmer is already shown or disabled"):(a.animate.show(e),s.onShow.call(f),s.onChange.call(f))},hide:function(e){e=S.isFunction(e)?e:function(){},a.is.dimmed()||a.is.animating()?(a.debug("Hiding dimmer",r),a.animate.hide(e),s.onHide.call(f),s.onChange.call(f)):a.debug("Dimmer is not visible")},toggle:function(){a.verbose("Toggling dimmer visibility",r),a.is.dimmed()?a.is.closable()&&a.hide():a.show()},animate:{show:function(e){e=S.isFunction(e)?e:function(){},s.useCSS&&S.fn.transition!==E&&r.transition("is supported")?(s.useFlex?(a.debug("Using flex dimmer"),a.remove.legacy()):(a.debug("Using legacy non-flex dimmer"),a.set.legacy()),"auto"!==s.opacity&&a.set.opacity(),r.transition({displayType:s.useFlex?"flex":"block",animation:s.transition+" in",queue:!1,duration:a.get.duration(),useFailSafe:!0,onStart:function(){a.set.dimmed()},onComplete:function(){a.set.active(),e()}})):(a.verbose("Showing dimmer animation with javascript"),a.set.dimmed(),"auto"==s.opacity&&(s.opacity=.8),r.stop().css({opacity:0,width:"100%",height:"100%"}).fadeTo(a.get.duration(),s.opacity,function(){r.removeAttr("style"),a.set.active(),e()}))},hide:function(e){e=S.isFunction(e)?e:function(){},s.useCSS&&S.fn.transition!==E&&r.transition("is supported")?(a.verbose("Hiding dimmer with css"),r.transition({displayType:s.useFlex?"flex":"block",animation:s.transition+" out",queue:!1,duration:a.get.duration(),useFailSafe:!0,onComplete:function(){a.remove.dimmed(),a.remove.variation(),a.remove.active(),e()}})):(a.verbose("Hiding dimmer with javascript"),r.stop().fadeOut(a.get.duration(),function(){a.remove.dimmed(),a.remove.active(),r.removeAttr("style"),e()}))}},get:{dimmer:function(){return r},duration:function(){return"object"==typeof s.duration?a.is.active()?s.duration.hide:s.duration.show:s.duration}},has:{dimmer:function(){return s.dimmerName?0<h.find(n.dimmer).filter("."+s.dimmerName).length:0<h.find(n.dimmer).length}},is:{active:function(){return r.hasClass(i.active)},animating:function(){return r.is(":animated")||r.hasClass(i.animating)},closable:function(){return"auto"==s.closable?"hover"!=s.on:s.closable},dimmer:function(){return h.hasClass(i.dimmer)},dimmable:function(){return h.hasClass(i.dimmable)},dimmed:function(){return t.hasClass(i.dimmed)},disabled:function(){return t.hasClass(i.disabled)},enabled:function(){return!a.is.disabled()},page:function(){return t.is("body")},pageDimmer:function(){return r.hasClass(i.pageDimmer)}},can:{show:function(){return!r.hasClass(i.disabled)}},set:{opacity:function(e){var t=r.css("background-color"),n=t.split(","),i=n&&3==n.length,o=n&&4==n.length;e=0===s.opacity?0:s.opacity||e,t=i||o?(n[3]=e+")",n.join(",")):"rgba(0, 0, 0, "+e+")",a.debug("Setting opacity to",e),r.css("background-color",t)},legacy:function(){r.addClass(i.legacy)},active:function(){r.addClass(i.active)},dimmable:function(){t.addClass(i.dimmable)},dimmed:function(){t.addClass(i.dimmed)},pageDimmer:function(){r.addClass(i.pageDimmer)},disabled:function(){r.addClass(i.disabled)},variation:function(e){(e=e||s.variation)&&r.addClass(e)}},remove:{active:function(){r.removeClass(i.active)},legacy:function(){r.removeClass(i.legacy)},dimmed:function(){t.removeClass(i.dimmed)},disabled:function(){r.removeClass(i.disabled)},variation:function(e){(e=e||s.variation)&&r.removeClass(e)}},setting:function(e,t){if(a.debug("Changing setting",e,t),S.isPlainObject(e))S.extend(!0,s,e);else{if(t===E)return s[e];S.isPlainObject(s[e])?S.extend(!0,s[e],t):s[e]=t}},internal:function(e,t){if(S.isPlainObject(e))S.extend(!0,a,e);else{if(t===E)return a[e];a[e]=t}},debug:function(){!s.silent&&s.debug&&(s.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,s.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!s.silent&&s.verbose&&s.debug&&(s.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,s.name+":"),a.verbose.apply(console,arguments)))},error:function(){s.silent||(a.error=Function.prototype.bind.call(console.error,console,s.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;s.performance&&(n=(t=(new Date).getTime())-(b||t),b=t,y.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:f,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=s.name+":",n=0;b=!1,clearTimeout(a.performance.timer),S.each(y,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",u&&(e+=" '"+u+"'"),1<v.length&&(e+=" ("+v.length+")"),(console.group!==E||console.table!==E)&&0<y.length&&(console.groupCollapsed(e),console.table?console.table(y):S.each(y,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),y=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||x,t=f||t,"string"==typeof i&&s!==E&&(i=i.split(/[\. ]/),o=i.length-1,S.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(S.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==E)return r=s[n],!1;if(!S.isPlainObject(s[t])||e==o)return s[t]!==E?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),S.isFunction(r)?n=r.apply(t,e):r!==E&&(n=r),Array.isArray(m)?m.push(n):m!==E?m=[m,n]:n!==E&&(m=n),r}}).preinitialize(),T?(p===E&&a.initialize(),a.invoke(w)):(p!==E&&p.invoke("destroy"),a.initialize())}),m!==E?m:this},S.fn.dimmer.settings={name:"Dimmer",namespace:"dimmer",silent:!1,debug:!1,verbose:!1,performance:!0,useFlex:!0,dimmerName:!1,variation:!1,closable:"auto",useCSS:!0,transition:"fade",on:!1,opacity:"auto",duration:{show:500,hide:500},displayLoader:!1,loaderText:!1,loaderVariation:"",onChange:function(){},onShow:function(){},onHide:function(){},error:{method:"The method you called is not defined."},className:{active:"active",animating:"animating",dimmable:"dimmable",dimmed:"dimmed",dimmer:"dimmer",disabled:"disabled",hide:"hide",legacy:"legacy",pageDimmer:"page",show:"show",loader:"ui loader"},selector:{dimmer:"> .ui.dimmer",content:".ui.dimmer > .content, .ui.dimmer > .content > .center"},template:{dimmer:function(e){var t,n=S("<div/>").addClass("ui dimmer");return e.displayLoader&&(t=S("<div/>").addClass(e.className.loader).addClass(e.loaderVariation),e.loaderText&&(t.text(e.loaderText),t.addClass("text")),n.append(t)),n}}}}(jQuery,window,document),function(Q,J,ee,te){"use strict";Q.isFunction=Q.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},J=void 0!==J&&J.Math==Math?J:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),Q.fn.dropdown=function(j){var U,V=Q(this),q=Q(ee),G=V.selector||"",W="ontouchstart"in ee.documentElement,$=(new Date).getTime(),X=[],Y=j,Z="string"==typeof Y,K=[].slice.call(arguments,1);return V.each(function(n){var c,e,t,i,o,r,s,a,g,p=Q.isPlainObject(j)?Q.extend(!0,{},Q.fn.dropdown.settings,j):Q.extend({},Q.fn.dropdown.settings),m=p.className,u=p.message,l=p.fields,v=p.keys,b=p.metadata,d=p.namespace,h=p.regExp,y=p.selector,f=p.error,w=p.templates,T="."+d,x="module-"+d,S=Q(this),C=Q(p.context),E=S.find(y.text),P=S.find(y.search),R=S.find(y.sizer),I=S.find(y.input),_=S.find(y.icon),A=S.find(y.clearIcon),O=0<S.prev().find(y.text).length?S.prev().find(y.text):S.prev(),k=S.children(y.menu),D=k.find(y.item),M=p.hideDividers?D.parent().children(y.divider):Q(),F=!1,L=!1,N=!1,H=!1,B=this,z=S.data(x);g={initialize:function(){g.debug("Initializing dropdown",p),g.is.alreadySetup()?g.setup.reference():(p.ignoreDiacritics&&!String.prototype.normalize&&(p.ignoreDiacritics=!1,g.error(f.noNormalize,B)),g.setup.layout(),p.values&&g.change.values(p.values),g.refreshData(),g.save.defaults(),g.restore.selected(),g.create.id(),g.bind.events(),g.observeChanges(),g.instantiate())},instantiate:function(){g.verbose("Storing instance of dropdown",g),z=g,S.data(x,g)},destroy:function(){g.verbose("Destroying previous dropdown",S),g.remove.tabbable(),g.remove.active(),k.transition("stop all"),k.removeClass(m.visible).addClass(m.hidden),S.off(T).removeData(x),k.off(T),q.off(o),g.disconnect.menuObserver(),g.disconnect.selectObserver()},observeChanges:function(){"MutationObserver"in J&&(s=new MutationObserver(g.event.select.mutation),a=new MutationObserver(g.event.menu.mutation),g.debug("Setting up mutation observer",s,a),g.observe.select(),g.observe.menu())},disconnect:{menuObserver:function(){a&&a.disconnect()},selectObserver:function(){s&&s.disconnect()}},observe:{select:function(){g.has.input()&&s&&s.observe(S[0],{childList:!0,subtree:!0})},menu:function(){g.has.menu()&&a&&a.observe(k[0],{childList:!0,subtree:!0})}},create:{id:function(){r=(Math.random().toString(16)+"000000000").substr(2,8),o="."+r,g.verbose("Creating unique id for element",r)},userChoice:function(e){var n,i,o;return!!(e=e||g.get.userValues())&&(e=Array.isArray(e)?e:[e],Q.each(e,function(e,t){!1===g.get.item(t)&&(o=p.templates.addition(g.add.variables(u.addResult,t)),i=Q("<div />").html(o).attr("data-"+b.value,t).attr("data-"+b.text,t).addClass(m.addition).addClass(m.item),p.hideAdditions&&i.addClass(m.hidden),n=n===te?i:n.add(i),g.verbose("Creating user choices for value",t,i))}),n)},userLabels:function(e){var t=g.get.userValues();t&&(g.debug("Adding user labels",t),Q.each(t,function(e,t){g.verbose("Adding custom user value"),g.add.label(t,t)}))},menu:function(){k=Q("<div />").addClass(m.menu).appendTo(S)},sizer:function(){R=Q("<span />").addClass(m.sizer).insertAfter(P)}},search:function(e){e=e!==te?e:g.get.query(),g.verbose("Searching for query",e),g.has.minCharacters(e)?g.filter(e):g.hide()},select:{firstUnfiltered:function(){g.verbose("Selecting first non-filtered element"),g.remove.selectedItem(),D.not(y.unselectable).not(y.addition+y.hidden).eq(0).addClass(m.selected)},nextAvailable:function(e){var t=(e=e.eq(0)).nextAll(y.item).not(y.unselectable).eq(0),n=e.prevAll(y.item).not(y.unselectable).eq(0);0<t.length?(g.verbose("Moving selection to",t),t.addClass(m.selected)):(g.verbose("Moving selection to",n),n.addClass(m.selected))}},setup:{api:function(){var e={debug:p.debug,urlData:{value:g.get.value(),query:g.get.query()},on:!1};g.verbose("First request, initializing API"),S.api(e)},layout:function(){S.is("select")&&(g.setup.select(),g.setup.returnedObject()),g.has.menu()||g.create.menu(),g.is.selection()&&g.is.clearable()&&!g.has.clearItem()&&(g.verbose("Adding clear icon"),A=Q("<i />").addClass("remove icon").insertBefore(E)),g.is.search()&&!g.has.search()&&(g.verbose("Adding search input"),P=Q("<input />").addClass(m.search).prop("autocomplete","off").insertBefore(E)),g.is.multiple()&&g.is.searchSelection()&&!g.has.sizer()&&g.create.sizer(),p.allowTab&&g.set.tabbable()},select:function(){var e=g.get.selectValues();g.debug("Dropdown initialized on a select",e),S.is("select")&&(I=S),0<I.parent(y.dropdown).length?(g.debug("UI dropdown already exists. Creating dropdown menu only"),S=I.closest(y.dropdown),g.has.menu()||g.create.menu(),k=S.children(y.menu),g.setup.menu(e)):(g.debug("Creating entire dropdown from select"),S=Q("<div />").attr("class",I.attr("class")).addClass(m.selection).addClass(m.dropdown).html(w.dropdown(e,l,p.preserveHTML,p.className)).insertBefore(I),I.hasClass(m.multiple)&&!1===I.prop("multiple")&&(g.error(f.missingMultiple),I.prop("multiple",!0)),I.is("[multiple]")&&g.set.multiple(),I.prop("disabled")&&(g.debug("Disabling dropdown"),S.addClass(m.disabled)),I.removeAttr("class").detach().prependTo(S)),g.refresh()},menu:function(e){k.html(w.menu(e,l,p.preserveHTML,p.className)),D=k.find(y.item),M=p.hideDividers?D.parent().children(y.divider):Q()},reference:function(){g.debug("Dropdown behavior was called on select, replacing with closest dropdown"),S=S.parent(y.dropdown),z=S.data(x),B=S.get(0),g.refresh(),g.setup.returnedObject()},returnedObject:function(){var e=V.slice(0,n),t=V.slice(n+1);V=e.add(S).add(t)}},refresh:function(){g.refreshSelectors(),g.refreshData()},refreshItems:function(){D=k.find(y.item),M=p.hideDividers?D.parent().children(y.divider):Q()},refreshSelectors:function(){g.verbose("Refreshing selector cache"),E=S.find(y.text),P=S.find(y.search),I=S.find(y.input),_=S.find(y.icon),O=0<S.prev().find(y.text).length?S.prev().find(y.text):S.prev(),k=S.children(y.menu),D=k.find(y.item),M=p.hideDividers?D.parent().children(y.divider):Q()},refreshData:function(){g.verbose("Refreshing cached metadata"),D.removeData(b.text).removeData(b.value)},clearData:function(){g.verbose("Clearing metadata"),D.removeData(b.text).removeData(b.value),S.removeData(b.defaultText).removeData(b.defaultValue).removeData(b.placeholderText)},toggle:function(){g.verbose("Toggling menu visibility"),g.is.active()?g.hide():g.show()},show:function(e){if(e=Q.isFunction(e)?e:function(){},!g.can.show()&&g.is.remote()&&(g.debug("No API results retrieved, searching before show"),g.queryRemote(g.get.query(),g.show)),g.can.show()&&!g.is.active()){if(g.debug("Showing dropdown"),!g.has.message()||g.has.maxSelections()||g.has.allResultsFiltered()||g.remove.message(),g.is.allFiltered())return!0;!1!==p.onShow.call(B)&&g.animate.show(function(){g.can.click()&&g.bind.intent(),g.has.search()&&g.focusSearch(),g.set.visible(),e.call(B)})}},hide:function(e){e=Q.isFunction(e)?e:function(){},g.is.active()&&!g.is.animatingOutward()?(g.debug("Hiding dropdown"),!1!==p.onHide.call(B)&&g.animate.hide(function(){g.remove.visible(),g.is.focusedOnSearch()&&P.blur(),e.call(B)})):g.can.click()&&g.unbind.intent()},hideOthers:function(){g.verbose("Finding other dropdowns to hide"),V.not(S).has(y.menu+"."+m.visible).dropdown("hide")},hideMenu:function(){g.verbose("Hiding menu  instantaneously"),g.remove.active(),g.remove.visible(),k.transition("hide")},hideSubMenus:function(){var e=k.children(y.item).find(y.menu);g.verbose("Hiding sub menus",e),e.transition("hide")},bind:{events:function(){W&&g.bind.touchEvents(),g.bind.keyboardEvents(),g.bind.inputEvents(),g.bind.mouseEvents()},touchEvents:function(){g.debug("Touch device detected binding additional touch events"),g.is.searchSelection()||g.is.single()&&S.on("touchstart"+T,g.event.test.toggle),k.on("touchstart"+T,y.item,g.event.item.mouseenter)},keyboardEvents:function(){g.verbose("Binding keyboard events"),S.on("keydown"+T,g.event.keydown),g.has.search()&&S.on(g.get.inputEvent()+T,y.search,g.event.input),g.is.multiple()&&q.on("keydown"+o,g.event.document.keydown)},inputEvents:function(){g.verbose("Binding input change events"),S.on("change"+T,y.input,g.event.change)},mouseEvents:function(){g.verbose("Binding mouse events"),g.is.multiple()&&S.on("click"+T,y.label,g.event.label.click).on("click"+T,y.remove,g.event.remove.click),g.is.searchSelection()?(S.on("mousedown"+T,g.event.mousedown).on("mouseup"+T,g.event.mouseup).on("mousedown"+T,y.menu,g.event.menu.mousedown).on("mouseup"+T,y.menu,g.event.menu.mouseup).on("click"+T,y.icon,g.event.icon.click).on("click"+T,y.clearIcon,g.event.clearIcon.click).on("focus"+T,y.search,g.event.search.focus).on("click"+T,y.search,g.event.search.focus).on("blur"+T,y.search,g.event.search.blur).on("click"+T,y.text,g.event.text.focus),g.is.multiple()&&S.on("click"+T,g.event.click)):("click"==p.on?S.on("click"+T,y.icon,g.event.icon.click).on("click"+T,g.event.test.toggle):"hover"==p.on?S.on("mouseenter"+T,g.delay.show).on("mouseleave"+T,g.delay.hide):S.on(p.on+T,g.toggle),S.on("mousedown"+T,g.event.mousedown).on("mouseup"+T,g.event.mouseup).on("focus"+T,g.event.focus).on("click"+T,y.clearIcon,g.event.clearIcon.click),g.has.menuSearch()?S.on("blur"+T,y.search,g.event.search.blur):S.on("blur"+T,g.event.blur)),k.on("mouseenter"+T,y.item,g.event.item.mouseenter).on("mouseleave"+T,y.item,g.event.item.mouseleave).on("click"+T,y.item,g.event.item.click)},intent:function(){g.verbose("Binding hide intent event to document"),W&&q.on("touchstart"+o,g.event.test.touch).on("touchmove"+o,g.event.test.touch),q.on("click"+o,g.event.test.hide)}},unbind:{intent:function(){g.verbose("Removing hide intent event from document"),W&&q.off("touchstart"+o).off("touchmove"+o),q.off("click"+o)}},filter:function(e){function t(){g.is.multiple()&&g.filterActive(),(e||!e&&0==g.get.activeItem().length)&&g.select.firstUnfiltered(),g.has.allResultsFiltered()?p.onNoResults.call(B,n)?p.allowAdditions?p.hideAdditions&&(g.verbose("User addition with no menu, setting empty style"),g.set.empty(),g.hideMenu()):(g.verbose("All items filtered, showing message",n),g.add.message(u.noResults)):(g.verbose("All items filtered, hiding dropdown",n),g.hideMenu()):(g.remove.empty(),g.remove.message()),p.allowAdditions&&g.add.userSuggestion(g.escape.htmlEntities(e)),g.is.searchSelection()&&g.can.show()&&g.is.focusedOnSearch()&&g.show()}var n=e!==te?e:g.get.query();p.useLabels&&g.has.maxSelections()||(p.apiSettings?g.can.useAPI()?g.queryRemote(n,function(){p.filterRemoteData&&g.filterItems(n);var e=I.val();Array.isArray(e)||(e=e&&""!==e?e.split(p.delimiter):[]),Q.each(e,function(e,t){D.filter('[data-value="'+t+'"]').addClass(m.filtered)}),t()}):g.error(f.noAPI):(g.filterItems(n),t()))},queryRemote:function(e,n){var t={errorDuration:!1,cache:"local",throttle:p.throttle,urlData:{query:e},onError:function(){g.add.message(u.serverError),n()},onFailure:function(){g.add.message(u.serverError),n()},onSuccess:function(e){var t=e[l.remoteValues];Array.isArray(t)||(t=[]),g.remove.message(),g.setup.menu({values:t}),0!==t.length||p.allowAdditions||g.add.message(u.noResults),n()}};S.api("get request")||g.setup.api(),t=Q.extend(!0,{},t,p.apiSettings),S.api("setting",t).api("query")},filterItems:function(e){var i=g.remove.diacritics(e!==te?e:g.get.query()),o=null,t=g.escape.string(i),r=new RegExp("^"+t,"igm");g.has.query()&&(o=[],g.verbose("Searching for matching values",i),D.each(function(){var e,t,n=Q(this);if("both"===p.match||"text"===p.match){if(-1!==(e=g.remove.diacritics(String(g.get.choiceText(n,!1)))).search(r))return o.push(this),!0;if("exact"===p.fullTextSearch&&g.exactSearch(i,e))return o.push(this),!0;if(!0===p.fullTextSearch&&g.fuzzySearch(i,e))return o.push(this),!0}if("both"===p.match||"value"===p.match){if(-1!==(t=g.remove.diacritics(String(g.get.choiceValue(n,e)))).search(r))return o.push(this),!0;if("exact"===p.fullTextSearch&&g.exactSearch(i,t))return o.push(this),!0;if(!0===p.fullTextSearch&&g.fuzzySearch(i,t))return o.push(this),!0}})),g.debug("Showing only matched items",i),g.remove.filteredItem(),o&&D.not(o).addClass(m.filtered),g.has.query()?!0===p.hideDividers?M.addClass(m.hidden):"empty"===p.hideDividers&&M.removeClass(m.hidden).filter(function(){var e=Q(this).nextUntil(y.item);return 0===(e.length?e:Q(this)).nextUntil(y.divider).filter(y.item+":not(."+m.filtered+")").length}).addClass(m.hidden):M.removeClass(m.hidden)},fuzzySearch:function(e,t){var n=t.length,i=e.length;if(e=e.toLowerCase(),t=t.toLowerCase(),n<i)return!1;if(i===n)return e===t;e:for(var o=0,r=0;o<i;o++){for(var s=e.charCodeAt(o);r<n;)if(t.charCodeAt(r++)===s)continue e;return!1}return!0},exactSearch:function(e,t){return e=e.toLowerCase(),-1<(t=t.toLowerCase()).indexOf(e)},filterActive:function(){p.useLabels&&D.filter("."+m.active).addClass(m.filtered)},focusSearch:function(e){g.has.search()&&!g.is.focusedOnSearch()&&(e?(S.off("focus"+T,y.search),P.focus(),S.on("focus"+T,y.search,g.event.search.focus)):P.focus())},blurSearch:function(){g.has.search()&&P.blur()},forceSelection:function(){var e=D.not(m.filtered).filter("."+m.selected).eq(0),t=D.not(m.filtered).filter("."+m.active).eq(0),n=0<e.length?e:t;0<n.length&&!g.is.multiple()?(g.debug("Forcing partial selection to selected item",n),g.event.item.click.call(n,{},!0)):(p.allowAdditions&&g.set.selected(g.get.query()),g.remove.searchTerm())},change:{values:function(e){p.allowAdditions||g.clear(),g.debug("Creating dropdown with specified values",e),g.setup.menu({values:e}),Q.each(e,function(e,t){if(1==t.selected&&(g.debug("Setting initial selection to",t[l.value]),g.set.selected(t[l.value]),!g.is.multiple()))return!1})}},event:{change:function(){N||(g.debug("Input changed, updating selection"),g.set.selected())},focus:function(){p.showOnFocus&&!F&&g.is.hidden()&&!t&&g.show()},blur:function(e){t=ee.activeElement===this,F||t||(g.remove.activeLabel(),g.hide())},mousedown:function(){g.is.searchSelection()?i=!0:F=!0},mouseup:function(){g.is.searchSelection()?i=!1:F=!1},click:function(e){Q(e.target).is(S)&&(g.is.focusedOnSearch()?g.show():g.focusSearch())},search:{focus:function(e){F=!0,g.is.multiple()&&g.remove.activeLabel(),(p.showOnFocus||"focus"!==e.type&&"focusin"!==e.type)&&g.search()},blur:function(e){t=ee.activeElement===this,g.is.searchSelection()&&!i&&(L||t||(p.forceSelection&&g.forceSelection(),g.hide())),i=!1}},clearIcon:{click:function(e){g.clear(),g.is.searchSelection()&&g.remove.searchTerm(),g.hide(),e.stopPropagation()}},icon:{click:function(e){H=!0,g.has.search()?g.is.active()?g.blurSearch():p.showOnFocus?g.focusSearch():g.toggle():g.toggle()}},text:{focus:function(e){F=!0,g.focusSearch()}},input:function(e){(g.is.multiple()||g.is.searchSelection())&&g.set.filtered(),clearTimeout(g.timer),g.timer=setTimeout(g.search,p.delay.search)},label:{click:function(e){var t=Q(this),n=S.find(y.label),i=n.filter("."+m.active),o=t.nextAll("."+m.active),r=t.prevAll("."+m.active),s=0<o.length?t.nextUntil(o).add(i).add(t):t.prevUntil(r).add(i).add(t);e.shiftKey?(i.removeClass(m.active),s.addClass(m.active)):e.ctrlKey?t.toggleClass(m.active):(i.removeClass(m.active),t.addClass(m.active)),p.onLabelSelect.apply(this,n.filter("."+m.active))}},remove:{click:function(){var e=Q(this).parent();e.hasClass(m.active)?g.remove.activeLabels():g.remove.activeLabels(e)}},test:{toggle:function(e){var t=g.is.multiple()?g.show:g.toggle;g.is.bubbledLabelClick(e)||g.is.bubbledIconClick(e)||g.determine.eventOnElement(e,t)&&e.preventDefault()},touch:function(e){g.determine.eventOnElement(e,function(){"touchstart"==e.type?g.timer=setTimeout(function(){g.hide()},p.delay.touch):"touchmove"==e.type&&clearTimeout(g.timer)}),e.stopPropagation()},hide:function(e){g.determine.eventInModule(e,g.hide)&&B.id&&Q(e.target).attr("for")===B.id&&e.preventDefault()}},select:{mutation:function(e){g.debug("<select> modified, recreating menu"),g.is.selectMutation(e)&&(g.disconnect.selectObserver(),g.refresh(),g.setup.select(),g.set.selected(),g.observe.select())}},menu:{mutation:function(e){var t=e[0],n=t.addedNodes?Q(t.addedNodes[0]):Q(!1),i=t.removedNodes?Q(t.removedNodes[0]):Q(!1),o=n.add(i),r=o.is(y.addition)||0<o.closest(y.addition).length,s=o.is(y.message)||0<o.closest(y.message).length;r||s?(g.debug("Updating item selector cache"),g.refreshItems()):(g.debug("Menu modified, updating selector cache"),g.refresh())},mousedown:function(){L=!0},mouseup:function(){L=!1}},item:{mouseenter:function(e){var t=Q(e.target),n=Q(this),i=n.children(y.menu),o=n.siblings(y.item).children(y.menu),r=0<i.length;0<i.find(t).length||!r||(clearTimeout(g.itemTimer),g.itemTimer=setTimeout(function(){g.verbose("Showing sub-menu",i),Q.each(o,function(){g.animate.hide(!1,Q(this))}),g.animate.show(!1,i)},p.delay.show),e.preventDefault())},mouseleave:function(e){var t=Q(this).children(y.menu);0<t.length&&(clearTimeout(g.itemTimer),g.itemTimer=setTimeout(function(){g.verbose("Hiding sub-menu",t),g.animate.hide(!1,t)},p.delay.hide))},click:function(e,t){var n=Q(this),i=Q(e?e.target:""),o=n.find(y.menu),r=g.get.choiceText(n),s=g.get.choiceValue(n,r),a=0<o.length,l=0<o.find(i).length;"input"!==ee.activeElement.tagName.toLowerCase()&&Q(ee.activeElement).blur(),l||a&&!p.allowCategorySelection||(g.is.searchSelection()&&(p.allowAdditions&&g.remove.userAddition(),g.remove.searchTerm(),g.is.focusedOnSearch()||1==t||g.focusSearch(!0)),p.useLabels||(g.remove.filteredItem(),g.set.scrollPosition(n)),g.determine.selectAction.call(this,r,s))}},document:{keydown:function(e){var t=e.which;if(g.is.inObject(t,v)){var n=S.find(y.label),i=n.filter("."+m.active),o=(i.data(b.value),n.index(i)),r=n.length,s=0<i.length,a=1<i.length,l=0===o,c=o+1==r,u=g.is.searchSelection(),d=g.is.focusedOnSearch(),h=g.is.focused(),f=d&&0===g.get.caretPosition(!1),p=f&&0!==g.get.caretPosition(!0);if(u&&!s&&!d)return;t==v.leftArrow?!h&&!f||s?s&&(e.shiftKey?g.verbose("Adding previous label to selection"):(g.verbose("Selecting previous label"),n.removeClass(m.active)),l&&!a?i.addClass(m.active):i.prev(y.siblingLabel).addClass(m.active).end(),e.preventDefault()):(g.verbose("Selecting previous label"),n.last().addClass(m.active)):t==v.rightArrow?(h&&!s&&n.first().addClass(m.active),s&&(e.shiftKey?g.verbose("Adding next label to selection"):(g.verbose("Selecting next label"),n.removeClass(m.active)),c?u?d?n.removeClass(m.active):g.focusSearch():a?i.next(y.siblingLabel).addClass(m.active):i.addClass(m.active):i.next(y.siblingLabel).addClass(m.active),e.preventDefault())):t==v.deleteKey||t==v.backspace?s?(g.verbose("Removing active labels"),c&&u&&!d&&g.focusSearch(),i.last().next(y.siblingLabel).addClass(m.active),g.remove.activeLabels(i),e.preventDefault()):!f||p||s||t!=v.backspace||(g.verbose("Removing last label on input backspace"),i=n.last().addClass(m.active),g.remove.activeLabels(i)):i.removeClass(m.active)}}},keydown:function(e){var t=e.which;if(g.is.inObject(t,v)){var n,i=D.not(y.unselectable).filter("."+m.selected).eq(0),o=k.children("."+m.active).eq(0),r=0<i.length?i:o,s=0<r.length?r.siblings(":not(."+m.filtered+")").addBack():k.children(":not(."+m.filtered+")"),a=r.children(y.menu),l=r.closest(y.menu),c=l.hasClass(m.visible)||l.hasClass(m.animating)||0<l.parent(y.menu).length,u=0<a.length,d=0<r.length,h=0<r.not(y.unselectable).length,f=t==v.delimiter&&p.allowAdditions&&g.is.multiple();if(p.allowAdditions&&p.hideAdditions&&(t==v.enter||f)&&h&&(g.verbose("Selecting item from keyboard shortcut",r),g.event.item.click.call(r,e),g.is.searchSelection()&&g.remove.searchTerm(),g.is.multiple()&&e.preventDefault()),g.is.visible()){if(t!=v.enter&&!f||(t==v.enter&&d&&u&&!p.allowCategorySelection?(g.verbose("Pressed enter on unselectable category, opening sub menu"),t=v.rightArrow):h&&(g.verbose("Selecting item from keyboard shortcut",r),g.event.item.click.call(r,e),g.is.searchSelection()&&(g.remove.searchTerm(),g.is.multiple()&&P.focus())),e.preventDefault()),d&&(t==v.leftArrow&&l[0]!==k[0]&&(g.verbose("Left key pressed, closing sub-menu"),g.animate.hide(!1,l),r.removeClass(m.selected),l.closest(y.item).addClass(m.selected),e.preventDefault()),t==v.rightArrow&&u&&(g.verbose("Right key pressed, opening sub-menu"),g.animate.show(!1,a),r.removeClass(m.selected),a.find(y.item).eq(0).addClass(m.selected),e.preventDefault())),t==v.upArrow){if(n=d&&c?r.prevAll(y.item+":not("+y.unselectable+")").eq(0):D.eq(0),s.index(n)<0)return g.verbose("Up key pressed but reached top of current menu"),void e.preventDefault();g.verbose("Up key pressed, changing active item"),r.removeClass(m.selected),n.addClass(m.selected),g.set.scrollPosition(n),p.selectOnKeydown&&g.is.single()&&g.set.selectedItem(n),e.preventDefault()}if(t==v.downArrow){if(0===(n=d&&c?n=r.nextAll(y.item+":not("+y.unselectable+")").eq(0):D.eq(0)).length)return g.verbose("Down key pressed but reached bottom of current menu"),void e.preventDefault();g.verbose("Down key pressed, changing active item"),D.removeClass(m.selected),n.addClass(m.selected),g.set.scrollPosition(n),p.selectOnKeydown&&g.is.single()&&g.set.selectedItem(n),e.preventDefault()}t==v.pageUp&&(g.scrollPage("up"),e.preventDefault()),t==v.pageDown&&(g.scrollPage("down"),e.preventDefault()),t==v.escape&&(g.verbose("Escape key pressed, closing dropdown"),g.hide())}else f&&e.preventDefault(),t!=v.downArrow||g.is.visible()||(g.verbose("Down key pressed, showing dropdown"),g.show(),e.preventDefault())}else g.has.search()||g.set.selectedLetter(String.fromCharCode(t))}},trigger:{change:function(){var e=ee.createEvent("HTMLEvents"),t=I[0];t&&(g.verbose("Triggering native change event"),e.initEvent("change",!0,!1),t.dispatchEvent(e))}},determine:{selectAction:function(e,t){c=!0,g.verbose("Determining action",p.action),Q.isFunction(g.action[p.action])?(g.verbose("Triggering preset action",p.action,e,t),g.action[p.action].call(B,e,t,this)):Q.isFunction(p.action)?(g.verbose("Triggering user action",p.action,e,t),p.action.call(B,e,t,this)):g.error(f.action,p.action),c=!1},eventInModule:function(e,t){var n=Q(e.target),i=0<n.closest(ee.documentElement).length,o=0<n.closest(S).length;return t=Q.isFunction(t)?t:function(){},i&&!o?(g.verbose("Triggering event",t),t(),!0):(g.verbose("Event occurred in dropdown, canceling callback"),!1)},eventOnElement:function(e,t){var n=Q(e.target),i=n.closest(y.siblingLabel),o=ee.body.contains(e.target),r=0===S.find(i).length||!(g.is.multiple()&&p.useLabels),s=0===n.closest(k).length;return t=Q.isFunction(t)?t:function(){},o&&r&&s?(g.verbose("Triggering event",t),t(),!0):(g.verbose("Event occurred in dropdown menu, canceling callback"),!1)}},action:{nothing:function(){},activate:function(e,t,n){t=t!==te?t:e,g.can.activate(Q(n))&&(g.set.selected(t,Q(n)),g.is.multiple()||g.hideAndClear())},select:function(e,t,n){t=t!==te?t:e,g.can.activate(Q(n))&&(g.set.value(t,e,Q(n)),g.is.multiple()||g.hideAndClear())},combo:function(e,t,n){t=t!==te?t:e,g.set.selected(t,Q(n)),g.hideAndClear()},hide:function(e,t,n){g.set.value(t,e,Q(n)),g.hideAndClear()}},get:{id:function(){return r},defaultText:function(){return S.data(b.defaultText)},defaultValue:function(){return S.data(b.defaultValue)},placeholderText:function(){return"auto"!=p.placeholder&&"string"==typeof p.placeholder?p.placeholder:S.data(b.placeholderText)||""},text:function(){return E.text()},query:function(){return Q.trim(P.val())},searchWidth:function(e){return e=e!==te?e:P.val(),R.text(e),Math.ceil(R.width()+1)},selectionCount:function(){var e=g.get.values();return g.is.multiple()?Array.isArray(e)?e.length:0:""!==g.get.value()?1:0},transition:function(e){return"auto"==p.transition?g.is.upward(e)?"slide up":"slide down":p.transition},userValues:function(){var e=g.get.values();return!!e&&(e=Array.isArray(e)?e:[e],Q.grep(e,function(e){return!1===g.get.item(e)}))},uniqueArray:function(n){return Q.grep(n,function(e,t){return Q.inArray(e,n)===t})},caretPosition:function(e){var t,n,i=P.get(0);return e&&"selectionEnd"in i?i.selectionEnd:!e&&"selectionStart"in i?i.selectionStart:ee.selection?(i.focus(),n=(t=ee.selection.createRange()).text.length,e?n:(t.moveStart("character",-i.value.length),t.text.length-n)):void 0},value:function(){var e=0<I.length?I.val():S.data(b.value),t=Array.isArray(e)&&1===e.length&&""===e[0];return e===te||t?"":e},values:function(){var e=g.get.value();return""===e?"":!g.has.selectInput()&&g.is.multiple()?"string"==typeof e?g.escape.htmlEntities(e).split(p.delimiter):"":e},remoteValues:function(){var e=g.get.values(),i=!1;return e&&("string"==typeof e&&(e=[e]),Q.each(e,function(e,t){var n=g.read.remoteData(t);g.verbose("Restoring value from session data",n,t),n&&((i=i||{})[t]=n)})),i},choiceText:function(e,t){if(t=t!==te?t:p.preserveHTML,e)return 0<e.find(y.menu).length&&(g.verbose("Retrieving text of element with sub-menu"),(e=e.clone()).find(y.menu).remove(),e.find(y.menuIcon).remove()),e.data(b.text)!==te?e.data(b.text):t?Q.trim(e.html()):Q.trim(e.text())},choiceValue:function(e,t){return t=t||g.get.choiceText(e),!!e&&(e.data(b.value)!==te?String(e.data(b.value)):"string"==typeof t?Q.trim(t.toLowerCase()):String(t))},inputEvent:function(){var e=P[0];return!!e&&(e.oninput!==te?"input":e.onpropertychange!==te?"propertychange":"keyup")},selectValues:function(){var r={},s=[];return r.values=[],S.find("option").each(function(){var e=Q(this),t=e.html(),n=e.attr("disabled"),i=e.attr("value")!==te?e.attr("value"):t,o=e.parent("optgroup");"auto"===p.placeholder&&""===i?r.placeholder=t:(o.length===s.length&&o[0]===s[0]||(r.values.push({type:"header",divider:p.headerDivider,name:o.attr("label")||""}),s=o),r.values.push({name:t,value:i,disabled:n}))}),p.placeholder&&"auto"!==p.placeholder&&(g.debug("Setting placeholder value to",p.placeholder),r.placeholder=p.placeholder),p.sortSelect?(!0===p.sortSelect?r.values.sort(function(e,t){return e.name.localeCompare(t.name)}):"natural"===p.sortSelect?r.values.sort(function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}):Q.isFunction(p.sortSelect)&&r.values.sort(p.sortSelect),g.debug("Retrieved and sorted values from select",r)):g.debug("Retrieved values from select",r),r},activeItem:function(){return D.filter("."+m.active)},selectedItem:function(){var e=D.not(y.unselectable).filter("."+m.selected);return 0<e.length?e:D.eq(0)},itemWithAdditions:function(e){var t=g.get.item(e),n=g.create.userChoice(e);return n&&0<n.length&&(t=0<t.length?t.add(n):n),t},item:function(i,o){var e,r,s=!1;return i=i!==te?i:g.get.values()!==te?g.get.values():g.get.text(),e=(r=g.is.multiple()&&Array.isArray(i))?0<i.length:i!==te&&null!==i,o=""===i||!1===i||!0===i||(o||!1),e&&D.each(function(){var e=Q(this),t=g.get.choiceText(e),n=g.get.choiceValue(e,t);if(null!==n&&n!==te)if(r)-1!==Q.inArray(String(n),i)&&(s=s?s.add(e):e);else if(o){if(g.verbose("Ambiguous dropdown value using strict type check",e,i),n===i)return s=e,!0}else if(String(n)==String(i))return g.verbose("Found select item by value",n,i),s=e,!0}),s}},check:{maxSelections:function(e){return!p.maxSelections||((e=e!==te?e:g.get.selectionCount())>=p.maxSelections?(g.debug("Maximum selection count reached"),p.useLabels&&(D.addClass(m.filtered),g.add.message(u.maxSelections)),!0):(g.verbose("No longer at maximum selection count"),g.remove.message(),g.remove.filteredItem(),g.is.searchSelection()&&g.filterItems(),!1))}},restore:{defaults:function(){g.clear(),g.restore.defaultText(),g.restore.defaultValue()},defaultText:function(){var e=g.get.defaultText();e===g.get.placeholderText?(g.debug("Restoring default placeholder text",e),g.set.placeholderText(e)):(g.debug("Restoring default text",e),g.set.text(e))},placeholderText:function(){g.set.placeholderText()},defaultValue:function(){var e=g.get.defaultValue();e!==te&&(g.debug("Restoring default value",e),""!==e?(g.set.value(e),g.set.selected()):(g.remove.activeItem(),g.remove.selectedItem()))},labels:function(){p.allowAdditions&&(p.useLabels||(g.error(f.labels),p.useLabels=!0),g.debug("Restoring selected values"),g.create.userLabels()),g.check.maxSelections()},selected:function(){g.restore.values(),g.is.multiple()?(g.debug("Restoring previously selected values and labels"),g.restore.labels()):g.debug("Restoring previously selected values")},values:function(){g.set.initialLoad(),p.apiSettings&&p.saveRemoteData&&g.get.remoteValues()?g.restore.remoteValues():g.set.selected();var e=g.get.value();!e||""===e||Array.isArray(e)&&0===e.length?I.addClass(m.noselection):I.removeClass(m.noselection),g.remove.initialLoad()},remoteValues:function(){var e=g.get.remoteValues();g.debug("Recreating selected from session data",e),e&&(g.is.single()?Q.each(e,function(e,t){g.set.text(t)}):Q.each(e,function(e,t){g.add.label(e,t)}))}},read:{remoteData:function(e){var t;if(J.Storage!==te)return(t=sessionStorage.getItem(e))!==te&&t;g.error(f.noStorage)}},save:{defaults:function(){g.save.defaultText(),g.save.placeholderText(),g.save.defaultValue()},defaultValue:function(){var e=g.get.value();g.verbose("Saving default value as",e),S.data(b.defaultValue,e)},defaultText:function(){var e=g.get.text();g.verbose("Saving default text as",e),S.data(b.defaultText,e)},placeholderText:function(){var e;!1!==p.placeholder&&E.hasClass(m.placeholder)&&(e=g.get.text(),g.verbose("Saving placeholder text as",e),S.data(b.placeholderText,e))},remoteData:function(e,t){J.Storage!==te?(g.verbose("Saving remote data to session storage",t,e),sessionStorage.setItem(t,e)):g.error(f.noStorage)}},clear:function(){g.is.multiple()&&p.useLabels?g.remove.labels():(g.remove.activeItem(),g.remove.selectedItem(),g.remove.filteredItem()),g.set.placeholderText(),g.clearValue()},clearValue:function(){g.set.value("")},scrollPage:function(e,t){var n,i,o=t||g.get.selectedItem(),r=o.closest(y.menu),s=r.outerHeight(),a=r.scrollTop(),l=D.eq(0).outerHeight(),c=Math.floor(s/l),u=(r.prop("scrollHeight"),"up"==e?a-l*c:a+l*c),d=D.not(y.unselectable);i="up"==e?d.index(o)-c:d.index(o)+c,0<(n=("up"==e?0<=i:i<d.length)?d.eq(i):"up"==e?d.first():d.last()).length&&(g.debug("Scrolling page",e,n),o.removeClass(m.selected),n.addClass(m.selected),p.selectOnKeydown&&g.is.single()&&g.set.selectedItem(n),r.scrollTop(u))},set:{filtered:function(){var e=g.is.multiple(),t=g.is.searchSelection(),n=e&&t,i=t?g.get.query():"",o="string"==typeof i&&0<i.length,r=g.get.searchWidth(),s=""!==i;e&&o&&(g.verbose("Adjusting input width",r,p.glyphWidth),P.css("width",r)),o||n&&s?(g.verbose("Hiding placeholder text"),E.addClass(m.filtered)):e&&(!n||s)||(g.verbose("Showing placeholder text"),E.removeClass(m.filtered))},empty:function(){S.addClass(m.empty)},loading:function(){S.addClass(m.loading)},placeholderText:function(e){e=e||g.get.placeholderText(),g.debug("Setting placeholder text",e),g.set.text(e),E.addClass(m.placeholder)},tabbable:function(){g.is.searchSelection()?(g.debug("Added tabindex to searchable dropdown"),P.val("").attr("tabindex",0),k.attr("tabindex",-1)):(g.debug("Added tabindex to dropdown"),S.attr("tabindex")===te&&(S.attr("tabindex",0),k.attr("tabindex",-1)))},initialLoad:function(){g.verbose("Setting initial load"),e=!0},activeItem:function(e){p.allowAdditions&&0<e.filter(y.addition).length?e.addClass(m.filtered):e.addClass(m.active)},partialSearch:function(e){var t=g.get.query().length;P.val(e.substr(0,t))},scrollPosition:function(e,t){var n,i,o,r,s,a;n=(e=e||g.get.selectedItem()).closest(y.menu),i=e&&0<e.length,t=t!==te&&t,0===g.get.activeItem().length&&(t=!1),e&&0<n.length&&i&&(e.position().top,n.addClass(m.loading),o=(r=n.scrollTop())-n.offset().top+e.offset().top,t||(a=r+n.height()<o+5,s=o-5<r),g.debug("Scrolling to active item",o),(t||s||a)&&n.scrollTop(o),n.removeClass(m.loading))},text:function(e){"combo"===p.action?(g.debug("Changing combo button text",e,O),p.preserveHTML?O.html(e):O.text(e)):"activate"===p.action&&(e!==g.get.placeholderText()&&E.removeClass(m.placeholder),g.debug("Changing text",e,E),E.removeClass(m.filtered),p.preserveHTML?E.html(e):E.text(e))},selectedItem:function(e){var t=g.get.choiceValue(e),n=g.get.choiceText(e,!1),i=g.get.choiceText(e,!0);g.debug("Setting user selection to item",e),g.remove.activeItem(),g.set.partialSearch(n),g.set.activeItem(e),g.set.selected(t,e),g.set.text(i)},selectedLetter:function(e){var t,n=D.filter("."+m.selected),i=0<n.length&&g.has.firstLetter(n,e),o=!1;i&&(t=n.nextAll(D).eq(0),g.has.firstLetter(t,e)&&(o=t)),o||D.each(function(){if(g.has.firstLetter(Q(this),e))return o=Q(this),!1}),o&&(g.verbose("Scrolling to next value with letter",e),g.set.scrollPosition(o),n.removeClass(m.selected),o.addClass(m.selected),p.selectOnKeydown&&g.is.single()&&g.set.selectedItem(o))},direction:function(e){"auto"==p.direction?(e?g.is.upward(e)&&g.remove.upward(e):g.remove.upward(),g.can.openDownward(e)?g.remove.upward(e):g.set.upward(e),g.is.leftward(e)||g.can.openRightward(e)||g.set.leftward(e)):"upward"==p.direction&&g.set.upward(e)},upward:function(e){(e||S).addClass(m.upward)},leftward:function(e){(e||k).addClass(m.leftward)},value:function(e,t,n){e===te||""===e||Array.isArray(e)&&0===e.length?I.addClass(m.noselection):I.removeClass(m.noselection);var i=g.escape.value(e),o=0<I.length,r=g.get.values(),s=e!==te?String(e):e;if(o){if(!p.allowReselection&&s==r&&(g.verbose("Skipping value update already same value",e,r),!g.is.initialLoad()))return;g.is.single()&&g.has.selectInput()&&g.can.extendSelect()&&(g.debug("Adding user option",e),g.add.optionValue(e)),g.debug("Updating input value",i,r),N=!0,I.val(i),!1===p.fireOnInit&&g.is.initialLoad()?g.debug("Input native change event ignored on initial load"):g.trigger.change(),N=!1}else g.verbose("Storing value in metadata",i,I),i!==r&&S.data(b.value,s);!1===p.fireOnInit&&g.is.initialLoad()?g.verbose("No callback on initial load",p.onChange):p.onChange.call(B,e,t,n)},active:function(){S.addClass(m.active)},multiple:function(){S.addClass(m.multiple)},visible:function(){S.addClass(m.visible)},exactly:function(e,t){g.debug("Setting selected to exact values"),g.clear(),g.set.selected(e,t)},selected:function(e,a){var l=g.is.multiple();(a=p.allowAdditions?a||g.get.itemWithAdditions(e):a||g.get.item(e))&&(g.debug("Setting selected menu item to",a),g.is.multiple()&&g.remove.searchWidth(),g.is.single()?(g.remove.activeItem(),g.remove.selectedItem()):p.useLabels&&g.remove.selectedItem(),a.each(function(){var e=Q(this),t=g.get.choiceText(e),n=g.get.choiceValue(e,t),i=e.hasClass(m.filtered),o=e.hasClass(m.active),r=e.hasClass(m.addition),s=l&&1==a.length;l?!o||r?(p.apiSettings&&p.saveRemoteData&&g.save.remoteData(t,n),p.useLabels?(g.add.label(n,t,s),g.add.value(n,t,e),g.set.activeItem(e),g.filterActive(),g.select.nextAvailable(a)):(g.add.value(n,t,e),g.set.text(g.add.variables(u.count)),g.set.activeItem(e))):i||!p.useLabels&&!c||(g.debug("Selected active value, removing label"),g.remove.selected(n)):(p.apiSettings&&p.saveRemoteData&&g.save.remoteData(t,n),g.set.text(t),g.set.value(n,t,e),e.addClass(m.active).addClass(m.selected))}))}},add:{label:function(e,t,n){var i,o=g.is.searchSelection()?P:E,r=g.escape.value(e);p.ignoreCase&&(r=r.toLowerCase()),i=Q("<a />").addClass(m.label).attr("data-"+b.value,r).html(w.label(r,t,p.preserveHTML,p.className)),i=p.onLabelCreate.call(i,r,t),g.has.label(e)?g.debug("User selection already exists, skipping",r):(p.label.variation&&i.addClass(p.label.variation),!0===n?(g.debug("Animating in label",i),i.addClass(m.hidden).insertBefore(o).transition({animation:p.label.transition,debug:p.debug,verbose:p.verbose,duration:p.label.duration})):(g.debug("Adding selection label",i),i.insertBefore(o)))},message:function(e){var t=k.children(y.message),n=p.templates.message(g.add.variables(e));0<t.length?t.html(n):t=Q("<div/>").html(n).addClass(m.message).appendTo(k)},optionValue:function(e){var t=g.escape.value(e);0<I.find('option[value="'+g.escape.string(t)+'"]').length||(g.disconnect.selectObserver(),g.is.single()&&(g.verbose("Removing previous user addition"),I.find("option."+m.addition).remove()),Q("<option/>").prop("value",t).addClass(m.addition).html(e).appendTo(I),g.verbose("Adding user addition as an <option>",e),g.observe.select())},userSuggestion:function(e){var t,n=k.children(y.addition),i=g.get.item(e),o=i&&i.not(y.addition).length,r=0<n.length;p.useLabels&&g.has.maxSelections()||(""===e||o?n.remove():(r?(n.data(b.value,e).data(b.text,e).attr("data-"+b.value,e).attr("data-"+b.text,e).removeClass(m.filtered),p.hideAdditions||(t=p.templates.addition(g.add.variables(u.addResult,e)),n.html(t)),g.verbose("Replacing user suggestion with new value",n)):((n=g.create.userChoice(e)).prependTo(k),g.verbose("Adding item choice to menu corresponding with user choice addition",n)),p.hideAdditions&&!g.is.allFiltered()||n.addClass(m.selected).siblings().removeClass(m.selected),g.refreshItems()))},variables:function(e,t){var n,i,o=-1!==e.search("{count}"),r=-1!==e.search("{maxCount}"),s=-1!==e.search("{term}");return g.verbose("Adding templated variables to message",e),o&&(n=g.get.selectionCount(),e=e.replace("{count}",n)),r&&(n=g.get.selectionCount(),e=e.replace("{maxCount}",p.maxSelections)),s&&(i=t||g.get.query(),e=e.replace("{term}",i)),e},value:function(e,t,n){var i,o=g.get.values();g.has.value(e)?g.debug("Value already selected"):""!==e?(i=Array.isArray(o)?(i=o.concat([e]),g.get.uniqueArray(i)):[e],g.has.selectInput()?g.can.extendSelect()&&(g.debug("Adding value to select",e,i,I),g.add.optionValue(e)):(i=i.join(p.delimiter),g.debug("Setting hidden input to delimited value",i,I)),!1===p.fireOnInit&&g.is.initialLoad()?g.verbose("Skipping onadd callback on initial load",p.onAdd):p.onAdd.call(B,e,t,n),g.set.value(i,e,t,n),g.check.maxSelections()):g.debug("Cannot select blank values from multiselect")}},remove:{active:function(){S.removeClass(m.active)},activeLabel:function(){S.find(y.label).removeClass(m.active)},empty:function(){S.removeClass(m.empty)},loading:function(){S.removeClass(m.loading)},initialLoad:function(){e=!1},upward:function(e){(e||S).removeClass(m.upward)},leftward:function(e){(e||k).removeClass(m.leftward)},visible:function(){S.removeClass(m.visible)},activeItem:function(){D.removeClass(m.active)},filteredItem:function(){p.useLabels&&g.has.maxSelections()||(p.useLabels&&g.is.multiple()?D.not("."+m.active).removeClass(m.filtered):D.removeClass(m.filtered),p.hideDividers&&M.removeClass(m.hidden),g.remove.empty())},optionValue:function(e){var t=g.escape.value(e),n=I.find('option[value="'+g.escape.string(t)+'"]');0<n.length&&n.hasClass(m.addition)&&(s&&(s.disconnect(),g.verbose("Temporarily disconnecting mutation observer")),n.remove(),g.verbose("Removing user addition as an <option>",t),s&&s.observe(I[0],{childList:!0,subtree:!0}))},message:function(){k.children(y.message).remove()},searchWidth:function(){P.css("width","")},searchTerm:function(){g.verbose("Cleared search term"),P.val(""),g.set.filtered()},userAddition:function(){D.filter(y.addition).remove()},selected:function(e,t){if(!(t=p.allowAdditions?t||g.get.itemWithAdditions(e):t||g.get.item(e)))return!1;t.each(function(){var e=Q(this),t=g.get.choiceText(e),n=g.get.choiceValue(e,t);g.is.multiple()?p.useLabels?(g.remove.value(n,t,e),g.remove.label(n)):(g.remove.value(n,t,e),0===g.get.selectionCount()?g.set.placeholderText():g.set.text(g.add.variables(u.count))):g.remove.value(n,t,e),e.removeClass(m.filtered).removeClass(m.active),p.useLabels&&e.removeClass(m.selected)})},selectedItem:function(){D.removeClass(m.selected)},value:function(e,t,n){var i,o=g.get.values();g.has.selectInput()?(g.verbose("Input is <select> removing selected option",e),i=g.remove.arrayValue(e,o),g.remove.optionValue(e)):(g.verbose("Removing from delimited values",e),i=(i=g.remove.arrayValue(e,o)).join(p.delimiter)),!1===p.fireOnInit&&g.is.initialLoad()?g.verbose("No callback on initial load",p.onRemove):p.onRemove.call(B,e,t,n),g.set.value(i,t,n),g.check.maxSelections()},arrayValue:function(t,e){return Array.isArray(e)||(e=[e]),e=Q.grep(e,function(e){return t!=e}),g.verbose("Removed value from delimited string",t,e),e},label:function(e,t){var n=S.find(y.label).filter("[data-"+b.value+'="'+g.escape.string(e)+'"]');g.verbose("Removing label",n),n.remove()},activeLabels:function(e){e=e||S.find(y.label).filter("."+m.active),g.verbose("Removing active label selections",e),g.remove.labels(e)},labels:function(e){e=e||S.find(y.label),g.verbose("Removing labels",e),e.each(function(){var e=Q(this),t=e.data(b.value),n=t!==te?String(t):t,i=g.is.userValue(n);!1!==p.onLabelRemove.call(e,t)?(g.remove.message(),i?(g.remove.value(n),g.remove.label(n)):g.remove.selected(n)):g.debug("Label remove callback cancelled removal")})},tabbable:function(){g.is.searchSelection()?(g.debug("Searchable dropdown initialized"),P.removeAttr("tabindex")):(g.debug("Simple selection dropdown initialized"),S.removeAttr("tabindex")),k.removeAttr("tabindex")},diacritics:function(e){return p.ignoreDiacritics?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}},has:{menuSearch:function(){return g.has.search()&&0<P.closest(k).length},clearItem:function(){return 0<A.length},search:function(){return 0<P.length},sizer:function(){return 0<R.length},selectInput:function(){return I.is("select")},minCharacters:function(e){return p.minCharacters&&!H?(e=e!==te?String(e):String(g.get.query())).length>=p.minCharacters:!(H=!1)},firstLetter:function(e,t){var n;return!(!e||0===e.length||"string"!=typeof t)&&(n=g.get.choiceText(e,!1),(t=t.toLowerCase())==String(n).charAt(0).toLowerCase())},input:function(){return 0<I.length},items:function(){return 0<D.length},menu:function(){return 0<k.length},message:function(){return 0!==k.children(y.message).length},label:function(e){var t=g.escape.value(e),n=S.find(y.label);return p.ignoreCase&&(t=t.toLowerCase()),0<n.filter("[data-"+b.value+'="'+g.escape.string(t)+'"]').length},maxSelections:function(){return p.maxSelections&&g.get.selectionCount()>=p.maxSelections},allResultsFiltered:function(){var e=D.not(y.addition);return e.filter(y.unselectable).length===e.length},userSuggestion:function(){return 0<k.children(y.addition).length},query:function(){return""!==g.get.query()},value:function(e){return p.ignoreCase?g.has.valueIgnoringCase(e):g.has.valueMatchingCase(e)},valueMatchingCase:function(e){var t=g.get.values();return!!(Array.isArray(t)?t&&-1!==Q.inArray(e,t):t==e)},valueIgnoringCase:function(n){var e=g.get.values(),i=!1;return Array.isArray(e)||(e=[e]),Q.each(e,function(e,t){if(String(n).toLowerCase()==String(t).toLowerCase())return!(i=!0)}),i}},is:{active:function(){return S.hasClass(m.active)},animatingInward:function(){return k.transition("is inward")},animatingOutward:function(){return k.transition("is outward")},bubbledLabelClick:function(e){return Q(e.target).is("select, input")&&0<S.closest("label").length},bubbledIconClick:function(e){return 0<Q(e.target).closest(_).length},alreadySetup:function(){return S.is("select")&&S.parent(y.dropdown).data(x)!==te&&0===S.prev().length},animating:function(e){return e?e.transition&&e.transition("is animating"):k.transition&&k.transition("is animating")},leftward:function(e){return(e||k).hasClass(m.leftward)},clearable:function(){return S.hasClass(m.clearable)||p.clearable},disabled:function(){return S.hasClass(m.disabled)},focused:function(){return ee.activeElement===S[0]},focusedOnSearch:function(){return ee.activeElement===P[0]},allFiltered:function(){return(g.is.multiple()||g.has.search())&&!(0==p.hideAdditions&&g.has.userSuggestion())&&!g.has.message()&&g.has.allResultsFiltered()},hidden:function(e){return!g.is.visible(e)},initialLoad:function(){return e},inObject:function(n,e){var i=!1;return Q.each(e,function(e,t){if(t==n)return i=!0}),i},multiple:function(){return S.hasClass(m.multiple)},remote:function(){return p.apiSettings&&g.can.useAPI()},single:function(){return!g.is.multiple()},selectMutation:function(e){var n=!1;return Q.each(e,function(e,t){if(Q(t.target).is("select")||Q(t.addedNodes).is("select"))return!(n=!0)}),n},search:function(){return S.hasClass(m.search)},searchSelection:function(){return g.has.search()&&1===P.parent(y.dropdown).length},selection:function(){return S.hasClass(m.selection)},userValue:function(e){return-1!==Q.inArray(e,g.get.userValues())},upward:function(e){return(e||S).hasClass(m.upward)},visible:function(e){return e?e.hasClass(m.visible):k.hasClass(m.visible)},verticallyScrollableContext:function(){var e=C.get(0)!==J&&C.css("overflow-y");return"auto"==e||"scroll"==e},horizontallyScrollableContext:function(){var e=C.get(0)!==J&&C.css("overflow-X");return"auto"==e||"scroll"==e}},can:{activate:function(e){return!!p.useLabels||(!g.has.maxSelections()||!(!g.has.maxSelections()||!e.hasClass(m.active)))},openDownward:function(e){var t,n,i=e||k,o=!0;return i.addClass(m.loading),n={context:{offset:C.get(0)===J?{top:0,left:0}:C.offset(),scrollTop:C.scrollTop(),height:C.outerHeight()},menu:{offset:i.offset(),height:i.outerHeight()}},g.is.verticallyScrollableContext()&&(n.menu.offset.top+=n.context.scrollTop),o=(t={above:n.context.scrollTop<=n.menu.offset.top-n.context.offset.top-n.menu.height,below:n.context.scrollTop+n.context.height>=n.menu.offset.top-n.context.offset.top+n.menu.height}).below?(g.verbose("Dropdown can fit in context downward",t),!0):t.below||t.above?(g.verbose("Dropdown cannot fit below, opening upward",t),!1):(g.verbose("Dropdown cannot fit in either direction, favoring downward",t),!0),i.removeClass(m.loading),o},openRightward:function(e){var t,n,i=e||k,o=!0;return i.addClass(m.loading),n={context:{offset:C.get(0)===J?{top:0,left:0}:C.offset(),scrollLeft:C.scrollLeft(),width:C.outerWidth()},menu:{offset:i.offset(),width:i.outerWidth()}},g.is.horizontallyScrollableContext()&&(n.menu.offset.left+=n.context.scrollLeft),(t=n.menu.offset.left-n.context.offset.left+n.menu.width>=n.context.scrollLeft+n.context.width)&&(g.verbose("Dropdown cannot fit in context rightward",t),o=!1),i.removeClass(m.loading),o},click:function(){return W||"click"==p.on},extendSelect:function(){return p.allowAdditions||p.apiSettings},show:function(){return!g.is.disabled()&&(g.has.items()||g.has.message())},useAPI:function(){return Q.fn.api!==te}},animate:{show:function(e,t){var n,i=t||k,o=t?function(){}:function(){g.hideSubMenus(),g.hideOthers(),g.set.active()};e=Q.isFunction(e)?e:function(){},g.verbose("Doing menu show animation",i),g.set.direction(t),n=g.get.transition(t),g.is.selection()&&g.set.scrollPosition(g.get.selectedItem(),!0),(g.is.hidden(i)||g.is.animating(i))&&("none"==n?(o(),i.transition("show"),e.call(B)):Q.fn.transition!==te&&S.transition("is supported")?i.transition({animation:n+" in",debug:p.debug,verbose:p.verbose,duration:p.duration,queue:!0,onStart:o,onComplete:function(){e.call(B)}}):g.error(f.noTransition,n))},hide:function(e,t){var n=t||k,i=t?function(){}:function(){g.can.click()&&g.unbind.intent(),g.remove.active()},o=g.get.transition(t);e=Q.isFunction(e)?e:function(){},(g.is.visible(n)||g.is.animating(n))&&(g.verbose("Doing menu hide animation",n),"none"==o?(i(),n.transition("hide"),e.call(B)):Q.fn.transition!==te&&S.transition("is supported")?n.transition({animation:o+" out",duration:p.duration,debug:p.debug,verbose:p.verbose,queue:!1,onStart:i,onComplete:function(){e.call(B)}}):g.error(f.transition))}},hideAndClear:function(){g.remove.searchTerm(),g.has.maxSelections()||(g.has.search()?g.hide(function(){g.remove.filteredItem()}):g.hide())},delay:{show:function(){g.verbose("Delaying show event to ensure user intent"),clearTimeout(g.timer),g.timer=setTimeout(g.show,p.delay.show)},hide:function(){g.verbose("Delaying hide event to ensure user intent"),clearTimeout(g.timer),g.timer=setTimeout(g.hide,p.delay.hide)}},escape:{value:function(e){var t=Array.isArray(e),n="string"==typeof e,i=!n&&!t,o=n&&-1!==e.search(h.quote),r=[];return i||!o?e:(g.debug("Encoding quote values for use in select",e),t?(Q.each(e,function(e,t){r.push(t.replace(h.quote,"&quot;"))}),r):e.replace(h.quote,"&quot;"))},string:function(e){return(e=String(e)).replace(h.escape,"\\$&")},htmlEntities:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return/[&<>"'`]/.test(e)?e.replace(/[&<>"'`]/g,function(e){return t[e]}):e}},setting:function(e,t){if(g.debug("Changing setting",e,t),Q.isPlainObject(e))Q.extend(!0,p,e);else{if(t===te)return p[e];Q.isPlainObject(p[e])?Q.extend(!0,p[e],t):p[e]=t}},internal:function(e,t){if(Q.isPlainObject(e))Q.extend(!0,g,e);else{if(t===te)return g[e];g[e]=t}},debug:function(){!p.silent&&p.debug&&(p.performance?g.performance.log(arguments):(g.debug=Function.prototype.bind.call(console.info,console,p.name+":"),g.debug.apply(console,arguments)))},verbose:function(){!p.silent&&p.verbose&&p.debug&&(p.performance?g.performance.log(arguments):(g.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),g.verbose.apply(console,arguments)))},error:function(){p.silent||(g.error=Function.prototype.bind.call(console.error,console,p.name+":"),g.error.apply(console,arguments))},performance:{log:function(e){var t,n;p.performance&&(n=(t=(new Date).getTime())-($||t),$=t,X.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:B,"Execution Time":n})),clearTimeout(g.performance.timer),g.performance.timer=setTimeout(g.performance.display,500)},display:function(){var e=p.name+":",n=0;$=!1,clearTimeout(g.performance.timer),Q.each(X,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",G&&(e+=" '"+G+"'"),(console.group!==te||console.table!==te)&&0<X.length&&(console.groupCollapsed(e),console.table?console.table(X):Q.each(X,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),X=[]}},invoke:function(i,e,t){var o,r,n,s=z;return e=e||K,t=B||t,"string"==typeof i&&s!==te&&(i=i.split(/[\. ]/),o=i.length-1,Q.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(Q.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==te)return r=s[n],!1;if(!Q.isPlainObject(s[t])||e==o)return s[t]!==te?r=s[t]:g.error(f.method,i),!1;s=s[t]}})),Q.isFunction(r)?n=r.apply(t,e):r!==te&&(n=r),Array.isArray(U)?U.push(n):U!==te?U=[U,n]:n!==te&&(U=n),r}},Z?(z===te&&g.initialize(),g.invoke(Y)):(z!==te&&z.invoke("destroy"),g.initialize())}),U!==te?U:V},Q.fn.dropdown.settings={silent:!1,debug:!1,verbose:!1,performance:!0,on:"click",action:"activate",values:!1,clearable:!1,apiSettings:!1,selectOnKeydown:!0,minCharacters:0,filterRemoteData:!1,saveRemoteData:!0,throttle:200,context:J,direction:"auto",keepOnScreen:!0,match:"both",fullTextSearch:!1,ignoreDiacritics:!1,hideDividers:!1,placeholder:"auto",preserveHTML:!0,sortSelect:!1,forceSelection:!0,allowAdditions:!1,ignoreCase:!1,hideAdditions:!0,maxSelections:!1,useLabels:!0,delimiter:",",showOnFocus:!0,allowReselection:!1,allowTab:!0,allowCategorySelection:!1,fireOnInit:!1,transition:"auto",duration:200,glyphWidth:1.037,headerDivider:!0,label:{transition:"scale",duration:200,variation:!1},delay:{hide:300,show:200,search:20,touch:50},onChange:function(e,t,n){},onAdd:function(e,t,n){},onRemove:function(e,t,n){},onLabelSelect:function(e){},onLabelCreate:function(e,t){return Q(this)},onLabelRemove:function(e){return!0},onNoResults:function(e){return!0},onShow:function(){},onHide:function(){},name:"Dropdown",namespace:"dropdown",message:{addResult:"Add <b>{term}</b>",count:"{count} selected",maxSelections:"Max {maxCount} selections",noResults:"No results found.",serverError:"There was an error contacting the server"},error:{action:"You called a dropdown action that was not defined",alreadySetup:"Once a select has been initialized behaviors must be called on the created ui dropdown",labels:"Allowing user additions currently requires the use of labels.",missingMultiple:"<select> requires multiple property to be set to correctly preserve multiple values",method:"The method you called is not defined.",noAPI:"The API module is required to load resources remotely",noStorage:"Saving remote data requires session storage",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>",noNormalize:'"ignoreDiacritics" setting will be ignored. Browser does not support String().normalize(). You may consider including <https://cdn.jsdelivr.net/npm/unorm@1.4.1/lib/unorm.min.js> as a polyfill.'},regExp:{escape:/[-[\]{}()*+?.,\\^$|#\s:=@]/g,quote:/"/g},metadata:{defaultText:"defaultText",defaultValue:"defaultValue",placeholderText:"placeholder",text:"text",value:"value"},fields:{remoteValues:"results",values:"values",disabled:"disabled",name:"name",value:"value",text:"text",type:"type",image:"image",imageClass:"imageClass",icon:"icon",iconClass:"iconClass",class:"class",divider:"divider"},keys:{backspace:8,delimiter:188,deleteKey:46,enter:13,escape:27,pageUp:33,pageDown:34,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},selector:{addition:".addition",divider:".divider, .header",dropdown:".ui.dropdown",hidden:".hidden",icon:"> .dropdown.icon",input:'> input[type="hidden"], > select',item:".item",label:"> .label",remove:"> .label > .delete.icon",siblingLabel:".label",menu:".menu",message:".message",menuIcon:".dropdown.icon",search:"input.search, .menu > .search > input, .menu input.search",sizer:"> input.sizer",text:"> .text:not(.icon)",unselectable:".disabled, .filtered",clearIcon:"> .remove.icon"},className:{active:"active",addition:"addition",animating:"animating",disabled:"disabled",empty:"empty",dropdown:"ui dropdown",filtered:"filtered",hidden:"hidden transition",icon:"icon",image:"image",item:"item",label:"ui label",loading:"loading",menu:"menu",message:"message",multiple:"multiple",placeholder:"default",sizer:"sizer",search:"search",selected:"selected",selection:"selection",upward:"upward",leftward:"left",visible:"visible",clearable:"clearable",noselection:"noselection",delete:"delete",header:"header",divider:"divider",groupIcon:""}},Q.fn.dropdown.settings.templates={deQuote:function(e){return String(e).replace(/"/g,"")},escape:function(e,t){if(t)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return/[&<>"'`]/.test(e)?e.replace(/[&<>"'`]/g,function(e){return n[e]}):e},dropdown:function(e,t,n,i){var o=e.placeholder||!1,r="",s=Q.fn.dropdown.settings.templates.escape;return r+='<i class="dropdown icon"></i>',r+=o?'<div class="default text">'+s(o,n)+"</div>":'<div class="text"></div>',r+='<div class="'+i.menu+'">',r+=Q.fn.dropdown.settings.templates.menu(e,t,n,i),r+="</div>"},menu:function(e,a,l,c){var t=e[a.values]||[],u="",d=Q.fn.dropdown.settings.templates.escape,h=Q.fn.dropdown.settings.templates.deQuote;return Q.each(t,function(e,t){var n=t[a.type]?t[a.type]:"item";if("item"===n){var i=t[a.text]?' data-text="'+h(t[a.text])+'"':"",o=t[a.disabled]?c.disabled+" ":"";u+='<div class="'+o+(t[a.class]?h(t[a.class]):c.item)+'" data-value="'+h(t[a.value])+'"'+i+">",t[a.image]&&(u+='<img class="'+(t[a.imageClass]?h(t[a.imageClass]):c.image)+'" src="'+h(t[a.image])+'">'),t[a.icon]&&(u+='<i class="'+h(t[a.icon])+" "+(t[a.iconClass]?h(t[a.iconClass]):c.icon)+'"></i>'),u+=d(t[a.name],l),u+="</div>"}else if("header"===n){var r=d(t[a.name],l),s=t[a.icon]?h(t[a.icon]):c.groupIcon;""===r&&""===s||(u+='<div class="'+(t[a.class]?h(t[a.class]):c.header)+'">',""!==s&&(u+='<i class="'+s+" "+(t[a.iconClass]?h(t[a.iconClass]):c.icon)+'"></i>'),u+=r,u+="</div>"),t[a.divider]&&(u+='<div class="'+c.divider+'"></div>')}}),u},label:function(e,t,n,i){return(0,Q.fn.dropdown.settings.templates.escape)(t,n)+'<i class="'+i.delete+' icon"></i>'},message:function(e){return e},addition:function(e){return e}}}(jQuery,window,document),function(C,e,t,E){"use strict";C.isFunction=C.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),C.fn.embed=function(g){var m,v=C(this),b=v.selector||"",y=(new Date).getTime(),w=[],T=g,x="string"==typeof T,S=[].slice.call(arguments,1);return v.each(function(){var a,i=C.isPlainObject(g)?C.extend(!0,{},C.fn.embed.settings,g):C.extend({},C.fn.embed.settings),e=i.selector,t=i.className,o=i.sources,l=i.error,r=i.metadata,n=i.namespace,s=i.templates,c="."+n,u="module-"+n,d=C(this),h=(d.find(e.placeholder),d.find(e.icon),d.find(e.embed)),f=this,p=d.data(u);a={initialize:function(){a.debug("Initializing embed"),a.determine.autoplay(),a.create(),a.bind.events(),a.instantiate()},instantiate:function(){a.verbose("Storing instance of module",a),p=a,d.data(u,a)},destroy:function(){a.verbose("Destroying previous instance of embed"),a.reset(),d.removeData(u).off(c)},refresh:function(){a.verbose("Refreshing selector cache"),d.find(e.placeholder),d.find(e.icon),h=d.find(e.embed)},bind:{events:function(){a.has.placeholder()&&(a.debug("Adding placeholder events"),d.on("click"+c,e.placeholder,a.createAndShow).on("click"+c,e.icon,a.createAndShow))}},create:function(){a.get.placeholder()?a.createPlaceholder():a.createAndShow()},createPlaceholder:function(e){var t=a.get.icon(),n=a.get.url();a.generate.embed(n);e=e||a.get.placeholder(),d.html(s.placeholder(e,t)),a.debug("Creating placeholder for embed",e,t)},createEmbed:function(e){a.refresh(),e=e||a.get.url(),h=C("<div/>").addClass(t.embed).html(a.generate.embed(e)).appendTo(d),i.onCreate.call(f,e),a.debug("Creating embed object",h)},changeEmbed:function(e){h.html(a.generate.embed(e))},createAndShow:function(){a.createEmbed(),a.show()},change:function(e,t,n){a.debug("Changing video to ",e,t,n),d.data(r.source,e).data(r.id,t),n?d.data(r.url,n):d.removeData(r.url),a.has.embed()?a.changeEmbed():a.create()},reset:function(){a.debug("Clearing embed and showing placeholder"),a.remove.data(),a.remove.active(),a.remove.embed(),a.showPlaceholder(),i.onReset.call(f)},show:function(){a.debug("Showing embed"),a.set.active(),i.onDisplay.call(f)},hide:function(){a.debug("Hiding embed"),a.showPlaceholder()},showPlaceholder:function(){a.debug("Showing placeholder image"),a.remove.active(),i.onPlaceholderDisplay.call(f)},get:{id:function(){return i.id||d.data(r.id)},placeholder:function(){return i.placeholder||d.data(r.placeholder)},icon:function(){return i.icon?i.icon:d.data(r.icon)!==E?d.data(r.icon):a.determine.icon()},source:function(e){return i.source?i.source:d.data(r.source)!==E?d.data(r.source):a.determine.source()},type:function(){var e=a.get.source();return o[e]!==E&&o[e].type},url:function(){return i.url?i.url:d.data(r.url)!==E?d.data(r.url):a.determine.url()}},determine:{autoplay:function(){a.should.autoplay()&&(i.autoplay=!0)},source:function(n){var i=!1;return(n=n||a.get.url())&&C.each(o,function(e,t){if(-1!==n.search(t.domain))return i=e,!1}),i},icon:function(){var e=a.get.source();return o[e]!==E&&o[e].icon},url:function(){var e,t=i.id||d.data(r.id),n=i.source||d.data(r.source);return(e=o[n]!==E&&o[n].url.replace("{id}",t))&&d.data(r.url,e),e}},set:{active:function(){d.addClass(t.active)}},remove:{data:function(){d.removeData(r.id).removeData(r.icon).removeData(r.placeholder).removeData(r.source).removeData(r.url)},active:function(){d.removeClass(t.active)},embed:function(){h.empty()}},encode:{parameters:function(e){var t,n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&amp;")}},generate:{embed:function(e){a.debug("Generating embed html");var t,n,i=a.get.source();return(e=a.get.url(e))?(n=a.generate.parameters(i),t=s.iframe(e,n)):a.error(l.noURL,d),t},parameters:function(e,t){var n=o[e]&&o[e].parameters!==E?o[e].parameters(i):{};return(t=t||i.parameters)&&(n=C.extend({},n,t)),n=i.onEmbed(n),a.encode.parameters(n)}},has:{embed:function(){return 0<h.length},placeholder:function(){return i.placeholder||d.data(r.placeholder)}},should:{autoplay:function(){return"auto"===i.autoplay?i.placeholder||d.data(r.placeholder)!==E:i.autoplay}},is:{video:function(){return"video"==a.get.type()}},setting:function(e,t){if(a.debug("Changing setting",e,t),C.isPlainObject(e))C.extend(!0,i,e);else{if(t===E)return i[e];C.isPlainObject(i[e])?C.extend(!0,i[e],t):i[e]=t}},internal:function(e,t){if(C.isPlainObject(e))C.extend(!0,a,e);else{if(t===E)return a[e];a[e]=t}},debug:function(){!i.silent&&i.debug&&(i.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,i.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!i.silent&&i.verbose&&i.debug&&(i.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,i.name+":"),a.verbose.apply(console,arguments)))},error:function(){i.silent||(a.error=Function.prototype.bind.call(console.error,console,i.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;i.performance&&(n=(t=(new Date).getTime())-(y||t),y=t,w.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:f,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=i.name+":",n=0;y=!1,clearTimeout(a.performance.timer),C.each(w,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",b&&(e+=" '"+b+"'"),1<v.length&&(e+=" ("+v.length+")"),(console.group!==E||console.table!==E)&&0<w.length&&(console.groupCollapsed(e),console.table?console.table(w):C.each(w,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),w=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||S,t=f||t,"string"==typeof i&&s!==E&&(i=i.split(/[\. ]/),o=i.length-1,C.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(C.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==E)return r=s[n],!1;if(!C.isPlainObject(s[t])||e==o)return s[t]!==E?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),C.isFunction(r)?n=r.apply(t,e):r!==E&&(n=r),Array.isArray(m)?m.push(n):m!==E?m=[m,n]:n!==E&&(m=n),r}},x?(p===E&&a.initialize(),a.invoke(T)):(p!==E&&p.invoke("destroy"),a.initialize())}),m!==E?m:this},C.fn.embed.settings={name:"Embed",namespace:"embed",silent:!1,debug:!1,verbose:!1,performance:!0,icon:!1,source:!1,url:!1,id:!1,autoplay:"auto",color:"#444444",hd:!0,brandedUI:!1,parameters:!1,onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(e){},onEmbed:function(e){return e},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},error:{noURL:"No URL specified",method:"The method you called is not defined"},className:{active:"active",embed:"embed"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(e){return{autohide:!e.brandedUI,autoplay:e.autoplay,color:e.color||E,hq:e.hd,jsapi:e.api,modestbranding:!e.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(e){return{api:e.api,autoplay:e.autoplay,byline:e.brandedUI,color:e.color||E,portrait:e.brandedUI,title:e.brandedUI}}}},templates:{iframe:function(e,t){var n=e;return t&&(n+="?"+t),'<iframe src="'+n+'" width="100%" height="100%" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(e,t){var n="";return t&&(n+='<i class="'+t+' icon"></i>'),e&&(n+='<img class="placeholder" src="'+e+'">'),n}},api:!1,onPause:function(){},onPlay:function(){},onStop:function(){}}}(jQuery,window,document),function(N,H,B,z){"use strict";N.isFunction=N.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},H=void 0!==H&&H.Math==Math?H:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),N.fn.modal=function(E){var P,e=N(this),R=N(H),I=N(B),_=N("body"),A=e.selector||"",O=(new Date).getTime(),k=[],D=E,M="string"==typeof D,F=[].slice.call(arguments,1),L=H.requestAnimationFrame||H.mozRequestAnimationFrame||H.webkitRequestAnimationFrame||H.msRequestAnimationFrame||function(e){setTimeout(e,0)};return e.each(function(){var o,r,e,i,n,s,a,t,l,c,u,d=N.isPlainObject(E)?N.extend(!0,{},N.fn.modal.settings,E):N.extend({},N.fn.modal.settings),h=d.selector,f=d.className,p=d.namespace,g=d.error,m="."+p,v="module-"+p,b=N(this),y=N(d.context),w=b.find(h.close),T=this,x=b.data(v),S=!1,C="";u={initialize:function(){u.verbose("Initializing dimmer",y),u.create.id(),u.create.dimmer(),d.allowMultiple&&u.create.innerDimmer(),d.centered||b.addClass("top aligned"),u.refreshModals(),u.bind.events(),d.observeChanges&&u.observeChanges(),u.instantiate()},instantiate:function(){u.verbose("Storing instance of modal"),x=u,b.data(v,x)},create:{dimmer:function(){var e={debug:d.debug,dimmerName:"modals"},t=N.extend(!0,e,d.dimmerSettings);N.fn.dimmer!==z?(u.debug("Creating dimmer"),i=y.dimmer(t),d.detachable?(u.verbose("Modal is detachable, moving content into dimmer"),i.dimmer("add content",b)):u.set.undetached(),n=i.dimmer("get dimmer")):u.error(g.dimmer)},id:function(){l=(Math.random().toString(16)+"000000000").substr(2,8),t="."+l,u.verbose("Creating unique id for element",l)},innerDimmer:function(){0==b.find(h.dimmer).length&&b.prepend('<div class="ui inverted dimmer"></div>')}},destroy:function(){c&&c.disconnect(),u.verbose("Destroying previous modal"),b.removeData(v).off(m),R.off(t),n.off(t),w.off(m),y.dimmer("destroy")},observeChanges:function(){"MutationObserver"in H&&((c=new MutationObserver(function(e){u.debug("DOM tree modified, refreshing"),u.refresh()})).observe(T,{childList:!0,subtree:!0}),u.debug("Setting up mutation observer",c))},refresh:function(){u.remove.scrolling(),u.cacheSizes(),u.can.useFlex()||u.set.modalOffset(),u.set.screenHeight(),u.set.type()},refreshModals:function(){r=b.siblings(h.modal),o=r.add(b)},attachEvents:function(e,t){var n=N(e);t=N.isFunction(u[t])?u[t]:u.toggle,0<n.length?(u.debug("Attaching modal events to element",e,t),n.off(m).on("click"+m,t)):u.error(g.notFound,e)},bind:{events:function(){u.verbose("Attaching events"),b.on("click"+m,h.close,u.event.close).on("click"+m,h.approve,u.event.approve).on("click"+m,h.deny,u.event.deny),R.on("resize"+t,u.event.resize)},scrollLock:function(){i.get(0).addEventListener("touchmove",u.event.preventScroll,{passive:!1})}},unbind:{scrollLock:function(){i.get(0).removeEventListener("touchmove",u.event.preventScroll,{passive:!1})}},get:{id:function(){return(Math.random().toString(16)+"000000000").substr(2,8)}},event:{approve:function(){S||!1===d.onApprove.call(T,N(this))?u.verbose("Approve callback returned false cancelling hide"):(S=!0,u.hide(function(){S=!1}))},preventScroll:function(e){-1!==e.target.className.indexOf("dimmer")&&e.preventDefault()},deny:function(){S||!1===d.onDeny.call(T,N(this))?u.verbose("Deny callback returned false cancelling hide"):(S=!0,u.hide(function(){S=!1}))},close:function(){u.hide()},mousedown:function(e){var t=N(e.target);(s=0<t.closest(h.modal).length)&&u.verbose("Mouse down event registered inside the modal"),(a=u.is.scrolling()&&N(H).outerWidth()-d.scrollbarWidth<=e.clientX)&&u.verbose("Mouse down event registered inside the scrollbar")},mouseup:function(e){if(d.closable)if(s)u.debug("Dimmer clicked but mouse down was initially registered inside the modal");else if(a)u.debug("Dimmer clicked but mouse down was initially registered inside the scrollbar");else{var t=0<N(e.target).closest(h.modal).length,n=N.contains(B.documentElement,e.target);if(!t&&n&&u.is.active()&&b.hasClass(f.front)){if(u.debug("Dimmer clicked, hiding all modals"),d.allowMultiple){if(!u.hideAll())return}else if(!u.hide())return;u.remove.clickaway()}}else u.verbose("Dimmer clicked but closable setting is disabled")},debounce:function(e,t){clearTimeout(u.timer),u.timer=setTimeout(e,t)},keyboard:function(e){27==e.which&&(d.closable?(u.debug("Escape key pressed hiding modal"),b.hasClass(f.front)&&u.hide()):u.debug("Escape key pressed, but closable is set to false"),e.preventDefault())},resize:function(){i.dimmer("is active")&&(u.is.animating()||u.is.active())&&L(u.refresh)}},toggle:function(){u.is.active()||u.is.animating()?u.hide():u.show()},show:function(e){e=N.isFunction(e)?e:function(){},u.refreshModals(),u.set.dimmerSettings(),u.set.dimmerStyles(),u.showModal(e)},hide:function(e){return e=N.isFunction(e)?e:function(){},u.refreshModals(),u.hideModal(e)},showModal:function(e){e=N.isFunction(e)?e:function(){},u.is.animating()||!u.is.active()?(u.showDimmer(),u.cacheSizes(),u.can.useFlex()?u.remove.legacy():(u.set.legacy(),u.set.modalOffset(),u.debug("Using non-flex legacy modal positioning.")),u.set.screenHeight(),u.set.type(),u.set.clickaway(),!d.allowMultiple&&u.others.active()?u.hideOthers(u.showModal):(S=!1,d.allowMultiple&&(u.others.active()&&r.filter("."+f.active).find(h.dimmer).addClass("active"),d.detachable&&b.detach().appendTo(n)),d.onShow.call(T),d.transition&&N.fn.transition!==z&&b.transition("is supported")?(u.debug("Showing modal with css animations"),b.transition({debug:d.debug,animation:d.transition+" in",queue:d.queue,duration:d.duration,useFailSafe:!0,onComplete:function(){d.onVisible.apply(T),d.keyboardShortcuts&&u.add.keyboardShortcuts(),u.save.focus(),u.set.active(),d.autofocus&&u.set.autofocus(),e()}})):u.error(g.noTransition))):u.debug("Modal is already visible")},hideModal:function(e,t,n){var i=r.filter("."+f.active).last();if(e=N.isFunction(e)?e:function(){},u.debug("Hiding modal"),!1===d.onHide.call(T,N(this)))return u.verbose("Hide callback returned false cancelling hide"),S=!1;(u.is.animating()||u.is.active())&&(d.transition&&N.fn.transition!==z&&b.transition("is supported")?(u.remove.active(),b.transition({debug:d.debug,animation:d.transition+" out",queue:d.queue,duration:d.duration,useFailSafe:!0,onStart:function(){u.others.active()||u.others.animating()||t||u.hideDimmer(),d.keyboardShortcuts&&!u.others.active()&&u.remove.keyboardShortcuts()},onComplete:function(){u.unbind.scrollLock(),d.allowMultiple&&(i.addClass(f.front),b.removeClass(f.front),n?o.find(h.dimmer).removeClass("active"):i.find(h.dimmer).removeClass("active")),d.onHidden.call(T),u.remove.dimmerStyles(),u.restore.focus(),e()}})):u.error(g.noTransition))},showDimmer:function(){i.dimmer("is animating")||!i.dimmer("is active")?(u.save.bodyMargin(),u.debug("Showing dimmer"),i.dimmer("show")):u.debug("Dimmer already visible")},hideDimmer:function(){i.dimmer("is animating")||i.dimmer("is active")?(u.unbind.scrollLock(),i.dimmer("hide",function(){u.restore.bodyMargin(),u.remove.clickaway(),u.remove.screenHeight()})):u.debug("Dimmer is not visible cannot hide")},hideAll:function(n){var e=o.filter("."+f.active+", ."+f.animating);if(n=N.isFunction(n)?n:function(){},0<e.length){u.debug("Hiding all visible modals");var i=!0;return N(e.get().reverse()).each(function(e,t){i=i&&N(t).modal("hide modal",n,!1,!0)}),i&&u.hideDimmer(),i}},hideOthers:function(e){var t=r.filter("."+f.active+", ."+f.animating);e=N.isFunction(e)?e:function(){},0<t.length&&(u.debug("Hiding other modals",r),t.modal("hide modal",e,!0))},others:{active:function(){return 0<r.filter("."+f.active).length},animating:function(){return 0<r.filter("."+f.animating).length}},add:{keyboardShortcuts:function(){u.verbose("Adding keyboard shortcuts"),I.on("keyup"+m,u.event.keyboard)}},save:{focus:function(){0<N(B.activeElement).closest(b).length||(e=N(B.activeElement).blur())},bodyMargin:function(){C=_.css("margin-right");var e=parseInt(C.replace(/[^\d.]/g,""))+(H.innerWidth-B.documentElement.clientWidth);_.css("margin-right",e+"px"),_.find(h.bodyFixed).css("padding-right",e+"px")}},restore:{focus:function(){e&&0<e.length&&d.restoreFocus&&e.focus()},bodyMargin:function(){_.css("margin-right",C),_.find(h.bodyFixed).css("padding-right",C)}},remove:{active:function(){b.removeClass(f.active)},legacy:function(){b.removeClass(f.legacy)},clickaway:function(){n.off("mousedown"+t),n.off("mouseup"+t)},dimmerStyles:function(){n.removeClass(f.inverted),i.removeClass(f.blurring)},bodyStyle:function(){""===_.attr("style")&&(u.verbose("Removing style attribute"),_.removeAttr("style"))},screenHeight:function(){u.debug("Removing page height"),_.css("height","")},keyboardShortcuts:function(){u.verbose("Removing keyboard shortcuts"),I.off("keyup"+m)},scrolling:function(){i.removeClass(f.scrolling),b.removeClass(f.scrolling)}},cacheSizes:function(){b.addClass(f.loading);var e=b.prop("scrollHeight"),t=b.outerWidth(),n=b.outerHeight();u.cache!==z&&0===n||(u.cache={pageHeight:N(B).outerHeight(),width:t,height:n+d.offset,scrollHeight:e+d.offset,contextHeight:"body"==d.context?N(H).height():i.height()},u.cache.topOffset=-u.cache.height/2),b.removeClass(f.loading),u.debug("Caching modal and container sizes",u.cache)},can:{useFlex:function(){return"auto"==d.useFlex?d.detachable&&!u.is.ie():d.useFlex},fit:function(){var e=u.cache.contextHeight,t=u.cache.contextHeight/2,n=u.cache.topOffset,i=u.cache.scrollHeight,o=u.cache.height,r=d.padding;return o<i?t+n+i+r<e:o+2*r<e}},is:{active:function(){return b.hasClass(f.active)},ie:function(){return!H.ActiveXObject&&"ActiveXObject"in H||"ActiveXObject"in H},animating:function(){return b.transition("is supported")?b.transition("is animating"):b.is(":visible")},scrolling:function(){return i.hasClass(f.scrolling)},modernBrowser:function(){return!(H.ActiveXObject||"ActiveXObject"in H)}},set:{autofocus:function(){var e=b.find("[tabindex], :input").filter(":visible").filter(function(){return 0===N(this).closest(".disabled").length}),t=e.filter("[autofocus]"),n=0<t.length?t.first():e.first();0<n.length&&n.focus()},clickaway:function(){n.on("mousedown"+t,u.event.mousedown),n.on("mouseup"+t,u.event.mouseup)},dimmerSettings:function(){if(N.fn.dimmer!==z){var e={debug:d.debug,dimmerName:"modals",closable:"auto",useFlex:u.can.useFlex(),duration:{show:d.duration,hide:d.duration}},t=N.extend(!0,e,d.dimmerSettings);d.inverted&&(t.variation=t.variation!==z?t.variation+" inverted":"inverted"),y.dimmer("setting",t)}else u.error(g.dimmer)},dimmerStyles:function(){d.inverted?n.addClass(f.inverted):n.removeClass(f.inverted),d.blurring?i.addClass(f.blurring):i.removeClass(f.blurring)},modalOffset:function(){var e=u.cache.width,t=u.cache.height;b.css({marginTop:!b.hasClass("aligned")&&u.can.fit()?-t/2:0,marginLeft:-e/2}),u.verbose("Setting modal offset for legacy mode")},screenHeight:function(){u.can.fit()?_.css("height",""):b.hasClass("bottom")||(u.debug("Modal is taller than page content, resizing page height"),_.css("height",u.cache.height+2*d.padding))},active:function(){b.addClass(f.active+" "+f.front),r.filter("."+f.active).removeClass(f.front)},scrolling:function(){i.addClass(f.scrolling),b.addClass(f.scrolling),u.unbind.scrollLock()},legacy:function(){b.addClass(f.legacy)},type:function(){u.can.fit()?(u.verbose("Modal fits on screen"),u.others.active()||u.others.animating()||(u.remove.scrolling(),u.bind.scrollLock())):b.hasClass("bottom")?u.verbose("Bottom aligned modal not fitting on screen is unsupported for scrolling"):(u.verbose("Modal cannot fit on screen setting to scrolling"),u.set.scrolling())},undetached:function(){i.addClass(f.undetached)}},setting:function(e,t){if(u.debug("Changing setting",e,t),N.isPlainObject(e))N.extend(!0,d,e);else{if(t===z)return d[e];N.isPlainObject(d[e])?N.extend(!0,d[e],t):d[e]=t}},internal:function(e,t){if(N.isPlainObject(e))N.extend(!0,u,e);else{if(t===z)return u[e];u[e]=t}},debug:function(){!d.silent&&d.debug&&(d.performance?u.performance.log(arguments):(u.debug=Function.prototype.bind.call(console.info,console,d.name+":"),u.debug.apply(console,arguments)))},verbose:function(){!d.silent&&d.verbose&&d.debug&&(d.performance?u.performance.log(arguments):(u.verbose=Function.prototype.bind.call(console.info,console,d.name+":"),u.verbose.apply(console,arguments)))},error:function(){d.silent||(u.error=Function.prototype.bind.call(console.error,console,d.name+":"),u.error.apply(console,arguments))},performance:{log:function(e){var t,n;d.performance&&(n=(t=(new Date).getTime())-(O||t),O=t,k.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:T,"Execution Time":n})),clearTimeout(u.performance.timer),u.performance.timer=setTimeout(u.performance.display,500)},display:function(){var e=d.name+":",n=0;O=!1,clearTimeout(u.performance.timer),N.each(k,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",A&&(e+=" '"+A+"'"),(console.group!==z||console.table!==z)&&0<k.length&&(console.groupCollapsed(e),console.table?console.table(k):N.each(k,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),k=[]}},invoke:function(i,e,t){var o,r,n,s=x;return e=e||F,t=T||t,"string"==typeof i&&s!==z&&(i=i.split(/[\. ]/),o=i.length-1,N.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(N.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==z)return r=s[n],!1;if(!N.isPlainObject(s[t])||e==o)return s[t]!==z&&(r=s[t]),!1;s=s[t]}})),N.isFunction(r)?n=r.apply(t,e):r!==z&&(n=r),Array.isArray(P)?P.push(n):P!==z?P=[P,n]:n!==z&&(P=n),r}},M?(x===z&&u.initialize(),u.invoke(D)):(x!==z&&x.invoke("destroy"),u.initialize())}),P!==z?P:this},N.fn.modal.settings={name:"Modal",namespace:"modal",useFlex:"auto",offset:0,silent:!1,debug:!1,verbose:!1,performance:!0,observeChanges:!1,allowMultiple:!1,detachable:!0,closable:!0,autofocus:!0,restoreFocus:!0,inverted:!1,blurring:!1,centered:!0,dimmerSettings:{closable:!1,useCSS:!0},keyboardShortcuts:!0,context:"body",queue:!1,duration:500,transition:"scale",padding:50,scrollbarWidth:10,onShow:function(){},onVisible:function(){},onHide:function(){return!0},onHidden:function(){},onApprove:function(){return!0},onDeny:function(){return!0},selector:{close:"> .close",approve:".actions .positive, .actions .approve, .actions .ok",deny:".actions .negative, .actions .deny, .actions .cancel",modal:".ui.modal",dimmer:"> .ui.dimmer",bodyFixed:"> .ui.fixed.menu, > .ui.right.toast-container, > .ui.right.sidebar"},error:{dimmer:"UI Dimmer, a required component is not included in this page",method:"The method you called is not defined.",notFound:"The element you specified could not be found"},className:{active:"active",animating:"animating",blurring:"blurring",inverted:"inverted",legacy:"legacy",loading:"loading",scrolling:"scrolling",undetached:"undetached",front:"front"}}}(jQuery,window,document),function(y,w,e,T){"use strict";y.isFunction=y.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},w=void 0!==w&&w.Math==Math?w:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),y.fn.nag=function(d){var h,e=y(this),f=e.selector||"",p=(new Date).getTime(),g=[],m=d,v="string"==typeof m,b=[].slice.call(arguments,1);return e.each(function(){var a,i=y.isPlainObject(d)?y.extend(!0,{},y.fn.nag.settings,d):y.extend({},y.fn.nag.settings),e=i.selector,l=i.error,t=i.namespace,n="."+t,o=t+"-module",r=y(this),s=i.context?y(i.context):y("body"),c=this,u=r.data(o);a={initialize:function(){a.verbose("Initializing element"),r.on("click"+n,e.close,a.dismiss).data(o,a),i.detachable&&r.parent()[0]!==s[0]&&r.detach().prependTo(s),0<i.displayTime&&setTimeout(a.hide,i.displayTime),a.show()},destroy:function(){a.verbose("Destroying instance"),r.removeData(o).off(n)},show:function(){a.should.show()&&!r.is(":visible")&&(a.debug("Showing nag",i.animation.show),"fade"==i.animation.show?r.fadeIn(i.duration,i.easing):r.slideDown(i.duration,i.easing))},hide:function(){a.debug("Showing nag",i.animation.hide),"fade"==i.animation.show?r.fadeIn(i.duration,i.easing):r.slideUp(i.duration,i.easing)},onHide:function(){a.debug("Removing nag",i.animation.hide),r.remove(),i.onHide&&i.onHide()},dismiss:function(e){i.storageMethod&&a.storage.set(i.key,i.value),a.hide(),e.stopImmediatePropagation(),e.preventDefault()},should:{show:function(){return i.persist?(a.debug("Persistent nag is set, can show nag"),!0):a.storage.get(i.key)!=i.value.toString()?(a.debug("Stored value is not set, can show nag",a.storage.get(i.key)),!0):(a.debug("Stored value is set, cannot show nag",a.storage.get(i.key)),!1)}},get:{storageOptions:function(){var e={};return i.expires&&(e.expires=i.expires),i.domain&&(e.domain=i.domain),i.path&&(e.path=i.path),e}},clear:function(){a.storage.remove(i.key)},storage:{set:function(e,t){var n=a.get.storageOptions();if("localstorage"==i.storageMethod&&w.localStorage!==T)w.localStorage.setItem(e,t),a.debug("Value stored using local storage",e,t);else if("sessionstorage"==i.storageMethod&&w.sessionStorage!==T)w.sessionStorage.setItem(e,t),a.debug("Value stored using session storage",e,t);else{if(y.cookie===T)return void a.error(l.noCookieStorage);y.cookie(e,t,n),a.debug("Value stored using cookie",e,t,n)}},get:function(e,t){var n;return"localstorage"==i.storageMethod&&w.localStorage!==T?n=w.localStorage.getItem(e):"sessionstorage"==i.storageMethod&&w.sessionStorage!==T?n=w.sessionStorage.getItem(e):y.cookie!==T?n=y.cookie(e):a.error(l.noCookieStorage),"undefined"!=n&&"null"!=n&&n!==T&&null!==n||(n=T),n},remove:function(e){var t=a.get.storageOptions();"localstorage"==i.storageMethod&&w.localStorage!==T?w.localStorage.removeItem(e):"sessionstorage"==i.storageMethod&&w.sessionStorage!==T?w.sessionStorage.removeItem(e):y.cookie!==T?y.removeCookie(e,t):a.error(l.noStorage)}},setting:function(e,t){if(a.debug("Changing setting",e,t),y.isPlainObject(e))y.extend(!0,i,e);else{if(t===T)return i[e];y.isPlainObject(i[e])?y.extend(!0,i[e],t):i[e]=t}},internal:function(e,t){if(y.isPlainObject(e))y.extend(!0,a,e);else{if(t===T)return a[e];a[e]=t}},debug:function(){!i.silent&&i.debug&&(i.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,i.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!i.silent&&i.verbose&&i.debug&&(i.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,i.name+":"),a.verbose.apply(console,arguments)))},error:function(){i.silent||(a.error=Function.prototype.bind.call(console.error,console,i.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;i.performance&&(n=(t=(new Date).getTime())-(p||t),p=t,g.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:c,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=i.name+":",n=0;p=!1,clearTimeout(a.performance.timer),y.each(g,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",f&&(e+=" '"+f+"'"),(console.group!==T||console.table!==T)&&0<g.length&&(console.groupCollapsed(e),console.table?console.table(g):y.each(g,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),g=[]}},invoke:function(i,e,t){var o,r,n,s=u;return e=e||b,t=c||t,"string"==typeof i&&s!==T&&(i=i.split(/[\. ]/),o=i.length-1,y.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(y.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==T)return r=s[n],!1;if(!y.isPlainObject(s[t])||e==o)return s[t]!==T?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),y.isFunction(r)?n=r.apply(t,e):r!==T&&(n=r),Array.isArray(h)?h.push(n):h!==T?h=[h,n]:n!==T&&(h=n),r}},v?(u===T&&a.initialize(),a.invoke(m)):(u!==T&&u.invoke("destroy"),a.initialize())}),h!==T?h:this},y.fn.nag.settings={name:"Nag",silent:!1,debug:!1,verbose:!1,performance:!0,namespace:"Nag",persist:!1,displayTime:0,animation:{show:"slide",hide:"slide"},context:!1,detachable:!1,expires:30,domain:!1,path:"/",storageMethod:"cookie",key:"nag",value:"dismiss",error:{noCookieStorage:"$.cookie is not included. A storage solution is required.",noStorage:"Neither $.cookie or store is defined. A storage solution is required for storing state",method:"The method you called is not defined."},className:{bottom:"bottom",fixed:"fixed"},selector:{close:".close.icon"},speed:500,easing:"easeOutQuad",onHide:function(){}},y.extend(y.easing,{easeOutQuad:function(e,t,n,i,o){return-i*(t/=o)*(t-2)+n}})}(jQuery,window,document),function(L,N,H,B){"use strict";L.isFunction=L.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},N=void 0!==N&&N.Math==Math?N:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),L.fn.popup=function(C){var E,e=L(this),P=L(H),R=L(N),I=L("body"),_=e.selector||"",A="ontouchstart"in H.documentElement?"touchstart":"click",O=(new Date).getTime(),k=[],D=C,M="string"==typeof D,F=[].slice.call(arguments,1);return e.each(function(){var u,c,e,t,n,d,h=L.isPlainObject(C)?L.extend(!0,{},L.fn.popup.settings,C):L.extend({},L.fn.popup.settings),o=h.selector,f=h.className,p=h.error,g=h.metadata,i=h.namespace,r="."+h.namespace,s="module-"+i,m=L(this),a=L(h.context),l=L(h.scrollContext),v=L(h.boundary),b=h.target?L(h.target):m,y=0,w=!1,T=!1,x=this,S=m.data(s);d={initialize:function(){d.debug("Initializing",m),d.createID(),d.bind.events(),!d.exists()&&h.preserve&&d.create(),h.observeChanges&&d.observeChanges(),d.instantiate()},instantiate:function(){d.verbose("Storing instance",d),S=d,m.data(s,S)},observeChanges:function(){"MutationObserver"in N&&((e=new MutationObserver(d.event.documentChanged)).observe(H,{childList:!0,subtree:!0}),d.debug("Setting up mutation observer",e))},refresh:function(){h.popup?u=L(h.popup).eq(0):h.inline&&(u=b.nextAll(o.popup).eq(0),h.popup=u),h.popup?(u.addClass(f.loading),c=d.get.offsetParent(),u.removeClass(f.loading),h.movePopup&&d.has.popup()&&d.get.offsetParent(u)[0]!==c[0]&&(d.debug("Moving popup to the same offset parent as target"),u.detach().appendTo(c))):c=h.inline?d.get.offsetParent(b):d.has.popup()?d.get.offsetParent(u):I,c.is("html")&&c[0]!==I[0]&&(d.debug("Setting page as offset parent"),c=I),d.get.variation()&&d.set.variation()},reposition:function(){d.refresh(),d.set.position()},destroy:function(){d.debug("Destroying previous module"),e&&e.disconnect(),u&&!h.preserve&&d.removePopup(),clearTimeout(d.hideTimer),clearTimeout(d.showTimer),d.unbind.close(),d.unbind.events(),m.removeData(s)},event:{start:function(e){var t=L.isPlainObject(h.delay)?h.delay.show:h.delay;clearTimeout(d.hideTimer),(!T||T&&h.addTouchEvents)&&(d.showTimer=setTimeout(d.show,t))},end:function(){var e=L.isPlainObject(h.delay)?h.delay.hide:h.delay;clearTimeout(d.showTimer),d.hideTimer=setTimeout(d.hide,e)},touchstart:function(e){T=!0,h.addTouchEvents&&d.show()},resize:function(){d.is.visible()&&d.set.position()},documentChanged:function(e){[].forEach.call(e,function(e){e.removedNodes&&[].forEach.call(e.removedNodes,function(e){(e==x||0<L(e).find(x).length)&&(d.debug("Element removed from DOM, tearing down events"),d.destroy())})})},hideGracefully:function(e){var t=L(e.target),n=L.contains(H.documentElement,e.target),i=0<t.closest(o.popup).length;e&&!i&&n?(d.debug("Click occurred outside popup hiding popup"),d.hide()):d.debug("Click was inside popup, keeping popup open")}},create:function(){var e=d.get.html(),t=d.get.title(),n=d.get.content();e||n||t?(d.debug("Creating pop-up html"),e=e||h.templates.popup({title:t,content:n}),u=L("<div/>").addClass(f.popup).data(g.activator,m).html(e),h.inline?(d.verbose("Inserting popup element inline",u),u.insertAfter(m)):(d.verbose("Appending popup element to body",u),u.appendTo(a)),d.refresh(),d.set.variation(),h.hoverable&&d.bind.popup(),h.onCreate.call(u,x)):0!==b.next(o.popup).length?(d.verbose("Pre-existing popup found"),h.inline=!0,h.popup=b.next(o.popup).data(g.activator,m),d.refresh(),h.hoverable&&d.bind.popup()):h.popup?(L(h.popup).data(g.activator,m),d.verbose("Used popup specified in settings"),d.refresh(),h.hoverable&&d.bind.popup()):d.debug("No content specified skipping display",x)},createID:function(){n=(Math.random().toString(16)+"000000000").substr(2,8),t="."+n,d.verbose("Creating unique id for element",n)},toggle:function(){d.debug("Toggling pop-up"),d.is.hidden()?(d.debug("Popup is hidden, showing pop-up"),d.unbind.close(),d.show()):(d.debug("Popup is visible, hiding pop-up"),d.hide())},show:function(e){if(e=e||function(){},d.debug("Showing pop-up",h.transition),d.is.hidden()&&(!d.is.active()||!d.is.dropdown())){if(d.exists()||d.create(),!1===h.onShow.call(u,x))return void d.debug("onShow callback returned false, cancelling popup animation");h.preserve||h.popup||d.refresh(),u&&d.set.position()&&(d.save.conditions(),h.exclusive&&d.hideAll(),d.animate.show(e))}},hide:function(e){if(e=e||function(){},d.is.visible()||d.is.animating()){if(!1===h.onHide.call(u,x))return void d.debug("onHide callback returned false, cancelling popup animation");d.remove.visible(),d.unbind.close(),d.restore.conditions(),d.animate.hide(e)}},hideAll:function(){L(o.popup).filter("."+f.popupVisible).each(function(){L(this).data(g.activator).popup("hide")})},exists:function(){return!!u&&(h.inline||h.popup?d.has.popup():1<=u.closest(a).length)},removePopup:function(){d.has.popup()&&!h.popup&&(d.debug("Removing popup",u),u.remove(),u=B,h.onRemove.call(u,x))},save:{conditions:function(){d.cache={title:m.attr("title")},d.cache.title&&m.removeAttr("title"),d.verbose("Saving original attributes",d.cache.title)}},restore:{conditions:function(){return d.cache&&d.cache.title&&(m.attr("title",d.cache.title),d.verbose("Restoring original attributes",d.cache.title)),!0}},supports:{svg:function(){return"undefined"!=typeof SVGGraphicsElement}},animate:{show:function(e){e=L.isFunction(e)?e:function(){},h.transition&&L.fn.transition!==B&&m.transition("is supported")?(d.set.visible(),u.transition({animation:h.transition+" in",queue:!1,debug:h.debug,verbose:h.verbose,duration:h.duration,onComplete:function(){d.bind.close(),e.call(u,x),h.onVisible.call(u,x)}})):d.error(p.noTransition)},hide:function(e){e=L.isFunction(e)?e:function(){},d.debug("Hiding pop-up"),h.transition&&L.fn.transition!==B&&m.transition("is supported")?u.transition({animation:h.transition+" out",queue:!1,duration:h.duration,debug:h.debug,verbose:h.verbose,onComplete:function(){d.reset(),e.call(u,x),h.onHidden.call(u,x)}}):d.error(p.noTransition)}},change:{content:function(e){u.html(e)}},get:{html:function(){return m.removeData(g.html),m.data(g.html)||h.html},title:function(){return m.removeData(g.title),m.data(g.title)||h.title},content:function(){return m.removeData(g.content),m.data(g.content)||h.content||m.attr("title")},variation:function(){return m.removeData(g.variation),m.data(g.variation)||h.variation},popup:function(){return u},popupOffset:function(){return u.offset()},calculations:function(){var e,t=d.get.offsetParent(u),n=b[0],i=v[0]==N,o=h.inline||h.popup&&h.movePopup?b.position():b.offset(),r=i?{top:0,left:0}:v.offset(),s={},a=i?{top:R.scrollTop(),left:R.scrollLeft()}:{top:0,left:0};if(s={target:{element:b[0],width:b.outerWidth(),height:b.outerHeight(),top:o.top,left:o.left,margin:{}},popup:{width:u.outerWidth(),height:u.outerHeight()},parent:{width:c.outerWidth(),height:c.outerHeight()},screen:{top:r.top,left:r.left,scroll:{top:a.top,left:a.left},width:v.width(),height:v.height()}},t.get(0)!==c.get(0)){var l=t.offset();s.target.top-=l.top,s.target.left-=l.left,s.parent.width=t.outerWidth(),s.parent.height=t.outerHeight()}return h.setFluidWidth&&d.is.fluid()&&(s.container={width:u.parent().outerWidth()},s.popup.width=s.container.width),s.target.margin.top=h.inline?parseInt(N.getComputedStyle(n).getPropertyValue("margin-top"),10):0,s.target.margin.left=h.inline?d.is.rtl()?parseInt(N.getComputedStyle(n).getPropertyValue("margin-right"),10):parseInt(N.getComputedStyle(n).getPropertyValue("margin-left"),10):0,e=s.screen,s.boundary={top:e.top+e.scroll.top,bottom:e.top+e.scroll.top+e.height,left:e.left+e.scroll.left,right:e.left+e.scroll.left+e.width},s},id:function(){return n},startEvent:function(){return"hover"==h.on?"mouseenter":"focus"==h.on&&"focus"},scrollEvent:function(){return"scroll"},endEvent:function(){return"hover"==h.on?"mouseleave":"focus"==h.on&&"blur"},distanceFromBoundary:function(e,t){var n,i,o={};return n=(t=t||d.get.calculations()).popup,i=t.boundary,e&&(o={top:e.top-i.top,left:e.left-i.left,right:i.right-(e.left+n.width),bottom:i.bottom-(e.top+n.height)},d.verbose("Distance from boundaries determined",e,o)),o},offsetParent:function(e){var t=(e!==B?e[0]:b[0]).parentNode,n=L(t);if(t)for(var i="none"===n.css("transform"),o="static"===n.css("position"),r=n.is("body");t&&!r&&o&&i;)t=t.parentNode,i="none"===(n=L(t)).css("transform"),o="static"===n.css("position"),r=n.is("body");return n&&0<n.length?n:L()},positions:function(){return{"top left":!1,"top center":!1,"top right":!1,"bottom left":!1,"bottom center":!1,"bottom right":!1,"left center":!1,"right center":!1}},nextPosition:function(e){var t=e.split(" "),n=t[0],i=t[1],o="top"==n||"bottom"==n,r=!1,s=!1,a=!1;return w||(d.verbose("All available positions available"),w=d.get.positions()),d.debug("Recording last position tried",e),w[e]=!0,"opposite"===h.prefer&&(a=(a=[{top:"bottom",bottom:"top",left:"right",right:"left"}[n],i]).join(" "),r=!0===w[a],d.debug("Trying opposite strategy",a)),"adjacent"===h.prefer&&o&&(a=(a=[n,{left:"center",center:"right",right:"left"}[i]]).join(" "),s=!0===w[a],d.debug("Trying adjacent strategy",a)),(s||r)&&(d.debug("Using backup position",a),a={"top left":"top center","top center":"top right","top right":"right center","right center":"bottom right","bottom right":"bottom center","bottom center":"bottom left","bottom left":"left center","left center":"top left"}[e]),a}},set:{position:function(e,t){if(0!==b.length&&0!==u.length){var n,i,o,r,s,a,l,c;if(t=t||d.get.calculations(),e=e||m.data(g.position)||h.position,n=m.data(g.offset)||h.offset,i=h.distanceAway,o=t.target,r=t.popup,s=t.parent,d.should.centerArrow(t)&&(d.verbose("Adjusting offset to center arrow on small target element"),"top left"!=e&&"bottom left"!=e||(n+=o.width/2,n-=h.arrowPixelsFromEdge),"top right"!=e&&"bottom right"!=e||(n-=o.width/2,n+=h.arrowPixelsFromEdge)),0===o.width&&0===o.height&&!d.is.svg(o.element))return d.debug("Popup target is hidden, no action taken"),!1;switch(h.inline&&(d.debug("Adding margin to calculation",o.margin),"left center"==e||"right center"==e?(n+=o.margin.top,i+=-o.margin.left):"top left"==e||"top center"==e||"top right"==e?(n+=o.margin.left,i-=o.margin.top):(n+=o.margin.left,i+=o.margin.top)),d.debug("Determining popup position from calculations",e,t),d.is.rtl()&&(e=e.replace(/left|right/g,function(e){return"left"==e?"right":"left"}),d.debug("RTL: Popup position updated",e)),y==h.maxSearchDepth&&"string"==typeof h.lastResort&&(e=h.lastResort),e){case"top left":a={top:"auto",bottom:s.height-o.top+i,left:o.left+n,right:"auto"};break;case"top center":a={bottom:s.height-o.top+i,left:o.left+o.width/2-r.width/2+n,top:"auto",right:"auto"};break;case"top right":a={bottom:s.height-o.top+i,right:s.width-o.left-o.width-n,top:"auto",left:"auto"};break;case"left center":a={top:o.top+o.height/2-r.height/2+n,right:s.width-o.left+i,left:"auto",bottom:"auto"};break;case"right center":a={top:o.top+o.height/2-r.height/2+n,left:o.left+o.width+i,bottom:"auto",right:"auto"};break;case"bottom left":a={top:o.top+o.height+i,left:o.left+n,bottom:"auto",right:"auto"};break;case"bottom center":a={top:o.top+o.height+i,left:o.left+o.width/2-r.width/2+n,bottom:"auto",right:"auto"};break;case"bottom right":a={top:o.top+o.height+i,right:s.width-o.left-o.width-n,left:"auto",bottom:"auto"}}if(a===B&&d.error(p.invalidPosition,e),d.debug("Calculated popup positioning values",a),u.css(a).removeClass(f.position).addClass(e).addClass(f.loading),l=d.get.popupOffset(),c=d.get.distanceFromBoundary(l,t),!h.forcePosition&&d.is.offstage(c,e)){if(d.debug("Position is outside viewport",e),y<h.maxSearchDepth)return y++,e=d.get.nextPosition(e),d.debug("Trying new position",e),!!u&&d.set.position(e,t);if(!h.lastResort)return d.debug("Popup could not find a position to display",u),d.error(p.cannotPlace,x),d.remove.attempts(),d.remove.loading(),d.reset(),h.onUnplaceable.call(u,x),!1;d.debug("No position found, showing with last position")}return d.debug("Position is on stage",e),d.remove.attempts(),d.remove.loading(),h.setFluidWidth&&d.is.fluid()&&d.set.fluidWidth(t),!0}d.error(p.notFound)},fluidWidth:function(e){e=e||d.get.calculations(),d.debug("Automatically setting element width to parent width",e.parent.width),u.css("width",e.container.width)},variation:function(e){(e=e||d.get.variation())&&d.has.popup()&&(d.verbose("Adding variation to popup",e),u.addClass(e))},visible:function(){m.addClass(f.visible)}},remove:{loading:function(){u.removeClass(f.loading)},variation:function(e){(e=e||d.get.variation())&&(d.verbose("Removing variation",e),u.removeClass(e))},visible:function(){m.removeClass(f.visible)},attempts:function(){d.verbose("Resetting all searched positions"),y=0,w=!1}},bind:{events:function(){d.debug("Binding popup events to module"),"click"==h.on&&m.on(A+r,d.toggle),"hover"==h.on&&m.on("touchstart"+r,d.event.touchstart),d.get.startEvent()&&m.on(d.get.startEvent()+r,d.event.start).on(d.get.endEvent()+r,d.event.end),h.target&&d.debug("Target set to element",b),R.on("resize"+t,d.event.resize)},popup:function(){d.verbose("Allowing hover events on popup to prevent closing"),u&&d.has.popup()&&u.on("mouseenter"+r,d.event.start).on("mouseleave"+r,d.event.end)},close:function(){(!0===h.hideOnScroll||"auto"==h.hideOnScroll&&"click"!=h.on)&&d.bind.closeOnScroll(),d.is.closable()?d.bind.clickaway():"hover"==h.on&&T&&d.bind.touchClose()},closeOnScroll:function(){d.verbose("Binding scroll close event to document"),l.one(d.get.scrollEvent()+t,d.event.hideGracefully)},touchClose:function(){d.verbose("Binding popup touchclose event to document"),P.on("touchstart"+t,function(e){d.verbose("Touched away from popup"),d.event.hideGracefully.call(x,e)})},clickaway:function(){d.verbose("Binding popup close event to document"),P.on(A+t,function(e){d.verbose("Clicked away from popup"),d.event.hideGracefully.call(x,e)})}},unbind:{events:function(){R.off(t),m.off(r)},close:function(){P.off(t),l.off(t)}},has:{popup:function(){return u&&0<u.length}},should:{centerArrow:function(e){return!d.is.basic()&&e.target.width<=2*h.arrowPixelsFromEdge}},is:{closable:function(){return"auto"==h.closable?"hover"!=h.on:h.closable},offstage:function(e,n){var i=[];return L.each(e,function(e,t){t<-h.jitter&&(d.debug("Position exceeds allowable distance from edge",e,t,n),i.push(e))}),0<i.length},svg:function(e){return d.supports.svg()&&e instanceof SVGGraphicsElement},basic:function(){return m.hasClass(f.basic)},active:function(){return m.hasClass(f.active)},animating:function(){return u!==B&&u.hasClass(f.animating)},fluid:function(){return u!==B&&u.hasClass(f.fluid)},visible:function(){return u!==B&&u.hasClass(f.popupVisible)},dropdown:function(){return m.hasClass(f.dropdown)},hidden:function(){return!d.is.visible()},rtl:function(){return"rtl"==m.css("direction")}},reset:function(){d.remove.visible(),h.preserve?L.fn.transition!==B&&u.transition("remove transition"):d.removePopup()},setting:function(e,t){if(L.isPlainObject(e))L.extend(!0,h,e);else{if(t===B)return h[e];h[e]=t}},internal:function(e,t){if(L.isPlainObject(e))L.extend(!0,d,e);else{if(t===B)return d[e];d[e]=t}},debug:function(){!h.silent&&h.debug&&(h.performance?d.performance.log(arguments):(d.debug=Function.prototype.bind.call(console.info,console,h.name+":"),d.debug.apply(console,arguments)))},verbose:function(){!h.silent&&h.verbose&&h.debug&&(h.performance?d.performance.log(arguments):(d.verbose=Function.prototype.bind.call(console.info,console,h.name+":"),d.verbose.apply(console,arguments)))},error:function(){h.silent||(d.error=Function.prototype.bind.call(console.error,console,h.name+":"),d.error.apply(console,arguments))},performance:{log:function(e){var t,n;h.performance&&(n=(t=(new Date).getTime())-(O||t),O=t,k.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:x,"Execution Time":n})),clearTimeout(d.performance.timer),d.performance.timer=setTimeout(d.performance.display,500)},display:function(){var e=h.name+":",n=0;O=!1,clearTimeout(d.performance.timer),L.each(k,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",_&&(e+=" '"+_+"'"),(console.group!==B||console.table!==B)&&0<k.length&&(console.groupCollapsed(e),console.table?console.table(k):L.each(k,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),k=[]}},invoke:function(i,e,t){var o,r,n,s=S;return e=e||F,t=x||t,"string"==typeof i&&s!==B&&(i=i.split(/[\. ]/),o=i.length-1,L.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(L.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==B)return r=s[n],!1;if(!L.isPlainObject(s[t])||e==o)return s[t]!==B&&(r=s[t]),!1;s=s[t]}})),L.isFunction(r)?n=r.apply(t,e):r!==B&&(n=r),Array.isArray(E)?E.push(n):E!==B?E=[E,n]:n!==B&&(E=n),r}},M?(S===B&&d.initialize(),d.invoke(D)):(S!==B&&S.invoke("destroy"),d.initialize())}),E!==B?E:this},L.fn.popup.settings={name:"Popup",silent:!1,debug:!1,verbose:!1,performance:!0,namespace:"popup",observeChanges:!0,onCreate:function(){},onRemove:function(){},onShow:function(){},onVisible:function(){},onHide:function(){},onUnplaceable:function(){},onHidden:function(){},on:"hover",boundary:N,addTouchEvents:!0,position:"top left",forcePosition:!1,variation:"",movePopup:!0,target:!1,popup:!1,inline:!1,preserve:!1,hoverable:!1,content:!1,html:!1,title:!1,closable:!0,hideOnScroll:"auto",exclusive:!1,context:"body",scrollContext:N,prefer:"opposite",lastResort:!1,arrowPixelsFromEdge:20,delay:{show:50,hide:70},setFluidWidth:!0,duration:200,transition:"scale",distanceAway:0,jitter:2,offset:0,maxSearchDepth:15,error:{invalidPosition:"The position you specified is not a valid position",cannotPlace:"Popup does not fit within the boundaries of the viewport",method:"The method you called is not defined.",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>",notFound:"The target or popup you specified does not exist on the page"},metadata:{activator:"activator",content:"content",html:"html",offset:"offset",position:"position",title:"title",variation:"variation"},className:{active:"active",basic:"basic",animating:"animating",dropdown:"dropdown",fluid:"fluid",loading:"loading",popup:"ui popup",position:"top left center bottom right",visible:"visible",popupVisible:"visible"},selector:{popup:".ui.popup"},templates:{escape:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return/[&<>"'`]/.test(e)?e.replace(/[&<>"'`]/g,function(e){return t[e]}):e},popup:function(e){var t="",n=L.fn.popup.settings.templates.escape;return typeof e!==B&&(typeof e.title!==B&&e.title&&(e.title=n(e.title),t+='<div class="header">'+e.title+"</div>"),typeof e.content!==B&&e.content&&(e.content=n(e.content),t+='<div class="content">'+e.content+"</div>")),t}}}}(jQuery,window,document),function(C,e,E,P){"use strict";C.isFunction=C.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),C.fn.progress=function(m){var v,e=C(this),b=e.selector||"",y=(new Date).getTime(),w=[],T=m,x="string"==typeof T,S=[].slice.call(arguments,1);return e.each(function(){var c,a=C.isPlainObject(m)?C.extend(!0,{},C.fn.progress.settings,m):C.extend({},C.fn.progress.settings),t=a.className,n=a.metadata,e=a.namespace,i=a.selector,l=a.error,o="."+e,r="module-"+e,u=C(this),d=C(this).find(i.bar),s=C(this).find(i.progress),h=C(this).find(i.label),f=this,p=u.data(r),g=!1;c={helper:{sum:function(e){return Array.isArray(e)?e.reduce(function(e,t){return e+Number(t)},0):0},derivePrecision:function(e,t){for(var n=0,i=1,o=e/t;n<10&&!(1<(o*=i));)i=Math.pow(10,n++);return i},forceArray:function(e){return Array.isArray(e)?e:isNaN(e)?"string"==typeof e?e.split(","):[]:[e]}},initialize:function(){c.set.duration(),c.set.transitionEvent(),c.debug(f),c.read.metadata(),c.read.settings(),c.instantiate()},instantiate:function(){c.verbose("Storing instance of progress",c),p=c,u.data(r,c)},destroy:function(){c.verbose("Destroying previous progress for",u),clearInterval(p.interval),c.remove.state(),u.removeData(r),p=P},reset:function(){c.remove.nextValue(),c.update.progress(0)},complete:function(){(c.percent===P||c.percent<100)&&(c.remove.progressPoll(),c.set.percent(100))},read:{metadata:function(){var e={percent:c.helper.forceArray(u.data(n.percent)),total:u.data(n.total),value:c.helper.forceArray(u.data(n.value))};e.total&&(c.debug("Total value set from metadata",e.total),c.set.total(e.total)),0<e.value.length&&(c.debug("Current value set from metadata",e.value),c.set.value(e.value),c.set.progress(e.value)),0<e.percent.length&&(c.debug("Current percent value set from metadata",e.percent),c.set.percent(e.percent))},settings:function(){!1!==a.total&&(c.debug("Current total set in settings",a.total),c.set.total(a.total)),!1!==a.value&&(c.debug("Current value set in settings",a.value),c.set.value(a.value),c.set.progress(c.value)),!1!==a.percent&&(c.debug("Current percent set in settings",a.percent),c.set.percent(a.percent))}},bind:{transitionEnd:function(t){var e=c.get.transitionEnd();d.one(e+o,function(e){clearTimeout(c.failSafeTimer),t.call(this,e)}),c.failSafeTimer=setTimeout(function(){d.triggerHandler(e)},a.duration+a.failSafeDelay),c.verbose("Adding fail safe timer",c.timer)}},increment:function(e){var t,n;e=c.has.total()?(t=c.get.value(),e||1):(t=c.get.percent(),e||c.get.randomValue()),n=t+e,c.debug("Incrementing percentage by",t,n,e),n=c.get.normalizedValue(n),c.set.progress(n)},decrement:function(e){var t,n;c.get.total()?(n=(t=c.get.value())-(e=e||1),c.debug("Decrementing value by",e,t)):(n=(t=c.get.percent())-(e=e||c.get.randomValue()),c.debug("Decrementing percentage by",e,t)),n=c.get.normalizedValue(n),c.set.progress(n)},has:{progressPoll:function(){return c.progressPoll},total:function(){return!1!==c.get.total()}},get:{text:function(e,t){var n=t||0,i=c.get.value(n),o=c.total||0,r=g?c.get.displayPercent(n):c.get.percent(n),s=0<c.total?o-i:100-r;return e=(e=e||"").replace("{value}",i).replace("{total}",o).replace("{left}",s).replace("{percent}",r).replace("{bar}",a.text.bars[n]||""),c.verbose("Adding variables to progress bar text",e),e},normalizedValue:function(e){if(e<0)return c.debug("Value cannot decrement below 0"),0;if(c.has.total()){if(e>c.total)return c.debug("Value cannot increment above total",c.total),c.total}else if(100<e)return c.debug("Value cannot increment above 100 percent"),100;return e},updateInterval:function(){return"auto"==a.updateInterval?a.duration:a.updateInterval},randomValue:function(){return c.debug("Generating random increment percentage"),Math.floor(Math.random()*a.random.max+a.random.min)},numericValue:function(e){return"string"==typeof e?""!==e.replace(/[^\d.]/g,"")&&+e.replace(/[^\d.]/g,""):e},transitionEnd:function(){var e,t=E.createElement("element"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(t.style[e]!==P)return n[e]},displayPercent:function(e){var t=C(d[e]),n=t.width(),i=u.width(),o=parseInt(t.css("min-width"),10)<n?n/i*100:c.percent;return 0<a.precision?Math.round(o*(10*a.precision))/(10*a.precision):Math.round(o)},percent:function(e){return c.percent&&c.percent[e||0]||0},value:function(e){return c.nextValue||c.value&&c.value[e||0]||0},total:function(){return c.total||!1}},create:{progressPoll:function(){c.progressPoll=setTimeout(function(){c.update.toNextValue(),c.remove.progressPoll()},c.get.updateInterval())}},is:{complete:function(){return c.is.success()||c.is.warning()||c.is.error()},success:function(){return u.hasClass(t.success)},warning:function(){return u.hasClass(t.warning)},error:function(){return u.hasClass(t.error)},active:function(){return u.hasClass(t.active)},visible:function(){return u.is(":visible")}},remove:{progressPoll:function(){c.verbose("Removing progress poll timer"),c.progressPoll&&(clearTimeout(c.progressPoll),delete c.progressPoll)},nextValue:function(){c.verbose("Removing progress value stored for next update"),delete c.nextValue},state:function(){c.verbose("Removing stored state"),delete c.total,delete c.percent,delete c.value},active:function(){c.verbose("Removing active state"),u.removeClass(t.active)},success:function(){c.verbose("Removing success state"),u.removeClass(t.success)},warning:function(){c.verbose("Removing warning state"),u.removeClass(t.warning)},error:function(){c.verbose("Removing error state"),u.removeClass(t.error)}},set:{barWidth:function(e){c.debug("set bar width with ",e),e=c.helper.forceArray(e);var o=-1,r=-1,s=c.helper.sum(e),a=d.length,l=1<a,t=e.map(function(e,t){var n=t===a-1&&0===s,i=C(d[t]);return 0===e&&l&&!n?i.css("display","none"):(l&&n&&i.css("background","transparent"),-1==o&&(o=t),r=t,i.css({display:"block",width:e+"%"})),parseFloat(e)});e.forEach(function(e,t){C(d[t]).css({borderTopLeftRadius:t==o?"":0,borderBottomLeftRadius:t==o?"":0,borderTopRightRadius:t==r?"":0,borderBottomRightRadius:t==r?"":0})}),u.attr("data-percent",t)},duration:function(e){e="number"==typeof(e=e||a.duration)?e+"ms":e,c.verbose("Setting progress bar transition duration",e),d.css({"transition-duration":e})},percent:function(e){e=c.helper.forceArray(e).map(function(e){return"string"==typeof e?+e.replace("%",""):e});var t=c.has.total(),n=c.helper.sum(e),i=1<e.length&&t,o=c.helper.sum(c.helper.forceArray(c.value));if(i&&o>c.total)c.error(l.sumExceedsTotal,o,c.total);else if(!i&&100<n)c.error(l.tooHigh,n);else if(n<0)c.error(l.tooLow,n);else{var r=0<a.precision?a.precision:i?c.helper.derivePrecision(Math.min.apply(null,c.value),c.total):P,s=e.map(function(e){return 0<r?Math.round(e*(10*r))/(10*r):Math.round(e)});c.percent=s,t||(c.value=s.map(function(e){return 0<r?Math.round(e/100*c.total*(10*r))/(10*r):Math.round(e/100*c.total*10)/10}),a.limitValues&&(c.value=c.value.map(function(e){return 100<e?100:c.value<0?0:c.value}))),c.set.barWidth(e),c.set.labelInterval(),c.set.labels()}a.onChange.call(f,e,c.value,c.total)},labelInterval:function(){clearInterval(c.interval),c.bind.transitionEnd(function(){c.verbose("Bar finished animating, removing continuous label updates"),clearInterval(c.interval),g=!1,c.set.labels()}),g=!0,c.interval=setInterval(function(){C.contains(E.documentElement,f)||(clearInterval(c.interval),g=!1),c.set.labels()},a.framerate)},labels:function(){c.verbose("Setting both bar progress and outer label text"),c.set.barLabel(),c.set.state()},label:function(e){(e=e||"")&&(e=c.get.text(e),c.verbose("Setting label to text",e),h.text(e))},state:function(e){100===(e=e!==P?e:c.helper.sum(c.percent))?a.autoSuccess&&1===d.length&&!(c.is.warning()||c.is.error()||c.is.success())?(c.set.success(),c.debug("Automatically triggering success at 100%")):(c.verbose("Reached 100% removing active state"),c.remove.active(),c.remove.progressPoll()):0<e?(c.verbose("Adjusting active progress bar label",e),c.set.active()):(c.remove.active(),c.set.label(a.text.active))},barLabel:function(i){s.map(function(e,t){var n=C(t);i!==P?n.text(c.get.text(i,e)):"ratio"==a.label&&c.total?(c.verbose("Adding ratio to bar label"),n.text(c.get.text(a.text.ratio,e))):"percent"==a.label&&(c.verbose("Adding percentage to bar label"),n.text(c.get.text(a.text.percent,e)))})},active:function(e){e=e||a.text.active,c.debug("Setting active state"),a.showActivity&&!c.is.active()&&u.addClass(t.active),c.remove.warning(),c.remove.error(),c.remove.success(),(e=a.onLabelUpdate("active",e,c.value,c.total))&&c.set.label(e),c.bind.transitionEnd(function(){a.onActive.call(f,c.value,c.total)})},success:function(e){e=e||a.text.success||a.text.active,c.debug("Setting success state"),u.addClass(t.success),c.remove.active(),c.remove.warning(),c.remove.error(),c.complete(),e=a.text.success?a.onLabelUpdate("success",e,c.value,c.total):a.onLabelUpdate("active",e,c.value,c.total),c.set.label(e),c.bind.transitionEnd(function(){a.onSuccess.call(f,c.total)})},warning:function(e){e=e||a.text.warning,c.debug("Setting warning state"),u.addClass(t.warning),c.remove.active(),c.remove.success(),c.remove.error(),c.complete(),(e=a.onLabelUpdate("warning",e,c.value,c.total))&&c.set.label(e),c.bind.transitionEnd(function(){a.onWarning.call(f,c.value,c.total)})},error:function(e){e=e||a.text.error,c.debug("Setting error state"),u.addClass(t.error),c.remove.active(),c.remove.success(),c.remove.warning(),c.complete(),(e=a.onLabelUpdate("error",e,c.value,c.total))&&c.set.label(e),c.bind.transitionEnd(function(){a.onError.call(f,c.value,c.total)})},transitionEvent:function(){c.get.transitionEnd()},total:function(e){c.total=e},value:function(e){c.value=c.helper.forceArray(e)},progress:function(e){c.has.progressPoll()?(c.debug("Updated within interval, setting next update to use new value",e),c.set.nextValue(e)):(c.debug("First update in progress update interval, immediately updating",e),c.update.progress(e),c.create.progressPoll())},nextValue:function(e){c.nextValue=e}},update:{toNextValue:function(){var e=c.nextValue;e&&(c.debug("Update interval complete using last updated value",e),c.update.progress(e),c.remove.nextValue())},progress:function(e){var n=c.has.total();n&&c.set.value(e);var t=c.helper.forceArray(e).map(function(e){var t;return!1===(e=c.get.numericValue(e))&&c.error(l.nonNumeric,e),e=c.get.normalizedValue(e),n?(t=e/c.total*100,c.debug("Calculating percent complete from total",t)):(t=e,c.debug("Setting value to exact percentage value",t)),t});c.set.percent(t)}},setting:function(e,t){if(c.debug("Changing setting",e,t),C.isPlainObject(e))C.extend(!0,a,e);else{if(t===P)return a[e];C.isPlainObject(a[e])?C.extend(!0,a[e],t):a[e]=t}},internal:function(e,t){if(C.isPlainObject(e))C.extend(!0,c,e);else{if(t===P)return c[e];c[e]=t}},debug:function(){!a.silent&&a.debug&&(a.performance?c.performance.log(arguments):(c.debug=Function.prototype.bind.call(console.info,console,a.name+":"),c.debug.apply(console,arguments)))},verbose:function(){!a.silent&&a.verbose&&a.debug&&(a.performance?c.performance.log(arguments):(c.verbose=Function.prototype.bind.call(console.info,console,a.name+":"),c.verbose.apply(console,arguments)))},error:function(){a.silent||(c.error=Function.prototype.bind.call(console.error,console,a.name+":"),c.error.apply(console,arguments))},performance:{log:function(e){var t,n;a.performance&&(n=(t=(new Date).getTime())-(y||t),y=t,w.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:f,"Execution Time":n})),clearTimeout(c.performance.timer),c.performance.timer=setTimeout(c.performance.display,500)},display:function(){var e=a.name+":",n=0;y=!1,clearTimeout(c.performance.timer),C.each(w,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",b&&(e+=" '"+b+"'"),(console.group!==P||console.table!==P)&&0<w.length&&(console.groupCollapsed(e),console.table?console.table(w):C.each(w,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),w=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||S,t=f||t,"string"==typeof i&&s!==P&&(i=i.split(/[\. ]/),o=i.length-1,C.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(C.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==P)return r=s[n],!1;if(!C.isPlainObject(s[t])||e==o)return s[t]!==P?r=s[t]:c.error(l.method,i),!1;s=s[t]}})),C.isFunction(r)?n=r.apply(t,e):r!==P&&(n=r),Array.isArray(v)?v.push(n):v!==P?v=[v,n]:n!==P&&(v=n),r}},x?(p===P&&c.initialize(),c.invoke(T)):(p!==P&&p.invoke("destroy"),c.initialize())}),v!==P?v:this},C.fn.progress.settings={name:"Progress",namespace:"progress",silent:!1,debug:!1,verbose:!1,performance:!0,random:{min:2,max:5},duration:300,updateInterval:"auto",autoSuccess:!0,showActivity:!0,limitValues:!0,label:"percent",precision:0,framerate:1e3/30,percent:!1,total:!1,value:!1,failSafeDelay:100,onLabelUpdate:function(e,t,n,i){return t},onChange:function(e,t,n){},onSuccess:function(e){},onActive:function(e,t){},onError:function(e,t){},onWarning:function(e,t){},error:{method:"The method you called is not defined.",nonNumeric:"Progress value is non numeric",tooHigh:"Value specified is above 100%",tooLow:"Value specified is below 0%",sumExceedsTotal:"Sum of multple values exceed total"},regExp:{variable:/\{\$*[A-z0-9]+\}/g},metadata:{percent:"percent",total:"total",value:"value"},selector:{bar:"> .bar",label:"> .label",progress:".bar > .progress"},text:{active:!1,error:!1,success:!1,warning:!1,percent:"{percent}%",ratio:"{value} of {total}",bars:[""]},className:{active:"active",error:"error",success:"success",warning:"warning"}}}(jQuery,window,document),function(B,t,z,j){"use strict";t=void 0!==t&&t.Math==Math?t:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),B.fn.slider=function(I){var _,e=B(this),A=B(t),O=e.selector||"",k=(new Date).getTime(),D=[],M=I,F="string"==typeof M,L=[].slice.call(arguments,1),N=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],H=0;return e.each(function(){var f,o,r,e,p,s,t,a,g,m,v,l,n,b,c=B.isPlainObject(I)?B.extend(!0,{},B.fn.slider.settings,I):B.extend({},B.fn.slider.settings),i=c.className,u=c.metadata,d=c.namespace,h=c.error,y=c.keys,w=c.interpretLabel,T=!1,x="."+d,S="module-"+d,C=B(this),E=this,P=C.data(S),R=1;b={initialize:function(){b.debug("Initializing slider",c),t=H+=1,n=b.setup.testOutTouch(),b.setup.layout(),b.setup.labels(),b.is.disabled()||b.bind.events(),b.read.metadata(),b.read.settings(),b.instantiate()},instantiate:function(){b.verbose("Storing instance of slider",b),P=b,C.data(S,b)},destroy:function(){b.verbose("Destroying previous slider for",C),clearInterval(P.interval),b.unbind.events(),b.unbind.slidingEvents(),C.removeData(S),P=j},setup:{layout:function(){C.attr("tabindex")===j&&C.attr("tabindex",0),0==C.find(".inner").length&&C.append("<div class='inner'><div class='track'></div><div class='track-fill'></div><div class='thumb'></div></div>"),l=b.get.precision(),o=C.find(".thumb:not(.second)"),f=o,b.is.range()&&(0==C.find(".thumb.second").length&&C.find(".inner").append("<div class='thumb second'></div>"),r=C.find(".thumb.second")),e=C.find(".track"),p=C.find(".track-fill"),v=o.width()/2},labels:function(){b.is.labeled()&&(0!=(s=C.find(".labels:not(.auto)")).length?b.setup.customLabel():b.setup.autoLabel(),c.showLabelTicks&&C.addClass(i.ticked))},testOutTouch:function(){try{return z.createEvent("TouchEvent"),!0}catch(e){return!1}},customLabel:function(){var n,e=s.find(".label"),i=e.length,o=b.get.min(),r=b.get.max();e.each(function(e){var t=B(this).attr("data-value");n=t?((t=r<t?r:t<o?o:t)-o)/(r-o):(e+1)/(i+1),b.update.labelPosition(n,B(this))})},autoLabel:function(){if(0!=b.get.step()){0!=(s=C.find(".labels")).length?s.empty():s=C.append('<ul class="auto labels"></ul>').find(".labels");for(var e=0,t=b.get.numLabels();e<=t;e++){var n=b.get.label(e),i=""!==n?e%b.get.gapRatio()?B('<li class="halftick label"></li>'):B('<li class="label">'+n+"</li>"):null,o=e/t;i&&(b.update.labelPosition(o,i),s.append(i))}}}},bind:{events:function(){b.bind.globalKeyboardEvents(),b.bind.keyboardEvents(),b.bind.mouseEvents(),b.is.touch()&&b.bind.touchEvents(),c.autoAdjustLabels&&b.bind.windowEvents()},keyboardEvents:function(){b.verbose("Binding keyboard events"),C.on("keydown"+x,b.event.keydown)},globalKeyboardEvents:function(){B(z).on("keydown"+x+t,b.event.activateFocus)},mouseEvents:function(){b.verbose("Binding mouse events"),C.find(".track, .thumb, .inner").on("mousedown"+x,function(e){e.stopImmediatePropagation(),e.preventDefault(),b.event.down(e)}),C.on("mousedown"+x,b.event.down),C.on("mouseenter"+x,function(e){T=!0}),C.on("mouseleave"+x,function(e){T=!1})},touchEvents:function(){b.verbose("Binding touch events"),C.find(".track, .thumb, .inner").on("touchstart"+x,function(e){e.stopImmediatePropagation(),e.preventDefault(),b.event.down(e)}),C.on("touchstart"+x,b.event.down)},slidingEvents:function(){b.verbose("Binding page wide events while handle is being draged"),b.is.touch()?(B(z).on("touchmove"+x,b.event.move),B(z).on("touchend"+x,b.event.up)):(B(z).on("mousemove"+x,b.event.move),B(z).on("mouseup"+x,b.event.up))},windowEvents:function(){A.on("resize"+x,b.event.resize)}},unbind:{events:function(){C.find(".track, .thumb, .inner").off("mousedown"+x),C.find(".track, .thumb, .inner").off("touchstart"+x),C.off("mousedown"+x),C.off("mouseenter"+x),C.off("mouseleave"+x),C.off("touchstart"+x),C.off("keydown"+x),C.off("focusout"+x),B(z).off("keydown"+x+t,b.event.activateFocus),A.off("resize"+x)},slidingEvents:function(){b.is.touch()?(B(z).off("touchmove"+x),B(z).off("touchend"+x)):(B(z).off("mousemove"+x),B(z).off("mouseup"+x))}},event:{down:function(e,t){if(e.preventDefault(),b.is.range()){var n=b.determine.eventPos(e,t),i=b.determine.pos(n);f=b.determine.closestThumb(i)}b.is.disabled()||b.bind.slidingEvents()},move:function(e,t){e.preventDefault();var n=b.determine.valueFromEvent(e,t);if(0==b.get.step()||b.is.smooth()){var i=b.thumbVal,o=b.secondThumbVal,r=b.determine.smoothValueFromEvent(e,t);f.hasClass("second")?o=n:i=n,n=Math.abs(i-(o||0)),b.update.position(r),c.onMove.call(E,n,i,o)}else b.update.value(n,function(e,t,n){c.onMove.call(E,e,t,n)})},up:function(e,t){e.preventDefault();var n=b.determine.valueFromEvent(e,t);b.set.value(n),b.unbind.slidingEvents()},keydown:function(e,t){if(b.is.focused()&&B(z).trigger(e),t||b.is.focused()){var n=b.determine.keyMovement(e);if(0!=n)switch(e.preventDefault(),n){case 1:b.takeStep();break;case 2:b.takeStep(b.get.multiplier());break;case-1:b.backStep();break;case-2:b.backStep(b.get.multiplier())}}},activateFocus:function(e){!b.is.focused()&&b.is.hover()&&0!=b.determine.keyMovement(e)&&(e.preventDefault(),b.event.keydown(e,!0),C.focus())},resize:function(e){R!=b.get.gapRatio()&&(b.setup.labels(),R=b.get.gapRatio())}},resync:function(){b.verbose("Resyncing thumb position based on value"),b.is.range()&&b.update.position(b.secondThumbVal,r),b.update.position(b.thumbVal,o),b.setup.labels()},takeStep:function(e){e=e!=j?e:1;var t=b.get.step(),n=b.get.currentThumbValue();if(b.verbose("Taking a step"),0<t)b.set.value(n+t*e);else if(0==t){var i=b.get.precision(),o=n+e/i;b.set.value(Math.round(o*i)/i)}},backStep:function(e){e=e!=j?e:1;var t=b.get.step(),n=b.get.currentThumbValue();if(b.verbose("Going back a step"),0<t)b.set.value(n-t*e);else if(0==t){var i=b.get.precision(),o=n-e/i;b.set.value(Math.round(o*i)/i)}},is:{range:function(){return C.hasClass(c.className.range)},hover:function(){return T},focused:function(){return C.is(":focus")},disabled:function(){return C.hasClass(c.className.disabled)},labeled:function(){return C.hasClass(c.className.labeled)},reversed:function(){return C.hasClass(c.className.reversed)},vertical:function(){return C.hasClass(c.className.vertical)},smooth:function(){return c.smooth||C.hasClass(c.className.smooth)},touch:function(){return n}},get:{trackOffset:function(){return b.is.vertical()?e.offset().top:e.offset().left},trackLength:function(){return b.is.vertical()?e.height():e.width()},trackLeft:function(){return b.is.vertical()?e.position().top:e.position().left},trackStartPos:function(){return b.is.reversed()?b.get.trackLeft()+b.get.trackLength():b.get.trackLeft()},trackEndPos:function(){return b.is.reversed()?b.get.trackLeft():b.get.trackLeft()+b.get.trackLength()},trackStartMargin:function(){return(b.is.vertical()?b.is.reversed()?C.css("padding-bottom"):C.css("padding-top"):b.is.reversed()?C.css("padding-right"):C.css("padding-left"))||"0px"},trackEndMargin:function(){return(b.is.vertical()?b.is.reversed()?C.css("padding-top"):C.css("padding-bottom"):b.is.reversed()?C.css("padding-left"):C.css("padding-right"))||"0px"},precision:function(){var e,t=b.get.step();if(0!=t){var n=String(t).split(".");e=2==n.length?n[1].length:0}else e=c.decimalPlaces;var i=Math.pow(10,e);return b.debug("Precision determined",i),i},min:function(){return c.min},max:function(){var e=b.get.step(),t=b.get.min(),n=0===e?0:Math.floor((c.max-t)/e);return 0==(0===e?0:(c.max-t)%e)?c.max:t+n*e},step:function(){return c.step},numLabels:function(){var e=Math.round((b.get.max()-b.get.min())/b.get.step());return b.debug("Determined that there should be "+e+" labels"),e},labelType:function(){return c.labelType},label:function(e){if(w)return w(e);switch(c.labelType){case c.labelTypes.number:return Math.round((e*b.get.step()+b.get.min())*l)/l;case c.labelTypes.letter:return N[e%26];default:return e}},value:function(){return a},currentThumbValue:function(){return f.hasClass("second")?b.secondThumbVal:b.thumbVal},thumbValue:function(e){switch(e){case"second":if(b.is.range())return b.secondThumbVal;b.error(h.notrange);break;case"first":default:return b.thumbVal}},multiplier:function(){return c.pageMultiplier},thumbPosition:function(e){switch(e){case"second":if(b.is.range())return m;b.error(h.notrange);break;case"first":default:return g}},gapRatio:function(){var e=1;if(c.autoAdjustLabels){for(var t=b.get.numLabels(),n=1;b.get.trackLength()/t*n<c.labelDistance;)t%n||(e=n),n+=1;return e}return 1}},determine:{pos:function(e){return b.is.reversed()?b.get.trackStartPos()-e+b.get.trackOffset():e-b.get.trackOffset()-b.get.trackStartPos()},closestThumb:function(e){var t=parseFloat(b.determine.thumbPos(o)),n=Math.abs(e-t),i=parseFloat(b.determine.thumbPos(r));return n<=Math.abs(e-i)?o:r},closestThumbPos:function(e){var t=parseFloat(b.determine.thumbPos(o)),n=Math.abs(e-t),i=parseFloat(b.determine.thumbPos(r));return n<=Math.abs(e-i)?t:i},thumbPos:function(e){return b.is.vertical()?b.is.reversed()?e.css("bottom"):e.css("top"):b.is.reversed()?e.css("right"):e.css("left")},positionFromValue:function(e){var t=b.get.min(),n=b.get.max(),i=(e=n<e?n:e<t?t:e,b.get.trackLength()),o=(e-t)/(n-t),r=Math.round(o*i);return b.verbose("Determined position: "+r+" from value: "+e),r},positionFromRatio:function(e){var t=b.get.trackLength(),n=b.get.step(),i=Math.round(e*t);return 0==n?i:Math.round(i/n)*n},valueFromEvent:function(e,t){var n=b.determine.eventPos(e,t),i=b.determine.pos(n);return n<b.get.trackOffset()?b.is.reversed()?b.get.max():b.get.min():n>b.get.trackOffset()+b.get.trackLength()?b.is.reversed()?b.get.min():b.get.max():b.determine.value(i)},smoothValueFromEvent:function(e,t){var n,i=b.get.min(),o=b.get.max(),r=b.get.trackLength(),s=b.determine.eventPos(e,t)-b.get.trackOffset();return n=(s=s<0?0:r<s?r:s)/r,b.is.reversed()&&(n=1-n),n*(o-i)+i},eventPos:function(e,t){if(b.is.touch()){var n=e.changedTouches[0].pageY||e.touches[0].pageY,i=e.changedTouches[0].pageX||e.touches[0].pageX;return b.is.vertical()?n:i}var o=e.pageY||t.pageY,r=e.pageX||t.pageX;return b.is.vertical()?o:r},value:function(e){var t=b.is.reversed()?b.get.trackEndPos():b.get.trackStartPos(),n=(e-t)/((b.is.reversed()?b.get.trackStartPos():b.get.trackEndPos())-t),i=b.get.max()-b.get.min(),o=b.get.step(),r=n*i,s=0==o?r:Math.round(r/o)*o;return b.verbose("Determined value based upon position: "+e+" as: "+r),r!=s&&b.verbose("Rounding value to closest step: "+s),s=Math.round(s*l)/l,b.verbose("Cutting off additional decimal places"),s+b.get.min()},keyMovement:function(e){var t=e.which,n=b.is.vertical()?b.is.reversed()?y.downArrow:y.upArrow:y.downArrow,i=b.is.vertical()?b.is.reversed()?y.upArrow:y.downArrow:y.upArrow,o=b.is.vertical()?y.leftArrow:b.is.reversed()?y.rightArrow:y.leftArrow,r=b.is.vertical()?y.rightArrow:b.is.reversed()?y.leftArrow:y.rightArrow;return t==n||t==o?-1:t==i||t==r?1:t==y.pageDown?-2:t==y.pageUp?2:0}},handleNewValuePosition:function(e){var t=b.get.min(),n=b.get.max();return e<=t?e=t:n<=e&&(e=n),b.determine.positionFromValue(e)},set:{value:function(e){b.update.value(e,function(e,t,n){c.onChange.call(E,e,t,n),c.onMove.call(E,e,t,n)})},rangeValue:function(e,t){if(b.is.range()){var n=b.get.min(),i=b.get.max();e<=n?e=n:i<=e&&(e=i),t<=n?t=n:i<=t&&(t=i),b.thumbVal=e,b.secondThumbVal=t,a=Math.abs(b.thumbVal-b.secondThumbVal),b.update.position(b.thumbVal,o),b.update.position(b.secondThumbVal,r),c.onChange.call(E,a,b.thumbVal,b.secondThumbVal),c.onMove.call(E,a,b.thumbVal,b.secondThumbVal)}else b.error(h.notrange)},position:function(e,t){var n=b.determine.value(e);switch(t){case"second":b.secondThumbVal=n,b.update.position(n,r);break;default:b.thumbVal=n,b.update.position(n,o)}a=Math.abs(b.thumbVal-(b.secondThumbVal||0)),b.set.value(a)}},update:{value:function(e,t){var n=b.get.min(),i=b.get.max();e<=n?e=n:i<=e&&(e=i),b.is.range()?(f.hasClass("second")?b.secondThumbVal=e:b.thumbVal=e,a=Math.abs(b.thumbVal-b.secondThumbVal)):(a=e,b.thumbVal=a),b.update.position(e),b.debug("Setting slider value to "+a),"function"==typeof t&&t(a,b.thumbVal,b.secondThumbVal)},position:function(e,t){var n=b.handleNewValuePosition(e),i=t!=j?t:f,o=b.thumbVal||b.get.min(),r=b.secondThumbVal||b.get.min();b.is.range()&&i.hasClass("second")?(m=n,r=e):(g=n,o=e);var s,a,l=b.get.min(),c=b.get.max(),u=100*(e-l)/(c-l),d=100*(Math.min(o,r)-l)/(c-l),h=100*(1-(Math.max(o,r)-l)/(c-l));s=b.is.vertical()?b.is.reversed()?(a={bottom:"calc("+u+"% - "+v+"px)",top:"auto"},{bottom:d+"%",top:h+"%"}):(a={top:"calc("+u+"% - "+v+"px)",bottom:"auto"},{top:d+"%",bottom:h+"%"}):b.is.reversed()?(a={right:"calc("+u+"% - "+v+"px)",left:"auto"},{right:d+"%",left:h+"%"}):(a={left:"calc("+u+"% - "+v+"px)",right:"auto"},{left:d+"%",right:h+"%"}),i.css(a),p.css(s),b.debug("Setting slider position to "+n)},labelPosition:function(e,t){var n=b.get.trackStartMargin(),i=b.get.trackEndMargin(),o=b.is.vertical()?b.is.reversed()?"bottom":"top":b.is.reversed()?"right":"left",r=b.is.reversed()&&!b.is.vertical()?" - ":" + ",s="(100% - "+n+" - "+i+") * "+e;t.css(o,"calc("+s+r+n+")")}},goto:{max:function(){b.set.value(b.get.max())},min:function(){b.set.value(b.get.min())}},read:{metadata:function(){var e={thumbVal:C.data(u.thumbVal),secondThumbVal:C.data(u.secondThumbVal)};e.thumbVal&&(b.is.range()&&e.secondThumbVal?(b.debug("Current value set from metadata",e.thumbVal,e.secondThumbVal),b.set.rangeValue(e.thumbVal,e.secondThumbVal)):(b.debug("Current value set from metadata",e.thumbVal),b.set.value(e.thumbVal)))},settings:function(){!1!==c.start&&(b.is.range()?(b.debug("Start position set from settings",c.start,c.end),b.set.rangeValue(c.start,c.end)):(b.debug("Start position set from settings",c.start),b.set.value(c.start)))}},setting:function(e,t){if(b.debug("Changing setting",e,t),B.isPlainObject(e))B.extend(!0,c,e);else{if(t===j)return c[e];B.isPlainObject(c[e])?B.extend(!0,c[e],t):c[e]=t}},internal:function(e,t){if(B.isPlainObject(e))B.extend(!0,b,e);else{if(t===j)return b[e];b[e]=t}},debug:function(){!c.silent&&c.debug&&(c.performance?b.performance.log(arguments):(b.debug=Function.prototype.bind.call(console.info,console,c.name+":"),b.debug.apply(console,arguments)))},verbose:function(){!c.silent&&c.verbose&&c.debug&&(c.performance?b.performance.log(arguments):(b.verbose=Function.prototype.bind.call(console.info,console,c.name+":"),b.verbose.apply(console,arguments)))},error:function(){c.silent||(b.error=Function.prototype.bind.call(console.error,console,c.name+":"),b.error.apply(console,arguments))},performance:{log:function(e){var t,n;c.performance&&(n=(t=(new Date).getTime())-(k||t),k=t,D.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:E,"Execution Time":n})),clearTimeout(b.performance.timer),b.performance.timer=setTimeout(b.performance.display,500)},display:function(){var e=c.name+":",n=0;k=!1,clearTimeout(b.performance.timer),B.each(D,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",O&&(e+=" '"+O+"'"),(console.group!==j||console.table!==j)&&0<D.length&&(console.groupCollapsed(e),console.table?console.table(D):B.each(D,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),D=[]}},invoke:function(i,e,t){var o,r,n,s=P;return e=e||L,t=E||t,"string"==typeof i&&s!==j&&(i=i.split(/[\. ]/),o=i.length-1,B.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(B.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==j)return r=s[n],!1;if(!B.isPlainObject(s[t])||e==o)return s[t]!==j?r=s[t]:b.error(h.method,i),!1;s=s[t]}})),B.isFunction(r)?n=r.apply(t,e):r!==j&&(n=r),B.isArray(_)?_.push(n):_!==j?_=[_,n]:n!==j&&(_=n),r}},F?(P===j&&b.initialize(),b.invoke(M)):(P!==j&&P.invoke("destroy"),b.initialize())}),_!==j?_:this},B.fn.slider.settings={silent:!1,debug:!1,verbose:!1,performance:!0,name:"Slider",namespace:"slider",error:{method:"The method you called is not defined.",notrange:"This slider is not a range slider"},metadata:{thumbVal:"thumbVal",secondThumbVal:"secondThumbVal"},min:0,max:20,step:1,start:0,end:20,labelType:"number",showLabelTicks:!1,smooth:!1,autoAdjustLabels:!0,labelDistance:100,decimalPlaces:2,pageMultiplier:2,selector:{},className:{reversed:"reversed",disabled:"disabled",labeled:"labeled",ticked:"ticked",vertical:"vertical",range:"range",smooth:"smooth"},keys:{pageUp:33,pageDown:34,leftArrow:37,upArrow:38,rightArrow:39,downArrow:40},labelTypes:{number:"number",letter:"letter"},onChange:function(e,t,n){},onMove:function(e,t,n){}}}(jQuery,window,document),function(x,e,t,S){"use strict";x.isFunction=x.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),x.fn.rating=function(f){var p,g=x(this),m=g.selector||"",v=(new Date).getTime(),b=[],y=f,w="string"==typeof y,T=[].slice.call(arguments,1);return g.each(function(){var e,i,o=x.isPlainObject(f)?x.extend(!0,{},x.fn.rating.settings,f):x.extend({},x.fn.rating.settings),t=o.namespace,r=o.className,n=o.metadata,s=o.selector,a="."+t,l="module-"+t,c=this,u=x(this).data(l),d=x(this),h=d.find(s.icon);i={initialize:function(){i.verbose("Initializing rating module",o),0===h.length&&i.setup.layout(),o.interactive&&!i.is.disabled()?i.enable():i.disable(),i.set.initialLoad(),i.set.rating(i.get.initialRating()),i.remove.initialLoad(),i.instantiate()},instantiate:function(){i.verbose("Instantiating module",o),u=i,d.data(l,i)},destroy:function(){i.verbose("Destroying previous instance",u),i.remove.events(),d.removeData(l)},refresh:function(){h=d.find(s.icon)},setup:{layout:function(){var e=i.get.maxRating(),t=i.get.icon(),n=x.fn.rating.settings.templates.icon(e,t);i.debug("Generating icon html dynamically"),d.html(n),i.refresh()}},event:{mouseenter:function(){var e=x(this);e.nextAll().removeClass(r.selected),d.addClass(r.selected),e.addClass(r.selected).prevAll().addClass(r.selected)},mouseleave:function(){d.removeClass(r.selected),h.removeClass(r.selected)},click:function(){var e=x(this),t=i.get.rating(),n=h.index(e)+1;("auto"==o.clearable?1===h.length:o.clearable)&&t==n?i.clearRating():i.set.rating(n)}},clearRating:function(){i.debug("Clearing current rating"),i.set.rating(0)},bind:{events:function(){i.verbose("Binding events"),d.on("mouseenter"+a,s.icon,i.event.mouseenter).on("mouseleave"+a,s.icon,i.event.mouseleave).on("click"+a,s.icon,i.event.click)}},remove:{events:function(){i.verbose("Removing events"),d.off(a)},initialLoad:function(){e=!1}},enable:function(){i.debug("Setting rating to interactive mode"),i.bind.events(),d.removeClass(r.disabled)},disable:function(){i.debug("Setting rating to read-only mode"),i.remove.events(),d.addClass(r.disabled)},is:{initialLoad:function(){return e},disabled:function(){return d.hasClass(r.disabled)}},get:{icon:function(){var e=d.data(n.icon);return e&&d.removeData(n.icon),e||o.icon},initialRating:function(){return d.data(n.rating)!==S?(d.removeData(n.rating),d.data(n.rating)):o.initialRating},maxRating:function(){return d.data(n.maxRating)!==S?(d.removeData(n.maxRating),d.data(n.maxRating)):o.maxRating},rating:function(){var e=h.filter("."+r.active).length;return i.verbose("Current rating retrieved",e),e}},set:{rating:function(e){var t=0<=e-1?e-1:0,n=h.eq(t);d.removeClass(r.selected),h.removeClass(r.selected).removeClass(r.active),0<e&&(i.verbose("Setting current rating to",e),n.prevAll().addBack().addClass(r.active)),i.is.initialLoad()||o.onRate.call(c,e)},initialLoad:function(){e=!0}},setting:function(e,t){if(i.debug("Changing setting",e,t),x.isPlainObject(e))x.extend(!0,o,e);else{if(t===S)return o[e];x.isPlainObject(o[e])?x.extend(!0,o[e],t):o[e]=t}},internal:function(e,t){if(x.isPlainObject(e))x.extend(!0,i,e);else{if(t===S)return i[e];i[e]=t}},debug:function(){!o.silent&&o.debug&&(o.performance?i.performance.log(arguments):(i.debug=Function.prototype.bind.call(console.info,console,o.name+":"),i.debug.apply(console,arguments)))},verbose:function(){!o.silent&&o.verbose&&o.debug&&(o.performance?i.performance.log(arguments):(i.verbose=Function.prototype.bind.call(console.info,console,o.name+":"),i.verbose.apply(console,arguments)))},error:function(){o.silent||(i.error=Function.prototype.bind.call(console.error,console,o.name+":"),i.error.apply(console,arguments))},performance:{log:function(e){var t,n;o.performance&&(n=(t=(new Date).getTime())-(v||t),v=t,b.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:c,"Execution Time":n})),clearTimeout(i.performance.timer),i.performance.timer=setTimeout(i.performance.display,500)},display:function(){var e=o.name+":",n=0;v=!1,clearTimeout(i.performance.timer),x.each(b,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",m&&(e+=" '"+m+"'"),1<g.length&&(e+=" ("+g.length+")"),(console.group!==S||console.table!==S)&&0<b.length&&(console.groupCollapsed(e),console.table?console.table(b):x.each(b,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),b=[]}},invoke:function(i,e,t){var o,r,n,s=u;return e=e||T,t=c||t,"string"==typeof i&&s!==S&&(i=i.split(/[\. ]/),o=i.length-1,x.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(x.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==S)return r=s[n],!1;if(!x.isPlainObject(s[t])||e==o)return s[t]!==S&&(r=s[t]),!1;s=s[t]}})),x.isFunction(r)?n=r.apply(t,e):r!==S&&(n=r),Array.isArray(p)?p.push(n):p!==S?p=[p,n]:n!==S&&(p=n),r}},w?(u===S&&i.initialize(),i.invoke(y)):(u!==S&&u.invoke("destroy"),i.initialize())}),p!==S?p:this},x.fn.rating.settings={name:"Rating",namespace:"rating",icon:"star",silent:!1,debug:!1,verbose:!1,performance:!0,initialRating:0,interactive:!0,maxRating:4,clearable:"auto",fireOnInit:!1,onRate:function(e){},error:{method:"The method you called is not defined",noMaximum:"No maximum rating specified. Cannot generate HTML automatically"},metadata:{rating:"rating",maxRating:"maxRating",icon:"icon"},className:{active:"active",disabled:"disabled",selected:"selected",loading:"loading"},selector:{icon:".icon"},templates:{icon:function(e,t){for(var n=1,i="";n<=e;)i+='<i class="'+t+' icon"></i>',n++;return i}}}}(jQuery,window,document),function(_,A,O,k){"use strict";_.isFunction=_.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},A=void 0!==A&&A.Math==Math?A:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),_.fn.search=function(w){var T,x=_(this),S=x.selector||"",C=(new Date).getTime(),E=[],P=w,R="string"==typeof P,I=[].slice.call(arguments,1);return _(this).each(function(){var h,u=_.isPlainObject(w)?_.extend(!0,{},_.fn.search.settings,w):_.extend({},_.fn.search.settings),f=u.className,c=u.metadata,i=u.regExp,r=u.fields,p=u.selector,d=u.error,e=u.namespace,o="."+e,t=e+"-module",g=_(this),m=g.find(p.prompt),n=g.find(p.searchButton),s=g.find(p.results),a=g.find(p.result),v=(g.find(p.category),this),l=g.data(t),b=!1,y=!1;h={initialize:function(){h.verbose("Initializing module"),h.get.settings(),h.determine.searchFields(),h.bind.events(),h.set.type(),h.create.results(),h.instantiate()},instantiate:function(){h.verbose("Storing instance of module",h),l=h,g.data(t,h)},destroy:function(){h.verbose("Destroying instance"),g.off(o).removeData(t)},refresh:function(){h.debug("Refreshing selector cache"),m=g.find(p.prompt),n=g.find(p.searchButton),g.find(p.category),s=g.find(p.results),a=g.find(p.result)},refreshResults:function(){s=g.find(p.results),a=g.find(p.result)},bind:{events:function(){h.verbose("Binding events to search"),u.automatic&&(g.on(h.get.inputEvent()+o,p.prompt,h.event.input),m.attr("autocomplete","off")),g.on("focus"+o,p.prompt,h.event.focus).on("blur"+o,p.prompt,h.event.blur).on("keydown"+o,p.prompt,h.handleKeyboard).on("click"+o,p.searchButton,h.query).on("mousedown"+o,p.results,h.event.result.mousedown).on("mouseup"+o,p.results,h.event.result.mouseup).on("click"+o,p.result,h.event.result.click)}},determine:{searchFields:function(){w&&w.searchFields!==k&&(u.searchFields=w.searchFields)}},event:{input:function(){u.searchDelay?(clearTimeout(h.timer),h.timer=setTimeout(function(){h.is.focused()&&h.query()},u.searchDelay)):h.query()},focus:function(){h.set.focus(),u.searchOnFocus&&h.has.minimumCharacters()&&h.query(function(){h.can.show()&&h.showResults()})},blur:function(e){function t(){h.cancel.query(),h.remove.focus(),h.timer=setTimeout(h.hideResults,u.hideDelay)}var n=O.activeElement===this;n||(y=!1,h.resultsClicked?(h.debug("Determining if user action caused search to close"),g.one("click.close"+o,p.results,function(e){h.is.inMessage(e)||b?m.focus():(b=!1,h.is.animating()||h.is.hidden()||t())})):(h.debug("Input blurred without user action, closing results"),t()))},result:{mousedown:function(){h.resultsClicked=!0},mouseup:function(){h.resultsClicked=!1},click:function(e){h.debug("Search result selected");var t=_(this),n=t.find(p.title).eq(0),i=t.is("a[href]")?t:t.find("a[href]").eq(0),o=i.attr("href")||!1,r=i.attr("target")||!1,s=0<n.length&&n.text(),a=h.get.results(),l=t.data(c.result)||h.get.result(s,a);if(s&&h.set.value(s),_.isFunction(u.onSelect)&&!1===u.onSelect.call(v,l,a))return h.debug("Custom onSelect callback cancelled default select action"),void(b=!0);h.hideResults(),o&&(h.verbose("Opening search link found in result",i),"_blank"==r||e.ctrlKey?A.open(o):A.location.href=o)}}},handleKeyboard:function(e){var t,n=g.find(p.result),i=g.find(p.category),o=n.filter("."+f.active),r=n.index(o),s=n.length,a=0<o.length,l=e.which,c=13,u=38,d=40;if(l==27&&(h.verbose("Escape key pressed, blurring search field"),h.hideResults(),y=!0),h.is.visible())if(l==c){if(h.verbose("Enter key pressed, selecting active result"),0<n.filter("."+f.active).length)return h.event.result.click.call(n.filter("."+f.active),e),e.preventDefault(),!1}else l==u&&a?(h.verbose("Up key pressed, changing active result"),t=r-1<0?r:r-1,i.removeClass(f.active),n.removeClass(f.active).eq(t).addClass(f.active).closest(i).addClass(f.active),e.preventDefault()):l==d&&(h.verbose("Down key pressed, changing active result"),t=s<=r+1?r:r+1,i.removeClass(f.active),n.removeClass(f.active).eq(t).addClass(f.active).closest(i).addClass(f.active),e.preventDefault());else l==c&&(h.verbose("Enter key pressed, executing query"),h.query(),h.set.buttonPressed(),m.one("keyup",h.remove.buttonFocus))},setup:{api:function(t,n){var e={debug:u.debug,on:!1,cache:u.cache,action:"search",urlData:{query:t},onSuccess:function(e){h.parse.response.call(v,e,t),n()},onFailure:function(){h.displayMessage(d.serverError),n()},onAbort:function(e){},onError:h.error};_.extend(!0,e,u.apiSettings),h.verbose("Setting up API request",e),g.api(e)}},can:{useAPI:function(){return _.fn.api!==k},show:function(){return h.is.focused()&&!h.is.visible()&&!h.is.empty()},transition:function(){return u.transition&&_.fn.transition!==k&&g.transition("is supported")}},is:{animating:function(){return s.hasClass(f.animating)},hidden:function(){return s.hasClass(f.hidden)},inMessage:function(e){if(e.target){var t=_(e.target);return _.contains(O.documentElement,e.target)&&0<t.closest(p.message).length}},empty:function(){return""===s.html()},visible:function(){return 0<s.filter(":visible").length},focused:function(){return 0<m.filter(":focus").length}},get:{settings:function(){_.isPlainObject(w)&&w.searchFullText&&(u.fullTextSearch=w.searchFullText,h.error(u.error.oldSearchSyntax,v)),u.ignoreDiacritics&&!String.prototype.normalize&&(u.ignoreDiacritics=!1,h.error(d.noNormalize,v))},inputEvent:function(){var e=m[0];return e!==k&&e.oninput!==k?"input":e!==k&&e.onpropertychange!==k?"propertychange":"keyup"},value:function(){return m.val()},results:function(){return g.data(c.results)},result:function(n,e){var i=!1;return n=n!==k?n:h.get.value(),e=e!==k?e:h.get.results(),"category"===u.type?(h.debug("Finding result that matches",n),_.each(e,function(e,t){if(Array.isArray(t.results)&&(i=h.search.object(n,t.results)[0]))return!1})):(h.debug("Finding result in results object",n),i=h.search.object(n,e)[0]),i||!1}},select:{firstResult:function(){h.verbose("Selecting first result"),a.first().addClass(f.active)}},set:{focus:function(){g.addClass(f.focus)},loading:function(){g.addClass(f.loading)},value:function(e){h.verbose("Setting search input value",e),m.val(e)},type:function(e){e=e||u.type,"category"==u.type&&g.addClass(u.type)},buttonPressed:function(){n.addClass(f.pressed)}},remove:{loading:function(){g.removeClass(f.loading)},focus:function(){g.removeClass(f.focus)},buttonPressed:function(){n.removeClass(f.pressed)},diacritics:function(e){return u.ignoreDiacritics?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}},query:function(e){e=_.isFunction(e)?e:function(){};var t=h.get.value(),n=h.read.cache(t);e=e||function(){},h.has.minimumCharacters()?(n?(h.debug("Reading result from cache",t),h.save.results(n.results),h.addResults(n.html),h.inject.id(n.results),e()):(h.debug("Querying for",t),_.isPlainObject(u.source)||Array.isArray(u.source)?(h.search.local(t),e()):h.can.useAPI()?h.search.remote(t,e):(h.error(d.source),e())),u.onSearchQuery.call(v,t)):h.hideResults()},search:{local:function(e){var t,n=h.search.object(e,u.source);h.set.loading(),h.save.results(n),h.debug("Returned full local search results",n),0<u.maxResults&&(h.debug("Using specified max results",n),n=n.slice(0,u.maxResults)),"category"==u.type&&(n=h.create.categoryResults(n)),t=h.generateResults({results:n}),h.remove.loading(),h.addResults(t),h.inject.id(n),h.write.cache(e,{html:t,results:n})},remote:function(e,t){t=_.isFunction(t)?t:function(){},g.api("is loading")&&g.api("abort"),h.setup.api(e,t),g.api("query")},object:function(o,t,e){o=h.remove.diacritics(String(o));function r(e,t){var n=-1==_.inArray(t,s),i=-1==_.inArray(t,l),o=-1==_.inArray(t,a);n&&i&&o&&e.push(t)}var s=[],a=[],l=[],n=o.replace(i.escape,"\\$&"),c=new RegExp(i.beginsWith+n,"i");return t=t||u.source,e=e!==k?e:u.searchFields,Array.isArray(e)||(e=[e]),t===k||!1===t?(h.error(d.source),[]):(_.each(e,function(e,i){_.each(t,function(e,t){var n;"string"!=typeof t[i]&&"number"!=typeof t[i]||(-1!==(n="string"==typeof t[i]?h.remove.diacritics(t[i]):t[i].toString()).search(c)?r(s,t):"exact"===u.fullTextSearch&&h.exactSearch(o,n)?r(a,t):1==u.fullTextSearch&&h.fuzzySearch(o,n)&&r(l,t))})}),_.merge(a,l),_.merge(s,a),s)}},exactSearch:function(e,t){return e=e.toLowerCase(),-1<(t=t.toLowerCase()).indexOf(e)},fuzzySearch:function(e,t){var n=t.length,i=e.length;if("string"!=typeof e)return!1;if(e=e.toLowerCase(),t=t.toLowerCase(),n<i)return!1;if(i===n)return e===t;e:for(var o=0,r=0;o<i;o++){for(var s=e.charCodeAt(o);r<n;)if(t.charCodeAt(r++)===s)continue e;return!1}return!0},parse:{response:function(e,t){if(Array.isArray(e)){var n={};n[r.results]=e,e=n}var i=h.generateResults(e);h.verbose("Parsing server response",e),e!==k&&t!==k&&e[r.results]!==k&&(h.addResults(i),h.inject.id(e[r.results]),h.write.cache(t,{html:i,results:e[r.results]}),h.save.results(e[r.results]))}},cancel:{query:function(){h.can.useAPI()&&g.api("abort")}},has:{minimumCharacters:function(){return h.get.value().length>=u.minCharacters},results:function(){return 0!==s.length&&""!=s.html()}},clear:{cache:function(e){var t=g.data(c.cache);e?e&&t&&t[e]&&(h.debug("Removing value from cache",e),delete t[e],g.data(c.cache,t)):(h.debug("Clearing cache",e),g.removeData(c.cache))}},read:{cache:function(e){var t=g.data(c.cache);return!!u.cache&&(h.verbose("Checking cache for generated html for query",e),"object"==typeof t&&t[e]!==k&&t[e])}},create:{categoryResults:function(e){var n={};return _.each(e,function(e,t){t.category&&(n[t.category]===k?(h.verbose("Creating new category of results",t.category),n[t.category]={name:t.category,results:[t]}):n[t.category].results.push(t))}),n},id:function(e,t){var n,i=e+1;return t!==k?(n=String.fromCharCode(97+t)+i,h.verbose("Creating category result id",n)):(n=i,h.verbose("Creating result id",n)),n},results:function(){0===s.length&&(s=_("<div />").addClass(f.results).appendTo(g))}},inject:{result:function(e,t,n){h.verbose("Injecting result into results");var i=n!==k?s.children().eq(n).children(p.results).first().children(p.result).eq(t):s.children(p.result).eq(t);h.verbose("Injecting results metadata",i),i.data(c.result,e)},id:function(e){h.debug("Injecting unique ids into results");var n=0,i=0;return"category"===u.type?_.each(e,function(e,t){0<t.results.length&&(i=0,_.each(t.results,function(e,t){t.id===k&&(t.id=h.create.id(i,n)),h.inject.result(t,i,n),i++}),n++)}):_.each(e,function(e,t){t.id===k&&(t.id=h.create.id(i)),h.inject.result(t,i),i++}),e}},save:{results:function(e){h.verbose("Saving current search results to metadata",e),g.data(c.results,e)}},write:{cache:function(e,t){var n=g.data(c.cache)!==k?g.data(c.cache):{};u.cache&&(h.verbose("Writing generated html to cache",e,t),n[e]=t,g.data(c.cache,n))}},addResults:function(e){if(_.isFunction(u.onResultsAdd)&&!1===u.onResultsAdd.call(s,e))return h.debug("onResultsAdd callback cancelled default action"),!1;e?(s.html(e),h.refreshResults(),u.selectFirstResult&&h.select.firstResult(),h.showResults()):h.hideResults(function(){s.empty()})},showResults:function(e){e=_.isFunction(e)?e:function(){},y||!h.is.visible()&&h.has.results()&&(h.can.transition()?(h.debug("Showing results with css animations"),s.transition({animation:u.transition+" in",debug:u.debug,verbose:u.verbose,duration:u.duration,onComplete:function(){e()},queue:!0})):(h.debug("Showing results with javascript"),s.stop().fadeIn(u.duration,u.easing)),u.onResultsOpen.call(s))},hideResults:function(e){e=_.isFunction(e)?e:function(){},h.is.visible()&&(h.can.transition()?(h.debug("Hiding results with css animations"),s.transition({animation:u.transition+" out",debug:u.debug,verbose:u.verbose,duration:u.duration,onComplete:function(){e()},queue:!0})):(h.debug("Hiding results with javascript"),s.stop().fadeOut(u.duration,u.easing)),u.onResultsClose.call(s))},generateResults:function(e){h.debug("Generating html from response",e);var t=u.templates[u.type],n=_.isPlainObject(e[r.results])&&!_.isEmptyObject(e[r.results]),i=Array.isArray(e[r.results])&&0<e[r.results].length,o="";return n||i?(0<u.maxResults&&(n?"standard"==u.type&&h.error(d.maxResults):e[r.results]=e[r.results].slice(0,u.maxResults)),_.isFunction(t)?o=t(e,r,u.preserveHTML):h.error(d.noTemplate,!1)):u.showNoResults&&(o=h.displayMessage(d.noResults,"empty",d.noResultsHeader)),u.onResults.call(v,e),o},displayMessage:function(e,t,n){return t=t||"standard",h.debug("Displaying message",e,t,n),h.addResults(u.templates.message(e,t,n)),u.templates.message(e,t,n)},setting:function(e,t){if(_.isPlainObject(e))_.extend(!0,u,e);else{if(t===k)return u[e];u[e]=t}},internal:function(e,t){if(_.isPlainObject(e))_.extend(!0,h,e);else{if(t===k)return h[e];h[e]=t}},debug:function(){!u.silent&&u.debug&&(u.performance?h.performance.log(arguments):(h.debug=Function.prototype.bind.call(console.info,console,u.name+":"),h.debug.apply(console,arguments)))},verbose:function(){!u.silent&&u.verbose&&u.debug&&(u.performance?h.performance.log(arguments):(h.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),h.verbose.apply(console,arguments)))},error:function(){u.silent||(h.error=Function.prototype.bind.call(console.error,console,u.name+":"),h.error.apply(console,arguments))},performance:{log:function(e){var t,n;u.performance&&(n=(t=(new Date).getTime())-(C||t),C=t,E.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:v,"Execution Time":n})),clearTimeout(h.performance.timer),h.performance.timer=setTimeout(h.performance.display,500)},display:function(){var e=u.name+":",n=0;C=!1,clearTimeout(h.performance.timer),_.each(E,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",S&&(e+=" '"+S+"'"),1<x.length&&(e+=" ("+x.length+")"),(console.group!==k||console.table!==k)&&0<E.length&&(console.groupCollapsed(e),console.table?console.table(E):_.each(E,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),E=[]}},invoke:function(i,e,t){var o,r,n,s=l;return e=e||I,t=v||t,"string"==typeof i&&s!==k&&(i=i.split(/[\. ]/),o=i.length-1,_.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(_.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==k)return r=s[n],!1;if(!_.isPlainObject(s[t])||e==o)return s[t]!==k&&(r=s[t]),!1;s=s[t]}})),_.isFunction(r)?n=r.apply(t,e):r!==k&&(n=r),Array.isArray(T)?T.push(n):T!==k?T=[T,n]:n!==k&&(T=n),r}},R?(l===k&&h.initialize(),h.invoke(P)):(l!==k&&l.invoke("destroy"),h.initialize())}),T!==k?T:this},_.fn.search.settings={name:"Search",namespace:"search",silent:!1,debug:!1,verbose:!1,performance:!0,type:"standard",minCharacters:1,selectFirstResult:!1,apiSettings:!1,source:!1,searchOnFocus:!0,searchFields:["id","title","description"],displayField:"",fullTextSearch:"exact",ignoreDiacritics:!1,automatic:!0,hideDelay:0,searchDelay:200,maxResults:7,cache:!0,showNoResults:!0,preserveHTML:!0,transition:"scale",duration:200,easing:"easeOutExpo",onSelect:!1,onResultsAdd:!1,onSearchQuery:function(e){},onResults:function(e){},onResultsOpen:function(){},onResultsClose:function(){},className:{animating:"animating",active:"active",empty:"empty",focus:"focus",hidden:"hidden",loading:"loading",results:"results",pressed:"down"},error:{source:"Cannot search. No source used, and Semantic API module was not included",noResultsHeader:"No Results",noResults:"Your search returned no results",logging:"Error in debug logging, exiting.",noEndpoint:"No search endpoint was specified",noTemplate:"A valid template name was not specified.",oldSearchSyntax:"searchFullText setting has been renamed fullTextSearch for consistency, please adjust your settings.",serverError:"There was an issue querying the server.",maxResults:"Results must be an array to use maxResults setting",method:"The method you called is not defined.",noNormalize:'"ignoreDiacritics" setting will be ignored. Browser does not support String().normalize(). You may consider including <https://cdn.jsdelivr.net/npm/unorm@1.4.1/lib/unorm.min.js> as a polyfill.'},metadata:{cache:"cache",results:"results",result:"result"},regExp:{escape:/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,beginsWith:"(?:s|^)"},fields:{categories:"results",categoryName:"name",categoryResults:"results",description:"description",image:"image",price:"price",results:"results",title:"title",url:"url",action:"action",actionText:"text",actionURL:"url"},selector:{prompt:".prompt",searchButton:".search.button",results:".results",message:".results > .message",category:".category",result:".result",title:".title, .name"},templates:{escape:function(e,t){if(t)return e;var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return/[&<>"'`]/.test(e)?e.replace(/[&<>"'`]/g,function(e){return n[e]}):e},message:function(e,t,n){var i="";return e!==k&&t!==k&&(i+='<div class="message '+t+'">',n&&(i+='<div class="header">'+n+"</div>"),i+=' <div class="description">'+e+"</div>",i+="</div>"),i},category:function(e,n,i){var o="",r=_.fn.search.settings.templates.escape;return e[n.categoryResults]!==k&&(_.each(e[n.categoryResults],function(e,t){t[n.results]!==k&&0<t.results.length&&(o+='<div class="category">',t[n.categoryName]!==k&&(o+='<div class="name">'+r(t[n.categoryName],i)+"</div>"),o+='<div class="results">',_.each(t.results,function(e,t){t[n.url]?o+='<a class="result" href="'+t[n.url].replace(/"/g,"")+'">':o+='<a class="result">',t[n.image]!==k&&(o+='<div class="image"> <img src="'+t[n.image].replace(/"/g,"")+'"></div>'),o+='<div class="content">',t[n.price]!==k&&(o+='<div class="price">'+r(t[n.price],i)+"</div>"),t[n.title]!==k&&(o+='<div class="title">'+r(t[n.title],i)+"</div>"),t[n.description]!==k&&(o+='<div class="description">'+r(t[n.description],i)+"</div>"),o+="</div>",o+="</a>"}),o+="</div>",o+="</div>")}),e[n.action]&&(!1===n.actionURL?o+='<div class="action">'+r(e[n.action][n.actionText],i)+"</div>":o+='<a href="'+e[n.action][n.actionURL].replace(/"/g,"")+'" class="action">'+r(e[n.action][n.actionText],i)+"</a>"),o)},standard:function(e,n,i){var o="",r=_.fn.search.settings.templates.escape;return e[n.results]!==k&&(_.each(e[n.results],function(e,t){t[n.url]?o+='<a class="result" href="'+t[n.url].replace(/"/g,"")+'">':o+='<a class="result">',t[n.image]!==k&&(o+='<div class="image"> <img src="'+t[n.image].replace(/"/g,"")+'"></div>'),o+='<div class="content">',t[n.price]!==k&&(o+='<div class="price">'+r(t[n.price],i)+"</div>"),t[n.title]!==k&&(o+='<div class="title">'+r(t[n.title],i)+"</div>"),t[n.description]!==k&&(o+='<div class="description">'+r(t[n.description],i)+"</div>"),o+="</div>",o+="</a>"}),e[n.action]&&(!1===n.actionURL?o+='<div class="action">'+r(e[n.action][n.actionText],i)+"</div>":o+='<a href="'+e[n.action][n.actionURL].replace(/"/g,"")+'" class="action">'+r(e[n.action][n.actionText],i)+"</a>"),o)}}}}(jQuery,window,document),function(R,e,I,_){"use strict";R.isFunction=R.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),R.fn.shape=function(b){var y,w=R(this),T=(new Date).getTime(),x=[],S=b,C="string"==typeof S,E=[].slice.call(arguments,1),P=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,0)};return w.each(function(){var i,o,s,t=w.selector||"",a=R.isPlainObject(b)?R.extend(!0,{},R.fn.shape.settings,b):R.extend({},R.fn.shape.settings),e=a.namespace,l=a.selector,n=a.error,c=a.className,r="."+e,u="module-"+e,d=R(this),h=d.find(">"+l.sides),f=h.find(">"+l.side),p=!1,g=this,m=d.data(u);if(s={initialize:function(){s.verbose("Initializing module for",g),s.set.defaultSide(),s.instantiate()},instantiate:function(){s.verbose("Storing instance of module",s),m=s,d.data(u,m)},destroy:function(){s.verbose("Destroying previous module for",g),d.removeData(u).off(r)},refresh:function(){s.verbose("Refreshing selector cache for",g),d=R(g),h=R(this).find(l.sides),f=R(this).find(l.side)},repaint:function(){s.verbose("Forcing repaint event");(h[0]||I.createElement("div")).offsetWidth},animate:function(e,t){s.verbose("Animating box with properties",e),t=t||function(e){s.verbose("Executing animation callback"),e!==_&&e.stopPropagation(),s.reset(),s.set.active()},a.beforeChange.call(o[0]),s.get.transitionEvent()?(s.verbose("Starting CSS animation"),d.addClass(c.animating),h.css(e).one(s.get.transitionEvent(),t),s.set.duration(a.duration),P(function(){d.addClass(c.animating),i.addClass(c.hidden)})):t()},queue:function(e){s.debug("Queueing animation of",e),h.one(s.get.transitionEvent(),function(){s.debug("Executing queued animation"),setTimeout(function(){d.shape(e)},0)})},reset:function(){s.verbose("Animating states reset"),d.removeClass(c.animating).attr("style","").removeAttr("style"),h.attr("style","").removeAttr("style"),f.attr("style","").removeAttr("style").removeClass(c.hidden),o.removeClass(c.animating).attr("style","").removeAttr("style")},is:{complete:function(){return f.filter("."+c.active)[0]==o[0]},animating:function(){return d.hasClass(c.animating)},hidden:function(){return 0<d.closest(":hidden").length}},set:{defaultSide:function(){i=f.filter("."+a.className.active),o=0<i.next(l.side).length?i.next(l.side):f.first(),p=!1,s.verbose("Active side set to",i),s.verbose("Next side set to",o)},duration:function(e){e="number"==typeof(e=e||a.duration)?e+"ms":e,s.verbose("Setting animation duration",e),!a.duration&&0!==a.duration||h.add(f).css({"-webkit-transition-duration":e,"-moz-transition-duration":e,"-ms-transition-duration":e,"-o-transition-duration":e,"transition-duration":e})},currentStageSize:function(){var e=f.filter("."+a.className.active),t=e.outerWidth(!0),n=e.outerHeight(!0);d.css({width:t,height:n})},stageSize:function(){var e=d.clone().addClass(c.loading),t=e.find(">"+l.sides+">"+l.side),n=t.filter("."+a.className.active),i=p?t.eq(p):0<n.next(l.side).length?n.next(l.side):t.first(),o="next"===a.width?i.outerWidth(!0):"initial"===a.width?d.width():a.width,r="next"===a.height?i.outerHeight(!0):"initial"===a.height?d.height():a.height;n.removeClass(c.active),i.addClass(c.active),e.insertAfter(d),e.remove(),"auto"!==a.width&&(d.css("width",o+a.jitter),s.verbose("Specifying width during animation",o)),"auto"!==a.height&&(d.css("height",r+a.jitter),s.verbose("Specifying height during animation",r))},nextSide:function(e){p=e,o=f.filter(e),p=f.index(o),0===o.length&&(s.set.defaultSide(),s.error(n.side)),s.verbose("Next side manually set to",o)},active:function(){s.verbose("Setting new side to active",o),f.removeClass(c.active),o.addClass(c.active),a.onChange.call(o[0]),s.set.defaultSide()}},flip:{to:function(e,t){if(s.is.hidden())s.debug("Module not visible",o);else if(!s.is.complete()||s.is.animating()||a.allowRepeats){var n=s.get.transform[e]();s.is.animating()?s.queue("flip "+e):(s.debug("Flipping "+e,o),s.set.stageSize(),s.stage[t](),s.animate(n))}else s.debug("Side already visible",o)},up:function(){s.flip.to("up","above")},down:function(){s.flip.to("down","below")},left:function(){s.flip.to("left","left")},right:function(){s.flip.to("right","right")},over:function(){s.flip.to("over","behind")},back:function(){s.flip.to("back","behind")}},get:{transform:{up:function(){var e=i.outerHeight(!0)/2;return{transform:"translateY("+(o.outerHeight(!0)-e)+"px) translateZ(-"+e+"px) rotateX(-90deg)"}},down:function(){var e=i.outerHeight(!0)/2;return{transform:"translateY(-"+e+"px) translateZ(-"+e+"px) rotateX(90deg)"}},left:function(){var e=i.outerWidth(!0)/2;return{transform:"translateX("+(o.outerWidth(!0)-e)+"px) translateZ(-"+e+"px) rotateY(90deg)"}},right:function(){var e=i.outerWidth(!0)/2;return{transform:"translateX(-"+e+"px) translateZ(-"+e+"px) rotateY(-90deg)"}},over:function(){return{transform:"translateX("+-(i.outerWidth(!0)-o.outerWidth(!0))/2+"px) rotateY(180deg)"}},back:function(){return{transform:"translateX("+-(i.outerWidth(!0)-o.outerWidth(!0))/2+"px) rotateY(-180deg)"}}},transitionEvent:function(){var e,t=I.createElement("element"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(t.style[e]!==_)return n[e]},nextSide:function(){return 0<i.next(l.side).length?i.next(l.side):f.first()}},stage:{above:function(){var e={origin:(i.outerHeight(!0)-o.outerHeight(!0))/2,depth:{active:o.outerHeight(!0)/2,next:i.outerHeight(!0)/2}};s.verbose("Setting the initial animation position as above",o,e),i.css({transform:"rotateX(0deg)"}),o.addClass(c.animating).css({top:e.origin+"px",transform:"rotateX(90deg) translateZ("+e.depth.next+"px) translateY(-"+e.depth.active+"px)"})},below:function(){var e={origin:(i.outerHeight(!0)-o.outerHeight(!0))/2,depth:{active:o.outerHeight(!0)/2,next:i.outerHeight(!0)/2}};s.verbose("Setting the initial animation position as below",o,e),i.css({transform:"rotateX(0deg)"}),o.addClass(c.animating).css({top:e.origin+"px",transform:"rotateX(-90deg) translateZ("+e.depth.next+"px) translateY("+e.depth.active+"px)"})},left:function(){var e=i.outerWidth(!0),t=o.outerWidth(!0),n={origin:(e-t)/2,depth:{active:t/2,next:e/2}};s.verbose("Setting the initial animation position as left",o,n),i.css({transform:"rotateY(0deg)"}),o.addClass(c.animating).css({left:n.origin+"px",transform:"rotateY(-90deg) translateZ("+n.depth.next+"px) translateX(-"+n.depth.active+"px)"})},right:function(){var e=i.outerWidth(!0),t=o.outerWidth(!0),n={origin:(e-t)/2,depth:{active:t/2,next:e/2}};s.verbose("Setting the initial animation position as right",o,n),i.css({transform:"rotateY(0deg)"}),o.addClass(c.animating).css({left:n.origin+"px",transform:"rotateY(90deg) translateZ("+n.depth.next+"px) translateX("+n.depth.active+"px)"})},behind:function(){var e=i.outerWidth(!0),t=o.outerWidth(!0),n={origin:(e-t)/2,depth:{active:t/2,next:e/2}};s.verbose("Setting the initial animation position as behind",o,n),i.css({transform:"rotateY(0deg)"}),o.addClass(c.animating).css({left:n.origin+"px",transform:"rotateY(-180deg)"})}},setting:function(e,t){if(s.debug("Changing setting",e,t),R.isPlainObject(e))R.extend(!0,a,e);else{if(t===_)return a[e];R.isPlainObject(a[e])?R.extend(!0,a[e],t):a[e]=t}},internal:function(e,t){if(R.isPlainObject(e))R.extend(!0,s,e);else{if(t===_)return s[e];s[e]=t}},debug:function(){!a.silent&&a.debug&&(a.performance?s.performance.log(arguments):(s.debug=Function.prototype.bind.call(console.info,console,a.name+":"),s.debug.apply(console,arguments)))},verbose:function(){!a.silent&&a.verbose&&a.debug&&(a.performance?s.performance.log(arguments):(s.verbose=Function.prototype.bind.call(console.info,console,a.name+":"),s.verbose.apply(console,arguments)))},error:function(){a.silent||(s.error=Function.prototype.bind.call(console.error,console,a.name+":"),s.error.apply(console,arguments))},performance:{log:function(e){var t,n;a.performance&&(n=(t=(new Date).getTime())-(T||t),T=t,x.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:g,"Execution Time":n})),clearTimeout(s.performance.timer),s.performance.timer=setTimeout(s.performance.display,500)},display:function(){var e=a.name+":",n=0;T=!1,clearTimeout(s.performance.timer),R.each(x,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",t&&(e+=" '"+t+"'"),1<w.length&&(e+=" ("+w.length+")"),(console.group!==_||console.table!==_)&&0<x.length&&(console.groupCollapsed(e),console.table?console.table(x):R.each(x,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),x=[]}},invoke:function(i,e,t){var o,r,n,s=m;return e=e||E,t=g||t,"string"==typeof i&&s!==_&&(i=i.split(/[\. ]/),o=i.length-1,R.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(R.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==_)return r=s[n],!1;if(!R.isPlainObject(s[t])||e==o)return s[t]!==_&&(r=s[t]),!1;s=s[t]}})),R.isFunction(r)?n=r.apply(t,e):r!==_&&(n=r),Array.isArray(y)?y.push(n):y!==_?y=[y,n]:n!==_&&(y=n),r}},C){m===_&&s.initialize();var v=d.find("input");0<v.length?(v.blur(),setTimeout(function(){s.invoke(S)},150)):s.invoke(S)}else m!==_&&m.invoke("destroy"),s.initialize()}),y!==_?y:this},R.fn.shape.settings={name:"Shape",silent:!1,debug:!1,verbose:!1,jitter:0,performance:!0,namespace:"shape",width:"initial",height:"initial",beforeChange:function(){},onChange:function(){},allowRepeats:!1,duration:!1,error:{side:"You tried to switch to a side that does not exist.",method:"The method you called is not defined"},className:{animating:"animating",hidden:"hidden",loading:"loading",active:"active"},selector:{sides:".sides",side:".side"}}}(jQuery,window,document),function(D,M,F,L){"use strict";D.isFunction=D.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},M=void 0!==M&&M.Math==Math?M:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),D.fn.sidebar=function(w){var T,e=D(this),x=D(M),S=D(F),C=D("html"),E=D("head"),P=e.selector||"",R=(new Date).getTime(),I=[],_=w,A="string"==typeof _,O=[].slice.call(arguments,1),k=M.requestAnimationFrame||M.mozRequestAnimationFrame||M.webkitRequestAnimationFrame||M.msRequestAnimationFrame||function(e){setTimeout(e,0)};return e.each(function(){var s,a,e,t,l,c,u=D.isPlainObject(w)?D.extend(!0,{},D.fn.sidebar.settings,w):D.extend({},D.fn.sidebar.settings),n=u.selector,r=u.className,i=u.namespace,o=u.regExp,d=u.error,h="."+i,f="module-"+i,p=D(this),g=D(u.context),m=p.children(n.sidebar),v=(g.children(n.fixed),g.children(n.pusher)),b=this,y=p.data(f);c={initialize:function(){c.debug("Initializing sidebar",w),c.create.id(),l=c.get.transitionEvent(),u.delaySetup?k(c.setup.layout):c.setup.layout(),k(function(){c.setup.cache()}),c.instantiate()},instantiate:function(){c.verbose("Storing instance of module",c),y=c,p.data(f,c)},create:{id:function(){e=(Math.random().toString(16)+"000000000").substr(2,8),a="."+e,c.verbose("Creating unique id for element",e)}},destroy:function(){c.verbose("Destroying previous module for",p),p.off(h).removeData(f),c.is.ios()&&c.remove.ios(),g.off(a),x.off(a),S.off(a)},event:{clickaway:function(e){if(u.closable){var t=0<v.find(e.target).length||v.is(e.target),n=g.is(e.target);t&&(c.verbose("User clicked on dimmed page"),c.hide()),n&&(c.verbose("User clicked on dimmable context (scaled out page)"),c.hide())}},touch:function(e){},containScroll:function(e){b.scrollTop<=0&&(b.scrollTop=1),b.scrollTop+b.offsetHeight>=b.scrollHeight&&(b.scrollTop=b.scrollHeight-b.offsetHeight-1)},scroll:function(e){0===D(e.target).closest(n.sidebar).length&&e.preventDefault()}},bind:{clickaway:function(){c.verbose("Adding clickaway events to context",g),g.on("click"+a,c.event.clickaway).on("touchend"+a,c.event.clickaway)},scrollLock:function(){u.scrollLock&&(c.debug("Disabling page scroll"),x.on("DOMMouseScroll"+a,c.event.scroll)),c.verbose("Adding events to contain sidebar scroll"),S.on("touchmove"+a,c.event.touch),p.on("scroll"+h,c.event.containScroll)}},unbind:{clickaway:function(){c.verbose("Removing clickaway events from context",g),g.off(a)},scrollLock:function(){c.verbose("Removing scroll lock from page"),S.off(a),x.off(a),p.off("scroll"+h)}},add:{inlineCSS:function(){var e,t=c.cache.width||p.outerWidth(),n=c.cache.height||p.outerHeight(),i=c.is.rtl(),o=c.get.direction(),r={left:t,right:-t,top:n,bottom:-n};i&&(c.verbose("RTL detected, flipping widths"),r.left=-t,r.right=t),e="<style>","left"===o||"right"===o?(c.debug("Adding CSS rules for animation distance",t),e+=" .ui.visible."+o+".sidebar ~ .fixed, .ui.visible."+o+".sidebar ~ .pusher {   -webkit-transform: translate3d("+r[o]+"px, 0, 0);           transform: translate3d("+r[o]+"px, 0, 0); }"):"top"!==o&&"bottom"!=o||(e+=" .ui.visible."+o+".sidebar ~ .fixed, .ui.visible."+o+".sidebar ~ .pusher {   -webkit-transform: translate3d(0, "+r[o]+"px, 0);           transform: translate3d(0, "+r[o]+"px, 0); }"),c.is.ie()&&("left"===o||"right"===o?(c.debug("Adding CSS rules for animation distance",t),e+=" body.pushable > .ui.visible."+o+".sidebar ~ .pusher:after {   -webkit-transform: translate3d("+r[o]+"px, 0, 0);           transform: translate3d("+r[o]+"px, 0, 0); }"):"top"!==o&&"bottom"!=o||(e+=" body.pushable > .ui.visible."+o+".sidebar ~ .pusher:after {   -webkit-transform: translate3d(0, "+r[o]+"px, 0);           transform: translate3d(0, "+r[o]+"px, 0); }"),e+=" body.pushable > .ui.visible.left.sidebar ~ .ui.visible.right.sidebar ~ .pusher:after, body.pushable > .ui.visible.right.sidebar ~ .ui.visible.left.sidebar ~ .pusher:after {   -webkit-transform: translate3d(0, 0, 0);           transform: translate3d(0, 0, 0); }"),s=D(e+="</style>").appendTo(E),c.debug("Adding sizing css to head",s)}},refresh:function(){c.verbose("Refreshing selector cache"),g=D(u.context),m=g.children(n.sidebar),v=g.children(n.pusher),g.children(n.fixed),c.clear.cache()},refreshSidebars:function(){c.verbose("Refreshing other sidebars"),m=g.children(n.sidebar)},repaint:function(){c.verbose("Forcing repaint event"),b.style.display="none";b.offsetHeight;b.scrollTop=b.scrollTop,b.style.display=""},setup:{cache:function(){c.cache={width:p.outerWidth(),height:p.outerHeight(),rtl:"rtl"==p.css("direction")}},layout:function(){0===g.children(n.pusher).length&&(c.debug("Adding wrapper element for sidebar"),c.error(d.pusher),v=D('<div class="pusher" />'),g.children().not(n.omitted).not(m).wrapAll(v),c.refresh()),0!==p.nextAll(n.pusher).length&&p.nextAll(n.pusher)[0]===v[0]||(c.debug("Moved sidebar to correct parent element"),c.error(d.movedSidebar,b),p.detach().prependTo(g),c.refresh()),c.clear.cache(),c.set.pushable(),c.set.direction()}},attachEvents:function(e,t){var n=D(e);t=D.isFunction(c[t])?c[t]:c.toggle,0<n.length?(c.debug("Attaching sidebar events to element",e,t),n.on("click"+h,t)):c.error(d.notFound,e)},show:function(e){if(e=D.isFunction(e)?e:function(){},c.is.hidden()){if(c.refreshSidebars(),u.overlay&&(c.error(d.overlay),u.transition="overlay"),c.refresh(),c.othersActive())if(c.debug("Other sidebars currently visible"),u.exclusive){if("overlay"!=u.transition)return void c.hideOthers(c.show);c.hideOthers()}else u.transition="overlay";c.pushPage(function(){e.call(b),u.onShow.call(b)}),u.onChange.call(b),u.onVisible.call(b)}else c.debug("Sidebar is already visible")},hide:function(e){e=D.isFunction(e)?e:function(){},(c.is.visible()||c.is.animating())&&(c.debug("Hiding sidebar",e),c.refreshSidebars(),c.pullPage(function(){e.call(b),u.onHidden.call(b)}),u.onChange.call(b),u.onHide.call(b))},othersAnimating:function(){return 0<m.not(p).filter("."+r.animating).length},othersVisible:function(){return 0<m.not(p).filter("."+r.visible).length},othersActive:function(){return c.othersVisible()||c.othersAnimating()},hideOthers:function(e){var t=m.not(p).filter("."+r.visible),n=t.length,i=0;e=e||function(){},t.sidebar("hide",function(){++i==n&&e()})},toggle:function(){c.verbose("Determining toggled direction"),c.is.hidden()?c.show():c.hide()},pushPage:function(t){var e,n,i,o=c.get.transition(),r="overlay"===o||c.othersActive()?p:v;t=D.isFunction(t)?t:function(){},"scale down"==u.transition&&c.scrollToTop(),c.set.transition(o),c.repaint(),e=function(){c.bind.clickaway(),c.add.inlineCSS(),c.set.animating(),c.set.visible()},n=function(){c.set.dimmed()},i=function(e){e.target==r[0]&&(r.off(l+a,i),c.remove.animating(),c.bind.scrollLock(),t.call(b))},r.off(l+a),r.on(l+a,i),k(e),u.dimPage&&!c.othersVisible()&&k(n)},pullPage:function(t){var e,n,i=c.get.transition(),o="overlay"==i||c.othersActive()?p:v;t=D.isFunction(t)?t:function(){},c.verbose("Removing context push state",c.get.direction()),c.unbind.clickaway(),c.unbind.scrollLock(),e=function(){c.set.transition(i),c.set.animating(),c.remove.visible(),u.dimPage&&!c.othersVisible()&&v.removeClass(r.dimmed)},n=function(e){e.target==o[0]&&(o.off(l+a,n),c.remove.animating(),c.remove.transition(),c.remove.inlineCSS(),("scale down"==i||u.returnScroll&&c.is.mobile())&&c.scrollBack(),t.call(b))},o.off(l+a),o.on(l+a,n),k(e)},scrollToTop:function(){c.verbose("Scrolling to top of page to avoid animation issues"),t=D(M).scrollTop(),p.scrollTop(0),M.scrollTo(0,0)},scrollBack:function(){c.verbose("Scrolling back to original page position"),M.scrollTo(0,t)},clear:{cache:function(){c.verbose("Clearing cached dimensions"),c.cache={}}},set:{ios:function(){C.addClass(r.ios)},pushed:function(){g.addClass(r.pushed)},pushable:function(){g.addClass(r.pushable)},dimmed:function(){v.addClass(r.dimmed)},active:function(){p.addClass(r.active)},animating:function(){p.addClass(r.animating)},transition:function(e){e=e||c.get.transition(),p.addClass(e)},direction:function(e){e=e||c.get.direction(),p.addClass(r[e])},visible:function(){p.addClass(r.visible)},overlay:function(){p.addClass(r.overlay)}},remove:{inlineCSS:function(){c.debug("Removing inline css styles",s),s&&0<s.length&&s.remove()},ios:function(){C.removeClass(r.ios)},pushed:function(){g.removeClass(r.pushed)},pushable:function(){g.removeClass(r.pushable)},active:function(){p.removeClass(r.active)},animating:function(){p.removeClass(r.animating)},transition:function(e){e=e||c.get.transition(),p.removeClass(e)},direction:function(e){e=e||c.get.direction(),p.removeClass(r[e])},visible:function(){p.removeClass(r.visible)},overlay:function(){p.removeClass(r.overlay)}},get:{direction:function(){return p.hasClass(r.top)?r.top:p.hasClass(r.right)?r.right:p.hasClass(r.bottom)?r.bottom:r.left},transition:function(){var e,t=c.get.direction();return e=c.is.mobile()?"auto"==u.mobileTransition?u.defaultTransition.mobile[t]:u.mobileTransition:"auto"==u.transition?u.defaultTransition.computer[t]:u.transition,c.verbose("Determined transition",e),e},transitionEvent:function(){var e,t=F.createElement("element"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(t.style[e]!==L)return n[e]}},is:{ie:function(){return!M.ActiveXObject&&"ActiveXObject"in M||"ActiveXObject"in M},ios:function(){var e=navigator.userAgent,t=e.match(o.ios),n=e.match(o.mobileChrome);return!(!t||n)&&(c.verbose("Browser was found to be iOS",e),!0)},mobile:function(){var e=navigator.userAgent;return e.match(o.mobile)?(c.verbose("Browser was found to be mobile",e),!0):(c.verbose("Browser is not mobile, using regular transition",e),!1)},hidden:function(){return!c.is.visible()},visible:function(){return p.hasClass(r.visible)},open:function(){return c.is.visible()},closed:function(){return c.is.hidden()},vertical:function(){return p.hasClass(r.top)},animating:function(){return g.hasClass(r.animating)},rtl:function(){return c.cache.rtl===L&&(c.cache.rtl="rtl"==p.css("direction")),c.cache.rtl}},setting:function(e,t){if(c.debug("Changing setting",e,t),D.isPlainObject(e))D.extend(!0,u,e);else{if(t===L)return u[e];D.isPlainObject(u[e])?D.extend(!0,u[e],t):u[e]=t}},internal:function(e,t){if(D.isPlainObject(e))D.extend(!0,c,e);else{if(t===L)return c[e];c[e]=t}},debug:function(){!u.silent&&u.debug&&(u.performance?c.performance.log(arguments):(c.debug=Function.prototype.bind.call(console.info,console,u.name+":"),c.debug.apply(console,arguments)))},verbose:function(){!u.silent&&u.verbose&&u.debug&&(u.performance?c.performance.log(arguments):(c.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),c.verbose.apply(console,arguments)))},error:function(){u.silent||(c.error=Function.prototype.bind.call(console.error,console,u.name+":"),c.error.apply(console,arguments))},performance:{log:function(e){var t,n;u.performance&&(n=(t=(new Date).getTime())-(R||t),R=t,I.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:b,"Execution Time":n})),clearTimeout(c.performance.timer),c.performance.timer=setTimeout(c.performance.display,500)},display:function(){var e=u.name+":",n=0;R=!1,clearTimeout(c.performance.timer),D.each(I,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",P&&(e+=" '"+P+"'"),(console.group!==L||console.table!==L)&&0<I.length&&(console.groupCollapsed(e),console.table?console.table(I):D.each(I,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),I=[]}},invoke:function(i,e,t){var o,r,n,s=y;return e=e||O,t=b||t,"string"==typeof i&&s!==L&&(i=i.split(/[\. ]/),o=i.length-1,D.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(D.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==L)return r=s[n],!1;if(!D.isPlainObject(s[t])||e==o)return s[t]!==L?r=s[t]:c.error(d.method,i),!1;s=s[t]}})),D.isFunction(r)?n=r.apply(t,e):r!==L&&(n=r),Array.isArray(T)?T.push(n):T!==L?T=[T,n]:n!==L&&(T=n),r}},A?(y===L&&c.initialize(),c.invoke(_)):(y!==L&&c.invoke("destroy"),c.initialize())}),T!==L?T:this},D.fn.sidebar.settings={name:"Sidebar",namespace:"sidebar",silent:!1,debug:!1,verbose:!1,performance:!0,transition:"auto",mobileTransition:"auto",defaultTransition:{computer:{left:"uncover",right:"uncover",top:"overlay",bottom:"overlay"},mobile:{left:"uncover",right:"uncover",top:"overlay",bottom:"overlay"}},context:"body",exclusive:!1,closable:!0,dimPage:!0,scrollLock:!1,returnScroll:!1,delaySetup:!1,duration:500,onChange:function(){},onShow:function(){},onHide:function(){},onHidden:function(){},onVisible:function(){},className:{active:"active",animating:"animating",dimmed:"dimmed",ios:"ios",pushable:"pushable",pushed:"pushed",right:"right",top:"top",left:"left",bottom:"bottom",visible:"visible"},selector:{fixed:".fixed",omitted:"script, link, style, .ui.modal, .ui.dimmer, .ui.nag, .ui.fixed",pusher:".pusher",sidebar:".ui.sidebar"},regExp:{ios:/(iPad|iPhone|iPod)/g,mobileChrome:/(CriOS)/g,mobile:/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|NetFront|Silk-Accelerated|(hpw|web)OS|Fennec|Minimo|Opera M(obi|ini)|Blazer|Dolfin|Dolphin|Skyfire|Zune/g},error:{method:"The method you called is not defined.",pusher:"Had to add pusher element. For optimal performance make sure body content is inside a pusher element",movedSidebar:"Had to move sidebar. For optimal performance make sure sidebar and pusher are direct children of your body tag",overlay:"The overlay setting is no longer supported, use animation: overlay",notFound:"There were no elements that matched the specified selector"}}}(jQuery,window,document),function(E,P,R,I){"use strict";E.isFunction=E.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},P=void 0!==P&&P.Math==Math?P:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),E.fn.sticky=function(v){var b,e=E(this),y=e.selector||"",w=(new Date).getTime(),T=[],x=v,S="string"==typeof x,C=[].slice.call(arguments,1);return e.each(function(){var t,i,e,n,d,h=E.isPlainObject(v)?E.extend(!0,{},E.fn.sticky.settings,v):E.extend({},E.fn.sticky.settings),o=h.className,r=h.namespace,s=h.error,a="."+r,l="module-"+r,c=E(this),u=E(P),f=E(h.scrollContext),p=c.data(l),g=P.requestAnimationFrame||P.mozRequestAnimationFrame||P.webkitRequestAnimationFrame||P.msRequestAnimationFrame||function(e){setTimeout(e,0)},m=this;d={initialize:function(){d.determineContainer(),d.determineContext(),d.verbose("Initializing sticky",h,t),d.save.positions(),d.checkErrors(),d.bind.events(),h.observeChanges&&d.observeChanges(),d.instantiate()},instantiate:function(){d.verbose("Storing instance of module",d),p=d,c.data(l,d)},destroy:function(){d.verbose("Destroying previous instance"),d.reset(),e&&e.disconnect(),n&&n.disconnect(),u.off("load"+a,d.event.load).off("resize"+a,d.event.resize),f.off("scrollchange"+a,d.event.scrollchange),c.removeData(l)},observeChanges:function(){"MutationObserver"in P&&(e=new MutationObserver(d.event.documentChanged),n=new MutationObserver(d.event.changed),e.observe(R,{childList:!0,subtree:!0}),n.observe(m,{childList:!0,subtree:!0}),n.observe(i[0],{childList:!0,subtree:!0}),d.debug("Setting up mutation observer",n))},determineContainer:function(){t=h.container?E(h.container):c.offsetParent()},determineContext:function(){0!==(i=h.context?E(h.context):t).length||d.error(s.invalidContext,h.context,c)},checkErrors:function(){if(d.is.hidden()&&d.error(s.visible,c),d.cache.element.height>d.cache.context.height)return d.reset(),void d.error(s.elementSize,c)},bind:{events:function(){u.on("load"+a,d.event.load).on("resize"+a,d.event.resize),f.off("scroll"+a).on("scroll"+a,d.event.scroll).on("scrollchange"+a,d.event.scrollchange)}},event:{changed:function(e){clearTimeout(d.timer),d.timer=setTimeout(function(){d.verbose("DOM tree modified, updating sticky menu",e),d.refresh()},100)},documentChanged:function(e){[].forEach.call(e,function(e){e.removedNodes&&[].forEach.call(e.removedNodes,function(e){(e==m||0<E(e).find(m).length)&&(d.debug("Element removed from DOM, tearing down events"),d.destroy())})})},load:function(){d.verbose("Page contents finished loading"),g(d.refresh)},resize:function(){d.verbose("Window resized"),g(d.refresh)},scroll:function(){g(function(){f.triggerHandler("scrollchange"+a,f.scrollTop())})},scrollchange:function(e,t){d.stick(t),h.onScroll.call(m)}},refresh:function(e){d.reset(),h.context||d.determineContext(),e&&d.determineContainer(),d.save.positions(),d.stick(),h.onReposition.call(m)},supports:{sticky:function(){var e=E("<div/>");return e.addClass(o.supported),e.css("position").match("sticky")}},save:{lastScroll:function(e){d.lastScroll=e},elementScroll:function(e){d.elementScroll=e},positions:function(){var e={height:f.height()},t={margin:{top:parseInt(c.css("margin-top"),10),bottom:parseInt(c.css("margin-bottom"),10)},offset:c.offset(),width:c.outerWidth(),height:c.outerHeight()},n={offset:i.offset(),height:i.outerHeight()};d.is.standardScroll()||(d.debug("Non-standard scroll. Removing scroll offset from element offset"),e.top=f.scrollTop(),e.left=f.scrollLeft(),t.offset.top+=e.top,n.offset.top+=e.top,t.offset.left+=e.left,n.offset.left+=e.left),d.cache={fits:t.height+h.offset<=e.height,sameHeight:t.height==n.height,scrollContext:{height:e.height},element:{margin:t.margin,top:t.offset.top-t.margin.top,left:t.offset.left,width:t.width,height:t.height,bottom:t.offset.top+t.height},context:{top:n.offset.top,height:n.height,bottom:n.offset.top+n.height}},d.set.containerSize(),d.stick(),d.debug("Caching element positions",d.cache)}},get:{direction:function(e){var t="down";return e=e||f.scrollTop(),d.lastScroll!==I&&(d.lastScroll<e?t="down":d.lastScroll>e&&(t="up")),t},scrollChange:function(e){return e=e||f.scrollTop(),d.lastScroll?e-d.lastScroll:0},currentElementScroll:function(){return d.elementScroll?d.elementScroll:d.is.top()?Math.abs(parseInt(c.css("top"),10))||0:Math.abs(parseInt(c.css("bottom"),10))||0},elementScroll:function(e){e=e||f.scrollTop();var t=d.cache.element,n=d.cache.scrollContext,i=d.get.scrollChange(e),o=t.height-n.height+h.offset,r=d.get.currentElementScroll(),s=r+i;return r=d.cache.fits||s<0?0:o<s?o:s}},remove:{lastScroll:function(){delete d.lastScroll},elementScroll:function(e){delete d.elementScroll},minimumSize:function(){t.css("min-height","")},offset:function(){c.css("margin-top","")}},set:{offset:function(){d.verbose("Setting offset on element",h.offset),c.css("margin-top",h.offset)},containerSize:function(){var e=t.get(0).tagName;"HTML"===e||"body"==e?d.determineContainer():Math.abs(t.outerHeight()-d.cache.context.height)>h.jitter&&(d.debug("Context has padding, specifying exact height for container",d.cache.context.height),t.css({height:d.cache.context.height}))},minimumSize:function(){var e=d.cache.element;t.css("min-height",e.height)},scroll:function(e){d.debug("Setting scroll on element",e),d.elementScroll!=e&&(d.is.top()&&c.css("bottom","").css("top",-e),d.is.bottom()&&c.css("top","").css("bottom",e))},size:function(){0!==d.cache.element.height&&0!==d.cache.element.width&&(m.style.setProperty("width",d.cache.element.width+"px","important"),m.style.setProperty("height",d.cache.element.height+"px","important"))}},is:{standardScroll:function(){return f[0]==P},top:function(){return c.hasClass(o.top)},bottom:function(){return c.hasClass(o.bottom)},initialPosition:function(){return!d.is.fixed()&&!d.is.bound()},hidden:function(){return!c.is(":visible")},bound:function(){return c.hasClass(o.bound)},fixed:function(){return c.hasClass(o.fixed)}},stick:function(e){var t=e||f.scrollTop(),n=d.cache,i=n.fits,o=n.sameHeight,r=n.element,s=n.scrollContext,a=n.context,l=d.is.bottom()&&h.pushing?h.bottomOffset:h.offset,c=(e={top:t+l,bottom:t+l+s.height},i?0:d.get.elementScroll(e.top)),u=!i;0===r.height||o||(d.is.initialPosition()?e.top>=a.bottom?(d.debug("Initial element position is bottom of container"),d.bindBottom()):e.top>r.top&&(r.height+e.top-c>=a.bottom?(d.debug("Initial element position is bottom of container"),d.bindBottom()):(d.debug("Initial element position is fixed"),d.fixTop())):d.is.fixed()?d.is.top()?e.top<=r.top?(d.debug("Fixed element reached top of container"),d.setInitialPosition()):r.height+e.top-c>=a.bottom?(d.debug("Fixed element reached bottom of container"),d.bindBottom()):u&&(d.set.scroll(c),d.save.lastScroll(e.top),d.save.elementScroll(c)):d.is.bottom()&&(e.bottom-r.height<=r.top?(d.debug("Bottom fixed rail has reached top of container"),d.setInitialPosition()):e.bottom>=a.bottom?(d.debug("Bottom fixed rail has reached bottom of container"),d.bindBottom()):u&&(d.set.scroll(c),d.save.lastScroll(e.top),d.save.elementScroll(c))):d.is.bottom()&&(e.top<=r.top?(d.debug("Jumped from bottom fixed to top fixed, most likely used home/end button"),d.setInitialPosition()):h.pushing?d.is.bound()&&e.bottom<=a.bottom&&(d.debug("Fixing bottom attached element to bottom of browser."),d.fixBottom()):d.is.bound()&&e.top<=a.bottom-r.height&&(d.debug("Fixing bottom attached element to top of browser."),d.fixTop())))},bindTop:function(){d.debug("Binding element to top of parent container"),d.remove.offset(),c.css({left:"",top:"",marginBottom:""}).removeClass(o.fixed).removeClass(o.bottom).addClass(o.bound).addClass(o.top),h.onTop.call(m),h.onUnstick.call(m)},bindBottom:function(){d.debug("Binding element to bottom of parent container"),d.remove.offset(),c.css({left:"",top:""}).removeClass(o.fixed).removeClass(o.top).addClass(o.bound).addClass(o.bottom),h.onBottom.call(m),h.onUnstick.call(m)},setInitialPosition:function(){d.debug("Returning to initial position"),d.unfix(),d.unbind()},fixTop:function(){d.debug("Fixing element to top of page"),h.setSize&&d.set.size(),d.set.minimumSize(),d.set.offset(),c.css({left:d.cache.element.left,bottom:"",marginBottom:""}).removeClass(o.bound).removeClass(o.bottom).addClass(o.fixed).addClass(o.top),h.onStick.call(m)},fixBottom:function(){d.debug("Sticking element to bottom of page"),h.setSize&&d.set.size(),d.set.minimumSize(),d.set.offset(),c.css({left:d.cache.element.left,bottom:"",marginBottom:""}).removeClass(o.bound).removeClass(o.top).addClass(o.fixed).addClass(o.bottom),h.onStick.call(m)},unbind:function(){d.is.bound()&&(d.debug("Removing container bound position on element"),d.remove.offset(),c.removeClass(o.bound).removeClass(o.top).removeClass(o.bottom))},unfix:function(){d.is.fixed()&&(d.debug("Removing fixed position on element"),d.remove.minimumSize(),d.remove.offset(),c.removeClass(o.fixed).removeClass(o.top).removeClass(o.bottom),h.onUnstick.call(m))},reset:function(){d.debug("Resetting elements position"),d.unbind(),d.unfix(),d.resetCSS(),d.remove.offset(),d.remove.lastScroll()},resetCSS:function(){c.css({width:"",height:""}),t.css({height:""})},setting:function(e,t){if(E.isPlainObject(e))E.extend(!0,h,e);else{if(t===I)return h[e];h[e]=t}},internal:function(e,t){if(E.isPlainObject(e))E.extend(!0,d,e);else{if(t===I)return d[e];d[e]=t}},debug:function(){!h.silent&&h.debug&&(h.performance?d.performance.log(arguments):(d.debug=Function.prototype.bind.call(console.info,console,h.name+":"),d.debug.apply(console,arguments)))},verbose:function(){!h.silent&&h.verbose&&h.debug&&(h.performance?d.performance.log(arguments):(d.verbose=Function.prototype.bind.call(console.info,console,h.name+":"),d.verbose.apply(console,arguments)))},error:function(){h.silent||(d.error=Function.prototype.bind.call(console.error,console,h.name+":"),d.error.apply(console,arguments))},performance:{log:function(e){var t,n;h.performance&&(n=(t=(new Date).getTime())-(w||t),w=t,T.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:m,"Execution Time":n})),clearTimeout(d.performance.timer),d.performance.timer=setTimeout(d.performance.display,0)},display:function(){var e=h.name+":",n=0;w=!1,clearTimeout(d.performance.timer),E.each(T,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",y&&(e+=" '"+y+"'"),(console.group!==I||console.table!==I)&&0<T.length&&(console.groupCollapsed(e),console.table?console.table(T):E.each(T,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),T=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||C,t=m||t,"string"==typeof i&&s!==I&&(i=i.split(/[\. ]/),o=i.length-1,E.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(E.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==I)return r=s[n],!1;if(!E.isPlainObject(s[t])||e==o)return s[t]!==I&&(r=s[t]),!1;s=s[t]}})),E.isFunction(r)?n=r.apply(t,e):r!==I&&(n=r),Array.isArray(b)?b.push(n):b!==I?b=[b,n]:n!==I&&(b=n),r}},S?(p===I&&d.initialize(),d.invoke(x)):(p!==I&&p.invoke("destroy"),d.initialize())}),b!==I?b:this},E.fn.sticky.settings={name:"Sticky",namespace:"sticky",silent:!1,debug:!1,verbose:!0,performance:!0,pushing:!1,context:!1,container:!1,scrollContext:P,offset:0,bottomOffset:0,jitter:5,setSize:!0,observeChanges:!1,onReposition:function(){},onScroll:function(){},onStick:function(){},onUnstick:function(){},onTop:function(){},onBottom:function(){},error:{container:"Sticky element must be inside a relative container",visible:"Element is hidden, you must call refresh after element becomes visible. Use silent setting to surpress this warning in production.",method:"The method you called is not defined.",invalidContext:"Context specified does not exist",elementSize:"Sticky element is larger than its container, cannot create sticky."},className:{bound:"bound",fixed:"fixed",supported:"native",top:"top",bottom:"bottom"}}}(jQuery,window,document),function(A,O,k,D){"use strict";A.isWindow=A.isWindow||function(e){return null!=e&&e===e.window},A.isFunction=A.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},O=void 0!==O&&O.Math==Math?O:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),A.fn.tab=function(c){var u,d=A.isFunction(this)?A(O):A(this),h=d.selector||"",f=(new Date).getTime(),p=[],P=c,R="string"==typeof P,I=[].slice.call(arguments,1),_=!1;return d.each(function(){var g,r,m,v,b,y,w=A.isPlainObject(c)?A.extend(!0,{},A.fn.tab.settings,c):A.extend({},A.fn.tab.settings),T=w.className,x=w.metadata,t=w.selector,S=w.error,n=w.regExp,e="."+w.namespace,i="module-"+w.namespace,C=A(this),o={},E=!0,s=0,a=this,l=C.data(i);b={initialize:function(){b.debug("Initializing tab menu item",C),b.fix.callbacks(),b.determineTabs(),b.debug("Determining tabs",w.context,r),w.auto&&b.set.auto(),b.bind.events(),w.history&&!_&&(b.initializeHistory(),_=!0),null==b.determine.activeTab()&&(b.debug("No active tab detected, setting first tab active",b.get.initialPath()),b.changeTab(b.get.initialPath())),b.instantiate()},instantiate:function(){b.verbose("Storing instance of module",b),l=b,C.data(i,b)},destroy:function(){b.debug("Destroying tabs",C),C.removeData(i).off(e)},bind:{events:function(){A.isWindow(a)||(b.debug("Attaching tab activation events to element",C),C.on("click"+e,b.event.click))}},determineTabs:function(){var e;"parent"===w.context?(0<C.closest(t.ui).length?(e=C.closest(t.ui),b.verbose("Using closest UI element as parent",e)):e=C,g=e.parent(),b.verbose("Determined parent element for creating context",g)):w.context?(g=A(w.context),b.verbose("Using selector for tab context",w.context,g)):g=A("body"),w.childrenOnly?(r=g.children(t.tabs),b.debug("Searching tab context children for tabs",g,r)):(r=g.find(t.tabs),b.debug("Searching tab context for tabs",g,r))},fix:{callbacks:function(){A.isPlainObject(c)&&(c.onTabLoad||c.onTabInit)&&(c.onTabLoad&&(c.onLoad=c.onTabLoad,delete c.onTabLoad,b.error(S.legacyLoad,c.onLoad)),c.onTabInit&&(c.onFirstLoad=c.onTabInit,delete c.onTabInit,b.error(S.legacyInit,c.onFirstLoad)),w=A.extend(!0,{},A.fn.tab.settings,c))}},initializeHistory:function(){if(b.debug("Initializing page state"),A.address===D)return b.error(S.state),!1;if("state"==w.historyType){if(b.debug("Using HTML5 to manage state"),!1===w.path)return b.error(S.path),!1;A.address.history(!0).state(w.path)}A.address.bind("change",b.event.history.change)},event:{click:function(e){var t=A(this).data(x.tab);t!==D?(w.history?(b.verbose("Updating page state",e),A.address.value(t)):(b.verbose("Changing tab",e),b.changeTab(t)),e.preventDefault()):b.debug("No tab specified")},history:{change:function(e){var t=e.pathNames.join("/")||b.get.initialPath(),n=w.templates.determineTitle(t)||!1;b.performance.display(),b.debug("History change event",t,e),y=e,t!==D&&b.changeTab(t),n&&A.address.title(n)}}},refresh:function(){m&&(b.debug("Refreshing tab",m),b.changeTab(m))},cache:{read:function(e){return e!==D&&o[e]},add:function(e,t){e=e||m,b.debug("Adding cached content for",e),o[e]=t},remove:function(e){e=e||m,b.debug("Removing cached content for",e),delete o[e]}},escape:{string:function(e){return(e=String(e)).replace(n.escape,"\\$&")}},set:{auto:function(){var e="string"==typeof w.path?w.path.replace(/\/$/,"")+"/{$tab}":"/{$tab}";b.verbose("Setting up automatic tab retrieval from server",e),A.isPlainObject(w.apiSettings)?w.apiSettings.url=e:w.apiSettings={url:e}},loading:function(e){var t=b.get.tabElement(e);t.hasClass(T.loading)||(b.verbose("Setting loading state for",t),t.addClass(T.loading).siblings(r).removeClass(T.active+" "+T.loading),0<t.length&&w.onRequest.call(t[0],e))},state:function(e){A.address.value(e)}},changeTab:function(d){var h=O.history&&O.history.pushState&&w.ignoreFirstLoad&&E,f=w.auto||A.isPlainObject(w.apiSettings),p=f&&!h?b.utilities.pathToArray(d):b.get.defaultPathArray(d);d=b.utilities.arrayToPath(p),A.each(p,function(e,t){var n,i,o,r,s=p.slice(0,e+1),a=b.utilities.arrayToPath(s),l=b.is.tab(a),c=e+1==p.length,u=b.get.tabElement(a);if(b.verbose("Looking for tab",t),l){if(b.verbose("Tab was found",t),m=a,v=b.utilities.filterArray(p,s),c?r=!0:(i=p.slice(0,e+2),o=b.utilities.arrayToPath(i),(r=!b.is.tab(o))&&b.verbose("Tab parameters found",i)),r&&f)return h?(b.debug("Ignoring remote content on first tab load",a),E=!1,b.cache.add(d,u.html()),b.activate.all(a),w.onFirstLoad.call(u[0],a,v,y),w.onLoad.call(u[0],a,v,y)):(b.activate.navigation(a),b.fetch.content(a,d)),!1;b.debug("Opened local tab",a),b.activate.all(a),b.cache.read(a)||(b.cache.add(a,!0),b.debug("First time tab loaded calling tab init"),w.onFirstLoad.call(u[0],a,v,y)),w.onLoad.call(u[0],a,v,y)}else{if(-1!=d.search("/")||""===d)return b.error(S.missingTab,C,g,a),!1;if(d=b.escape.string(d),a=(n=A("#"+d+', a[name="'+d+'"]')).closest("[data-tab]").data(x.tab),u=b.get.tabElement(a),n&&0<n.length&&a)return b.debug("Anchor link used, opening parent tab",u,n),u.hasClass(T.active)||setTimeout(function(){b.scrollTo(n)},0),b.activate.all(a),b.cache.read(a)||(b.cache.add(a,!0),b.debug("First time tab loaded calling tab init"),w.onFirstLoad.call(u[0],a,v,y)),w.onLoad.call(u[0],a,v,y),!1}})},scrollTo:function(e){var t=!!(e&&0<e.length)&&e.offset().top;!1!==t&&(b.debug("Forcing scroll to an in-page link in a hidden tab",t,e),A(k).scrollTop(t))},update:{content:function(e,t,n){var i=b.get.tabElement(e),o=i[0];n=n!==D?n:w.evaluateScripts,"string"==typeof w.cacheType&&"dom"==w.cacheType.toLowerCase()&&"string"!=typeof t?i.empty().append(A(t).clone(!0)):n?(b.debug("Updating HTML and evaluating inline scripts",e,t),i.html(t)):(b.debug("Updating HTML",e,t),o.innerHTML=t)}},fetch:{content:function(t,n){var e,i,o=b.get.tabElement(t),r={dataType:"html",encodeParameters:!1,on:"now",cache:w.alwaysRefresh,headers:{"X-Remote":!0},onSuccess:function(e){"response"==w.cacheType&&b.cache.add(n,e),b.update.content(t,e),t==m?(b.debug("Content loaded",t),b.activate.tab(t)):b.debug("Content loaded in background",t),w.onFirstLoad.call(o[0],t,v,y),w.onLoad.call(o[0],t,v,y),w.loadOnce?b.cache.add(n,!0):"string"==typeof w.cacheType&&"dom"==w.cacheType.toLowerCase()&&0<o.children().length?setTimeout(function(){var e=o.children().clone(!0);e=e.not("script"),b.cache.add(n,e)},0):b.cache.add(n,o.html())},urlData:{tab:n}},s=o.api("get request")||!1,a=s&&"pending"===s.state();n=n||t,i=b.cache.read(n),w.cache&&i?(b.activate.tab(t),b.debug("Adding cached content",n),w.loadOnce||("once"==w.evaluateScripts?b.update.content(t,i,!1):b.update.content(t,i)),w.onLoad.call(o[0],t,v,y)):a?(b.set.loading(t),b.debug("Content is already loading",n)):A.api!==D?(e=A.extend(!0,{},w.apiSettings,r),b.debug("Retrieving remote content",n,e),b.set.loading(t),o.api(e)):b.error(S.api)}},activate:{all:function(e){b.activate.tab(e),b.activate.navigation(e)},tab:function(e){var t=b.get.tabElement(e),n="siblings"==w.deactivate?t.siblings(r):r.not(t),i=t.hasClass(T.active);b.verbose("Showing tab content for",t),i||(t.addClass(T.active),n.removeClass(T.active+" "+T.loading),0<t.length&&w.onVisible.call(t[0],e))},navigation:function(e){var t=b.get.navElement(e),n="siblings"==w.deactivate?t.siblings(d):d.not(t),i=t.hasClass(T.active);b.verbose("Activating tab navigation for",t,e),i||(t.addClass(T.active),n.removeClass(T.active+" "+T.loading))}},deactivate:{all:function(){b.deactivate.navigation(),b.deactivate.tabs()},navigation:function(){d.removeClass(T.active)},tabs:function(){r.removeClass(T.active+" "+T.loading)}},is:{tab:function(e){return e!==D&&0<b.get.tabElement(e).length}},get:{initialPath:function(){return d.eq(0).data(x.tab)||r.eq(0).data(x.tab)},path:function(){return A.address.value()},defaultPathArray:function(e){return b.utilities.pathToArray(b.get.defaultPath(e))},defaultPath:function(e){var t=d.filter("[data-"+x.tab+'^="'+b.escape.string(e)+'/"]').eq(0).data(x.tab)||!1;if(t){if(b.debug("Found default tab",t),s<w.maxDepth)return s++,b.get.defaultPath(t);b.error(S.recursion)}else b.debug("No default tabs found for",e,r);return s=0,e},navElement:function(e){return e=e||m,d.filter("[data-"+x.tab+'="'+b.escape.string(e)+'"]')},tabElement:function(e){var t,n,i,o;return e=e||m,i=b.utilities.pathToArray(e),o=b.utilities.last(i),t=r.filter("[data-"+x.tab+'="'+b.escape.string(e)+'"]'),n=r.filter("[data-"+x.tab+'="'+b.escape.string(o)+'"]'),0<t.length?t:n},tab:function(){return m}},determine:{activeTab:function(){var i=null;return r.each(function(e,t){if(A(t).hasClass(T.active)){var n=A(this).data(x.tab);d.filter("[data-"+x.tab+'="'+b.escape.string(n)+'"]').hasClass(T.active)&&(i=n)}}),i}},utilities:{filterArray:function(e,t){return A.grep(e,function(e){return-1==A.inArray(e,t)})},last:function(e){return!!Array.isArray(e)&&e[e.length-1]},pathToArray:function(e){return e===D&&(e=m),"string"==typeof e?e.split("/"):[e]},arrayToPath:function(e){return!!Array.isArray(e)&&e.join("/")}},setting:function(e,t){if(b.debug("Changing setting",e,t),A.isPlainObject(e))A.extend(!0,w,e);else{if(t===D)return w[e];A.isPlainObject(w[e])?A.extend(!0,w[e],t):w[e]=t}},internal:function(e,t){if(A.isPlainObject(e))A.extend(!0,b,e);else{if(t===D)return b[e];b[e]=t}},debug:function(){!w.silent&&w.debug&&(w.performance?b.performance.log(arguments):(b.debug=Function.prototype.bind.call(console.info,console,w.name+":"),b.debug.apply(console,arguments)))},verbose:function(){!w.silent&&w.verbose&&w.debug&&(w.performance?b.performance.log(arguments):(b.verbose=Function.prototype.bind.call(console.info,console,w.name+":"),b.verbose.apply(console,arguments)))},error:function(){w.silent||(b.error=Function.prototype.bind.call(console.error,console,w.name+":"),b.error.apply(console,arguments))},performance:{log:function(e){var t,n;w.performance&&(n=(t=(new Date).getTime())-(f||t),f=t,p.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:a,"Execution Time":n})),clearTimeout(b.performance.timer),b.performance.timer=setTimeout(b.performance.display,500)},display:function(){var e=w.name+":",n=0;f=!1,clearTimeout(b.performance.timer),A.each(p,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",h&&(e+=" '"+h+"'"),(console.group!==D||console.table!==D)&&0<p.length&&(console.groupCollapsed(e),console.table?console.table(p):A.each(p,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),p=[]}},invoke:function(i,e,t){var o,r,n,s=l;return e=e||I,t=a||t,"string"==typeof i&&s!==D&&(i=i.split(/[\. ]/),o=i.length-1,A.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(A.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==D)return r=s[n],!1;if(!A.isPlainObject(s[t])||e==o)return s[t]!==D?r=s[t]:b.error(S.method,i),!1;s=s[t]}})),A.isFunction(r)?n=r.apply(t,e):r!==D&&(n=r),Array.isArray(u)?u.push(n):u!==D?u=[u,n]:n!==D&&(u=n),r}},R?(l===D&&b.initialize(),b.invoke(P)):(l!==D&&l.invoke("destroy"),b.initialize())}),u!==D?u:this},A.tab=function(){A(O).tab.apply(this,arguments)},A.fn.tab.settings={name:"Tab",namespace:"tab",silent:!1,debug:!1,verbose:!1,performance:!0,auto:!1,history:!1,historyType:"hash",path:!1,context:!1,childrenOnly:!1,maxDepth:25,deactivate:"siblings",alwaysRefresh:!1,cache:!0,loadOnce:!1,cacheType:"response",ignoreFirstLoad:!1,apiSettings:!1,evaluateScripts:"once",onFirstLoad:function(e,t,n){},onLoad:function(e,t,n){},onVisible:function(e,t,n){},onRequest:function(e,t,n){},templates:{determineTitle:function(e){}},error:{api:"You attempted to load content without API module",method:"The method you called is not defined",missingTab:"Activated tab cannot be found. Tabs are case-sensitive.",noContent:"The tab you specified is missing a content url.",path:"History enabled, but no path was specified",recursion:"Max recursive depth reached",legacyInit:"onTabInit has been renamed to onFirstLoad in 2.0, please adjust your code.",legacyLoad:"onTabLoad has been renamed to onLoad in 2.0. Please adjust your code",state:"History requires Asual's Address library <https://github.com/asual/jquery-address>"},regExp:{escape:/[-[\]{}()*+?.,\\^$|#\s:=@]/g},metadata:{tab:"tab",loaded:"loaded",promise:"promise"},className:{loading:"loading",active:"active"},selector:{tabs:".ui.tab",ui:".ui"}}}(jQuery,window,document),function(E,e,t,P){"use strict";E.isFunction=E.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),E.fn.toast=function(v){var b,e=E(this),y=e.selector||"",w=(new Date).getTime(),T=[],x=v,S="string"==typeof x,C=[].slice.call(arguments,1);return e.each(function(){var a,o=E.isPlainObject(v)?E.extend(!0,{},E.fn.toast.settings,v):E.extend({},E.fn.toast.settings),r=o.className,e=o.selector,l=o.error,t=o.namespace,n="."+t,i=t+"-module",s=E(this),c=E("<div/>",{class:o.className.box}),u=E("<div/>"),d=E("<div/>",{class:o.className.progress+" "+o.class}),h=E("<div/>",{class:"bar"}),f=E("<i/>",{class:"close icon"}),p=o.context?E(o.context):E("body"),g=this,m=s.data(i);a={initialize:function(){a.verbose("Initializing element"),"string"==typeof o.showProgress&&-1!==["top","bottom"].indexOf(o.showProgress)||(o.showProgress=!1),a.has.container()||a.create.container(),a.create.toast(),a.bind.events(),0<o.displayTime&&(a.closeTimer=setTimeout(a.close,o.displayTime+(o.showProgress?300:0))),a.show()},destroy:function(){a.debug("Removing toast",u),u.remove(),u=P,o.onRemove.call(u,g)},show:function(e){e=e||function(){},a.debug("Showing toast"),!1!==o.onShow.call(u,g)?a.animate.show(e):a.debug("onShow callback returned false, cancelling toast animation")},close:function(e){a.closeTimer&&clearTimeout(a.closeTimer),e=e||function(){},a.remove.visible(),a.unbind.events(),a.animate.close(e)},create:{container:function(){a.verbose("Creating container"),p.append('<div class="ui '+o.position+" "+r.container+'"></div>')},toast:function(){var e=E("<div/>").addClass(r.content);a.verbose("Creating toast"),o.closeIcon&&(u.append(f),u.css("cursor","default"));var t="string"==typeof o.showIcon?o.showIcon:o.showIcon&&o.icons[o.class]?o.icons[o.class]:"";if(""!=t){var n=E("<i/>").addClass(t+" "+r.icon);u.addClass(r.icon).append(n)}if(""!==o.title){var i=E("<div/>").addClass(r.title).text(o.title);e.append(i)}e.append(E("<div/>").html(o.message)),u.addClass(o.class+" "+r.toast).append(e),u.css("opacity",o.opacity),(o.compact||u.hasClass("compact"))&&c.addClass("compact"),u.hasClass("toast")&&!u.hasClass("inverted")?d.addClass("inverted"):d.removeClass("inverted"),u=c.append(u),o.showProgress&&0<o.displayTime&&(d.addClass(o.showProgress).append(h),d.hasClass("top")?u.prepend(d):u.append(d),h.css("transition","width "+o.displayTime/1e3+"s linear"),h.width(o.progressUp?"0%":"100%"),setTimeout(function(){void 0!==d&&h.width(o.progressUp?"100%":"0%")},300)),o.newestOnTop?u.prependTo(a.get.container()):u.appendTo(a.get.container())}},bind:{events:function(){a.debug("Binding events to toast"),(o.closeIcon?f:u).on("click"+n,a.event.click)}},unbind:{events:function(){a.debug("Unbinding events to toast"),(o.closeIcon?f:u).off("click"+n)}},animate:{show:function(e){e=E.isFunction(e)?e:function(){},o.transition&&E.fn.transition!==P&&s.transition("is supported")?(a.set.visible(),u.transition({animation:o.transition.showMethod+" in",queue:!1,debug:o.debug,verbose:o.verbose,duration:o.transition.showDuration,onComplete:function(){e.call(u,g),o.onVisible.call(u,g)}})):a.error(l.noTransition)},close:function(e){e=E.isFunction(e)?e:function(){},a.debug("Closing toast"),!1!==o.onHide.call(u,g)?o.transition&&E.fn.transition!==P&&s.transition("is supported")?u.transition({animation:o.transition.hideMethod+" out",queue:!1,duration:o.transition.hideDuration,debug:o.debug,verbose:o.verbose,onBeforeHide:function(e){e=E.isFunction(e)?e:function(){},""!==o.transition.closeEasing?(u.css("opacity",0),u.wrap("<div/>").parent().slideUp(500,o.transition.closeEasing,function(){u.parent().remove(),e.call(u)})):e.call(u)},onComplete:function(){a.destroy(),e.call(u,g),o.onHidden.call(u,g)}}):a.error(l.noTransition):a.debug("onHide callback returned false, cancelling toast animation")}},has:{container:function(){return a.verbose("Determining if there is already a container"),0<p.find(a.helpers.toClass(o.position)+e.container).length}},get:{container:function(){return p.find(a.helpers.toClass(o.position)+e.container)[0]}},set:{visible:function(){u.addClass(r.visible)}},remove:{visible:function(){u.removeClass(r.visible)}},event:{click:function(){o.onClick.call(u,g),a.close()}},helpers:{toClass:function(e){var t=e.split(" "),n="";return t.forEach(function(e){n+="."+e}),n}},setting:function(e,t){if(a.debug("Changing setting",e,t),E.isPlainObject(e))E.extend(!0,o,e);else{if(t===P)return o[e];E.isPlainObject(o[e])?E.extend(!0,o[e],t):o[e]=t}},internal:function(e,t){if(E.isPlainObject(e))E.extend(!0,a,e);else{if(t===P)return a[e];a[e]=t}},debug:function(){!o.silent&&o.debug&&(o.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,o.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!o.silent&&o.verbose&&o.debug&&(o.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,o.name+":"),a.verbose.apply(console,arguments)))},error:function(){o.silent||(a.error=Function.prototype.bind.call(console.error,console,o.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;o.performance&&(n=(t=(new Date).getTime())-(w||t),w=t,T.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:g,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=o.name+":",n=0;w=!1,clearTimeout(a.performance.timer),E.each(T,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",y&&(e+=" '"+y+"'"),(console.group!==P||console.table!==P)&&0<T.length&&(console.groupCollapsed(e),console.table?console.table(T):E.each(T,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),T=[]}},invoke:function(i,e,t){var o,r,n,s=m;return e=e||C,t=g||t,"string"==typeof i&&s!==P&&(i=i.split(/[\. ]/),o=i.length-1,E.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(E.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==P)return r=s[n],!1;if(!E.isPlainObject(s[t])||e==o)return s[t]!==P?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),E.isFunction(r)?n=r.apply(t,e):r!==P&&(n=r),Array.isArray(b)?b.push(n):b!==P?b=[b,n]:n!==P&&(b=n),r}},S?(m===P&&a.initialize(),a.invoke(x)):(m!==P&&m.invoke("destroy"),a.initialize())}),b!==P?b:this},E.fn.toast.settings={name:"Toast",namespace:"toast",silent:!1,debug:!1,verbose:!1,performance:!0,context:"body",position:"top right",class:"info",title:"",message:"",displayTime:3e3,showIcon:!0,newestOnTop:!1,showProgress:!1,progressUp:!0,opacity:1,compact:!0,closeIcon:!1,transition:{showMethod:"scale",showDuration:500,hideMethod:"scale",hideDuration:500,closeEasing:"easeOutBounce"},error:{method:"The method you called is not defined.",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>"},className:{container:"toast-container",box:"toast-box",progress:"ui attached active progress",toast:"ui toast",icon:"icon",visible:"visible",content:"content",title:"header"},icons:{info:"info",success:"checkmark",warning:"warning",error:"times"},selector:{container:".toast-container",box:".toast-box",toast:".ui.toast"},onShow:function(){},onVisible:function(){},onClick:function(){},onHide:function(){},onHidden:function(){},onRemove:function(){}},E.extend(E.easing,{easeOutBounce:function(e,t,n,i,o){return(t/=o)<1/2.75?i*(7.5625*t*t)+n:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+n:i*(7.5625*(t-=2.625/2.75)*t+.984375)+n}})}(jQuery,window,document),function(T,e,x,S){"use strict";T.isFunction=T.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),T.fn.transition=function(){var c,s=T(this),p=s.selector||"",g=(new Date).getTime(),m=[],v=arguments,b=v[0],y=[].slice.call(arguments,1),w="string"==typeof b;return s.each(function(i){var u,a,t,d,n,o,e,r,h,f=T(this),l=this;(h={initialize:function(){u=h.get.settings.apply(l,v),d=u.className,t=u.error,n=u.metadata,r="."+u.namespace,e="module-"+u.namespace,a=f.data(e)||h,o=h.get.animationEndEvent(),!1===(w=w&&h.invoke(b))&&(h.verbose("Converted arguments into settings object",u),u.interval?h.delay(u.animate):h.animate(),h.instantiate())},instantiate:function(){h.verbose("Storing instance of module",h),a=h,f.data(e,a)},destroy:function(){h.verbose("Destroying previous module for",l),f.removeData(e)},refresh:function(){h.verbose("Refreshing display type on next animation"),delete h.displayType},forceRepaint:function(){h.verbose("Forcing element repaint");var e=f.parent(),t=f.next();0===t.length?f.detach().appendTo(e):f.detach().insertBefore(t)},repaint:function(){h.verbose("Repainting element");l.offsetWidth},delay:function(e){var t,n=h.get.animationDirection();n=n||(h.can.transition()?h.get.direction():"static"),e=e!==S?e:u.interval,t="auto"==u.reverse&&n==d.outward||1==u.reverse?(s.length-i)*u.interval:i*u.interval,h.debug("Delaying animation by",t),setTimeout(h.animate,t)},animate:function(e){if(u=e||u,!h.is.supported())return h.error(t.support),!1;if(h.debug("Preparing animation",u.animation),h.is.animating()){if(u.queue)return!u.allowRepeats&&h.has.direction()&&h.is.occurring()&&!0!==h.queuing?h.debug("Animation is currently occurring, preventing queueing same animation",u.animation):h.queue(u.animation),!1;if(!u.allowRepeats&&h.is.occurring())return h.debug("Animation is already occurring, will not execute repeated animation",u.animation),!1;h.debug("New animation started, completing previous early",u.animation),a.complete()}h.can.animate()?h.set.animating(u.animation):h.error(t.noAnimation,u.animation,l)},reset:function(){h.debug("Resetting animation to beginning conditions"),h.remove.animationCallbacks(),h.restore.conditions(),h.remove.animating()},queue:function(e){h.debug("Queueing animation of",e),h.queuing=!0,f.one(o+".queue"+r,function(){h.queuing=!1,h.repaint(),h.animate.apply(this,u)})},complete:function(e){e&&e.target===l&&e.stopPropagation(),h.debug("Animation complete",u.animation),h.remove.completeCallback(),h.remove.failSafe(),h.is.looping()||(h.is.outward()?(h.verbose("Animation is outward, hiding element"),h.restore.conditions(),h.hide()):h.is.inward()?(h.verbose("Animation is outward, showing element"),h.restore.conditions(),h.show()):(h.verbose("Static animation completed"),h.restore.conditions(),u.onComplete.call(l)))},force:{visible:function(){var e=f.attr("style"),t=h.get.userStyle(e),n=h.get.displayType(),i=t+"display: "+n+" !important;",o=f[0].style.display;return!n||"none"===o&&u.skipInlineHidden||f[0].tagName.match(/(script|link|style)/i)?(h.remove.transition(),!1):(h.verbose("Overriding default display to show element",n),f.attr("style",i),!0)},hidden:function(){var e=f.attr("style"),t=f.css("display"),n=e===S||""===e;"none"===t||h.is.hidden()?n&&f.removeAttr("style"):(h.verbose("Overriding default display to hide element"),f.css("display","none"))}},has:{direction:function(e){var n=!1;return"string"==typeof(e=e||u.animation)&&(e=e.split(" "),T.each(e,function(e,t){t!==d.inward&&t!==d.outward||(n=!0)})),n},inlineDisplay:function(){var e=f.attr("style")||"";return Array.isArray(e.match(/display.*?;/,""))}},set:{animating:function(e){h.remove.completeCallback(),e=e||u.animation;var t=h.get.animationClass(e);h.save.animation(t),h.force.visible()&&(h.remove.hidden(),h.remove.direction(),h.start.animation(t))},duration:function(e,t){!(t="number"==typeof(t=t||u.duration)?t+"ms":t)&&0!==t||(h.verbose("Setting animation duration",t),f.css({"animation-duration":t}))},direction:function(e){(e=e||h.get.direction())==d.inward?h.set.inward():h.set.outward()},looping:function(){h.debug("Transition set to loop"),f.addClass(d.looping)},hidden:function(){f.addClass(d.transition).addClass(d.hidden)},inward:function(){h.debug("Setting direction to inward"),f.removeClass(d.outward).addClass(d.inward)},outward:function(){h.debug("Setting direction to outward"),f.removeClass(d.inward).addClass(d.outward)},visible:function(){f.addClass(d.transition).addClass(d.visible)}},start:{animation:function(e){e=e||h.get.animationClass(),h.debug("Starting tween",e),f.addClass(e).one(o+".complete"+r,h.complete),u.useFailSafe&&h.add.failSafe(),h.set.duration(u.duration),u.onStart.call(l)}},save:{animation:function(e){h.cache||(h.cache={}),h.cache.animation=e},displayType:function(e){"none"!==e&&f.data(n.displayType,e)},transitionExists:function(e,t){T.fn.transition.exists[e]=t,h.verbose("Saving existence of transition",e,t)}},restore:{conditions:function(){var e=h.get.currentAnimation();e&&(f.removeClass(e),h.verbose("Removing animation class",h.cache)),h.remove.duration()}},add:{failSafe:function(){var e=h.get.duration();h.timer=setTimeout(function(){f.triggerHandler(o)},e+u.failSafeDelay),h.verbose("Adding fail safe timer",h.timer)}},remove:{animating:function(){f.removeClass(d.animating)},animationCallbacks:function(){h.remove.queueCallback(),h.remove.completeCallback()},queueCallback:function(){f.off(".queue"+r)},completeCallback:function(){f.off(".complete"+r)},display:function(){f.css("display","")},direction:function(){f.removeClass(d.inward).removeClass(d.outward)},duration:function(){f.css("animation-duration","")},failSafe:function(){h.verbose("Removing fail safe timer",h.timer),h.timer&&clearTimeout(h.timer)},hidden:function(){f.removeClass(d.hidden)},visible:function(){f.removeClass(d.visible)},looping:function(){h.debug("Transitions are no longer looping"),h.is.looping()&&(h.reset(),f.removeClass(d.looping))},transition:function(){f.removeClass(d.transition).removeClass(d.visible).removeClass(d.hidden)}},get:{settings:function(e,t,n){return"object"==typeof e?T.extend(!0,{},T.fn.transition.settings,e):"function"==typeof n?T.extend({},T.fn.transition.settings,{animation:e,onComplete:n,duration:t}):"string"==typeof t||"number"==typeof t?T.extend({},T.fn.transition.settings,{animation:e,duration:t}):"object"==typeof t?T.extend({},T.fn.transition.settings,t,{animation:e}):"function"==typeof t?T.extend({},T.fn.transition.settings,{animation:e,onComplete:t}):T.extend({},T.fn.transition.settings,{animation:e})},animationClass:function(e){var t=e||u.animation,n=h.can.transition()&&!h.has.direction()?h.get.direction()+" ":"";return d.animating+" "+d.transition+" "+n+t},currentAnimation:function(){return!(!h.cache||h.cache.animation===S)&&h.cache.animation},currentDirection:function(){return h.is.inward()?d.inward:d.outward},direction:function(){return h.is.hidden()||!h.is.visible()?d.inward:d.outward},animationDirection:function(e){var n;return"string"==typeof(e=e||u.animation)&&(e=e.split(" "),T.each(e,function(e,t){t===d.inward?n=d.inward:t===d.outward&&(n=d.outward)})),n||!1},duration:function(e){return!1===(e=e||u.duration)&&(e=f.css("animation-duration")||0),"string"==typeof e?-1<e.indexOf("ms")?parseFloat(e):1e3*parseFloat(e):e},displayType:function(e){if(e=e===S||e,u.displayType)return u.displayType;if(e&&f.data(n.displayType)===S){var t=f.css("display");""===t||"none"===t?h.can.transition(!0):h.save.displayType(t)}return f.data(n.displayType)},userStyle:function(e){return(e=e||f.attr("style")||"").replace(/display.*?;/,"")},transitionExists:function(e){return T.fn.transition.exists[e]},animationStartEvent:function(){var e,t=x.createElement("div"),n={animation:"animationstart",OAnimation:"oAnimationStart",MozAnimation:"mozAnimationStart",WebkitAnimation:"webkitAnimationStart"};for(e in n)if(t.style[e]!==S)return n[e];return!1},animationEndEvent:function(){var e,t=x.createElement("div"),n={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(e in n)if(t.style[e]!==S)return n[e];return!1}},can:{transition:function(e){var t,n,i,o,r,s,a=u.animation,l=h.get.transitionExists(a),c=h.get.displayType(!1);if(l===S||e){if(h.verbose("Determining whether animation exists"),t=f.attr("class"),n=f.prop("tagName"),o=(i=T("<"+n+" />").addClass(t).insertAfter(f)).addClass(a).removeClass(d.inward).removeClass(d.outward).addClass(d.animating).addClass(d.transition).css("animationName"),r=i.addClass(d.inward).css("animationName"),c||(c=i.attr("class",t).removeAttr("style").removeClass(d.hidden).removeClass(d.visible).show().css("display"),h.verbose("Determining final display state",c),h.save.displayType(c)),i.remove(),o!=r)h.debug("Direction exists for animation",a),s=!0;else{if("none"==o||!o)return void h.debug("No animation defined in css",a);h.debug("Static animation found",a,c),s=!1}h.save.transitionExists(a,s)}return l!==S?l:s},animate:function(){return h.can.transition()!==S}},is:{animating:function(){return f.hasClass(d.animating)},inward:function(){return f.hasClass(d.inward)},outward:function(){return f.hasClass(d.outward)},looping:function(){return f.hasClass(d.looping)},occurring:function(e){return e="."+(e=e||u.animation).replace(" ","."),0<f.filter(e).length},visible:function(){return f.is(":visible")},hidden:function(){return"hidden"===f.css("visibility")},supported:function(){return!1!==o}},hide:function(){h.verbose("Hiding element"),h.is.animating()&&h.reset(),l.blur(),h.remove.display(),h.remove.visible(),T.isFunction(u.onBeforeHide)?u.onBeforeHide.call(l,function(){h.hideNow()}):h.hideNow()},hideNow:function(){h.set.hidden(),h.force.hidden(),u.onHide.call(l),u.onComplete.call(l)},show:function(e){h.verbose("Showing element",e),h.force.visible()&&(h.remove.hidden(),h.set.visible(),u.onShow.call(l),u.onComplete.call(l))},toggle:function(){h.is.visible()?h.hide():h.show()},stop:function(){h.debug("Stopping current animation"),f.triggerHandler(o)},stopAll:function(){h.debug("Stopping all animation"),h.remove.queueCallback(),f.triggerHandler(o)},clear:{queue:function(){h.debug("Clearing animation queue"),h.remove.queueCallback()}},enable:function(){h.verbose("Starting animation"),f.removeClass(d.disabled)},disable:function(){h.debug("Stopping animation"),f.addClass(d.disabled)},setting:function(e,t){if(h.debug("Changing setting",e,t),T.isPlainObject(e))T.extend(!0,u,e);else{if(t===S)return u[e];T.isPlainObject(u[e])?T.extend(!0,u[e],t):u[e]=t}},internal:function(e,t){if(T.isPlainObject(e))T.extend(!0,h,e);else{if(t===S)return h[e];h[e]=t}},debug:function(){!u.silent&&u.debug&&(u.performance?h.performance.log(arguments):(h.debug=Function.prototype.bind.call(console.info,console,u.name+":"),h.debug.apply(console,arguments)))},verbose:function(){!u.silent&&u.verbose&&u.debug&&(u.performance?h.performance.log(arguments):(h.verbose=Function.prototype.bind.call(console.info,console,u.name+":"),h.verbose.apply(console,arguments)))},error:function(){u.silent||(h.error=Function.prototype.bind.call(console.error,console,u.name+":"),h.error.apply(console,arguments))},performance:{log:function(e){var t,n;u.performance&&(n=(t=(new Date).getTime())-(g||t),g=t,m.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:l,"Execution Time":n})),clearTimeout(h.performance.timer),h.performance.timer=setTimeout(h.performance.display,500)},display:function(){var e=u.name+":",n=0;g=!1,clearTimeout(h.performance.timer),T.each(m,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",p&&(e+=" '"+p+"'"),1<s.length&&(e+=" ("+s.length+")"),(console.group!==S||console.table!==S)&&0<m.length&&(console.groupCollapsed(e),console.table?console.table(m):T.each(m,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),m=[]}},invoke:function(i,e,t){var o,r,n,s=a;return e=e||y,t=l||t,"string"==typeof i&&s!==S&&(i=i.split(/[\. ]/),o=i.length-1,T.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(T.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==S)return r=s[n],!1;if(!T.isPlainObject(s[t])||e==o)return s[t]!==S&&(r=s[t]),!1;s=s[t]}})),T.isFunction(r)?n=r.apply(t,e):r!==S&&(n=r),Array.isArray(c)?c.push(n):c!==S?c=[c,n]:n!==S&&(c=n),r!==S&&r}}).initialize()}),c!==S?c:this},T.fn.transition.exists={},T.fn.transition.settings={name:"Transition",silent:!1,debug:!1,verbose:!1,performance:!0,namespace:"transition",interval:0,reverse:"auto",onStart:function(){},onComplete:function(){},onShow:function(){},onHide:function(){},useFailSafe:!0,failSafeDelay:100,allowRepeats:!1,displayType:!1,animation:"fade",duration:!1,queue:!0,skipInlineHidden:!1,metadata:{displayType:"display"},className:{animating:"animating",disabled:"disabled",hidden:"hidden",inward:"in",loading:"loading",looping:"looping",outward:"out",transition:"transition",visible:"visible"},error:{noAnimation:"Element is no longer attached to DOM. Unable to animate.  Use silent setting to surpress this warning in production.",repeated:"That animation is already occurring, cancelling repeated animation",method:"The method you called is not defined",support:"This browser does not support CSS animations"}}}(jQuery,window,document),function(I,_,e,A){"use strict";I.isWindow=I.isWindow||function(e){return null!=e&&e===e.window},_=void 0!==_&&_.Math==Math?_:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),I.api=I.fn.api=function(w){var T,e=I.isFunction(this)?I(_):I(this),x=e.selector||"",S=(new Date).getTime(),C=[],E=w,P="string"==typeof E,R=[].slice.call(arguments,1);return e.each(function(){var r,s,n,e,a,l,c=I.isPlainObject(w)?I.extend(!0,{},I.fn.api.settings,w):I.extend({},I.fn.api.settings),t=c.namespace,i=c.metadata,o=c.selector,u=c.error,d=c.className,h="."+t,f="module-"+t,p=I(this),g=p.closest(o.form),m=c.stateContext?I(c.stateContext):p,v=this,b=m[0],y=p.data(f);l={initialize:function(){P||l.bind.events(),l.instantiate()},instantiate:function(){l.verbose("Storing instance of module",l),y=l,p.data(f,y)},destroy:function(){l.verbose("Destroying previous module for",v),p.removeData(f).off(h)},bind:{events:function(){var e=l.get.event();e?(l.verbose("Attaching API events to element",e),p.on(e+h,l.event.trigger)):"now"==c.on&&(l.debug("Querying API endpoint immediately"),l.query())}},decode:{json:function(e){if(e!==A&&"string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}},read:{cachedResponse:function(e){var t;if(_.Storage!==A)return t=sessionStorage.getItem(e),l.debug("Using cached response",e,t),t=l.decode.json(t);l.error(u.noStorage)}},write:{cachedResponse:function(e,t){t&&""===t?l.debug("Response empty, not caching",t):_.Storage!==A?(I.isPlainObject(t)&&(t=JSON.stringify(t)),sessionStorage.setItem(e,t),l.verbose("Storing cached response for url",e,t)):l.error(u.noStorage)}},query:function(){if(l.is.disabled())l.debug("Element is disabled API request aborted");else{if(l.is.loading()){if(!c.interruptRequests)return void l.debug("Cancelling request, previous request is still pending");l.debug("Interrupting previous request"),l.abort()}if(c.defaultData&&I.extend(!0,c.urlData,l.get.defaultData()),c.serializeForm&&(c.data=l.add.formData(c.data)),!1===(s=l.get.settings()))return l.cancelled=!0,void l.error(u.beforeSend);if(l.cancelled=!1,(n=l.get.templatedURL())||l.is.mocked()){if((n=l.add.urlData(n))||l.is.mocked()){if(s.url=c.base+n,r=I.extend(!0,{},c,{type:c.method||c.type,data:e,url:c.base+n,beforeSend:c.beforeXHR,success:function(){},failure:function(){},complete:function(){}}),l.debug("Querying URL",r.url),l.verbose("Using AJAX settings",r),"local"===c.cache&&l.read.cachedResponse(n))return l.debug("Response returned from local cache"),l.request=l.create.request(),void l.request.resolveWith(b,[l.read.cachedResponse(n)]);c.throttle?c.throttleFirstRequest||l.timer?(l.debug("Throttling request",c.throttle),clearTimeout(l.timer),l.timer=setTimeout(function(){l.timer&&delete l.timer,l.debug("Sending throttled request",e,r.method),l.send.request()},c.throttle)):(l.debug("Sending request",e,r.method),l.send.request(),l.timer=setTimeout(function(){},c.throttle)):(l.debug("Sending request",e,r.method),l.send.request())}}else l.error(u.missingURL)}},should:{removeError:function(){return!0===c.hideError||"auto"===c.hideError&&!l.is.form()}},is:{disabled:function(){return 0<p.filter(o.disabled).length},expectingJSON:function(){return"json"===c.dataType||"jsonp"===c.dataType},form:function(){return p.is("form")||m.is("form")},mocked:function(){return c.mockResponse||c.mockResponseAsync||c.response||c.responseAsync},input:function(){return p.is("input")},loading:function(){return!!l.request&&"pending"==l.request.state()},abortedRequest:function(e){return e&&e.readyState!==A&&0===e.readyState?(l.verbose("XHR request determined to be aborted"),!0):(l.verbose("XHR request was not aborted"),!1)},validResponse:function(e){return l.is.expectingJSON()&&I.isFunction(c.successTest)?(l.debug("Checking JSON returned success",c.successTest,e),c.successTest(e)?(l.debug("Response passed success test",e),!0):(l.debug("Response failed success test",e),!1)):(l.verbose("Response is not JSON, skipping validation",c.successTest,e),!0)}},was:{cancelled:function(){return l.cancelled||!1},succesful:function(){return l.verbose('This behavior will be deleted due to typo. Use "was successful" instead.'),l.was.successful()},successful:function(){return l.request&&"resolved"==l.request.state()},failure:function(){return l.request&&"rejected"==l.request.state()},complete:function(){return l.request&&("resolved"==l.request.state()||"rejected"==l.request.state())}},add:{urlData:function(o,r){var e,t;return o&&(e=o.match(c.regExp.required),t=o.match(c.regExp.optional),r=r||c.urlData,e&&(l.debug("Looking for required URL variables",e),I.each(e,function(e,t){var n=-1!==t.indexOf("$")?t.substr(2,t.length-3):t.substr(1,t.length-2),i=I.isPlainObject(r)&&r[n]!==A?r[n]:p.data(n)!==A?p.data(n):m.data(n)!==A?m.data(n):r[n];if(i===A)return l.error(u.requiredParameter,n,o),o=!1;l.verbose("Found required variable",n,i),i=c.encodeParameters?l.get.urlEncodedValue(i):i,o=o.replace(t,i)})),t&&(l.debug("Looking for optional URL variables",e),I.each(t,function(e,t){var n=-1!==t.indexOf("$")?t.substr(3,t.length-4):t.substr(2,t.length-3),i=I.isPlainObject(r)&&r[n]!==A?r[n]:p.data(n)!==A?p.data(n):m.data(n)!==A?m.data(n):r[n];o=i!==A?(l.verbose("Optional variable Found",n,i),o.replace(t,i)):(l.verbose("Optional variable not found",n),-1!==o.indexOf("/"+t)?o.replace("/"+t,""):o.replace(t,""))}))),o},formData:function(e){var t=I.fn.serializeObject!==A,n=t?g.serializeObject():g.serialize();return e=e||c.data,e=I.isPlainObject(e)?t?(l.debug("Extending existing data with form data",e,n),I.extend(!0,{},e,n)):(l.error(u.missingSerialize),l.debug("Cant extend data. Replacing data with form data",e,n),n):(l.debug("Adding form data",n),n)}},send:{request:function(){l.set.loading(),l.request=l.create.request(),l.is.mocked()?l.mockedXHR=l.create.mockedXHR():l.xhr=l.create.xhr(),c.onRequest.call(b,l.request,l.xhr)}},event:{trigger:function(e){l.query(),"submit"!=e.type&&"click"!=e.type||e.preventDefault()},xhr:{always:function(){},done:function(e,t,n){var i=this,o=(new Date).getTime()-a,r=c.loadingDuration-o,s=!!I.isFunction(c.onResponse)&&(l.is.expectingJSON()&&!c.rawResponse?c.onResponse.call(i,I.extend(!0,{},e)):c.onResponse.call(i,e));r=0<r?r:0,s&&(l.debug("Modified API response in onResponse callback",c.onResponse,s,e),e=s),0<r&&l.debug("Response completed early delaying state change by",r),setTimeout(function(){l.is.validResponse(e)?l.request.resolveWith(i,[e,n]):l.request.rejectWith(i,[n,"invalid"])},r)},fail:function(e,t,n){var i=this,o=(new Date).getTime()-a,r=c.loadingDuration-o;0<(r=0<r?r:0)&&l.debug("Response completed early delaying state change by",r),setTimeout(function(){l.is.abortedRequest(e)?l.request.rejectWith(i,[e,"aborted",n]):l.request.rejectWith(i,[e,"error",t,n])},r)}},request:{done:function(e,t){l.debug("Successful API Response",e),"local"===c.cache&&n&&(l.write.cachedResponse(n,e),l.debug("Saving server response locally",l.cache)),c.onSuccess.call(b,e,p,t)},complete:function(e,t){var n,i;l.was.successful()?(i=e,n=t):(n=e,i=l.get.responseFromXHR(n)),l.remove.loading(),c.onComplete.call(b,i,p,n)},fail:function(e,t,n){var i=l.get.responseFromXHR(e),o=l.get.errorFromRequest(i,t,n);if("aborted"==t)return l.debug("XHR Aborted (Most likely caused by page navigation or CORS Policy)",t,n),c.onAbort.call(b,t,p,e),!0;"invalid"==t?l.debug("JSON did not pass success test. A server-side error has most likely occurred",i):"error"==t&&e!==A&&(l.debug("XHR produced a server error",t,n),(e.status<200||300<=e.status)&&n!==A&&""!==n&&l.error(u.statusMessage+n,r.url),c.onError.call(b,o,p,e)),c.errorDuration&&"aborted"!==t&&(l.debug("Adding error state"),l.set.error(),l.should.removeError()&&setTimeout(l.remove.error,c.errorDuration)),l.debug("API Request failed",o,e),c.onFailure.call(b,i,p,e)}}},create:{request:function(){return I.Deferred().always(l.event.request.complete).done(l.event.request.done).fail(l.event.request.fail)},mockedXHR:function(){var e,t,n,i=c.mockResponse||c.response,o=c.mockResponseAsync||c.responseAsync;return n=I.Deferred().always(l.event.xhr.complete).done(l.event.xhr.done).fail(l.event.xhr.fail),i?(t=I.isFunction(i)?(l.debug("Using specified synchronous callback",i),i.call(b,s)):(l.debug("Using settings specified response",i),i),n.resolveWith(b,[t,!1,{responseText:t}])):I.isFunction(o)&&(e=function(e){l.debug("Async callback returned response",e),e?n.resolveWith(b,[e,!1,{responseText:e}]):n.rejectWith(b,[{responseText:e},!1,!1])},l.debug("Using specified async response callback",o),o.call(b,s,e)),n},xhr:function(){var e;return e=I.ajax(r).always(l.event.xhr.always).done(l.event.xhr.done).fail(l.event.xhr.fail),l.verbose("Created server request",e,r),e}},set:{error:function(){l.verbose("Adding error state to element",m),m.addClass(d.error)},loading:function(){l.verbose("Adding loading state to element",m),m.addClass(d.loading),a=(new Date).getTime()}},remove:{error:function(){l.verbose("Removing error state from element",m),m.removeClass(d.error)},loading:function(){l.verbose("Removing loading state from element",m),m.removeClass(d.loading)}},get:{responseFromXHR:function(e){return!!I.isPlainObject(e)&&(l.is.expectingJSON()?l.decode.json(e.responseText):e.responseText)},errorFromRequest:function(e,t,n){return I.isPlainObject(e)&&e.error!==A?e.error:c.error[t]!==A?c.error[t]:n},request:function(){return l.request||!1},xhr:function(){return l.xhr||!1},settings:function(){var e;return(e=c.beforeSend.call(b,c))&&(e.success!==A&&(l.debug("Legacy success callback detected",e),l.error(u.legacyParameters,e.success),e.onSuccess=e.success),e.failure!==A&&(l.debug("Legacy failure callback detected",e),l.error(u.legacyParameters,e.failure),e.onFailure=e.failure),e.complete!==A&&(l.debug("Legacy complete callback detected",e),l.error(u.legacyParameters,e.complete),e.onComplete=e.complete)),e===A&&l.error(u.noReturnedValue),!1===e?e:e!==A?I.extend(!0,{},e):I.extend(!0,{},c)},urlEncodedValue:function(e){var t=_.decodeURIComponent(e),n=_.encodeURIComponent(e);return t!==e?(l.debug("URL value is already encoded, avoiding double encoding",e),e):(l.verbose("Encoding value using encodeURIComponent",e,n),n)},defaultData:function(){var e={};return I.isWindow(v)||(l.is.input()?e.value=p.val():l.is.form()||(e.text=p.text())),e},event:function(){return I.isWindow(v)||"now"==c.on?(l.debug("API called without element, no events attached"),!1):"auto"==c.on?p.is("input")?v.oninput!==A?"input":v.onpropertychange!==A?"propertychange":"keyup":p.is("form")?"submit":"click":c.on},templatedURL:function(e){if(e=e||p.data(i.action)||c.action||!1,n=p.data(i.url)||c.url||!1)return l.debug("Using specified url",n),n;if(e){if(l.debug("Looking up url for action",e,c.api),c.api[e]===A&&!l.is.mocked())return void l.error(u.missingAction,c.action,c.api);n=c.api[e]}else l.is.form()&&(n=p.attr("action")||m.attr("action")||!1,l.debug("No url or action specified, defaulting to form action",n));return n}},abort:function(){var e=l.get.xhr();e&&"resolved"!==e.state()&&(l.debug("Cancelling API request"),e.abort())},reset:function(){l.remove.error(),l.remove.loading()},setting:function(e,t){if(l.debug("Changing setting",e,t),I.isPlainObject(e))I.extend(!0,c,e);else{if(t===A)return c[e];I.isPlainObject(c[e])?I.extend(!0,c[e],t):c[e]=t}},internal:function(e,t){if(I.isPlainObject(e))I.extend(!0,l,e);else{if(t===A)return l[e];l[e]=t}},debug:function(){!c.silent&&c.debug&&(c.performance?l.performance.log(arguments):(l.debug=Function.prototype.bind.call(console.info,console,c.name+":"),l.debug.apply(console,arguments)))},verbose:function(){!c.silent&&c.verbose&&c.debug&&(c.performance?l.performance.log(arguments):(l.verbose=Function.prototype.bind.call(console.info,console,c.name+":"),l.verbose.apply(console,arguments)))},error:function(){c.silent||(l.error=Function.prototype.bind.call(console.error,console,c.name+":"),l.error.apply(console,arguments))},performance:{log:function(e){var t,n;c.performance&&(n=(t=(new Date).getTime())-(S||t),S=t,C.push({Name:e[0],Arguments:[].slice.call(e,1)||"","Execution Time":n})),clearTimeout(l.performance.timer),l.performance.timer=setTimeout(l.performance.display,500)},display:function(){var e=c.name+":",n=0;S=!1,clearTimeout(l.performance.timer),I.each(C,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",x&&(e+=" '"+x+"'"),(console.group!==A||console.table!==A)&&0<C.length&&(console.groupCollapsed(e),console.table?console.table(C):I.each(C,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),C=[]}},invoke:function(i,e,t){var o,r,n,s=y;return e=e||R,t=v||t,"string"==typeof i&&s!==A&&(i=i.split(/[\. ]/),o=i.length-1,I.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(I.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==A)return r=s[n],!1;if(!I.isPlainObject(s[t])||e==o)return s[t]!==A?r=s[t]:l.error(u.method,i),!1;s=s[t]}})),I.isFunction(r)?n=r.apply(t,e):r!==A&&(n=r),Array.isArray(T)?T.push(n):T!==A?T=[T,n]:n!==A&&(T=n),r}},P?(y===A&&l.initialize(),l.invoke(E)):(y!==A&&y.invoke("destroy"),l.initialize())}),T!==A?T:this},I.api.settings={name:"API",namespace:"api",debug:!1,verbose:!1,performance:!0,api:{},cache:!0,interruptRequests:!0,on:"auto",stateContext:!1,loadingDuration:0,hideError:"auto",errorDuration:2e3,encodeParameters:!0,action:!1,url:!1,base:"",urlData:{},defaultData:!0,serializeForm:!1,throttle:0,throttleFirstRequest:!0,method:"get",data:{},dataType:"json",mockResponse:!1,mockResponseAsync:!1,response:!1,responseAsync:!1,rawResponse:!1,beforeSend:function(e){return e},beforeXHR:function(e){},onRequest:function(e,t){},onResponse:!1,onSuccess:function(e,t){},onComplete:function(e,t){},onFailure:function(e,t){},onError:function(e,t){},onAbort:function(e,t){},successTest:!1,error:{beforeSend:"The before send function has aborted the request",error:"There was an error with your request",exitConditions:"API Request Aborted. Exit conditions met",JSONParse:"JSON could not be parsed during error handling",legacyParameters:"You are using legacy API success callback names",method:"The method you called is not defined",missingAction:"API action used but no url was defined",missingSerialize:"jquery-serialize-object is required to add form data to an existing data object",missingURL:"No URL specified for api event",noReturnedValue:"The beforeSend callback must return a settings object, beforeSend ignored.",noStorage:"Caching responses locally requires session storage",parseError:"There was an error parsing your request",requiredParameter:"Missing a required URL parameter: ",statusMessage:"Server gave an error: ",timeout:"Your request timed out"},regExp:{required:/\{\$*[A-z0-9]+\}/g,optional:/\{\/\$*[A-z0-9]+\}/g},className:{loading:"loading",error:"error"},selector:{disabled:".disabled",form:"form"},metadata:{action:"action",url:"url"}}}(jQuery,window,document),function(x,e,t,S){"use strict";x.isFunction=x.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e=void 0!==e&&e.Math==Math?e:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),x.fn.state=function(f){var p,g=x(this),m=g.selector||"",v=(new Date).getTime(),b=[],y=f,w="string"==typeof y,T=[].slice.call(arguments,1);return g.each(function(){var a,o=x.isPlainObject(f)?x.extend(!0,{},x.fn.state.settings,f):x.extend({},x.fn.state.settings),l=o.error,n=o.metadata,t=o.className,e=o.namespace,i=o.states,r=o.text,s="."+e,c=e+"-module",u=x(this),d=this,h=u.data(c);a={initialize:function(){a.verbose("Initializing module"),o.automatic&&a.add.defaults(),o.context&&""!==m?x(o.context).on(m,"mouseenter"+s,a.change.text).on(m,"mouseleave"+s,a.reset.text).on(m,"click"+s,a.toggle.state):u.on("mouseenter"+s,a.change.text).on("mouseleave"+s,a.reset.text).on("click"+s,a.toggle.state),a.instantiate()},instantiate:function(){a.verbose("Storing instance of module",a),h=a,u.data(c,a)},destroy:function(){a.verbose("Destroying previous module",h),u.off(s).removeData(c)},refresh:function(){a.verbose("Refreshing selector cache"),u=x(d)},add:{defaults:function(){var n=f&&x.isPlainObject(f.states)?f.states:{};x.each(o.defaults,function(e,t){a.is[e]!==S&&a.is[e]()&&(a.verbose("Adding default states",e,d),x.extend(o.states,t,n))})}},is:{active:function(){return u.hasClass(t.active)},loading:function(){return u.hasClass(t.loading)},inactive:function(){return!u.hasClass(t.active)},state:function(e){return t[e]!==S&&u.hasClass(t[e])},enabled:function(){return!u.is(o.filter.active)},disabled:function(){return u.is(o.filter.active)},textEnabled:function(){return!u.is(o.filter.text)},button:function(){return u.is(".button:not(a, .submit)")},input:function(){return u.is("input")},progress:function(){return u.is(".ui.progress")}},allow:function(e){a.debug("Now allowing state",e),i[e]=!0},disallow:function(e){a.debug("No longer allowing",e),i[e]=!1},allows:function(e){return i[e]||!1},enable:function(){u.removeClass(t.disabled)},disable:function(){u.addClass(t.disabled)},setState:function(e){a.allows(e)&&u.addClass(t[e])},removeState:function(e){a.allows(e)&&u.removeClass(t[e])},toggle:{state:function(){var e;if(a.allows("active")&&a.is.enabled()){if(a.refresh(),x.fn.api!==S)if(e=u.api("get request"),u.api("was cancelled"))a.debug("API Request cancelled by beforesend"),o.activateTest=function(){return!1},o.deactivateTest=function(){return!1};else if(e)return void a.listenTo(e);a.change.state()}}},listenTo:function(e){a.debug("API request detected, waiting for state signal",e),e&&(r.loading&&a.update.text(r.loading),x.when(e).then(function(){"resolved"==e.state()?(a.debug("API request succeeded"),o.activateTest=function(){return!0},o.deactivateTest=function(){return!0}):(a.debug("API request failed"),o.activateTest=function(){return!1},o.deactivateTest=function(){return!1}),a.change.state()}))},change:{state:function(){a.debug("Determining state change direction"),a.is.inactive()?a.activate():a.deactivate(),o.sync&&a.sync(),o.onChange.call(d)},text:function(){a.is.textEnabled()&&(a.is.disabled()?(a.verbose("Changing text to disabled text",r.hover),a.update.text(r.disabled)):a.is.active()?r.hover?(a.verbose("Changing text to hover text",r.hover),a.update.text(r.hover)):r.deactivate&&(a.verbose("Changing text to deactivating text",r.deactivate),a.update.text(r.deactivate)):r.hover?(a.verbose("Changing text to hover text",r.hover),a.update.text(r.hover)):r.activate&&(a.verbose("Changing text to activating text",r.activate),a.update.text(r.activate)))}},activate:function(){o.activateTest.call(d)&&(a.debug("Setting state to active"),u.addClass(t.active),a.update.text(r.active),o.onActivate.call(d))},deactivate:function(){o.deactivateTest.call(d)&&(a.debug("Setting state to inactive"),u.removeClass(t.active),a.update.text(r.inactive),o.onDeactivate.call(d))},sync:function(){a.verbose("Syncing other buttons to current state"),a.is.active()?g.not(u).state("activate"):g.not(u).state("deactivate")},get:{text:function(){return o.selector.text?u.find(o.selector.text).text():u.html()},textFor:function(e){return r[e]||!1}},flash:{text:function(e,t,n){var i=a.get.text();a.debug("Flashing text message",e,t),e=e||o.text.flash,t=t||o.flashDuration,n=n||function(){},a.update.text(e),setTimeout(function(){a.update.text(i),n.call(d)},t)}},reset:{text:function(){var e=r.active||u.data(n.storedText),t=r.inactive||u.data(n.storedText);a.is.textEnabled()&&(a.is.active()&&e?(a.verbose("Resetting active text",e),a.update.text(e)):t&&(a.verbose("Resetting inactive text",e),a.update.text(t)))}},update:{text:function(e){var t=a.get.text();e&&e!==t?(a.debug("Updating text",e),o.selector.text?u.data(n.storedText,e).find(o.selector.text).text(e):u.data(n.storedText,e).html(e)):a.debug("Text is already set, ignoring update",e)}},setting:function(e,t){if(a.debug("Changing setting",e,t),x.isPlainObject(e))x.extend(!0,o,e);else{if(t===S)return o[e];x.isPlainObject(o[e])?x.extend(!0,o[e],t):o[e]=t}},internal:function(e,t){if(x.isPlainObject(e))x.extend(!0,a,e);else{if(t===S)return a[e];a[e]=t}},debug:function(){!o.silent&&o.debug&&(o.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,o.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!o.silent&&o.verbose&&o.debug&&(o.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,o.name+":"),a.verbose.apply(console,arguments)))},error:function(){o.silent||(a.error=Function.prototype.bind.call(console.error,console,o.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;o.performance&&(n=(t=(new Date).getTime())-(v||t),v=t,b.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:d,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=o.name+":",n=0;v=!1,clearTimeout(a.performance.timer),x.each(b,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",m&&(e+=" '"+m+"'"),(console.group!==S||console.table!==S)&&0<b.length&&(console.groupCollapsed(e),console.table?console.table(b):x.each(b,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),b=[]}},invoke:function(i,e,t){var o,r,n,s=h;return e=e||T,t=d||t,"string"==typeof i&&s!==S&&(i=i.split(/[\. ]/),o=i.length-1,x.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(x.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==S)return r=s[n],!1;if(!x.isPlainObject(s[t])||e==o)return s[t]!==S?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),x.isFunction(r)?n=r.apply(t,e):r!==S&&(n=r),Array.isArray(p)?p.push(n):p!==S?p=[p,n]:n!==S&&(p=n),r}},w?(h===S&&a.initialize(),a.invoke(y)):(h!==S&&h.invoke("destroy"),a.initialize())}),p!==S?p:this},x.fn.state.settings={name:"State",debug:!1,verbose:!1,namespace:"state",performance:!0,onActivate:function(){},onDeactivate:function(){},onChange:function(){},activateTest:function(){return!0},deactivateTest:function(){return!0},automatic:!0,sync:!1,flashDuration:1e3,filter:{text:".loading, .disabled",active:".disabled"},context:!1,error:{beforeSend:"The before send function has cancelled state change",method:"The method you called is not defined."},metadata:{promise:"promise",storedText:"stored-text"},className:{active:"active",disabled:"disabled",error:"error",loading:"loading",success:"success",warning:"warning"},selector:{text:!1},defaults:{input:{disabled:!0,loading:!0,active:!0},button:{disabled:!0,loading:!0,active:!0},progress:{active:!0,success:!0,warning:!0,error:!0}},states:{active:!0,disabled:!0,error:!0,loading:!0,success:!0,warning:!0},text:{disabled:!1,flash:!1,hover:!1,active:!1,inactive:!1,activate:!1,deactivate:!1}}}(jQuery,window,document),function(I,_,A,O){"use strict";I.isFunction=I.isFunction||function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},_=void 0!==_&&_.Math==Math?_:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),I.fn.visibility=function(b){var y,e=I(this),w=e.selector||"",T=(new Date).getTime(),x=[],S=b,C="string"==typeof S,E=[].slice.call(arguments,1),P=e.length,R=0;return e.each(function(){var e,t,n,a,o=I.isPlainObject(b)?I.extend(!0,{},I.fn.visibility.settings,b):I.extend({},I.fn.visibility.settings),i=o.className,r=o.namespace,l=o.error,s=o.metadata,c="."+r,u="module-"+r,d=I(_),h=I(this),f=I(o.context),p=h.data(u),g=_.requestAnimationFrame||_.mozRequestAnimationFrame||_.webkitRequestAnimationFrame||_.msRequestAnimationFrame||function(e){setTimeout(e,0)},m=this,v=!1;a={initialize:function(){a.debug("Initializing",o),a.setup.cache(),a.should.trackChanges()&&("image"==o.type&&a.setup.image(),"fixed"==o.type&&a.setup.fixed(),o.observeChanges&&a.observeChanges(),a.bind.events()),a.save.position(),a.is.visible()||a.error(l.visible,h),o.initialCheck&&a.checkVisibility(),a.instantiate()},instantiate:function(){a.debug("Storing instance",a),h.data(u,a),p=a},destroy:function(){a.verbose("Destroying previous module"),n&&n.disconnect(),t&&t.disconnect(),d.off("load"+c,a.event.load).off("resize"+c,a.event.resize),f.off("scroll"+c,a.event.scroll).off("scrollchange"+c,a.event.scrollchange),"fixed"==o.type&&(a.resetFixed(),a.remove.placeholder()),h.off(c).removeData(u)},observeChanges:function(){"MutationObserver"in _&&(t=new MutationObserver(a.event.contextChanged),n=new MutationObserver(a.event.changed),t.observe(A,{childList:!0,subtree:!0}),n.observe(m,{childList:!0,subtree:!0}),a.debug("Setting up mutation observer",n))},bind:{events:function(){a.verbose("Binding visibility events to scroll and resize"),o.refreshOnLoad&&d.on("load"+c,a.event.load),d.on("resize"+c,a.event.resize),f.off("scroll"+c).on("scroll"+c,a.event.scroll).on("scrollchange"+c,a.event.scrollchange)}},event:{changed:function(e){a.verbose("DOM tree modified, updating visibility calculations"),a.timer=setTimeout(function(){a.verbose("DOM tree modified, updating sticky menu"),a.refresh()},100)},contextChanged:function(e){[].forEach.call(e,function(e){e.removedNodes&&[].forEach.call(e.removedNodes,function(e){(e==m||0<I(e).find(m).length)&&(a.debug("Element removed from DOM, tearing down events"),a.destroy())})})},resize:function(){a.debug("Window resized"),o.refreshOnResize&&g(a.refresh)},load:function(){a.debug("Page finished loading"),g(a.refresh)},scroll:function(){o.throttle?(clearTimeout(a.timer),a.timer=setTimeout(function(){f.triggerHandler("scrollchange"+c,[f.scrollTop()])},o.throttle)):g(function(){f.triggerHandler("scrollchange"+c,[f.scrollTop()])})},scrollchange:function(e,t){a.checkVisibility(t)}},precache:function(e,t){e instanceof Array||(e=[e]);for(var n=e.length,i=0,o=[],r=A.createElement("img"),s=function(){++i>=e.length&&I.isFunction(t)&&t()};n--;)(r=A.createElement("img")).onload=s,r.onerror=s,r.src=e[n],o.push(r)},enableCallbacks:function(){a.debug("Allowing callbacks to occur"),v=!1},disableCallbacks:function(){a.debug("Disabling all callbacks temporarily"),v=!0},should:{trackChanges:function(){return C?(a.debug("One time query, no need to bind events"),!1):(a.debug("Callbacks being attached"),!0)}},setup:{cache:function(){a.cache={occurred:{},screen:{},element:{}}},image:function(){var e=h.data(s.src);e&&(a.verbose("Lazy loading image",e),o.once=!0,o.observeChanges=!1,o.onOnScreen=function(){a.debug("Image on screen",m),a.precache(e,function(){a.set.image(e,function(){++R==P&&o.onAllLoaded.call(this),o.onLoad.call(this)})})})},fixed:function(){a.debug("Setting up fixed"),o.once=!1,o.observeChanges=!1,o.initialCheck=!0,o.refreshOnLoad=!0,b.transition||(o.transition=!1),a.create.placeholder(),a.debug("Added placeholder",e),o.onTopPassed=function(){a.debug("Element passed, adding fixed position",h),a.show.placeholder(),a.set.fixed(),o.transition&&I.fn.transition!==O&&h.transition(o.transition,o.duration)},o.onTopPassedReverse=function(){a.debug("Element returned to position, removing fixed",h),a.hide.placeholder(),a.remove.fixed()}}},create:{placeholder:function(){a.verbose("Creating fixed position placeholder"),e=h.clone(!1).css("display","none").addClass(i.placeholder).insertAfter(h)}},show:{placeholder:function(){a.verbose("Showing placeholder"),e.css("display","block").css("visibility","hidden")}},hide:{placeholder:function(){a.verbose("Hiding placeholder"),e.css("display","none").css("visibility","")}},set:{fixed:function(){a.verbose("Setting element to fixed position"),h.addClass(i.fixed).css({position:"fixed",top:o.offset+"px",left:"auto",zIndex:o.zIndex}),o.onFixed.call(m)},image:function(e,t){if(h.attr("src",e),o.transition)if(I.fn.transition!==O){if(h.hasClass(i.visible))return void a.debug("Transition already occurred on this image, skipping animation");h.transition(o.transition,o.duration,t)}else h.fadeIn(o.duration,t);else h.show()}},is:{onScreen:function(){return a.get.elementCalculations().onScreen},offScreen:function(){return a.get.elementCalculations().offScreen},visible:function(){return!(!a.cache||!a.cache.element)&&!(0===a.cache.element.width&&0===a.cache.element.offset.top)},verticallyScrollableContext:function(){var e=f.get(0)!==_&&f.css("overflow-y");return"auto"==e||"scroll"==e},horizontallyScrollableContext:function(){var e=f.get(0)!==_&&f.css("overflow-x");return"auto"==e||"scroll"==e}},refresh:function(){a.debug("Refreshing constants (width/height)"),"fixed"==o.type&&a.resetFixed(),a.reset(),a.save.position(),o.checkOnRefresh&&a.checkVisibility(),o.onRefresh.call(m)},resetFixed:function(){a.remove.fixed(),a.remove.occurred()},reset:function(){a.verbose("Resetting all cached values"),I.isPlainObject(a.cache)&&(a.cache.screen={},a.cache.element={})},checkVisibility:function(e){a.verbose("Checking visibility of element",a.cache.element),!v&&a.is.visible()&&(a.save.scroll(e),a.save.calculations(),a.passed(),a.passingReverse(),a.topVisibleReverse(),a.bottomVisibleReverse(),a.topPassedReverse(),a.bottomPassedReverse(),a.onScreen(),a.offScreen(),a.passing(),a.topVisible(),a.bottomVisible(),a.topPassed(),a.bottomPassed(),o.onUpdate&&o.onUpdate.call(m,a.get.elementCalculations()))},passed:function(e,t){var n=a.get.elementCalculations();if(e&&t)o.onPassed[e]=t;else{if(e!==O)return a.get.pixelsPassed(e)>n.pixelsPassed;n.passing&&I.each(o.onPassed,function(e,t){n.bottomVisible||n.pixelsPassed>a.get.pixelsPassed(e)?a.execute(t,e):o.once||a.remove.occurred(t)})}},onScreen:function(e){var t=a.get.elementCalculations(),n=e||o.onOnScreen;if(e&&(a.debug("Adding callback for onScreen",e),o.onOnScreen=e),t.onScreen?a.execute(n,"onScreen"):o.once||a.remove.occurred("onScreen"),e!==O)return t.onOnScreen},offScreen:function(e){var t=a.get.elementCalculations(),n=e||o.onOffScreen;if(e&&(a.debug("Adding callback for offScreen",e),o.onOffScreen=e),t.offScreen?a.execute(n,"offScreen"):o.once||a.remove.occurred("offScreen"),e!==O)return t.onOffScreen},passing:function(e){var t=a.get.elementCalculations(),n=e||o.onPassing;if(e&&(a.debug("Adding callback for passing",e),o.onPassing=e),t.passing?a.execute(n,"passing"):o.once||a.remove.occurred("passing"),e!==O)return t.passing},topVisible:function(e){var t=a.get.elementCalculations(),n=e||o.onTopVisible,i="topVisible";if(e&&(a.debug("Adding callback for top visible",e),o.onTopVisible=e),t.topVisible?a.execute(n,i):o.once||a.remove.occurred(i),e===O)return t.topVisible},bottomVisible:function(e){var t=a.get.elementCalculations(),n=e||o.onBottomVisible,i="bottomVisible";if(e&&(a.debug("Adding callback for bottom visible",e),o.onBottomVisible=e),t.bottomVisible?a.execute(n,i):o.once||a.remove.occurred(i),e===O)return t.bottomVisible},topPassed:function(e){var t=a.get.elementCalculations(),n=e||o.onTopPassed;if(e&&(a.debug("Adding callback for top passed",e),o.onTopPassed=e),t.topPassed?a.execute(n,"topPassed"):o.once||a.remove.occurred("topPassed"),e===O)return t.topPassed},bottomPassed:function(e){var t=a.get.elementCalculations(),n=e||o.onBottomPassed,i="bottomPassed";if(e&&(a.debug("Adding callback for bottom passed",e),o.onBottomPassed=e),t.bottomPassed?a.execute(n,i):o.once||a.remove.occurred(i),e===O)return t.bottomPassed},passingReverse:function(e){var t=a.get.elementCalculations(),n=e||o.onPassingReverse,i="passingReverse";if(e&&(a.debug("Adding callback for passing reverse",e),o.onPassingReverse=e),t.passing?o.once||a.remove.occurred(i):a.get.occurred("passing")&&a.execute(n,i),e!==O)return!t.passing},topVisibleReverse:function(e){var t=a.get.elementCalculations(),n=e||o.onTopVisibleReverse,i="topVisibleReverse";if(e&&(a.debug("Adding callback for top visible reverse",e),o.onTopVisibleReverse=e),t.topVisible?o.once||a.remove.occurred(i):a.get.occurred("topVisible")&&a.execute(n,i),e===O)return!t.topVisible},bottomVisibleReverse:function(e){var t=a.get.elementCalculations(),n=e||o.onBottomVisibleReverse,i="bottomVisibleReverse";if(e&&(a.debug("Adding callback for bottom visible reverse",e),o.onBottomVisibleReverse=e),t.bottomVisible?o.once||a.remove.occurred(i):a.get.occurred("bottomVisible")&&a.execute(n,i),e===O)return!t.bottomVisible},topPassedReverse:function(e){var t=a.get.elementCalculations(),n=e||o.onTopPassedReverse,i="topPassedReverse";if(e&&(a.debug("Adding callback for top passed reverse",e),o.onTopPassedReverse=e),t.topPassed?o.once||a.remove.occurred(i):a.get.occurred("topPassed")&&a.execute(n,i),e===O)return!t.onTopPassed},bottomPassedReverse:function(e){var t=a.get.elementCalculations(),n=e||o.onBottomPassedReverse,i="bottomPassedReverse";if(e&&(a.debug("Adding callback for bottom passed reverse",e),o.onBottomPassedReverse=e),t.bottomPassed?o.once||a.remove.occurred(i):a.get.occurred("bottomPassed")&&a.execute(n,i),e===O)return!t.bottomPassed},execute:function(e,t){var n=a.get.elementCalculations(),i=a.get.screenCalculations();(e=e||!1)&&(o.continuous?(a.debug("Callback being called continuously",t,n),e.call(m,n,i)):a.get.occurred(t)||(a.debug("Conditions met",t,n),e.call(m,n,i))),a.save.occurred(t)},remove:{fixed:function(){a.debug("Removing fixed position"),h.removeClass(i.fixed).css({position:"",top:"",left:"",zIndex:""}),o.onUnfixed.call(m)},placeholder:function(){a.debug("Removing placeholder content"),e&&e.remove()},occurred:function(e){if(e){var t=a.cache.occurred;t[e]!==O&&!0===t[e]&&(a.debug("Callback can now be called again",e),a.cache.occurred[e]=!1)}else a.cache.occurred={}}},save:{calculations:function(){a.verbose("Saving all calculations necessary to determine positioning"),a.save.direction(),a.save.screenCalculations(),a.save.elementCalculations()},occurred:function(e){e&&(a.cache.occurred[e]!==O&&!0===a.cache.occurred[e]||(a.verbose("Saving callback occurred",e),a.cache.occurred[e]=!0))},scroll:function(e){e=e+o.offset||f.scrollTop()+o.offset,a.cache.scroll=e},direction:function(){var e,t=a.get.scroll(),n=a.get.lastScroll();return e=n<t&&n?"down":t<n&&n?"up":"static",a.cache.direction=e,a.cache.direction},elementPosition:function(){var e=a.cache.element,t=a.get.screenSize();return a.verbose("Saving element position"),e.fits=e.height<t.height,e.offset=h.offset(),e.width=h.outerWidth(),e.height=h.outerHeight(),a.is.verticallyScrollableContext()&&(e.offset.top+=f.scrollTop()-f.offset().top),a.is.horizontallyScrollableContext()&&(e.offset.left+=f.scrollLeft-f.offset().left),a.cache.element=e},elementCalculations:function(){var e=a.get.screenCalculations(),t=a.get.elementPosition();return o.includeMargin?(t.margin={},t.margin.top=parseInt(h.css("margin-top"),10),t.margin.bottom=parseInt(h.css("margin-bottom"),10),t.top=t.offset.top-t.margin.top,t.bottom=t.offset.top+t.height+t.margin.bottom):(t.top=t.offset.top,t.bottom=t.offset.top+t.height),t.topPassed=e.top>=t.top,t.bottomPassed=e.top>=t.bottom,t.topVisible=e.bottom>=t.top&&!t.topPassed,t.bottomVisible=e.bottom>=t.bottom&&!t.bottomPassed,t.pixelsPassed=0,t.percentagePassed=0,t.onScreen=(t.topVisible||t.passing)&&!t.bottomPassed,t.passing=t.topPassed&&!t.bottomPassed,t.offScreen=!t.onScreen,t.passing&&(t.pixelsPassed=e.top-t.top,t.percentagePassed=(e.top-t.top)/t.height),a.cache.element=t,a.verbose("Updated element calculations",t),t},screenCalculations:function(){var e=a.get.scroll();return a.save.direction(),a.cache.screen.top=e,a.cache.screen.bottom=e+a.cache.screen.height,a.cache.screen},screenSize:function(){a.verbose("Saving window position"),a.cache.screen={height:f.height()}},position:function(){a.save.screenSize(),a.save.elementPosition()}},get:{pixelsPassed:function(e){var t=a.get.elementCalculations();return-1<e.search("%")?t.height*(parseInt(e,10)/100):parseInt(e,10)},occurred:function(e){return a.cache.occurred!==O&&a.cache.occurred[e]||!1},direction:function(){return a.cache.direction===O&&a.save.direction(),a.cache.direction},elementPosition:function(){return a.cache.element===O&&a.save.elementPosition(),a.cache.element},elementCalculations:function(){return a.cache.element===O&&a.save.elementCalculations(),a.cache.element},screenCalculations:function(){return a.cache.screen===O&&a.save.screenCalculations(),a.cache.screen},screenSize:function(){return a.cache.screen===O&&a.save.screenSize(),a.cache.screen},scroll:function(){return a.cache.scroll===O&&a.save.scroll(),a.cache.scroll},lastScroll:function(){return a.cache.screen===O?(a.debug("First scroll event, no last scroll could be found"),!1):a.cache.screen.top}},setting:function(e,t){if(I.isPlainObject(e))I.extend(!0,o,e);else{if(t===O)return o[e];o[e]=t}},internal:function(e,t){if(I.isPlainObject(e))I.extend(!0,a,e);else{if(t===O)return a[e];a[e]=t}},debug:function(){!o.silent&&o.debug&&(o.performance?a.performance.log(arguments):(a.debug=Function.prototype.bind.call(console.info,console,o.name+":"),a.debug.apply(console,arguments)))},verbose:function(){!o.silent&&o.verbose&&o.debug&&(o.performance?a.performance.log(arguments):(a.verbose=Function.prototype.bind.call(console.info,console,o.name+":"),a.verbose.apply(console,arguments)))},error:function(){o.silent||(a.error=Function.prototype.bind.call(console.error,console,o.name+":"),a.error.apply(console,arguments))},performance:{log:function(e){var t,n;o.performance&&(n=(t=(new Date).getTime())-(T||t),T=t,x.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:m,"Execution Time":n})),clearTimeout(a.performance.timer),a.performance.timer=setTimeout(a.performance.display,500)},display:function(){var e=o.name+":",n=0;T=!1,clearTimeout(a.performance.timer),I.each(x,function(e,t){n+=t["Execution Time"]}),e+=" "+n+"ms",w&&(e+=" '"+w+"'"),(console.group!==O||console.table!==O)&&0<x.length&&(console.groupCollapsed(e),console.table?console.table(x):I.each(x,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),x=[]}},invoke:function(i,e,t){var o,r,n,s=p;return e=e||E,t=m||t,"string"==typeof i&&s!==O&&(i=i.split(/[\. ]/),o=i.length-1,I.each(i,function(e,t){var n=e!=o?t+i[e+1].charAt(0).toUpperCase()+i[e+1].slice(1):i;if(I.isPlainObject(s[n])&&e!=o)s=s[n];else{if(s[n]!==O)return r=s[n],!1;if(!I.isPlainObject(s[t])||e==o)return s[t]!==O?r=s[t]:a.error(l.method,i),!1;s=s[t]}})),I.isFunction(r)?n=r.apply(t,e):r!==O&&(n=r),Array.isArray(y)?y.push(n):y!==O?y=[y,n]:n!==O&&(y=n),r}},C?(p===O&&a.initialize(),p.save.scroll(),p.save.calculations(),a.invoke(S)):(p!==O&&p.invoke("destroy"),a.initialize())}),y!==O?y:this},I.fn.visibility.settings={name:"Visibility",namespace:"visibility",debug:!1,verbose:!1,performance:!0,observeChanges:!0,initialCheck:!0,refreshOnLoad:!0,refreshOnResize:!0,checkOnRefresh:!0,once:!0,continuous:!1,offset:0,includeMargin:!1,context:_,throttle:!1,type:!1,zIndex:"10",transition:"fade in",duration:1e3,onPassed:{},onOnScreen:!1,onOffScreen:!1,onPassing:!1,onTopVisible:!1,onBottomVisible:!1,onTopPassed:!1,onBottomPassed:!1,onPassingReverse:!1,onTopVisibleReverse:!1,onBottomVisibleReverse:!1,onTopPassedReverse:!1,onBottomPassedReverse:!1,onLoad:function(){},onAllLoaded:function(){},onFixed:function(){},onUnfixed:function(){},onUpdate:!1,onRefresh:function(){},metadata:{src:"src"},className:{fixed:"fixed",placeholder:"constraint",visible:"visible"},error:{method:"The method you called is not defined.",visible:"Element is hidden, you must call refresh after element becomes visible"}}}(jQuery,window,document);